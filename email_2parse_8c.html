<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: email/parse.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><a href="https://neomutt.org"><img alt="Logo" src="neomutt-64.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <a style="color: black; text-decoration: none;" href="https://neomutt.org">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">2025-12-11-236-g400a5f</span>
   </div>
   <div id="projectbrief">Teaching an old dog new tricks</div>
   </a>
   <a href="https://github.com/neomutt/neomutt" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000000; color:#fff; position: fixed; top: 0; border: 0; right: 0; z-index: 9999;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </td>
   <td><a style="text-decoration: none; position: absolute; right: 0; top: 25px; margin-right: 100px; color: #66d866; font-size: 400%;" href="http://www.doxygen.org/index.html">DOXYGEN</a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('email_2parse_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">parse.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Miscellaneous email parsing routines.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;config.h&quot;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &quot;<a class="el" href="mutt_2lib_8h_source.html">mutt/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="address_2lib_8h_source.html">address/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_2lib_8h_source.html">config/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="core_2lib_8h_source.html">core/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mutt_8h_source.html">mutt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="email_2parse_8h_source.html">parse.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="email_2body_8h_source.html">body.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="email_8h_source.html">email.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="envelope_8h_source.html">envelope.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="from_8h_source.html">from.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="globals2_8h_source.html">globals2.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mime_8h_source.html">mime.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="parameter_8h_source.html">parameter.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rfc2047_8h_source.html">rfc2047.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rfc2231_8h_source.html">rfc2231.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="url_8h_source.html">url.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="autocrypt_2lib_8h_source.html">autocrypt/lib.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for parse.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c__incl.svg" width="1606" height="351"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="email_2parse_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afc8bf29df56e545eff7652964eea6081" id="r_afc8bf29df56e545eff7652964eea6081"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afc8bf29df56e545eff7652964eea6081">CONTENT_TOO_BIG</a>&#160;&#160;&#160;(1 &lt;&lt; 30)</td></tr>
<tr class="memdesc:afc8bf29df56e545eff7652964eea6081"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum reasonable Content-Length value (1 GiB) to prevent overflow.  <br /></td></tr>
<tr class="separator:afc8bf29df56e545eff7652964eea6081"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa9d682d64619becd7ca5e03de02f6f18" id="r_aa9d682d64619becd7ca5e03de02f6f18"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa9d682d64619becd7ca5e03de02f6f18">parse_part</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b, int *counter)</td></tr>
<tr class="memdesc:aa9d682d64619becd7ca5e03de02f6f18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a MIME part.  <br /></td></tr>
<tr class="separator:aa9d682d64619becd7ca5e03de02f6f18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f9e27e3cd898ef0935029da9c3dcefd" id="r_a6f9e27e3cd898ef0935029da9c3dcefd"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f9e27e3cd898ef0935029da9c3dcefd">rfc822_parse_message</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *parent, int *counter)</td></tr>
<tr class="memdesc:a6f9e27e3cd898ef0935029da9c3dcefd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a Message/RFC822 body.  <br /></td></tr>
<tr class="separator:a6f9e27e3cd898ef0935029da9c3dcefd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac20b6c54dff7929453167e30d9dcc1a3" id="r_ac20b6c54dff7929453167e30d9dcc1a3"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac20b6c54dff7929453167e30d9dcc1a3">parse_multipart</a> (FILE *fp, const char *boundary, LOFF_T end_off, bool digest, int *counter)</td></tr>
<tr class="memdesc:ac20b6c54dff7929453167e30d9dcc1a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a multipart structure.  <br /></td></tr>
<tr class="separator:ac20b6c54dff7929453167e30d9dcc1a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa024a4cce886fe1fb4a32ed8f1b8d9b9" id="r_aa024a4cce886fe1fb4a32ed8f1b8d9b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa024a4cce886fe1fb4a32ed8f1b8d9b9">mutt_filter_commandline_header_tag</a> (char *header)</td></tr>
<tr class="memdesc:aa024a4cce886fe1fb4a32ed8f1b8d9b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sanitise characters in a header tag.  <br /></td></tr>
<tr class="separator:aa024a4cce886fe1fb4a32ed8f1b8d9b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb759563267cc1a4ee017738d8ee3013" id="r_aeb759563267cc1a4ee017738d8ee3013"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb759563267cc1a4ee017738d8ee3013">mutt_filter_commandline_header_value</a> (char *header)</td></tr>
<tr class="memdesc:aeb759563267cc1a4ee017738d8ee3013"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sanitise characters in a header value.  <br /></td></tr>
<tr class="separator:aeb759563267cc1a4ee017738d8ee3013"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a830caa65e6f462ab0ecae77bce746b" id="r_a2a830caa65e6f462ab0ecae77bce746b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2a830caa65e6f462ab0ecae77bce746b">mutt_auto_subscribe</a> (const char *mailto)</td></tr>
<tr class="memdesc:a2a830caa65e6f462ab0ecae77bce746b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if user is subscribed to mailing list.  <br /></td></tr>
<tr class="separator:a2a830caa65e6f462ab0ecae77bce746b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af286c6b467329705cc1ca7d92f9ad954" id="r_af286c6b467329705cc1ca7d92f9ad954"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af286c6b467329705cc1ca7d92f9ad954">parse_parameters</a> (struct ParameterList *pl, const char *s, bool allow_value_spaces)</td></tr>
<tr class="memdesc:af286c6b467329705cc1ca7d92f9ad954"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a list of Parameters.  <br /></td></tr>
<tr class="separator:af286c6b467329705cc1ca7d92f9ad954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a870232070405e395193a6c7e00e2df60" id="r_a870232070405e395193a6c7e00e2df60"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a870232070405e395193a6c7e00e2df60">parse_content_disposition</a> (const char *s, struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a870232070405e395193a6c7e00e2df60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a content disposition.  <br /></td></tr>
<tr class="separator:a870232070405e395193a6c7e00e2df60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b80e3daa9cb6eb8f8ed5adae704ee10" id="r_a5b80e3daa9cb6eb8f8ed5adae704ee10"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5b80e3daa9cb6eb8f8ed5adae704ee10">parse_references</a> (struct ListHead *head, const char *s)</td></tr>
<tr class="memdesc:a5b80e3daa9cb6eb8f8ed5adae704ee10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse references from an email header.  <br /></td></tr>
<tr class="separator:a5b80e3daa9cb6eb8f8ed5adae704ee10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74dcb6f4b53adc8cc3f61bcf4168fd51" id="r_a74dcb6f4b53adc8cc3f61bcf4168fd51"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a74dcb6f4b53adc8cc3f61bcf4168fd51">parse_content_language</a> (const char *s, struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a74dcb6f4b53adc8cc3f61bcf4168fd51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the content's language.  <br /></td></tr>
<tr class="separator:a74dcb6f4b53adc8cc3f61bcf4168fd51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f2728949322a1a6210d61d9629005d1" id="r_a5f2728949322a1a6210d61d9629005d1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a> (const char *s)</td></tr>
<tr class="memdesc:a5f2728949322a1a6210d61d9629005d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the string match the ignore list.  <br /></td></tr>
<tr class="separator:a5f2728949322a1a6210d61d9629005d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c22ec026399e230ecedab86f831a754" id="r_a6c22ec026399e230ecedab86f831a754"><td class="memItemLeft" align="right" valign="top">enum <a class="el" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79">ContentType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6c22ec026399e230ecedab86f831a754">mutt_check_mime_type</a> (const char *s)</td></tr>
<tr class="memdesc:a6c22ec026399e230ecedab86f831a754"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check a MIME type string.  <br /></td></tr>
<tr class="separator:a6c22ec026399e230ecedab86f831a754"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7b7d3d9446a52fbc31ef18eea1b52c2" id="r_aa7b7d3d9446a52fbc31ef18eea1b52c2"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa7b7d3d9446a52fbc31ef18eea1b52c2">mutt_extract_message_id</a> (const char *s, size_t *len)</td></tr>
<tr class="memdesc:aa7b7d3d9446a52fbc31ef18eea1b52c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find a message-id.  <br /></td></tr>
<tr class="separator:aa7b7d3d9446a52fbc31ef18eea1b52c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8692f01c25d10e357dbeee470ba26c2c" id="r_a8692f01c25d10e357dbeee470ba26c2c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8692f01c25d10e357dbeee470ba26c2c">mutt_check_encoding</a> (const char *c)</td></tr>
<tr class="memdesc:a8692f01c25d10e357dbeee470ba26c2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the encoding type.  <br /></td></tr>
<tr class="separator:a8692f01c25d10e357dbeee470ba26c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c0bcb79c2ff930b4131a1ede5828762" id="r_a1c0bcb79c2ff930b4131a1ede5828762"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1c0bcb79c2ff930b4131a1ede5828762">mutt_parse_content_type</a> (const char *s, struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a1c0bcb79c2ff930b4131a1ede5828762"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a content type.  <br /></td></tr>
<tr class="separator:a1c0bcb79c2ff930b4131a1ede5828762"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5875b5c866cb7caa2fb55c960bf59f2b" id="r_a5875b5c866cb7caa2fb55c960bf59f2b"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structAutocryptHeader.html">AutocryptHeader</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5875b5c866cb7caa2fb55c960bf59f2b">parse_autocrypt</a> (struct <a class="el" href="structAutocryptHeader.html">AutocryptHeader</a> *head, const char *s)</td></tr>
<tr class="memdesc:a5875b5c866cb7caa2fb55c960bf59f2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse an Autocrypt header line.  <br /></td></tr>
<tr class="separator:a5875b5c866cb7caa2fb55c960bf59f2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60bcab5634e02e9173938bb7ae4fec8b" id="r_a60bcab5634e02e9173938bb7ae4fec8b"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a60bcab5634e02e9173938bb7ae4fec8b">rfc2369_first_mailto</a> (const char *body)</td></tr>
<tr class="memdesc:a60bcab5634e02e9173938bb7ae4fec8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract the first mailto: URL from a RFC2369 list.  <br /></td></tr>
<tr class="separator:a60bcab5634e02e9173938bb7ae4fec8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a012cf883e316be91676a2f589b48f330" id="r_a012cf883e316be91676a2f589b48f330"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a012cf883e316be91676a2f589b48f330">mutt_rfc822_parse_line</a> (struct <a class="el" href="structEnvelope.html">Envelope</a> *env, struct <a class="el" href="structEmail.html">Email</a> *e, const char *name, size_t name_len, const char *body, bool user_hdrs, bool weed, bool do_2047)</td></tr>
<tr class="memdesc:a012cf883e316be91676a2f589b48f330"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse an email header.  <br /></td></tr>
<tr class="separator:a012cf883e316be91676a2f589b48f330"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b38814d1731678ff2a62299a565e0d2" id="r_a2b38814d1731678ff2a62299a565e0d2"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b38814d1731678ff2a62299a565e0d2">mutt_rfc822_read_line</a> (FILE *fp, struct <a class="el" href="structBuffer.html">Buffer</a> *buf)</td></tr>
<tr class="memdesc:a2b38814d1731678ff2a62299a565e0d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a header line from a file.  <br /></td></tr>
<tr class="separator:a2b38814d1731678ff2a62299a565e0d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a709f7f23d8a54a0f75abc28a0b365ace" id="r_a709f7f23d8a54a0f75abc28a0b365ace"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structEnvelope.html">Envelope</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a709f7f23d8a54a0f75abc28a0b365ace">mutt_rfc822_read_header</a> (FILE *fp, struct <a class="el" href="structEmail.html">Email</a> *e, bool user_hdrs, bool weed)</td></tr>
<tr class="memdesc:a709f7f23d8a54a0f75abc28a0b365ace"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses an RFC822 header.  <br /></td></tr>
<tr class="separator:a709f7f23d8a54a0f75abc28a0b365ace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cfe061d82e6381b14e355c0937ecfc1" id="r_a2cfe061d82e6381b14e355c0937ecfc1"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2cfe061d82e6381b14e355c0937ecfc1">mutt_read_mime_header</a> (FILE *fp, bool digest)</td></tr>
<tr class="memdesc:a2cfe061d82e6381b14e355c0937ecfc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a MIME header.  <br /></td></tr>
<tr class="separator:a2cfe061d82e6381b14e355c0937ecfc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcc90fb584fec1be116777c533e9b3d4" id="r_adcc90fb584fec1be116777c533e9b3d4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adcc90fb584fec1be116777c533e9b3d4">mutt_is_message_type</a> (int type, const char *subtype)</td></tr>
<tr class="memdesc:adcc90fb584fec1be116777c533e9b3d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if a mime type matches a message or not.  <br /></td></tr>
<tr class="separator:adcc90fb584fec1be116777c533e9b3d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a779380b3b7d9a2948d1b21b99f2f9532" id="r_a779380b3b7d9a2948d1b21b99f2f9532"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a779380b3b7d9a2948d1b21b99f2f9532">mailto_header_allowed</a> (const char *s, struct ListHead *h)</td></tr>
<tr class="memdesc:a779380b3b7d9a2948d1b21b99f2f9532"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is the string in the list.  <br /></td></tr>
<tr class="separator:a779380b3b7d9a2948d1b21b99f2f9532"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85f5f11a70b04f611f3e131f67644fbf" id="r_a85f5f11a70b04f611f3e131f67644fbf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85f5f11a70b04f611f3e131f67644fbf">mutt_parse_mailto</a> (struct <a class="el" href="structEnvelope.html">Envelope</a> *env, char **body, const char *src)</td></tr>
<tr class="memdesc:a85f5f11a70b04f611f3e131f67644fbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a mailto:// url.  <br /></td></tr>
<tr class="separator:a85f5f11a70b04f611f3e131f67644fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b38ac4f44b3414d0e18d26324861369" id="r_a0b38ac4f44b3414d0e18d26324861369"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b38ac4f44b3414d0e18d26324861369">mutt_parse_part</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a0b38ac4f44b3414d0e18d26324861369"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a MIME part.  <br /></td></tr>
<tr class="separator:a0b38ac4f44b3414d0e18d26324861369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a62f0f03006788df8c7bdd6f687457f" id="r_a0a62f0f03006788df8c7bdd6f687457f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a62f0f03006788df8c7bdd6f687457f">mutt_rfc822_parse_message</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a0a62f0f03006788df8c7bdd6f687457f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a Message/RFC822 body.  <br /></td></tr>
<tr class="separator:a0a62f0f03006788df8c7bdd6f687457f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c098e697548d0ad0809a1ac49b91f8e" id="r_a9c098e697548d0ad0809a1ac49b91f8e"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9c098e697548d0ad0809a1ac49b91f8e">mutt_parse_multipart</a> (FILE *fp, const char *boundary, LOFF_T end_off, bool digest)</td></tr>
<tr class="memdesc:a9c098e697548d0ad0809a1ac49b91f8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a multipart structure.  <br /></td></tr>
<tr class="separator:a9c098e697548d0ad0809a1ac49b91f8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Miscellaneous email parsing routines. </p>
<dl class="section author"><dt>Authors</dt><dd><ul>
<li>Richard Russon</li>
<li>Pietro Cerutti</li>
<li>Federico Kircheis</li>
<li>Ian Zimmerman</li>
<li>Christian Ludwig</li>
<li>David Purton</li>
<li>Steinar H Gunderson</li>
<li>Thomas Klausner</li>
</ul>
</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 2 of the License, or (at your option) any later version.</dd></dl>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>

<p class="definition">Definition in file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="afc8bf29df56e545eff7652964eea6081" name="afc8bf29df56e545eff7652964eea6081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc8bf29df56e545eff7652964eea6081">&#9670;&#160;</a></span>CONTENT_TOO_BIG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTENT_TOO_BIG&#160;&#160;&#160;(1 &lt;&lt; 30)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum reasonable Content-Length value (1 GiB) to prevent overflow. </p>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00061">61</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa9d682d64619becd7ca5e03de02f6f18" name="aa9d682d64619becd7ca5e03de02f6f18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9d682d64619becd7ca5e03de02f6f18">&#9670;&#160;</a></span>parse_part()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void parse_part </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>counter</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse a MIME part. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>File to read from </td></tr>
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> to store the results in </td></tr>
    <tr><td class="paramname">counter</td><td>Number of parts processed so far </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l01513">1513</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1514</span>{</div>
<div class="line"><span class="lineno"> 1515</span>  <span class="keywordflow">if</span> (!fp || !b)</div>
<div class="line"><span class="lineno"> 1516</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1517</span> </div>
<div class="line"><span class="lineno"> 1518</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *bound = NULL;</div>
<div class="line"><span class="lineno"> 1519</span>  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> recurse_level = 0;</div>
<div class="line"><span class="lineno"> 1520</span> </div>
<div class="line"><span class="lineno"> 1521</span>  <span class="keywordflow">if</span> (recurse_level &gt;= <a class="code hl_define" href="mime_8h.html#a37d78827e3cbfabf93b6341b5da8cdc1">MUTT_MIME_MAX_DEPTH</a>)</div>
<div class="line"><span class="lineno"> 1522</span>  {</div>
<div class="line"><span class="lineno"> 1523</span>    <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;recurse level too deep. giving up\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1524</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1525</span>  }</div>
<div class="line"><span class="lineno"> 1526</span>  recurse_level++;</div>
<div class="line"><span class="lineno"> 1527</span> </div>
<div class="line"><span class="lineno"> 1528</span>  <span class="keywordflow">switch</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a>)</div>
<div class="line"><span class="lineno"> 1529</span>  {</div>
<div class="line"><span class="lineno"> 1530</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>:</div>
<div class="line"><span class="lineno"> 1531</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;x-sun-attachment&quot;</span>))</div>
<div class="line"><span class="lineno"> 1532</span>        bound = <span class="stringliteral">&quot;--------&quot;</span>;</div>
<div class="line"><span class="lineno"> 1533</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1534</span>        bound = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;boundary&quot;</span>);</div>
<div class="line"><span class="lineno"> 1535</span> </div>
<div class="line"><span class="lineno"> 1536</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a>(fp, b-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>, SEEK_SET))</div>
<div class="line"><span class="lineno"> 1537</span>      {</div>
<div class="line"><span class="lineno"> 1538</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno"> 1539</span>      }</div>
<div class="line"><span class="lineno"> 1540</span>      b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = <a class="code hl_function" href="#ac20b6c54dff7929453167e30d9dcc1a3">parse_multipart</a>(fp, bound, b-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a> + b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a>,</div>
<div class="line"><span class="lineno"> 1541</span>                                 <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;digest&quot;</span>, b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>), counter);</div>
<div class="line"><span class="lineno"> 1542</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1543</span> </div>
<div class="line"><span class="lineno"> 1544</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a>:</div>
<div class="line"><span class="lineno"> 1545</span>      <span class="keywordflow">if</span> (!b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>)</div>
<div class="line"><span class="lineno"> 1546</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1547</span> </div>
<div class="line"><span class="lineno"> 1548</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a>(fp, b-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>, SEEK_SET))</div>
<div class="line"><span class="lineno"> 1549</span>      {</div>
<div class="line"><span class="lineno"> 1550</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno"> 1551</span>      }</div>
<div class="line"><span class="lineno"> 1552</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="#adcc90fb584fec1be116777c533e9b3d4">mutt_is_message_type</a>(b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a>, b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>))</div>
<div class="line"><span class="lineno"> 1553</span>        b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = <a class="code hl_function" href="#a6f9e27e3cd898ef0935029da9c3dcefd">rfc822_parse_message</a>(fp, b, counter);</div>
<div class="line"><span class="lineno"> 1554</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;external-body&quot;</span>))</div>
<div class="line"><span class="lineno"> 1555</span>        b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = <a class="code hl_function" href="#a2cfe061d82e6381b14e355c0937ecfc1">mutt_read_mime_header</a>(fp, 0);</div>
<div class="line"><span class="lineno"> 1556</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1557</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno"> 1558</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1559</span> </div>
<div class="line"><span class="lineno"> 1560</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1561</span>      <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno"> 1562</span>  }</div>
<div class="line"><span class="lineno"> 1563</span> </div>
<div class="line"><span class="lineno"> 1564</span>  <span class="comment">/* try to recover from parsing error */</span></div>
<div class="line"><span class="lineno"> 1565</span>  <span class="keywordflow">if</span> (!b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>)</div>
<div class="line"><span class="lineno"> 1566</span>  {</div>
<div class="line"><span class="lineno"> 1567</span>    b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> = <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>;</div>
<div class="line"><span class="lineno"> 1568</span>    <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;plain&quot;</span>);</div>
<div class="line"><span class="lineno"> 1569</span>  }</div>
<div class="line"><span class="lineno"> 1570</span>bail:</div>
<div class="line"><span class="lineno"> 1571</span>  recurse_level--;</div>
<div class="line"><span class="lineno"> 1572</span>}</div>
<div class="ttc" id="aemail_2parse_8c_html_a2cfe061d82e6381b14e355c0937ecfc1"><div class="ttname"><a href="#a2cfe061d82e6381b14e355c0937ecfc1">mutt_read_mime_header</a></div><div class="ttdeci">struct Body * mutt_read_mime_header(FILE *fp, bool digest)</div><div class="ttdoc">Parse a MIME header.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01361">parse.c:1361</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a6f9e27e3cd898ef0935029da9c3dcefd"><div class="ttname"><a href="#a6f9e27e3cd898ef0935029da9c3dcefd">rfc822_parse_message</a></div><div class="ttdeci">static struct Body * rfc822_parse_message(FILE *fp, struct Body *parent, int *counter)</div><div class="ttdoc">Parse a Message/RFC822 body.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01694">parse.c:1694</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_ac20b6c54dff7929453167e30d9dcc1a3"><div class="ttname"><a href="#ac20b6c54dff7929453167e30d9dcc1a3">parse_multipart</a></div><div class="ttdeci">static struct Body * parse_multipart(FILE *fp, const char *boundary, LOFF_T end_off, bool digest, int *counter)</div><div class="ttdoc">Parse a multipart structure.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01584">parse.c:1584</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_adcc90fb584fec1be116777c533e9b3d4"><div class="ttname"><a href="#adcc90fb584fec1be116777c533e9b3d4">mutt_is_message_type</a></div><div class="ttdeci">bool mutt_is_message_type(int type, const char *subtype)</div><div class="ttdoc">Determine if a mime type matches a message or not.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01497">parse.c:1497</a></div></div>
<div class="ttc" id="afile_8c_html_a6b60cb2044041374689e6e6641c5cc05"><div class="ttname"><a href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a></div><div class="ttdeci">bool mutt_file_seek(FILE *fp, LOFF_T offset, int whence)</div><div class="ttdoc">Wrapper for fseeko with error handling.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00652">file.c:652</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gae6c5fd73af3410b2d5e8099f8774c8da"><div class="ttname"><a href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a></div><div class="ttdeci">#define mutt_debug(LEVEL,...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00091">logging2.h:91</a></div></div>
<div class="ttc" id="alogging2_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5"><div class="ttname"><a href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a></div><div class="ttdeci">@ LL_DEBUG1</div><div class="ttdoc">Log at debug level 1.</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00045">logging2.h:45</a></div></div>
<div class="ttc" id="amime_8h_html_a37d78827e3cbfabf93b6341b5da8cdc1"><div class="ttname"><a href="mime_8h.html#a37d78827e3cbfabf93b6341b5da8cdc1">MUTT_MIME_MAX_DEPTH</a></div><div class="ttdeci">#define MUTT_MIME_MAX_DEPTH</div><div class="ttdoc">Maximum nesting depth for MIME parts to prevent stack overflow.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00069">mime.h:69</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a></div><div class="ttdeci">@ TYPE_MESSAGE</div><div class="ttdoc">Type: &#39;message/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00035">mime.h:35</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a></div><div class="ttdeci">@ TYPE_MULTIPART</div><div class="ttdoc">Type: &#39;multipart/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00037">mime.h:37</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdeci">@ TYPE_TEXT</div><div class="ttdoc">Type: &#39;text/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00674">string.c:674</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_af8c32ffc64dd55e92001a974a4be6bbf"><div class="ttname"><a href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a></div><div class="ttdeci">char * mutt_str_replace(char **p, const char *s)</div><div class="ttdoc">Replace one string with another.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00284">string.c:284</a></div></div>
<div class="ttc" id="aparameter_8c_html_a31d10561ad6b3637e7591569b903aa33"><div class="ttname"><a href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a></div><div class="ttdeci">char * mutt_param_get(const struct ParameterList *pl, const char *s)</div><div class="ttdoc">Find a matching Parameter.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8c_source.html#l00085">parameter.c:85</a></div></div>
<div class="ttc" id="astructBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00073">body.h:73</a></div></div>
<div class="ttc" id="astructBody_html_a1969dfeb0a155ccb16153fe777a103b0"><div class="ttname"><a href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">Body::offset</a></div><div class="ttdeci">LOFF_T offset</div><div class="ttdoc">offset where the actual data begins</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00052">body.h:52</a></div></div>
<div class="ttc" id="astructBody_html_a6f92d7ec8568ca04ae07931c56dd0790"><div class="ttname"><a href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">Body::length</a></div><div class="ttdeci">LOFF_T length</div><div class="ttdoc">length (in bytes) of attachment</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00053">body.h:53</a></div></div>
<div class="ttc" id="astructBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">Parameters of the content-type.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00063">body.h:63</a></div></div>
<div class="ttc" id="astructBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00061">body.h:61</a></div></div>
<div class="ttc" id="astructBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00040">body.h:40</a></div></div>
</div><!-- fragment --><div id="dynsection-1" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_aa9d682d64619becd7ca5e03de02f6f18_cgraph.svg" width="711" height="400"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-2" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_aa9d682d64619becd7ca5e03de02f6f18_icgraph.svg" width="312" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6f9e27e3cd898ef0935029da9c3dcefd" name="a6f9e27e3cd898ef0935029da9c3dcefd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f9e27e3cd898ef0935029da9c3dcefd">&#9670;&#160;</a></span>rfc822_parse_message()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structBody.html">Body</a> * rfc822_parse_message </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>parent</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>counter</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse a Message/RFC822 body. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>Stream to read from </td></tr>
    <tr><td class="paramname">parent</td><td>Info about the message/rfc822 body part </td></tr>
    <tr><td class="paramname">counter</td><td>Number of parts processed so far </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>New <a class="el" href="structBody.html" title="The body of an email.">Body</a> containing parsed message</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This assumes that 'parent-&gt;length' has been set! </dd></dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l01694">1694</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1695</span>{</div>
<div class="line"><span class="lineno"> 1696</span>  <span class="keywordflow">if</span> (!fp || !parent)</div>
<div class="line"><span class="lineno"> 1697</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1698</span> </div>
<div class="line"><span class="lineno"> 1699</span>  parent-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a> = <a class="code hl_function" href="email_2email_8c.html#ab53e91414f24cecdc75fcfea6f1824e3">email_new</a>();</div>
<div class="line"><span class="lineno"> 1700</span>  parent-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>-&gt;<a class="code hl_variable" href="structEmail.html#a8d35ff6f232f83e89e2d46af416708cc">offset</a> = ftello(fp);</div>
<div class="line"><span class="lineno"> 1701</span>  parent-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a> = <a class="code hl_function" href="#a709f7f23d8a54a0f75abc28a0b365ace">mutt_rfc822_read_header</a>(fp, parent-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1702</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *msg = parent-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div>
<div class="line"><span class="lineno"> 1703</span> </div>
<div class="line"><span class="lineno"> 1704</span>  <span class="comment">/* ignore the length given in the content-length since it could be wrong</span></div>
<div class="line"><span class="lineno"> 1705</span><span class="comment">   * and we already have the info to calculate the correct length */</span></div>
<div class="line"><span class="lineno"> 1706</span>  <span class="comment">/* if (msg-&gt;length == -1) */</span></div>
<div class="line"><span class="lineno"> 1707</span>  msg-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = parent-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> - (msg-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a> - parent-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>);</div>
<div class="line"><span class="lineno"> 1708</span> </div>
<div class="line"><span class="lineno"> 1709</span>  <span class="comment">/* if body of this message is empty, we can end up with a negative length */</span></div>
<div class="line"><span class="lineno"> 1710</span>  <span class="keywordflow">if</span> (msg-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 1711</span>    msg-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = 0;</div>
<div class="line"><span class="lineno"> 1712</span> </div>
<div class="line"><span class="lineno"> 1713</span>  <a class="code hl_function" href="#aa9d682d64619becd7ca5e03de02f6f18">parse_part</a>(fp, msg, counter);</div>
<div class="line"><span class="lineno"> 1714</span>  <span class="keywordflow">return</span> msg;</div>
<div class="line"><span class="lineno"> 1715</span>}</div>
<div class="ttc" id="aemail_2email_8c_html_ab53e91414f24cecdc75fcfea6f1824e3"><div class="ttname"><a href="email_2email_8c.html#ab53e91414f24cecdc75fcfea6f1824e3">email_new</a></div><div class="ttdeci">struct Email * email_new(void)</div><div class="ttdoc">Create a new Email.</div><div class="ttdef"><b>Definition</b> <a href="email_2email_8c_source.html#l00077">email.c:77</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a709f7f23d8a54a0f75abc28a0b365ace"><div class="ttname"><a href="#a709f7f23d8a54a0f75abc28a0b365ace">mutt_rfc822_read_header</a></div><div class="ttdeci">struct Envelope * mutt_rfc822_read_header(FILE *fp, struct Email *e, bool user_hdrs, bool weed)</div><div class="ttdoc">Parses an RFC822 header.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01204">parse.c:1204</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_aa9d682d64619becd7ca5e03de02f6f18"><div class="ttname"><a href="#aa9d682d64619becd7ca5e03de02f6f18">parse_part</a></div><div class="ttdeci">static void parse_part(FILE *fp, struct Body *b, int *counter)</div><div class="ttdoc">Parse a MIME part.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01513">parse.c:1513</a></div></div>
<div class="ttc" id="astructBody_html"><div class="ttname"><a href="structBody.html">Body</a></div><div class="ttdoc">The body of an email.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00035">body.h:36</a></div></div>
<div class="ttc" id="astructBody_html_a8e10ba22522218bd12bd3cb38dd3fcc9"><div class="ttname"><a href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">Body::email</a></div><div class="ttdeci">struct Email * email</div><div class="ttdoc">header information for message/rfc822</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00074">body.h:74</a></div></div>
<div class="ttc" id="astructEmail_html_a34cc4493729d7a3b1f4ed783e739a9ec"><div class="ttname"><a href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">Email::env</a></div><div class="ttdeci">struct Envelope * env</div><div class="ttdoc">Envelope information.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00068">email.h:68</a></div></div>
<div class="ttc" id="astructEmail_html_a57ad6ac618c0f685804f6f5bb390b3a6"><div class="ttname"><a href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">Email::body</a></div><div class="ttdeci">struct Body * body</div><div class="ttdoc">List of MIME parts.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00069">email.h:69</a></div></div>
<div class="ttc" id="astructEmail_html_a8d35ff6f232f83e89e2d46af416708cc"><div class="ttname"><a href="structEmail.html#a8d35ff6f232f83e89e2d46af416708cc">Email::offset</a></div><div class="ttdeci">LOFF_T offset</div><div class="ttdoc">Where in the stream does this message begin?</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00071">email.h:71</a></div></div>
</div><!-- fragment --><div id="dynsection-3" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a6f9e27e3cd898ef0935029da9c3dcefd_cgraph.svg" width="407" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-4" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a6f9e27e3cd898ef0935029da9c3dcefd_icgraph.svg" width="424" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac20b6c54dff7929453167e30d9dcc1a3" name="ac20b6c54dff7929453167e30d9dcc1a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac20b6c54dff7929453167e30d9dcc1a3">&#9670;&#160;</a></span>parse_multipart()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structBody.html">Body</a> * parse_multipart </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>boundary</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LOFF_T</td>          <td class="paramname"><span class="paramname"><em>end_off</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>digest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>counter</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse a multipart structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>Stream to read from </td></tr>
    <tr><td class="paramname">boundary</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> separator </td></tr>
    <tr><td class="paramname">end_off</td><td>Length of the multipart body (used when the final boundary is missing to avoid reading too far) </td></tr>
    <tr><td class="paramname">digest</td><td>true if reading a multipart/digest </td></tr>
    <tr><td class="paramname">counter</td><td>Number of parts processed so far </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>New <a class="el" href="structBody.html" title="The body of an email.">Body</a> containing parsed structure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l01584">1584</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1586</span>{</div>
<div class="line"><span class="lineno"> 1587</span>  <span class="keywordflow">if</span> (!fp)</div>
<div class="line"><span class="lineno"> 1588</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1589</span> </div>
<div class="line"><span class="lineno"> 1590</span>  <span class="keywordflow">if</span> (!boundary)</div>
<div class="line"><span class="lineno"> 1591</span>  {</div>
<div class="line"><span class="lineno"> 1592</span>    <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;multipart message has no boundary parameter&quot;</span>));</div>
<div class="line"><span class="lineno"> 1593</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1594</span>  }</div>
<div class="line"><span class="lineno"> 1595</span> </div>
<div class="line"><span class="lineno"> 1596</span>  <span class="keywordtype">char</span> buf[1024] = { 0 };</div>
<div class="line"><span class="lineno"> 1597</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *head = NULL, *last = NULL, *new_body = NULL;</div>
<div class="line"><span class="lineno"> 1598</span>  <span class="keywordtype">bool</span> <span class="keyword">final</span> = <span class="keyword">false</span>; <span class="comment">/* did we see the ending boundary? */</span></div>
<div class="line"><span class="lineno"> 1599</span> </div>
<div class="line"><span class="lineno"> 1600</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> blen = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(boundary);</div>
<div class="line"><span class="lineno"> 1601</span>  <span class="keywordflow">while</span> ((ftello(fp) &lt; end_off) &amp;&amp; fgets(buf, <span class="keyword">sizeof</span>(buf), fp))</div>
<div class="line"><span class="lineno"> 1602</span>  {</div>
<div class="line"><span class="lineno"> 1603</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> len = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(buf);</div>
<div class="line"><span class="lineno"> 1604</span> </div>
<div class="line"><span class="lineno"> 1605</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> crlf = ((len &gt; 1) &amp;&amp; (buf[len - 2] == <span class="charliteral">&#39;\r&#39;</span>)) ? 1 : 0;</div>
<div class="line"><span class="lineno"> 1606</span> </div>
<div class="line"><span class="lineno"> 1607</span>    <span class="keywordflow">if</span> ((buf[0] == <span class="charliteral">&#39;-&#39;</span>) &amp;&amp; (buf[1] == <span class="charliteral">&#39;-&#39;</span>) &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a>(buf + 2, boundary))</div>
<div class="line"><span class="lineno"> 1608</span>    {</div>
<div class="line"><span class="lineno"> 1609</span>      <span class="keywordflow">if</span> (last)</div>
<div class="line"><span class="lineno"> 1610</span>      {</div>
<div class="line"><span class="lineno"> 1611</span>        last-&gt;length = ftello(fp) - last-&gt;offset - len - 1 - crlf;</div>
<div class="line"><span class="lineno"> 1612</span>        <span class="keywordflow">if</span> (last-&gt;parts &amp;&amp; (last-&gt;parts-&gt;length == 0))</div>
<div class="line"><span class="lineno"> 1613</span>          last-&gt;parts-&gt;length = ftello(fp) - last-&gt;parts-&gt;offset - len - 1 - crlf;</div>
<div class="line"><span class="lineno"> 1614</span>        <span class="comment">/* if the body is empty, we can end up with a -1 length */</span></div>
<div class="line"><span class="lineno"> 1615</span>        <span class="keywordflow">if</span> (last-&gt;length &lt; 0)</div>
<div class="line"><span class="lineno"> 1616</span>          last-&gt;length = 0;</div>
<div class="line"><span class="lineno"> 1617</span>      }</div>
<div class="line"><span class="lineno"> 1618</span> </div>
<div class="line"><span class="lineno"> 1619</span>      <span class="keywordflow">if</span> (len &gt; 0)</div>
<div class="line"><span class="lineno"> 1620</span>      {</div>
<div class="line"><span class="lineno"> 1621</span>        <span class="comment">/* Remove any trailing whitespace, up to the length of the boundary */</span></div>
<div class="line"><span class="lineno"> 1622</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = len - 1; <a class="code hl_function" href="ctype_8c.html#a16dd3da88a22f7e3ea99e3474fc46fda">mutt_isspace</a>(buf[i]) &amp;&amp; (i &gt;= (blen + 2)); i--)</div>
<div class="line"><span class="lineno"> 1623</span>          buf[i] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1624</span>      }</div>
<div class="line"><span class="lineno"> 1625</span> </div>
<div class="line"><span class="lineno"> 1626</span>      <span class="comment">/* Check for the end boundary */</span></div>
<div class="line"><span class="lineno"> 1627</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(buf + blen + 2, <span class="stringliteral">&quot;--&quot;</span>))</div>
<div class="line"><span class="lineno"> 1628</span>      {</div>
<div class="line"><span class="lineno"> 1629</span>        <span class="keyword">final</span> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1630</span>        <span class="keywordflow">break</span>; <span class="comment">/* done parsing */</span></div>
<div class="line"><span class="lineno"> 1631</span>      }</div>
<div class="line"><span class="lineno"> 1632</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (buf[2 + blen] == <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno"> 1633</span>      {</div>
<div class="line"><span class="lineno"> 1634</span>        new_body = <a class="code hl_function" href="#a2cfe061d82e6381b14e355c0937ecfc1">mutt_read_mime_header</a>(fp, digest);</div>
<div class="line"><span class="lineno"> 1635</span>        <span class="keywordflow">if</span> (!new_body)</div>
<div class="line"><span class="lineno"> 1636</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1637</span> </div>
<div class="line"><span class="lineno"> 1638</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;new_body-&gt;parameter, <span class="stringliteral">&quot;content-lines&quot;</span>))</div>
<div class="line"><span class="lineno"> 1639</span>        {</div>
<div class="line"><span class="lineno"> 1640</span>          <span class="keywordtype">int</span> lines = 0;</div>
<div class="line"><span class="lineno"> 1641</span>          <a class="code hl_function" href="atoi_8c.html#ae5e07d3703764e9773459be2a6461f07">mutt_str_atoi</a>(<a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;new_body-&gt;parameter, <span class="stringliteral">&quot;content-lines&quot;</span>), &amp;lines);</div>
<div class="line"><span class="lineno"> 1642</span>          <span class="keywordflow">for</span> (; lines &gt; 0; lines--)</div>
<div class="line"><span class="lineno"> 1643</span>            <span class="keywordflow">if</span> ((ftello(fp) &gt;= end_off) || !fgets(buf, <span class="keyword">sizeof</span>(buf), fp))</div>
<div class="line"><span class="lineno"> 1644</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1645</span>        }</div>
<div class="line"><span class="lineno"> 1646</span> </div>
<div class="line"><span class="lineno"> 1647</span>        <span class="comment">/* Consistency checking - catch bad attachment end boundaries */</span></div>
<div class="line"><span class="lineno"> 1648</span>        <span class="keywordflow">if</span> (new_body-&gt;offset &gt; end_off)</div>
<div class="line"><span class="lineno"> 1649</span>        {</div>
<div class="line"><span class="lineno"> 1650</span>          <a class="code hl_function" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;new_body);</div>
<div class="line"><span class="lineno"> 1651</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1652</span>        }</div>
<div class="line"><span class="lineno"> 1653</span>        <span class="keywordflow">if</span> (head)</div>
<div class="line"><span class="lineno"> 1654</span>        {</div>
<div class="line"><span class="lineno"> 1655</span>          last-&gt;next = new_body;</div>
<div class="line"><span class="lineno"> 1656</span>          last = new_body;</div>
<div class="line"><span class="lineno"> 1657</span>        }</div>
<div class="line"><span class="lineno"> 1658</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1659</span>        {</div>
<div class="line"><span class="lineno"> 1660</span>          last = new_body;</div>
<div class="line"><span class="lineno"> 1661</span>          head = new_body;</div>
<div class="line"><span class="lineno"> 1662</span>        }</div>
<div class="line"><span class="lineno"> 1663</span> </div>
<div class="line"><span class="lineno"> 1664</span>        <span class="comment">/* It seems more intuitive to add the counter increment to</span></div>
<div class="line"><span class="lineno"> 1665</span><span class="comment">         * parse_part(), but we want to stop the case where a multipart</span></div>
<div class="line"><span class="lineno"> 1666</span><span class="comment">         * contains thousands of tiny parts before the memory and data</span></div>
<div class="line"><span class="lineno"> 1667</span><span class="comment">         * structures are allocated.  */</span></div>
<div class="line"><span class="lineno"> 1668</span>        <span class="keywordflow">if</span> (++(*counter) &gt;= <a class="code hl_define" href="mime_8h.html#af00b35324f19084a5f85ac5d1af2f1c3">MUTT_MIME_MAX_PARTS</a>)</div>
<div class="line"><span class="lineno"> 1669</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1670</span>      }</div>
<div class="line"><span class="lineno"> 1671</span>    }</div>
<div class="line"><span class="lineno"> 1672</span>  }</div>
<div class="line"><span class="lineno"> 1673</span> </div>
<div class="line"><span class="lineno"> 1674</span>  <span class="comment">/* in case of missing end boundary, set the length to something reasonable */</span></div>
<div class="line"><span class="lineno"> 1675</span>  <span class="keywordflow">if</span> (last &amp;&amp; (last-&gt;length == 0) &amp;&amp; !<span class="keyword">final</span>)</div>
<div class="line"><span class="lineno"> 1676</span>    last-&gt;length = end_off - last-&gt;offset;</div>
<div class="line"><span class="lineno"> 1677</span> </div>
<div class="line"><span class="lineno"> 1678</span>  <span class="comment">/* parse recursive MIME parts */</span></div>
<div class="line"><span class="lineno"> 1679</span>  <span class="keywordflow">for</span> (last = head; last; last = last-&gt;next)</div>
<div class="line"><span class="lineno"> 1680</span>    <a class="code hl_function" href="#aa9d682d64619becd7ca5e03de02f6f18">parse_part</a>(fp, last, counter);</div>
<div class="line"><span class="lineno"> 1681</span> </div>
<div class="line"><span class="lineno"> 1682</span>  <span class="keywordflow">return</span> head;</div>
<div class="line"><span class="lineno"> 1683</span>}</div>
<div class="ttc" id="aatoi_8c_html_ae5e07d3703764e9773459be2a6461f07"><div class="ttname"><a href="atoi_8c.html#ae5e07d3703764e9773459be2a6461f07">mutt_str_atoi</a></div><div class="ttdeci">const char * mutt_str_atoi(const char *str, int *dst)</div><div class="ttdoc">Convert ASCII string to an integer.</div><div class="ttdef"><b>Definition</b> <a href="atoi_8c_source.html#l00191">atoi.c:191</a></div></div>
<div class="ttc" id="actype_8c_html_a16dd3da88a22f7e3ea99e3474fc46fda"><div class="ttname"><a href="ctype_8c.html#a16dd3da88a22f7e3ea99e3474fc46fda">mutt_isspace</a></div><div class="ttdeci">bool mutt_isspace(int arg)</div><div class="ttdoc">Wrapper for isspace(3)</div><div class="ttdef"><b>Definition</b> <a href="ctype_8c_source.html#l00096">ctype.c:96</a></div></div>
<div class="ttc" id="aemail_2body_8c_html_a129af1c316fcbc26b55fb48957bab2cb"><div class="ttname"><a href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a></div><div class="ttdeci">void mutt_body_free(struct Body **ptr)</div><div class="ttdoc">Free a Body.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8c_source.html#l00058">body.c:58</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gacc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00094">logging2.h:94</a></div></div>
<div class="ttc" id="amime_8h_html_af00b35324f19084a5f85ac5d1af2f1c3"><div class="ttname"><a href="mime_8h.html#af00b35324f19084a5f85ac5d1af2f1c3">MUTT_MIME_MAX_PARTS</a></div><div class="ttdeci">#define MUTT_MIME_MAX_PARTS</div><div class="ttdoc">Maximum number of MIME parts to process to prevent DoS.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00071">mime.h:71</a></div></div>
<div class="ttc" id="amutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a6b6a50296dd2a31863a43379ef4a343d"><div class="ttname"><a href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a></div><div class="ttdeci">bool mutt_str_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00662">string.c:662</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a9bf968304f4f9b49e24215cb2e28d22d"><div class="ttname"><a href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a></div><div class="ttdeci">size_t mutt_str_startswith(const char *str, const char *prefix)</div><div class="ttdoc">Check whether a string starts with a prefix.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00234">string.c:234</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_acca6786b903b22a5924219f9db96e10d"><div class="ttname"><a href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a></div><div class="ttdeci">size_t mutt_str_len(const char *a)</div><div class="ttdoc">Calculate the length of a string, safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00500">string.c:500</a></div></div>
</div><!-- fragment --><div id="dynsection-5" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_ac20b6c54dff7929453167e30d9dcc1a3_cgraph.svg" width="692" height="476"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-6" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_ac20b6c54dff7929453167e30d9dcc1a3_icgraph.svg" width="334" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa024a4cce886fe1fb4a32ed8f1b8d9b9" name="aa024a4cce886fe1fb4a32ed8f1b8d9b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa024a4cce886fe1fb4a32ed8f1b8d9b9">&#9670;&#160;</a></span>mutt_filter_commandline_header_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_filter_commandline_header_tag </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>header</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sanitise characters in a header tag. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">header</td><td>String to sanitise </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00072">72</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>{</div>
<div class="line"><span class="lineno">   74</span>  <span class="keywordflow">if</span> (!header)</div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>  <span class="keywordflow">for</span> (; (*header != <span class="charliteral">&#39;\0&#39;</span>); header++)</div>
<div class="line"><span class="lineno">   78</span>  {</div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordflow">if</span> ((*header &lt; 33) || (*header &gt; 126) || (*header == <span class="charliteral">&#39;:&#39;</span>))</div>
<div class="line"><span class="lineno">   80</span>      *header = <span class="charliteral">&#39;?&#39;</span>;</div>
<div class="line"><span class="lineno">   81</span>  }</div>
<div class="line"><span class="lineno">   82</span>}</div>
</div><!-- fragment --><div id="dynsection-7" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_aa024a4cce886fe1fb4a32ed8f1b8d9b9_icgraph.svg" width="372" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aeb759563267cc1a4ee017738d8ee3013" name="aeb759563267cc1a4ee017738d8ee3013"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb759563267cc1a4ee017738d8ee3013">&#9670;&#160;</a></span>mutt_filter_commandline_header_value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_filter_commandline_header_value </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>header</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sanitise characters in a header value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">header</td><td>String to sanitise</td></tr>
  </table>
  </dd>
</dl>
<p>It might be preferable to use mutt_filter_unprintable() instead. This filter is being lax, but preventing a header injection via an embedded newline. </p>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00092">92</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   93</span>{</div>
<div class="line"><span class="lineno">   94</span>  <span class="keywordflow">if</span> (!header)</div>
<div class="line"><span class="lineno">   95</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>  <span class="keywordflow">for</span> (; (*header != <span class="charliteral">&#39;\0&#39;</span>); header++)</div>
<div class="line"><span class="lineno">   98</span>  {</div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">if</span> ((*header == <span class="charliteral">&#39;\n&#39;</span>) || (*header == <span class="charliteral">&#39;\r&#39;</span>))</div>
<div class="line"><span class="lineno">  100</span>      *header = <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><span class="lineno">  101</span>  }</div>
<div class="line"><span class="lineno">  102</span>}</div>
</div><!-- fragment --><div id="dynsection-8" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_aeb759563267cc1a4ee017738d8ee3013_icgraph.svg" width="687" height="116"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2a830caa65e6f462ab0ecae77bce746b" name="a2a830caa65e6f462ab0ecae77bce746b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a830caa65e6f462ab0ecae77bce746b">&#9670;&#160;</a></span>mutt_auto_subscribe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_auto_subscribe </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>mailto</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if user is subscribed to mailing list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mailto</td><td>URL of mailing list subscribe </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00108">108</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  109</span>{</div>
<div class="line"><span class="lineno">  110</span>  <span class="keywordflow">if</span> (!mailto)</div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="email_2globals_8c.html#a1de2e72a5a98bba257a6797327bd955d">AutoSubscribeCache</a>)</div>
<div class="line"><span class="lineno">  114</span>    <a class="code hl_variable" href="email_2globals_8c.html#a1de2e72a5a98bba257a6797327bd955d">AutoSubscribeCache</a> = <a class="code hl_function" href="hash_8c.html#a75439958fb5faf57c039faec79d19998">mutt_hash_new</a>(200, <a class="code hl_define" href="hash_8h.html#afd6c3412ccb58c9801dba870c9f66950">MUTT_HASH_STRCASECMP</a> | <a class="code hl_define" href="hash_8h.html#a8ab2e3b7f4fa1549400be41d58fc765c">MUTT_HASH_STRDUP_KEYS</a>);</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="hash_8c.html#a21cfc2c56db496fc57d3d85a71c03215">mutt_hash_find</a>(<a class="code hl_variable" href="email_2globals_8c.html#a1de2e72a5a98bba257a6797327bd955d">AutoSubscribeCache</a>, mailto))</div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>  <a class="code hl_function" href="hash_8c.html#a10bd305a8183db9829caee9ea1bac2f5">mutt_hash_insert</a>(<a class="code hl_variable" href="email_2globals_8c.html#a1de2e72a5a98bba257a6797327bd955d">AutoSubscribeCache</a>, mailto, <a class="code hl_variable" href="email_2globals_8c.html#a1de2e72a5a98bba257a6797327bd955d">AutoSubscribeCache</a>);</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structEnvelope.html">Envelope</a> *lpenv = <a class="code hl_function" href="envelope_8c.html#a406e6f76001e7604ce65ffe972fc19c1">mutt_env_new</a>(); <span class="comment">/* parsed envelope from the List-Post mailto: URL */</span></div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="#a85f5f11a70b04f611f3e131f67644fbf">mutt_parse_mailto</a>(lpenv, NULL, mailto) &amp;&amp; !<a class="code hl_define" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;lpenv-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>))</div>
<div class="line"><span class="lineno">  124</span>  {</div>
<div class="line"><span class="lineno">  125</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *mailbox = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(<a class="code hl_define" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;lpenv-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>)-&gt;mailbox);</div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordflow">if</span> (mailbox &amp;&amp; !<a class="code hl_function" href="mutt_2regex_8c.html#ab0efb83f9190881306c558339efb250a">mutt_regexlist_match</a>(&amp;<a class="code hl_variable" href="email_2globals_8c.html#a0d681fa4d907aa89d8f7c196e219e83f">SubscribedLists</a>, mailbox) &amp;&amp;</div>
<div class="line"><span class="lineno">  127</span>        !<a class="code hl_function" href="mutt_2regex_8c.html#ab0efb83f9190881306c558339efb250a">mutt_regexlist_match</a>(&amp;<a class="code hl_variable" href="email_2globals_8c.html#a4604400f5d21502c96623074740c892d">UnMailLists</a>, mailbox) &amp;&amp;</div>
<div class="line"><span class="lineno">  128</span>        !<a class="code hl_function" href="mutt_2regex_8c.html#ab0efb83f9190881306c558339efb250a">mutt_regexlist_match</a>(&amp;<a class="code hl_variable" href="email_2globals_8c.html#a2c8a30051d77dd1573791a115b1be7fc">UnSubscribedLists</a>, mailbox))</div>
<div class="line"><span class="lineno">  129</span>    {</div>
<div class="line"><span class="lineno">  130</span>      <span class="comment">/* mutt_regexlist_add() detects duplicates, so it is safe to</span></div>
<div class="line"><span class="lineno">  131</span><span class="comment">       * try to add here without any checks. */</span></div>
<div class="line"><span class="lineno">  132</span>      <a class="code hl_function" href="mutt_2regex_8c.html#a305eb49ea76a2bc81bf89c1b5417c308">mutt_regexlist_add</a>(&amp;<a class="code hl_variable" href="email_2globals_8c.html#a81cd00343beba80ed69224545216f7e2">MailLists</a>, mailbox, REG_ICASE, NULL);</div>
<div class="line"><span class="lineno">  133</span>      <a class="code hl_function" href="mutt_2regex_8c.html#a305eb49ea76a2bc81bf89c1b5417c308">mutt_regexlist_add</a>(&amp;<a class="code hl_variable" href="email_2globals_8c.html#a0d681fa4d907aa89d8f7c196e219e83f">SubscribedLists</a>, mailbox, REG_ICASE, NULL);</div>
<div class="line"><span class="lineno">  134</span>    }</div>
<div class="line"><span class="lineno">  135</span>  }</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  <a class="code hl_function" href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;lpenv);</div>
<div class="line"><span class="lineno">  138</span>}</div>
<div class="ttc" id="abuffer_8h_html_a728ebc5a947b77c8d56db44ce553a7ab"><div class="ttname"><a href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a></div><div class="ttdeci">static const char * buf_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00096">buffer.h:96</a></div></div>
<div class="ttc" id="aemail_2globals_8c_html_a0d681fa4d907aa89d8f7c196e219e83f"><div class="ttname"><a href="email_2globals_8c.html#a0d681fa4d907aa89d8f7c196e219e83f">SubscribedLists</a></div><div class="ttdeci">struct RegexList SubscribedLists</div><div class="ttdoc">List of header patterns to unignore (see)</div><div class="ttdef"><b>Definition</b> <a href="email_2globals_8c_source.html#l00048">globals.c:48</a></div></div>
<div class="ttc" id="aemail_2globals_8c_html_a1de2e72a5a98bba257a6797327bd955d"><div class="ttname"><a href="email_2globals_8c.html#a1de2e72a5a98bba257a6797327bd955d">AutoSubscribeCache</a></div><div class="ttdeci">struct HashTable * AutoSubscribeCache</div><div class="ttdoc">&lt; Hash Table: &quot;mailto:&quot; -&gt; AutoSubscribeCache</div><div class="ttdef"><b>Definition</b> <a href="email_2globals_8c_source.html#l00036">globals.c:36</a></div></div>
<div class="ttc" id="aemail_2globals_8c_html_a2c8a30051d77dd1573791a115b1be7fc"><div class="ttname"><a href="email_2globals_8c.html#a2c8a30051d77dd1573791a115b1be7fc">UnSubscribedLists</a></div><div class="ttdeci">struct RegexList UnSubscribedLists</div><div class="ttdef"><b>Definition</b> <a href="email_2globals_8c_source.html#l00054">globals.c:54</a></div></div>
<div class="ttc" id="aemail_2globals_8c_html_a4604400f5d21502c96623074740c892d"><div class="ttname"><a href="email_2globals_8c.html#a4604400f5d21502c96623074740c892d">UnMailLists</a></div><div class="ttdeci">struct RegexList UnMailLists</div><div class="ttdoc">List of regexes to exclude false matches in SubscribedLists.</div><div class="ttdef"><b>Definition</b> <a href="email_2globals_8c_source.html#l00052">globals.c:52</a></div></div>
<div class="ttc" id="aemail_2globals_8c_html_a81cd00343beba80ed69224545216f7e2"><div class="ttname"><a href="email_2globals_8c.html#a81cd00343beba80ed69224545216f7e2">MailLists</a></div><div class="ttdeci">struct RegexList MailLists</div><div class="ttdoc">List of permitted fields in a mailto: url.</div><div class="ttdef"><b>Definition</b> <a href="email_2globals_8c_source.html#l00040">globals.c:40</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a85f5f11a70b04f611f3e131f67644fbf"><div class="ttname"><a href="#a85f5f11a70b04f611f3e131f67644fbf">mutt_parse_mailto</a></div><div class="ttdeci">bool mutt_parse_mailto(struct Envelope *env, char **body, const char *src)</div><div class="ttdoc">Parse a mailto:// url.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01753">parse.c:1753</a></div></div>
<div class="ttc" id="aenvelope_8c_html_a244dacf9b1001c9ce1dbd473e001381f"><div class="ttname"><a href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a></div><div class="ttdeci">void mutt_env_free(struct Envelope **ptr)</div><div class="ttdoc">Free an Envelope.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8c_source.html#l00125">envelope.c:125</a></div></div>
<div class="ttc" id="aenvelope_8c_html_a406e6f76001e7604ce65ffe972fc19c1"><div class="ttname"><a href="envelope_8c.html#a406e6f76001e7604ce65ffe972fc19c1">mutt_env_new</a></div><div class="ttdeci">struct Envelope * mutt_env_new(void)</div><div class="ttdoc">Create a new Envelope.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8c_source.html#l00045">envelope.c:45</a></div></div>
<div class="ttc" id="ahash_8c_html_a10bd305a8183db9829caee9ea1bac2f5"><div class="ttname"><a href="hash_8c.html#a10bd305a8183db9829caee9ea1bac2f5">mutt_hash_insert</a></div><div class="ttdeci">struct HashElem * mutt_hash_insert(struct HashTable *table, const char *strkey, void *data)</div><div class="ttdoc">Add a new element to the Hash Table (with string keys)</div><div class="ttdef"><b>Definition</b> <a href="hash_8c_source.html#l00337">hash.c:337</a></div></div>
<div class="ttc" id="ahash_8c_html_a21cfc2c56db496fc57d3d85a71c03215"><div class="ttname"><a href="hash_8c.html#a21cfc2c56db496fc57d3d85a71c03215">mutt_hash_find</a></div><div class="ttdeci">void * mutt_hash_find(const struct HashTable *table, const char *strkey)</div><div class="ttdoc">Find the HashElem data in a Hash Table element using a key.</div><div class="ttdef"><b>Definition</b> <a href="hash_8c_source.html#l00364">hash.c:364</a></div></div>
<div class="ttc" id="ahash_8c_html_a75439958fb5faf57c039faec79d19998"><div class="ttname"><a href="hash_8c.html#a75439958fb5faf57c039faec79d19998">mutt_hash_new</a></div><div class="ttdeci">struct HashTable * mutt_hash_new(size_t num_elems, HashFlags flags)</div><div class="ttdoc">Create a new Hash Table (with string keys)</div><div class="ttdef"><b>Definition</b> <a href="hash_8c_source.html#l00261">hash.c:261</a></div></div>
<div class="ttc" id="ahash_8h_html_a8ab2e3b7f4fa1549400be41d58fc765c"><div class="ttname"><a href="hash_8h.html#a8ab2e3b7f4fa1549400be41d58fc765c">MUTT_HASH_STRDUP_KEYS</a></div><div class="ttdeci">#define MUTT_HASH_STRDUP_KEYS</div><div class="ttdoc">make a copy of the keys</div><div class="ttdef"><b>Definition</b> <a href="hash_8h_source.html#l00113">hash.h:113</a></div></div>
<div class="ttc" id="ahash_8h_html_afd6c3412ccb58c9801dba870c9f66950"><div class="ttname"><a href="hash_8h.html#afd6c3412ccb58c9801dba870c9f66950">MUTT_HASH_STRCASECMP</a></div><div class="ttdeci">#define MUTT_HASH_STRCASECMP</div><div class="ttdoc">use strcasecmp() to compare keys</div><div class="ttdef"><b>Definition</b> <a href="hash_8h_source.html#l00112">hash.h:112</a></div></div>
<div class="ttc" id="amutt_2regex_8c_html_a305eb49ea76a2bc81bf89c1b5417c308"><div class="ttname"><a href="mutt_2regex_8c.html#a305eb49ea76a2bc81bf89c1b5417c308">mutt_regexlist_add</a></div><div class="ttdeci">int mutt_regexlist_add(struct RegexList *rl, const char *str, uint16_t flags, struct Buffer *err)</div><div class="ttdoc">Compile a regex string and add it to a list.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2regex_8c_source.html#l00140">regex.c:140</a></div></div>
<div class="ttc" id="amutt_2regex_8c_html_ab0efb83f9190881306c558339efb250a"><div class="ttname"><a href="mutt_2regex_8c.html#ab0efb83f9190881306c558339efb250a">mutt_regexlist_match</a></div><div class="ttdeci">bool mutt_regexlist_match(struct RegexList *rl, const char *str)</div><div class="ttdoc">Does a string match any Regex in the list?</div><div class="ttdef"><b>Definition</b> <a href="mutt_2regex_8c_source.html#l00200">regex.c:200</a></div></div>
<div class="ttc" id="aqueue_8h_html_a7d6894360bd1c41e0e6f6d84998c1362"><div class="ttname"><a href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a></div><div class="ttdeci">#define TAILQ_FIRST(head)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00780">queue.h:780</a></div></div>
<div class="ttc" id="aqueue_8h_html_ac3c9da7ac712eacbbad5cc54d7a3477e"><div class="ttname"><a href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a></div><div class="ttdeci">#define TAILQ_EMPTY(head)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00778">queue.h:778</a></div></div>
<div class="ttc" id="astructEnvelope_html"><div class="ttname"><a href="structEnvelope.html">Envelope</a></div><div class="ttdoc">The header of an Email.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00056">envelope.h:57</a></div></div>
<div class="ttc" id="astructEnvelope_html_a2d927371b3b80e025d6f7522b7361fe7"><div class="ttname"><a href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">Envelope::to</a></div><div class="ttdeci">struct AddressList to</div><div class="ttdoc">Email&#39;s &#39;To&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00060">envelope.h:60</a></div></div>
</div><!-- fragment --><div id="dynsection-9" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a2a830caa65e6f462ab0ecae77bce746b_cgraph.svg" width="363" height="491"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-10" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a2a830caa65e6f462ab0ecae77bce746b_icgraph.svg" width="379" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af286c6b467329705cc1ca7d92f9ad954" name="af286c6b467329705cc1ca7d92f9ad954"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af286c6b467329705cc1ca7d92f9ad954">&#9670;&#160;</a></span>parse_parameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void parse_parameters </td>
          <td>(</td>
          <td class="paramtype">struct ParameterList *</td>          <td class="paramname"><span class="paramname"><em>pl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>allow_value_spaces</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse a list of Parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pl</td><td><a class="el" href="structParameter.html" title="Attribute associated with a MIME part.">Parameter</a> list for the results </td></tr>
    <tr><td class="paramname">s</td><td>String to parse </td></tr>
    <tr><td class="paramname">allow_value_spaces</td><td>Allow values with spaces</td></tr>
  </table>
  </dd>
</dl>
<p>Autocrypt defines an irregular parameter format that doesn't follow the rfc. It splits keydata across multiple lines without parameter continuations. The allow_value_spaces parameter allows parsing those values which are split by spaces when unfolded. </p>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00151">151</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  152</span>{</div>
<div class="line"><span class="lineno">  153</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structParameter.html">Parameter</a> *pnew = NULL;</div>
<div class="line"><span class="lineno">  154</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *p = NULL;</div>
<div class="line"><span class="lineno">  155</span>  <span class="keywordtype">size_t</span> i;</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *buf = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  158</span>  <span class="comment">/* allow_value_spaces, especially with autocrypt keydata, can result</span></div>
<div class="line"><span class="lineno">  159</span><span class="comment">   * in quite large parameter values.  avoid frequent reallocs by</span></div>
<div class="line"><span class="lineno">  160</span><span class="comment">   * pre-sizing */</span></div>
<div class="line"><span class="lineno">  161</span>  <span class="keywordflow">if</span> (allow_value_spaces)</div>
<div class="line"><span class="lineno">  162</span>    <a class="code hl_function" href="buffer_8c.html#ae144a736bd5f9de289bdc8f27fecf96a">buf_alloc</a>(buf, <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(s));</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>  <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;&#39;%s&#39;\n&quot;</span>, s);</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> assumed = !<a class="code hl_function" href="mutt_2slist_8c.html#a4811cefce245ed4de9d8aacd8b4ab43f">slist_is_empty</a>(<a class="code hl_function" href="config__cache_8c.html#addc06d02c91cce26bfe7c3692ddf0046">cc_assumed_charset</a>());</div>
<div class="line"><span class="lineno">  167</span>  <span class="keywordflow">while</span> (*s)</div>
<div class="line"><span class="lineno">  168</span>  {</div>
<div class="line"><span class="lineno">  169</span>    <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(buf);</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    p = strpbrk(s, <span class="stringliteral">&quot;=;&quot;</span>);</div>
<div class="line"><span class="lineno">  172</span>    <span class="keywordflow">if</span> (!p)</div>
<div class="line"><span class="lineno">  173</span>    {</div>
<div class="line"><span class="lineno">  174</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;malformed parameter: %s\n&quot;</span>, s);</div>
<div class="line"><span class="lineno">  175</span>      <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  176</span>    }</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>    <span class="comment">/* if we hit a ; now the parameter has no value, just skip it */</span></div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">if</span> (*p != <span class="charliteral">&#39;;&#39;</span>)</div>
<div class="line"><span class="lineno">  180</span>    {</div>
<div class="line"><span class="lineno">  181</span>      i = p - s;</div>
<div class="line"><span class="lineno">  182</span>      <span class="comment">/* remove whitespace from the end of the attribute name */</span></div>
<div class="line"><span class="lineno">  183</span>      <span class="keywordflow">while</span> ((i &gt; 0) &amp;&amp; <a class="code hl_function" href="string2_8h.html#ad5d1decff25d97de6e53c4e5fe184fba">mutt_str_is_email_wsp</a>(s[i - 1]))</div>
<div class="line"><span class="lineno">  184</span>        i--;</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>      <span class="comment">/* the check for the missing parameter token is here so that we can skip</span></div>
<div class="line"><span class="lineno">  187</span><span class="comment">       * over any quoted value that may be present.  */</span></div>
<div class="line"><span class="lineno">  188</span>      <span class="keywordflow">if</span> (i == 0)</div>
<div class="line"><span class="lineno">  189</span>      {</div>
<div class="line"><span class="lineno">  190</span>        <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;missing attribute: %s\n&quot;</span>, s);</div>
<div class="line"><span class="lineno">  191</span>        pnew = NULL;</div>
<div class="line"><span class="lineno">  192</span>      }</div>
<div class="line"><span class="lineno">  193</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  194</span>      {</div>
<div class="line"><span class="lineno">  195</span>        pnew = <a class="code hl_function" href="parameter_8c.html#adfc045ba3c75762a42dd11839c2da7da">mutt_param_new</a>();</div>
<div class="line"><span class="lineno">  196</span>        pnew-&gt;<a class="code hl_variable" href="structParameter.html#a189338f8764ba916b15b6848d1d79420">attribute</a> = <a class="code hl_function" href="mutt_2string_8c.html#a116d1d2391bc57f2ba3a9d9cfb15db76">mutt_strn_dup</a>(s, i);</div>
<div class="line"><span class="lineno">  197</span>      }</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>      <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  200</span>      {</div>
<div class="line"><span class="lineno">  201</span>        s = <a class="code hl_function" href="mutt_2string_8c.html#a5bc328ca69776d155059041aaff9435a">mutt_str_skip_email_wsp</a>(p + 1); <span class="comment">/* skip over the =, or space if we loop */</span></div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>        <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;&quot;&#39;</span>)</div>
<div class="line"><span class="lineno">  204</span>        {</div>
<div class="line"><span class="lineno">  205</span>          <span class="keywordtype">bool</span> state_ascii = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  206</span>          s++;</div>
<div class="line"><span class="lineno">  207</span>          <span class="keywordflow">for</span> (; *s; s++)</div>
<div class="line"><span class="lineno">  208</span>          {</div>
<div class="line"><span class="lineno">  209</span>            <span class="keywordflow">if</span> (assumed)</div>
<div class="line"><span class="lineno">  210</span>            {</div>
<div class="line"><span class="lineno">  211</span>              <span class="comment">// As iso-2022-* has a character of &#39;&quot;&#39; with non-ascii state, ignore it</span></div>
<div class="line"><span class="lineno">  212</span>              <span class="keywordflow">if</span> (*s == 0x1b)</div>
<div class="line"><span class="lineno">  213</span>              {</div>
<div class="line"><span class="lineno">  214</span>                <span class="keywordflow">if</span> ((s[1] == <span class="charliteral">&#39;(&#39;</span>) &amp;&amp; ((s[2] == <span class="charliteral">&#39;B&#39;</span>) || (s[2] == <span class="charliteral">&#39;J&#39;</span>)))</div>
<div class="line"><span class="lineno">  215</span>                  state_ascii = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  216</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  217</span>                  state_ascii = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  218</span>              }</div>
<div class="line"><span class="lineno">  219</span>            }</div>
<div class="line"><span class="lineno">  220</span>            <span class="keywordflow">if</span> (state_ascii &amp;&amp; (*s == <span class="charliteral">&#39;&quot;&#39;</span>))</div>
<div class="line"><span class="lineno">  221</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  222</span>            <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;\\&#39;</span>)</div>
<div class="line"><span class="lineno">  223</span>            {</div>
<div class="line"><span class="lineno">  224</span>              <span class="keywordflow">if</span> (s[1])</div>
<div class="line"><span class="lineno">  225</span>              {</div>
<div class="line"><span class="lineno">  226</span>                s++;</div>
<div class="line"><span class="lineno">  227</span>                <span class="comment">/* Quote the next character */</span></div>
<div class="line"><span class="lineno">  228</span>                <a class="code hl_function" href="buffer_8c.html#a9765efbb7f2c32e46fb1cb271a02ba20">buf_addch</a>(buf, *s);</div>
<div class="line"><span class="lineno">  229</span>              }</div>
<div class="line"><span class="lineno">  230</span>            }</div>
<div class="line"><span class="lineno">  231</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  232</span>            {</div>
<div class="line"><span class="lineno">  233</span>              <a class="code hl_function" href="buffer_8c.html#a9765efbb7f2c32e46fb1cb271a02ba20">buf_addch</a>(buf, *s);</div>
<div class="line"><span class="lineno">  234</span>            }</div>
<div class="line"><span class="lineno">  235</span>          }</div>
<div class="line"><span class="lineno">  236</span>          <span class="keywordflow">if</span> (*s)</div>
<div class="line"><span class="lineno">  237</span>            s++; <span class="comment">/* skip over the &quot; */</span></div>
<div class="line"><span class="lineno">  238</span>        }</div>
<div class="line"><span class="lineno">  239</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  240</span>        {</div>
<div class="line"><span class="lineno">  241</span>          <span class="keywordflow">for</span> (; *s &amp;&amp; *s != <span class="charliteral">&#39; &#39;</span> &amp;&amp; *s != <span class="charliteral">&#39;;&#39;</span>; s++)</div>
<div class="line"><span class="lineno">  242</span>            <a class="code hl_function" href="buffer_8c.html#a9765efbb7f2c32e46fb1cb271a02ba20">buf_addch</a>(buf, *s);</div>
<div class="line"><span class="lineno">  243</span>        }</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>        p = s;</div>
<div class="line"><span class="lineno">  246</span>      } <span class="keywordflow">while</span> (allow_value_spaces &amp;&amp; (*s == <span class="charliteral">&#39; &#39;</span>));</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>      <span class="comment">/* if the attribute token was missing, &#39;new&#39; will be NULL */</span></div>
<div class="line"><span class="lineno">  249</span>      <span class="keywordflow">if</span> (pnew)</div>
<div class="line"><span class="lineno">  250</span>      {</div>
<div class="line"><span class="lineno">  251</span>        pnew-&gt;<a class="code hl_variable" href="structParameter.html#ada5e74c000e2a745066632067df1ac8d">value</a> = <a class="code hl_function" href="buffer_8c.html#ad76477cc0c660bc50162393e997233eb">buf_strdup</a>(buf);</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>        <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;parse_parameter: &#39;%s&#39; = &#39;%s&#39;\n&quot;</span>,</div>
<div class="line"><span class="lineno">  254</span>                   pnew-&gt;<a class="code hl_variable" href="structParameter.html#a189338f8764ba916b15b6848d1d79420">attribute</a> ? pnew-&gt;<a class="code hl_variable" href="structParameter.html#a189338f8764ba916b15b6848d1d79420">attribute</a> : <span class="stringliteral">&quot;&quot;</span>, pnew-&gt;<a class="code hl_variable" href="structParameter.html#ada5e74c000e2a745066632067df1ac8d">value</a> ? pnew-&gt;<a class="code hl_variable" href="structParameter.html#ada5e74c000e2a745066632067df1ac8d">value</a> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>        <span class="comment">/* Add this parameter to the list */</span></div>
<div class="line"><span class="lineno">  257</span>        <a class="code hl_define" href="queue_8h.html#af0f99e8f322ea4eef2d9deaa505239a6">TAILQ_INSERT_HEAD</a>(pl, pnew, entries);</div>
<div class="line"><span class="lineno">  258</span>      }</div>
<div class="line"><span class="lineno">  259</span>    }</div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  261</span>    {</div>
<div class="line"><span class="lineno">  262</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;parameter with no value: %s\n&quot;</span>, s);</div>
<div class="line"><span class="lineno">  263</span>      s = p;</div>
<div class="line"><span class="lineno">  264</span>    }</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>    <span class="comment">/* Find the next parameter */</span></div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordflow">if</span> ((*s != <span class="charliteral">&#39;;&#39;</span>) &amp;&amp; !(s = strchr(s, <span class="charliteral">&#39;;&#39;</span>)))</div>
<div class="line"><span class="lineno">  268</span>      <span class="keywordflow">break</span>; <span class="comment">/* no more parameters */</span></div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>    <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  271</span>    {</div>
<div class="line"><span class="lineno">  272</span>      <span class="comment">/* Move past any leading whitespace. the +1 skips over the semicolon */</span></div>
<div class="line"><span class="lineno">  273</span>      s = <a class="code hl_function" href="mutt_2string_8c.html#a5bc328ca69776d155059041aaff9435a">mutt_str_skip_email_wsp</a>(s + 1);</div>
<div class="line"><span class="lineno">  274</span>    } <span class="keywordflow">while</span> (*s == <span class="charliteral">&#39;;&#39;</span>); <span class="comment">/* skip empty parameters */</span></div>
<div class="line"><span class="lineno">  275</span>  }</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>bail:</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>  <a class="code hl_function" href="rfc2231_8c.html#a95eb6a825f563e45d47c100ea43954c6">rfc2231_decode_parameters</a>(pl);</div>
<div class="line"><span class="lineno">  280</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;buf);</div>
<div class="line"><span class="lineno">  281</span>}</div>
<div class="ttc" id="abuffer_8c_html_a3b1f80652b37dc26046f9acdd85a0b05"><div class="ttname"><a href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a></div><div class="ttdeci">void buf_reset(struct Buffer *buf)</div><div class="ttdoc">Reset an existing Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00076">buffer.c:76</a></div></div>
<div class="ttc" id="abuffer_8c_html_a9765efbb7f2c32e46fb1cb271a02ba20"><div class="ttname"><a href="buffer_8c.html#a9765efbb7f2c32e46fb1cb271a02ba20">buf_addch</a></div><div class="ttdeci">size_t buf_addch(struct Buffer *buf, char c)</div><div class="ttdoc">Add a single character to a Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00241">buffer.c:241</a></div></div>
<div class="ttc" id="abuffer_8c_html_ad76477cc0c660bc50162393e997233eb"><div class="ttname"><a href="buffer_8c.html#ad76477cc0c660bc50162393e997233eb">buf_strdup</a></div><div class="ttdeci">char * buf_strdup(const struct Buffer *buf)</div><div class="ttdoc">Copy a Buffer&#39;s string.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00571">buffer.c:571</a></div></div>
<div class="ttc" id="abuffer_8c_html_ae144a736bd5f9de289bdc8f27fecf96a"><div class="ttname"><a href="buffer_8c.html#ae144a736bd5f9de289bdc8f27fecf96a">buf_alloc</a></div><div class="ttdeci">void buf_alloc(struct Buffer *buf, size_t new_size)</div><div class="ttdoc">Make sure a buffer can store at least new_size bytes.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00337">buffer.c:337</a></div></div>
<div class="ttc" id="aconfig__cache_8c_html_addc06d02c91cce26bfe7c3692ddf0046"><div class="ttname"><a href="config__cache_8c.html#addc06d02c91cce26bfe7c3692ddf0046">cc_assumed_charset</a></div><div class="ttdeci">const struct Slist * cc_assumed_charset(void)</div><div class="ttdoc">Get the cached value of $assumed_charset.</div><div class="ttdef"><b>Definition</b> <a href="config__cache_8c_source.html#l00101">config_cache.c:101</a></div></div>
<div class="ttc" id="alogging2_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3"><div class="ttname"><a href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a></div><div class="ttdeci">@ LL_DEBUG2</div><div class="ttdoc">Log at debug level 2.</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00046">logging2.h:46</a></div></div>
<div class="ttc" id="amutt_2slist_8c_html_a4811cefce245ed4de9d8aacd8b4ab43f"><div class="ttname"><a href="mutt_2slist_8c.html#a4811cefce245ed4de9d8aacd8b4ab43f">slist_is_empty</a></div><div class="ttdeci">bool slist_is_empty(const struct Slist *list)</div><div class="ttdoc">Is the slist empty?</div><div class="ttdef"><b>Definition</b> <a href="mutt_2slist_8c_source.html#l00140">slist.c:140</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a116d1d2391bc57f2ba3a9d9cfb15db76"><div class="ttname"><a href="mutt_2string_8c.html#a116d1d2391bc57f2ba3a9d9cfb15db76">mutt_strn_dup</a></div><div class="ttdeci">char * mutt_strn_dup(const char *begin, size_t len)</div><div class="ttdoc">Duplicate a sub-string.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00384">string.c:384</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a5bc328ca69776d155059041aaff9435a"><div class="ttname"><a href="mutt_2string_8c.html#a5bc328ca69776d155059041aaff9435a">mutt_str_skip_email_wsp</a></div><div class="ttdeci">char * mutt_str_skip_email_wsp(const char *s)</div><div class="ttdoc">Skip over whitespace as defined by RFC5322.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00610">string.c:610</a></div></div>
<div class="ttc" id="aparameter_8c_html_adfc045ba3c75762a42dd11839c2da7da"><div class="ttname"><a href="parameter_8c.html#adfc045ba3c75762a42dd11839c2da7da">mutt_param_new</a></div><div class="ttdeci">struct Parameter * mutt_param_new(void)</div><div class="ttdoc">Create a new Parameter.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8c_source.html#l00040">parameter.c:40</a></div></div>
<div class="ttc" id="apool_8c_html_a41cba27c25d33cb6822789a2856093f2"><div class="ttname"><a href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a></div><div class="ttdeci">struct Buffer * buf_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00091">pool.c:91</a></div></div>
<div class="ttc" id="apool_8c_html_a4cc6068279461cb8628219586dfa35a1"><div class="ttname"><a href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a></div><div class="ttdeci">void buf_pool_release(struct Buffer **ptr)</div><div class="ttdoc">Return a Buffer to the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00111">pool.c:111</a></div></div>
<div class="ttc" id="aqueue_8h_html_af0f99e8f322ea4eef2d9deaa505239a6"><div class="ttname"><a href="queue_8h.html#af0f99e8f322ea4eef2d9deaa505239a6">TAILQ_INSERT_HEAD</a></div><div class="ttdeci">#define TAILQ_INSERT_HEAD(head, elm, field)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00853">queue.h:853</a></div></div>
<div class="ttc" id="arfc2231_8c_html_a95eb6a825f563e45d47c100ea43954c6"><div class="ttname"><a href="rfc2231_8c.html#a95eb6a825f563e45d47c100ea43954c6">rfc2231_decode_parameters</a></div><div class="ttdeci">void rfc2231_decode_parameters(struct ParameterList *pl)</div><div class="ttdoc">Decode a Parameter list.</div><div class="ttdef"><b>Definition</b> <a href="rfc2231_8c_source.html#l00241">rfc2231.c:241</a></div></div>
<div class="ttc" id="astring2_8h_html_ad5d1decff25d97de6e53c4e5fe184fba"><div class="ttname"><a href="string2_8h.html#ad5d1decff25d97de6e53c4e5fe184fba">mutt_str_is_email_wsp</a></div><div class="ttdeci">static bool mutt_str_is_email_wsp(char c)</div><div class="ttdoc">Is this a whitespace character (for an email header)</div><div class="ttdef"><b>Definition</b> <a href="string2_8h_source.html#l00111">string2.h:111</a></div></div>
<div class="ttc" id="astructBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00035">buffer.h:36</a></div></div>
<div class="ttc" id="astructParameter_html"><div class="ttname"><a href="structParameter.html">Parameter</a></div><div class="ttdoc">Attribute associated with a MIME part.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8h_source.html#l00032">parameter.h:33</a></div></div>
<div class="ttc" id="astructParameter_html_a189338f8764ba916b15b6848d1d79420"><div class="ttname"><a href="structParameter.html#a189338f8764ba916b15b6848d1d79420">Parameter::attribute</a></div><div class="ttdeci">char * attribute</div><div class="ttdoc">Parameter name.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8h_source.html#l00034">parameter.h:34</a></div></div>
<div class="ttc" id="astructParameter_html_ada5e74c000e2a745066632067df1ac8d"><div class="ttname"><a href="structParameter.html#ada5e74c000e2a745066632067df1ac8d">Parameter::value</a></div><div class="ttdeci">char * value</div><div class="ttdoc">Parameter value.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8h_source.html#l00035">parameter.h:35</a></div></div>
</div><!-- fragment --><div id="dynsection-11" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_af286c6b467329705cc1ca7d92f9ad954_cgraph.svg" width="600" height="723"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-12" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_af286c6b467329705cc1ca7d92f9ad954_icgraph.svg" width="376" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a870232070405e395193a6c7e00e2df60" name="a870232070405e395193a6c7e00e2df60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a870232070405e395193a6c7e00e2df60">&#9670;&#160;</a></span>parse_content_disposition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void parse_content_disposition </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse a content disposition. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>String to parse </td></tr>
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> to save the result</td></tr>
  </table>
  </dd>
</dl>
<p>e.g. parse a string "inline" and set <a class="el" href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073" title="Content is inline.">DISP_INLINE</a>. </p>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00290">290</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  291</span>{</div>
<div class="line"><span class="lineno">  292</span>  <span class="keyword">struct </span>ParameterList pl = <a class="code hl_define" href="queue_8h.html#ac269df7d4126ed9885156cbad2cbf8af">TAILQ_HEAD_INITIALIZER</a>(pl);</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(s, <span class="stringliteral">&quot;inline&quot;</span>))</div>
<div class="line"><span class="lineno">  295</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a99aff302b287a47c407a7412a99630f5">disposition</a> = <a class="code hl_enumvalue" href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073">DISP_INLINE</a>;</div>
<div class="line"><span class="lineno">  296</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(s, <span class="stringliteral">&quot;form-data&quot;</span>))</div>
<div class="line"><span class="lineno">  297</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a99aff302b287a47c407a7412a99630f5">disposition</a> = <a class="code hl_enumvalue" href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a928cb3ca8d0289e37a22e6b83cd43905">DISP_FORM_DATA</a>;</div>
<div class="line"><span class="lineno">  298</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  299</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a99aff302b287a47c407a7412a99630f5">disposition</a> = <a class="code hl_enumvalue" href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a3c5d26739343bc8cc2934a4dee403417">DISP_ATTACH</a>;</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>  <span class="comment">/* Check to see if a default filename was given */</span></div>
<div class="line"><span class="lineno">  302</span>  s = strchr(s, <span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  303</span>  <span class="keywordflow">if</span> (s)</div>
<div class="line"><span class="lineno">  304</span>  {</div>
<div class="line"><span class="lineno">  305</span>    s = <a class="code hl_function" href="mutt_2string_8c.html#a5bc328ca69776d155059041aaff9435a">mutt_str_skip_email_wsp</a>(s + 1);</div>
<div class="line"><span class="lineno">  306</span>    <a class="code hl_function" href="#af286c6b467329705cc1ca7d92f9ad954">parse_parameters</a>(&amp;pl, s, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  307</span>    s = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;pl, <span class="stringliteral">&quot;filename&quot;</span>);</div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">if</span> (s)</div>
<div class="line"><span class="lineno">  309</span>      <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, s);</div>
<div class="line"><span class="lineno">  310</span>    s = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;pl, <span class="stringliteral">&quot;name&quot;</span>);</div>
<div class="line"><span class="lineno">  311</span>    <span class="keywordflow">if</span> (s)</div>
<div class="line"><span class="lineno">  312</span>      <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#aea3b13e7e6b68ebf707532938601321a">form_name</a>, s);</div>
<div class="line"><span class="lineno">  313</span>    <a class="code hl_function" href="parameter_8c.html#ade3b55d0262dc913be1e8307390514a0">mutt_param_free</a>(&amp;pl);</div>
<div class="line"><span class="lineno">  314</span>  }</div>
<div class="line"><span class="lineno">  315</span>}</div>
<div class="ttc" id="aemail_2parse_8c_html_af286c6b467329705cc1ca7d92f9ad954"><div class="ttname"><a href="#af286c6b467329705cc1ca7d92f9ad954">parse_parameters</a></div><div class="ttdeci">static void parse_parameters(struct ParameterList *pl, const char *s, bool allow_value_spaces)</div><div class="ttdoc">Parse a list of Parameters.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00151">parse.c:151</a></div></div>
<div class="ttc" id="amime_8h_html_a5f93dab7807282e699a6bc1b2d18a2d8a3c5d26739343bc8cc2934a4dee403417"><div class="ttname"><a href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a3c5d26739343bc8cc2934a4dee403417">DISP_ATTACH</a></div><div class="ttdeci">@ DISP_ATTACH</div><div class="ttdoc">Content is attached.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00063">mime.h:63</a></div></div>
<div class="ttc" id="amime_8h_html_a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073"><div class="ttname"><a href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073">DISP_INLINE</a></div><div class="ttdeci">@ DISP_INLINE</div><div class="ttdoc">Content is inline.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00062">mime.h:62</a></div></div>
<div class="ttc" id="amime_8h_html_a5f93dab7807282e699a6bc1b2d18a2d8a928cb3ca8d0289e37a22e6b83cd43905"><div class="ttname"><a href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a928cb3ca8d0289e37a22e6b83cd43905">DISP_FORM_DATA</a></div><div class="ttdeci">@ DISP_FORM_DATA</div><div class="ttdoc">Content is form-data.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00064">mime.h:64</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_aebd2a8a3f8a30062c31fa1474d87cc41"><div class="ttname"><a href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a></div><div class="ttdeci">size_t mutt_istr_startswith(const char *str, const char *prefix)</div><div class="ttdoc">Check whether a string starts with a prefix, ignoring case.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00246">string.c:246</a></div></div>
<div class="ttc" id="aparameter_8c_html_ade3b55d0262dc913be1e8307390514a0"><div class="ttname"><a href="parameter_8c.html#ade3b55d0262dc913be1e8307390514a0">mutt_param_free</a></div><div class="ttdeci">void mutt_param_free(struct ParameterList *pl)</div><div class="ttdoc">Free a ParameterList.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8c_source.html#l00062">parameter.c:62</a></div></div>
<div class="ttc" id="aqueue_8h_html_ac269df7d4126ed9885156cbad2cbf8af"><div class="ttname"><a href="queue_8h.html#ac269df7d4126ed9885156cbad2cbf8af">TAILQ_HEAD_INITIALIZER</a></div><div class="ttdeci">#define TAILQ_HEAD_INITIALIZER(head)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00694">queue.h:694</a></div></div>
<div class="ttc" id="astructBody_html_a99aff302b287a47c407a7412a99630f5"><div class="ttname"><a href="structBody.html#a99aff302b287a47c407a7412a99630f5">Body::disposition</a></div><div class="ttdeci">unsigned int disposition</div><div class="ttdoc">content-disposition, ContentDisposition</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00042">body.h:42</a></div></div>
<div class="ttc" id="astructBody_html_aea3b13e7e6b68ebf707532938601321a"><div class="ttname"><a href="structBody.html#aea3b13e7e6b68ebf707532938601321a">Body::form_name</a></div><div class="ttdeci">char * form_name</div><div class="ttdoc">Content-Disposition form-data name param.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00060">body.h:60</a></div></div>
<div class="ttc" id="astructBody_html_afe3cd2c4b1070e3d0edbf1fed939ac5a"><div class="ttname"><a href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">Body::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">When sending a message, this is the file to which this structure refers.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00059">body.h:59</a></div></div>
</div><!-- fragment --><div id="dynsection-13" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a870232070405e395193a6c7e00e2df60_cgraph.svg" width="607" height="304"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-14" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a870232070405e395193a6c7e00e2df60_icgraph.svg" width="634" height="66"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a5b80e3daa9cb6eb8f8ed5adae704ee10" name="a5b80e3daa9cb6eb8f8ed5adae704ee10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b80e3daa9cb6eb8f8ed5adae704ee10">&#9670;&#160;</a></span>parse_references()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void parse_references </td>
          <td>(</td>
          <td class="paramtype">struct ListHead *</td>          <td class="paramname"><span class="paramname"><em>head</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse references from an email header. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">head</td><td>List to receive the references </td></tr>
    <tr><td class="paramname">s</td><td>String to parse </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00322">322</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  323</span>{</div>
<div class="line"><span class="lineno">  324</span>  <span class="keywordflow">if</span> (!head)</div>
<div class="line"><span class="lineno">  325</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>  <span class="keywordtype">char</span> *m = NULL;</div>
<div class="line"><span class="lineno">  328</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> off = 0; (m = <a class="code hl_function" href="#aa7b7d3d9446a52fbc31ef18eea1b52c2">mutt_extract_message_id</a>(s, &amp;off)); s += off)</div>
<div class="line"><span class="lineno">  329</span>  {</div>
<div class="line"><span class="lineno">  330</span>    <a class="code hl_function" href="list_8c.html#a5a575610af3a8c6f267924b46c95b059">mutt_list_insert_head</a>(head, m);</div>
<div class="line"><span class="lineno">  331</span>  }</div>
<div class="line"><span class="lineno">  332</span>}</div>
<div class="ttc" id="aemail_2parse_8c_html_aa7b7d3d9446a52fbc31ef18eea1b52c2"><div class="ttname"><a href="#aa7b7d3d9446a52fbc31ef18eea1b52c2">mutt_extract_message_id</a></div><div class="ttdeci">char * mutt_extract_message_id(const char *s, size_t *len)</div><div class="ttdoc">Find a message-id.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00400">parse.c:400</a></div></div>
<div class="ttc" id="alist_8c_html_a5a575610af3a8c6f267924b46c95b059"><div class="ttname"><a href="list_8c.html#a5a575610af3a8c6f267924b46c95b059">mutt_list_insert_head</a></div><div class="ttdeci">struct ListNode * mutt_list_insert_head(struct ListHead *h, char *s)</div><div class="ttdoc">Insert a string at the beginning of a List.</div><div class="ttdef"><b>Definition</b> <a href="list_8c_source.html#l00046">list.c:46</a></div></div>
</div><!-- fragment --><div id="dynsection-15" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a5b80e3daa9cb6eb8f8ed5adae704ee10_cgraph.svg" width="366" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-16" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a5b80e3daa9cb6eb8f8ed5adae704ee10_icgraph.svg" width="356" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a74dcb6f4b53adc8cc3f61bcf4168fd51" name="a74dcb6f4b53adc8cc3f61bcf4168fd51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74dcb6f4b53adc8cc3f61bcf4168fd51">&#9670;&#160;</a></span>parse_content_language()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void parse_content_language </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the content's language. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Language string </td></tr>
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of the email </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00339">339</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  340</span>{</div>
<div class="line"><span class="lineno">  341</span>  <span class="keywordflow">if</span> (!s || !b)</div>
<div class="line"><span class="lineno">  342</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>  <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;RFC8255 &gt;&gt; Content-Language set to %s\n&quot;</span>, s);</div>
<div class="line"><span class="lineno">  345</span>  <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a043f55e8f15bc6f1324d35cb5d7f061c">language</a>, s);</div>
<div class="line"><span class="lineno">  346</span>}</div>
<div class="ttc" id="astructBody_html_a043f55e8f15bc6f1324d35cb5d7f061c"><div class="ttname"><a href="structBody.html#a043f55e8f15bc6f1324d35cb5d7f061c">Body::language</a></div><div class="ttdeci">char * language</div><div class="ttdoc">content-language (RFC8255)</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00078">body.h:78</a></div></div>
</div><!-- fragment --><div id="dynsection-17" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a74dcb6f4b53adc8cc3f61bcf4168fd51_cgraph.svg" width="358" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-18" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a74dcb6f4b53adc8cc3f61bcf4168fd51_icgraph.svg" width="626" height="66"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a5f2728949322a1a6210d61d9629005d1" name="a5f2728949322a1a6210d61d9629005d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f2728949322a1a6210d61d9629005d1">&#9670;&#160;</a></span>mutt_matches_ignore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mutt_matches_ignore </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the string match the ignore list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>String to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>String matches</td></tr>
  </table>
  </dd>
</dl>
<p>Checks Ignore and UnIgnore using mutt_list_match </p>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00355">355</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  356</span>{</div>
<div class="line"><span class="lineno">  357</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="list_8c.html#ae6e78596bbf371c69064967d7386def0">mutt_list_match</a>(s, &amp;<a class="code hl_variable" href="email_2globals_8c.html#aad575fe844c4641824e4e80523c3098b">Ignore</a>) &amp;&amp; !<a class="code hl_function" href="list_8c.html#ae6e78596bbf371c69064967d7386def0">mutt_list_match</a>(s, &amp;<a class="code hl_variable" href="email_2globals_8c.html#aedead725975fc1c761da7aba127d2586">UnIgnore</a>);</div>
<div class="line"><span class="lineno">  358</span>}</div>
<div class="ttc" id="aemail_2globals_8c_html_aad575fe844c4641824e4e80523c3098b"><div class="ttname"><a href="email_2globals_8c.html#aad575fe844c4641824e4e80523c3098b">Ignore</a></div><div class="ttdeci">struct ListHead Ignore</div><div class="ttdoc">List of regexes to match mailing lists.</div><div class="ttdef"><b>Definition</b> <a href="email_2globals_8c_source.html#l00038">globals.c:38</a></div></div>
<div class="ttc" id="aemail_2globals_8c_html_aedead725975fc1c761da7aba127d2586"><div class="ttname"><a href="email_2globals_8c.html#aedead725975fc1c761da7aba127d2586">UnIgnore</a></div><div class="ttdeci">struct ListHead UnIgnore</div><div class="ttdoc">List of regexes to exclude false matches in MailLists.</div><div class="ttdef"><b>Definition</b> <a href="email_2globals_8c_source.html#l00050">globals.c:50</a></div></div>
<div class="ttc" id="alist_8c_html_ae6e78596bbf371c69064967d7386def0"><div class="ttname"><a href="list_8c.html#ae6e78596bbf371c69064967d7386def0">mutt_list_match</a></div><div class="ttdeci">bool mutt_list_match(const char *s, struct ListHead *h)</div><div class="ttdoc">Is the string in the list (see notes)</div><div class="ttdef"><b>Definition</b> <a href="list_8c_source.html#l00194">list.c:194</a></div></div>
</div><!-- fragment --><div id="dynsection-19" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a5f2728949322a1a6210d61d9629005d1_cgraph.svg" width="332" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-20" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a5f2728949322a1a6210d61d9629005d1_icgraph.svg" width="575" height="216"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6c22ec026399e230ecedab86f831a754" name="a6c22ec026399e230ecedab86f831a754"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c22ec026399e230ecedab86f831a754">&#9670;&#160;</a></span>mutt_check_mime_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79">ContentType</a> mutt_check_mime_type </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check a MIME type string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>String to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">enum</td><td><a class="el" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79" title="Content-Type.">ContentType</a>, e.g. <a class="el" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167" title="Type: &#39;text/*&#39;.">TYPE_TEXT</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00365">365</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  366</span>{</div>
<div class="line"><span class="lineno">  367</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;text&quot;</span>, s))</div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>;</div>
<div class="line"><span class="lineno">  369</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;multipart&quot;</span>, s))</div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>;</div>
<div class="line"><span class="lineno">  371</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;x-sun-attachment&quot;</span>, s))</div>
<div class="line"><span class="lineno">  372</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>;</div>
<div class="line"><span class="lineno">  373</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;application&quot;</span>, s))</div>
<div class="line"><span class="lineno">  374</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>;</div>
<div class="line"><span class="lineno">  375</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;message&quot;</span>, s))</div>
<div class="line"><span class="lineno">  376</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a>;</div>
<div class="line"><span class="lineno">  377</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;image&quot;</span>, s))</div>
<div class="line"><span class="lineno">  378</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a1c84f9cd2b0d05b7d3f7711fcc0caad8">TYPE_IMAGE</a>;</div>
<div class="line"><span class="lineno">  379</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;audio&quot;</span>, s))</div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a17e2dc2b6c45bd9d56010ed4aed3fcf4">TYPE_AUDIO</a>;</div>
<div class="line"><span class="lineno">  381</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;video&quot;</span>, s))</div>
<div class="line"><span class="lineno">  382</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79afeeff8542e46439d4b704699ff009323">TYPE_VIDEO</a>;</div>
<div class="line"><span class="lineno">  383</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;model&quot;</span>, s))</div>
<div class="line"><span class="lineno">  384</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a33cf44e9e129e31bc10bf94ff7d50c03">TYPE_MODEL</a>;</div>
<div class="line"><span class="lineno">  385</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;*&quot;</span>, s))</div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79af173f42b16daa16262e56c2e12fb11b3">TYPE_ANY</a>;</div>
<div class="line"><span class="lineno">  387</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;.*&quot;</span>, s))</div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79af173f42b16daa16262e56c2e12fb11b3">TYPE_ANY</a>;</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17">TYPE_OTHER</a>;</div>
<div class="line"><span class="lineno">  391</span>}</div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a17e2dc2b6c45bd9d56010ed4aed3fcf4"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a17e2dc2b6c45bd9d56010ed4aed3fcf4">TYPE_AUDIO</a></div><div class="ttdeci">@ TYPE_AUDIO</div><div class="ttdoc">Type: &#39;audio/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00032">mime.h:32</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a1c84f9cd2b0d05b7d3f7711fcc0caad8"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a1c84f9cd2b0d05b7d3f7711fcc0caad8">TYPE_IMAGE</a></div><div class="ttdeci">@ TYPE_IMAGE</div><div class="ttdoc">Type: &#39;image/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00034">mime.h:34</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17">TYPE_OTHER</a></div><div class="ttdeci">@ TYPE_OTHER</div><div class="ttdoc">Unknown Content-Type.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00031">mime.h:31</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a33cf44e9e129e31bc10bf94ff7d50c03"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a33cf44e9e129e31bc10bf94ff7d50c03">TYPE_MODEL</a></div><div class="ttdeci">@ TYPE_MODEL</div><div class="ttdoc">Type: &#39;model/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00036">mime.h:36</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdeci">@ TYPE_APPLICATION</div><div class="ttdoc">Type: &#39;application/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79af173f42b16daa16262e56c2e12fb11b3"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79af173f42b16daa16262e56c2e12fb11b3">TYPE_ANY</a></div><div class="ttdeci">@ TYPE_ANY</div><div class="ttdoc">Type: &#39;&#39; or &#39;.&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00040">mime.h:40</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79afeeff8542e46439d4b704699ff009323"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79afeeff8542e46439d4b704699ff009323">TYPE_VIDEO</a></div><div class="ttdeci">@ TYPE_VIDEO</div><div class="ttdoc">Type: &#39;video/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00039">mime.h:39</a></div></div>
</div><!-- fragment --><div id="dynsection-21" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a6c22ec026399e230ecedab86f831a754_cgraph.svg" width="344" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-22" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a6c22ec026399e230ecedab86f831a754_icgraph.svg" width="412" height="254"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa7b7d3d9446a52fbc31ef18eea1b52c2" name="aa7b7d3d9446a52fbc31ef18eea1b52c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7b7d3d9446a52fbc31ef18eea1b52c2">&#9670;&#160;</a></span>mutt_extract_message_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * mutt_extract_message_id </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find a message-id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>String to parse </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">len</td><td>Number of bytes of s parsed </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> id found </td></tr>
    <tr><td class="paramname">NULL</td><td>No more message ids </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00400">400</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  401</span>{</div>
<div class="line"><span class="lineno">  402</span>  <span class="keywordflow">if</span> (!s || (*s == <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line"><span class="lineno">  403</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>  <span class="keywordtype">char</span> *decoded = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(s);</div>
<div class="line"><span class="lineno">  406</span>  <a class="code hl_function" href="rfc2047_8c.html#a89c57c82465740567f73641c9397d760">rfc2047_decode</a>(&amp;decoded);</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>  <span class="keywordtype">char</span> *res = NULL;</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> *p = decoded, *beg = NULL; *p; p++)</div>
<div class="line"><span class="lineno">  411</span>  {</div>
<div class="line"><span class="lineno">  412</span>    <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;&lt;&#39;</span>)</div>
<div class="line"><span class="lineno">  413</span>    {</div>
<div class="line"><span class="lineno">  414</span>      beg = p;</div>
<div class="line"><span class="lineno">  415</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  416</span>    }</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>    <span class="keywordflow">if</span> (beg &amp;&amp; (*p == <span class="charliteral">&#39;&gt;&#39;</span>))</div>
<div class="line"><span class="lineno">  419</span>    {</div>
<div class="line"><span class="lineno">  420</span>      <span class="keywordflow">if</span> (len)</div>
<div class="line"><span class="lineno">  421</span>        *len = p - decoded + 1;</div>
<div class="line"><span class="lineno">  422</span>      res = <a class="code hl_function" href="mutt_2string_8c.html#a116d1d2391bc57f2ba3a9d9cfb15db76">mutt_strn_dup</a>(beg, (p + 1) - beg);</div>
<div class="line"><span class="lineno">  423</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  424</span>    }</div>
<div class="line"><span class="lineno">  425</span>  }</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;decoded);</div>
<div class="line"><span class="lineno">  428</span>  <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  429</span>}</div>
<div class="ttc" id="amemory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdoc">Free memory and set the pointer to NULL.</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00068">memory.h:68</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a3fe33d90e4814281cd57de048119c950"><div class="ttname"><a href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a></div><div class="ttdeci">char * mutt_str_dup(const char *str)</div><div class="ttdoc">Copy a string, safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00257">string.c:257</a></div></div>
<div class="ttc" id="arfc2047_8c_html_a89c57c82465740567f73641c9397d760"><div class="ttname"><a href="rfc2047_8c.html#a89c57c82465740567f73641c9397d760">rfc2047_decode</a></div><div class="ttdeci">void rfc2047_decode(char **pd)</div><div class="ttdoc">Decode any RFC2047-encoded header fields.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00665">rfc2047.c:665</a></div></div>
</div><!-- fragment --><div id="dynsection-23" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_aa7b7d3d9446a52fbc31ef18eea1b52c2_cgraph.svg" width="519" height="144"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-24" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_aa7b7d3d9446a52fbc31ef18eea1b52c2_icgraph.svg" width="606" height="119"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a8692f01c25d10e357dbeee470ba26c2c" name="a8692f01c25d10e357dbeee470ba26c2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8692f01c25d10e357dbeee470ba26c2c">&#9670;&#160;</a></span>mutt_check_encoding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_check_encoding </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>c</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the encoding type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>String to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">enum</td><td><a class="el" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61" title="Content-Transfer-Encoding.">ContentEncoding</a>, e.g. <a class="el" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded" title="Quoted-printable text.">ENC_QUOTED_PRINTABLE</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00436">436</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  437</span>{</div>
<div class="line"><span class="lineno">  438</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(c, <span class="stringliteral">&quot;7bit&quot;</span>))</div>
<div class="line"><span class="lineno">  439</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e">ENC_7BIT</a>;</div>
<div class="line"><span class="lineno">  440</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(c, <span class="stringliteral">&quot;8bit&quot;</span>))</div>
<div class="line"><span class="lineno">  441</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466">ENC_8BIT</a>;</div>
<div class="line"><span class="lineno">  442</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(c, <span class="stringliteral">&quot;binary&quot;</span>))</div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a33a486b063e032293f7615de05f3cfa8">ENC_BINARY</a>;</div>
<div class="line"><span class="lineno">  444</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(c, <span class="stringliteral">&quot;quoted-printable&quot;</span>))</div>
<div class="line"><span class="lineno">  445</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a>;</div>
<div class="line"><span class="lineno">  446</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(c, <span class="stringliteral">&quot;base64&quot;</span>))</div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a>;</div>
<div class="line"><span class="lineno">  448</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(c, <span class="stringliteral">&quot;x-uuencode&quot;</span>))</div>
<div class="line"><span class="lineno">  449</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a17c00808bfbeb61dc2a001baf0aac5bd">ENC_UUENCODED</a>;</div>
<div class="line"><span class="lineno">  450</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(c, <span class="stringliteral">&quot;uuencode&quot;</span>))</div>
<div class="line"><span class="lineno">  451</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a17c00808bfbeb61dc2a001baf0aac5bd">ENC_UUENCODED</a>;</div>
<div class="line"><span class="lineno">  452</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a18d61a8aef64facb444f1987ee81c5c9">ENC_OTHER</a>;</div>
<div class="line"><span class="lineno">  453</span>}</div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e">ENC_7BIT</a></div><div class="ttdeci">@ ENC_7BIT</div><div class="ttdoc">7-bit text</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00049">mime.h:49</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a17c00808bfbeb61dc2a001baf0aac5bd"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a17c00808bfbeb61dc2a001baf0aac5bd">ENC_UUENCODED</a></div><div class="ttdeci">@ ENC_UUENCODED</div><div class="ttdoc">UUEncoded text.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00054">mime.h:54</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a18d61a8aef64facb444f1987ee81c5c9"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a18d61a8aef64facb444f1987ee81c5c9">ENC_OTHER</a></div><div class="ttdeci">@ ENC_OTHER</div><div class="ttdoc">Encoding unknown.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00048">mime.h:48</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a33a486b063e032293f7615de05f3cfa8"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a33a486b063e032293f7615de05f3cfa8">ENC_BINARY</a></div><div class="ttdeci">@ ENC_BINARY</div><div class="ttdoc">Binary.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00053">mime.h:53</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a></div><div class="ttdeci">@ ENC_BASE64</div><div class="ttdoc">Base-64 encoded text.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00052">mime.h:52</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466">ENC_8BIT</a></div><div class="ttdeci">@ ENC_8BIT</div><div class="ttdoc">8-bit text</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00050">mime.h:50</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a></div><div class="ttdeci">@ ENC_QUOTED_PRINTABLE</div><div class="ttdoc">Quoted-printable text.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00051">mime.h:51</a></div></div>
</div><!-- fragment --><div id="dynsection-25" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a8692f01c25d10e357dbeee470ba26c2c_cgraph.svg" width="359" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-26" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a8692f01c25d10e357dbeee470ba26c2c_icgraph.svg" width="835" height="214"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a1c0bcb79c2ff930b4131a1ede5828762" name="a1c0bcb79c2ff930b4131a1ede5828762"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c0bcb79c2ff930b4131a1ede5828762">&#9670;&#160;</a></span>mutt_parse_content_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_parse_content_type </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a content type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>String to parse </td></tr>
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> to save the result</td></tr>
  </table>
  </dd>
</dl>
<p>e.g. parse a string "inline" and set <a class="el" href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073" title="Content is inline.">DISP_INLINE</a>. </p>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00462">462</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  463</span>{</div>
<div class="line"><span class="lineno">  464</span>  <span class="keywordflow">if</span> (!s || !b)</div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>);</div>
<div class="line"><span class="lineno">  468</span>  <a class="code hl_function" href="parameter_8c.html#ade3b55d0262dc913be1e8307390514a0">mutt_param_free</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>);</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>  <span class="comment">/* First extract any existing parameters */</span></div>
<div class="line"><span class="lineno">  471</span>  <span class="keywordtype">char</span> *pc = strchr(s, <span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  472</span>  <span class="keywordflow">if</span> (pc)</div>
<div class="line"><span class="lineno">  473</span>  {</div>
<div class="line"><span class="lineno">  474</span>    *pc++ = 0;</div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">while</span> (*pc &amp;&amp; <a class="code hl_function" href="ctype_8c.html#a16dd3da88a22f7e3ea99e3474fc46fda">mutt_isspace</a>(*pc))</div>
<div class="line"><span class="lineno">  476</span>      pc++;</div>
<div class="line"><span class="lineno">  477</span>    <a class="code hl_function" href="#af286c6b467329705cc1ca7d92f9ad954">parse_parameters</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, pc, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>    <span class="comment">/* Some pre-RFC1521 gateways still use the &quot;name=filename&quot; convention,</span></div>
<div class="line"><span class="lineno">  480</span><span class="comment">     * but if a filename has already been set in the content-disposition,</span></div>
<div class="line"><span class="lineno">  481</span><span class="comment">     * let that take precedence, and don&#39;t set it here */</span></div>
<div class="line"><span class="lineno">  482</span>    pc = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;name&quot;</span>);</div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">if</span> (pc &amp;&amp; !b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>)</div>
<div class="line"><span class="lineno">  484</span>      b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(pc);</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>    <span class="comment">/* this is deep and utter perversion */</span></div>
<div class="line"><span class="lineno">  487</span>    pc = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;conversions&quot;</span>);</div>
<div class="line"><span class="lineno">  488</span>    <span class="keywordflow">if</span> (pc)</div>
<div class="line"><span class="lineno">  489</span>      b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = <a class="code hl_function" href="#a8692f01c25d10e357dbeee470ba26c2c">mutt_check_encoding</a>(pc);</div>
<div class="line"><span class="lineno">  490</span>  }</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>  <span class="comment">/* Now get the subtype */</span></div>
<div class="line"><span class="lineno">  493</span>  <span class="keywordtype">char</span> *subtype = strchr(s, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  494</span>  <span class="keywordflow">if</span> (subtype)</div>
<div class="line"><span class="lineno">  495</span>  {</div>
<div class="line"><span class="lineno">  496</span>    *subtype++ = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  497</span>    <span class="keywordflow">for</span> (pc = subtype; *pc &amp;&amp; !<a class="code hl_function" href="ctype_8c.html#a16dd3da88a22f7e3ea99e3474fc46fda">mutt_isspace</a>(*pc) &amp;&amp; (*pc != <span class="charliteral">&#39;;&#39;</span>); pc++)</div>
<div class="line"><span class="lineno">  498</span>      ; <span class="comment">// do nothing</span></div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>    *pc = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  501</span>    <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, subtype);</div>
<div class="line"><span class="lineno">  502</span>  }</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>  <span class="comment">/* Finally, get the major type */</span></div>
<div class="line"><span class="lineno">  505</span>  b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> = <a class="code hl_function" href="#a6c22ec026399e230ecedab86f831a754">mutt_check_mime_type</a>(s);</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;x-sun-attachment&quot;</span>, s))</div>
<div class="line"><span class="lineno">  508</span>    <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;x-sun-attachment&quot;</span>);</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>  <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17">TYPE_OTHER</a>)</div>
<div class="line"><span class="lineno">  511</span>  {</div>
<div class="line"><span class="lineno">  512</span>    <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a25c15115b34c11620fc995c13383fd9b">xtype</a>, s);</div>
<div class="line"><span class="lineno">  513</span>  }</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>  <span class="keywordflow">if</span> (!b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>)</div>
<div class="line"><span class="lineno">  516</span>  {</div>
<div class="line"><span class="lineno">  517</span>    <span class="comment">/* Some older non-MIME mailers (i.e., mailtool, elm) have a content-type</span></div>
<div class="line"><span class="lineno">  518</span><span class="comment">     * field, so we can attempt to convert the type to Body here.  */</span></div>
<div class="line"><span class="lineno">  519</span>    <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>)</div>
<div class="line"><span class="lineno">  520</span>    {</div>
<div class="line"><span class="lineno">  521</span>      b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(<span class="stringliteral">&quot;plain&quot;</span>);</div>
<div class="line"><span class="lineno">  522</span>    }</div>
<div class="line"><span class="lineno">  523</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a17e2dc2b6c45bd9d56010ed4aed3fcf4">TYPE_AUDIO</a>)</div>
<div class="line"><span class="lineno">  524</span>    {</div>
<div class="line"><span class="lineno">  525</span>      b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(<span class="stringliteral">&quot;basic&quot;</span>);</div>
<div class="line"><span class="lineno">  526</span>    }</div>
<div class="line"><span class="lineno">  527</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a>)</div>
<div class="line"><span class="lineno">  528</span>    {</div>
<div class="line"><span class="lineno">  529</span>      b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(<span class="stringliteral">&quot;rfc822&quot;</span>);</div>
<div class="line"><span class="lineno">  530</span>    }</div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17">TYPE_OTHER</a>)</div>
<div class="line"><span class="lineno">  532</span>    {</div>
<div class="line"><span class="lineno">  533</span>      <span class="keywordtype">char</span> buf[128] = { 0 };</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>      b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> = <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>;</div>
<div class="line"><span class="lineno">  536</span>      snprintf(buf, <span class="keyword">sizeof</span>(buf), <span class="stringliteral">&quot;x-%s&quot;</span>, s);</div>
<div class="line"><span class="lineno">  537</span>      b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(buf);</div>
<div class="line"><span class="lineno">  538</span>    }</div>
<div class="line"><span class="lineno">  539</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  540</span>    {</div>
<div class="line"><span class="lineno">  541</span>      b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(<span class="stringliteral">&quot;x-unknown&quot;</span>);</div>
<div class="line"><span class="lineno">  542</span>    }</div>
<div class="line"><span class="lineno">  543</span>  }</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>  <span class="comment">/* Default character set for text types. */</span></div>
<div class="line"><span class="lineno">  546</span>  <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>)</div>
<div class="line"><span class="lineno">  547</span>  {</div>
<div class="line"><span class="lineno">  548</span>    pc = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;charset&quot;</span>);</div>
<div class="line"><span class="lineno">  549</span>    <span class="keywordflow">if</span> (pc)</div>
<div class="line"><span class="lineno">  550</span>    {</div>
<div class="line"><span class="lineno">  551</span>      <span class="comment">/* Microsoft Outlook seems to think it is necessary to repeat</span></div>
<div class="line"><span class="lineno">  552</span><span class="comment">       * charset=, strip it off not to confuse ourselves */</span></div>
<div class="line"><span class="lineno">  553</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#aefa17bf84a5a1cb4b41afb08cd91ceff">mutt_istrn_equal</a>(pc, <span class="stringliteral">&quot;charset=&quot;</span>, <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;charset=&quot;</span>) - 1))</div>
<div class="line"><span class="lineno">  554</span>        <a class="code hl_function" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;charset&quot;</span>, pc + (<span class="keyword">sizeof</span>(<span class="stringliteral">&quot;charset=&quot;</span>) - 1));</div>
<div class="line"><span class="lineno">  555</span>    }</div>
<div class="line"><span class="lineno">  556</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  557</span>    {</div>
<div class="line"><span class="lineno">  558</span>      <a class="code hl_function" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;charset&quot;</span>,</div>
<div class="line"><span class="lineno">  559</span>                     <a class="code hl_function" href="mutt_2charset_8c.html#af919f6cab94a1ff6ba6fa6b9b9c2f8f8">mutt_ch_get_default_charset</a>(<a class="code hl_function" href="config__cache_8c.html#addc06d02c91cce26bfe7c3692ddf0046">cc_assumed_charset</a>()));</div>
<div class="line"><span class="lineno">  560</span>    }</div>
<div class="line"><span class="lineno">  561</span>  }</div>
<div class="line"><span class="lineno">  562</span>}</div>
<div class="ttc" id="aemail_2parse_8c_html_a6c22ec026399e230ecedab86f831a754"><div class="ttname"><a href="#a6c22ec026399e230ecedab86f831a754">mutt_check_mime_type</a></div><div class="ttdeci">enum ContentType mutt_check_mime_type(const char *s)</div><div class="ttdoc">Check a MIME type string.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00365">parse.c:365</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a8692f01c25d10e357dbeee470ba26c2c"><div class="ttname"><a href="#a8692f01c25d10e357dbeee470ba26c2c">mutt_check_encoding</a></div><div class="ttdeci">int mutt_check_encoding(const char *c)</div><div class="ttdoc">Check the encoding type.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00436">parse.c:436</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_af919f6cab94a1ff6ba6fa6b9b9c2f8f8"><div class="ttname"><a href="mutt_2charset_8c.html#af919f6cab94a1ff6ba6fa6b9b9c2f8f8">mutt_ch_get_default_charset</a></div><div class="ttdeci">const char * mutt_ch_get_default_charset(const struct Slist *const assumed_charset)</div><div class="ttdoc">Get the default character set.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00451">charset.c:451</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_aefa17bf84a5a1cb4b41afb08cd91ceff"><div class="ttname"><a href="mutt_2string_8c.html#aefa17bf84a5a1cb4b41afb08cd91ceff">mutt_istrn_equal</a></div><div class="ttdeci">bool mutt_istrn_equal(const char *a, const char *b, size_t num)</div><div class="ttdoc">Check for equality of two strings ignoring case (to a maximum), safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00457">string.c:457</a></div></div>
<div class="ttc" id="aparameter_8c_html_a42249fc15b1e52df046a0a10de29da44"><div class="ttname"><a href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a></div><div class="ttdeci">void mutt_param_set(struct ParameterList *pl, const char *attribute, const char *value)</div><div class="ttdoc">Set a Parameter.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8c_source.html#l00111">parameter.c:111</a></div></div>
<div class="ttc" id="astructBody_html_a25c15115b34c11620fc995c13383fd9b"><div class="ttname"><a href="structBody.html#a25c15115b34c11620fc995c13383fd9b">Body::xtype</a></div><div class="ttdeci">char * xtype</div><div class="ttdoc">content-type if x-unknown</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00062">body.h:62</a></div></div>
<div class="ttc" id="astructBody_html_ad2f05b8ff24813de41988e63de5d6a31"><div class="ttname"><a href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">Body::encoding</a></div><div class="ttdeci">unsigned int encoding</div><div class="ttdoc">content-transfer-encoding, ContentEncoding</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00041">body.h:41</a></div></div>
</div><!-- fragment --><div id="dynsection-27" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a1c0bcb79c2ff930b4131a1ede5828762_cgraph.svg" width="754" height="688"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-28" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a1c0bcb79c2ff930b4131a1ede5828762_icgraph.svg" width="634" height="302"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a5875b5c866cb7caa2fb55c960bf59f2b" name="a5875b5c866cb7caa2fb55c960bf59f2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5875b5c866cb7caa2fb55c960bf59f2b">&#9670;&#160;</a></span>parse_autocrypt()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structAutocryptHeader.html">AutocryptHeader</a> * parse_autocrypt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structAutocryptHeader.html">AutocryptHeader</a> *</td>          <td class="paramname"><span class="paramname"><em>head</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse an Autocrypt header line. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">head</td><td>Autocrypt header to insert before </td></tr>
    <tr><td class="paramname">s</td><td>Header string to parse </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>New <a class="el" href="structAutocryptHeader.html" title="Parse Autocrypt header info.">AutocryptHeader</a> inserted before head </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00571">571</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  572</span>{</div>
<div class="line"><span class="lineno">  573</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structAutocryptHeader.html">AutocryptHeader</a> *autocrypt = <a class="code hl_function" href="envelope_8c.html#ae9775769d2a2c71c04649e2bd5eab7af">mutt_autocrypthdr_new</a>();</div>
<div class="line"><span class="lineno">  574</span>  autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#aacc17a840cd493c68d74c21fd9076176">next</a> = head;</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>  <span class="keyword">struct </span>ParameterList pl = <a class="code hl_define" href="queue_8h.html#ac269df7d4126ed9885156cbad2cbf8af">TAILQ_HEAD_INITIALIZER</a>(pl);</div>
<div class="line"><span class="lineno">  577</span>  <a class="code hl_function" href="#af286c6b467329705cc1ca7d92f9ad954">parse_parameters</a>(&amp;pl, s, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  578</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;pl))</div>
<div class="line"><span class="lineno">  579</span>  {</div>
<div class="line"><span class="lineno">  580</span>    autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#a7ab8a3aca782be141dfceb8dae5d6938">invalid</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  581</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  582</span>  }</div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structParameter.html">Parameter</a> *p = NULL;</div>
<div class="line"><span class="lineno">  585</span>  <a class="code hl_define" href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a>(p, &amp;pl, entries)</div>
<div class="line"><span class="lineno">  586</span>  {</div>
<div class="line"><span class="lineno">  587</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p-&gt;<a class="code hl_variable" href="structParameter.html#a189338f8764ba916b15b6848d1d79420">attribute</a>, <span class="stringliteral">&quot;addr&quot;</span>))</div>
<div class="line"><span class="lineno">  588</span>    {</div>
<div class="line"><span class="lineno">  589</span>      <span class="keywordflow">if</span> (autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#aff8c01557e8d51c9fe23f2375535d39f">addr</a>)</div>
<div class="line"><span class="lineno">  590</span>      {</div>
<div class="line"><span class="lineno">  591</span>        autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#a7ab8a3aca782be141dfceb8dae5d6938">invalid</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  592</span>        <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  593</span>      }</div>
<div class="line"><span class="lineno">  594</span>      autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#aff8c01557e8d51c9fe23f2375535d39f">addr</a> = p-&gt;<a class="code hl_variable" href="structParameter.html#ada5e74c000e2a745066632067df1ac8d">value</a>;</div>
<div class="line"><span class="lineno">  595</span>      p-&gt;<a class="code hl_variable" href="structParameter.html#ada5e74c000e2a745066632067df1ac8d">value</a> = NULL;</div>
<div class="line"><span class="lineno">  596</span>    }</div>
<div class="line"><span class="lineno">  597</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p-&gt;<a class="code hl_variable" href="structParameter.html#a189338f8764ba916b15b6848d1d79420">attribute</a>, <span class="stringliteral">&quot;prefer-encrypt&quot;</span>))</div>
<div class="line"><span class="lineno">  598</span>    {</div>
<div class="line"><span class="lineno">  599</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p-&gt;<a class="code hl_variable" href="structParameter.html#ada5e74c000e2a745066632067df1ac8d">value</a>, <span class="stringliteral">&quot;mutual&quot;</span>))</div>
<div class="line"><span class="lineno">  600</span>        autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#adaf40c7d8ca45c8ca9fce9fe76794f93">prefer_encrypt</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  601</span>    }</div>
<div class="line"><span class="lineno">  602</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p-&gt;<a class="code hl_variable" href="structParameter.html#a189338f8764ba916b15b6848d1d79420">attribute</a>, <span class="stringliteral">&quot;keydata&quot;</span>))</div>
<div class="line"><span class="lineno">  603</span>    {</div>
<div class="line"><span class="lineno">  604</span>      <span class="keywordflow">if</span> (autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#ac867aa9322efc89ba78c592bd7c1d9bc">keydata</a>)</div>
<div class="line"><span class="lineno">  605</span>      {</div>
<div class="line"><span class="lineno">  606</span>        autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#a7ab8a3aca782be141dfceb8dae5d6938">invalid</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  607</span>        <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  608</span>      }</div>
<div class="line"><span class="lineno">  609</span>      autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#ac867aa9322efc89ba78c592bd7c1d9bc">keydata</a> = p-&gt;<a class="code hl_variable" href="structParameter.html#ada5e74c000e2a745066632067df1ac8d">value</a>;</div>
<div class="line"><span class="lineno">  610</span>      p-&gt;<a class="code hl_variable" href="structParameter.html#ada5e74c000e2a745066632067df1ac8d">value</a> = NULL;</div>
<div class="line"><span class="lineno">  611</span>    }</div>
<div class="line"><span class="lineno">  612</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p-&gt;<a class="code hl_variable" href="structParameter.html#a189338f8764ba916b15b6848d1d79420">attribute</a> &amp;&amp; (p-&gt;<a class="code hl_variable" href="structParameter.html#a189338f8764ba916b15b6848d1d79420">attribute</a>[0] != <span class="charliteral">&#39;_&#39;</span>))</div>
<div class="line"><span class="lineno">  613</span>    {</div>
<div class="line"><span class="lineno">  614</span>      autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#a7ab8a3aca782be141dfceb8dae5d6938">invalid</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  615</span>      <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  616</span>    }</div>
<div class="line"><span class="lineno">  617</span>  }</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>  <span class="comment">/* Checking the addr against From, and for multiple valid headers</span></div>
<div class="line"><span class="lineno">  620</span><span class="comment">   * occurs later, after all the headers are parsed. */</span></div>
<div class="line"><span class="lineno">  621</span>  <span class="keywordflow">if</span> (!autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#aff8c01557e8d51c9fe23f2375535d39f">addr</a> || !autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#ac867aa9322efc89ba78c592bd7c1d9bc">keydata</a>)</div>
<div class="line"><span class="lineno">  622</span>    autocrypt-&gt;<a class="code hl_variable" href="structAutocryptHeader.html#a7ab8a3aca782be141dfceb8dae5d6938">invalid</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>cleanup:</div>
<div class="line"><span class="lineno">  625</span>  <a class="code hl_function" href="parameter_8c.html#ade3b55d0262dc913be1e8307390514a0">mutt_param_free</a>(&amp;pl);</div>
<div class="line"><span class="lineno">  626</span>  <span class="keywordflow">return</span> autocrypt;</div>
<div class="line"><span class="lineno">  627</span>}</div>
<div class="ttc" id="aenvelope_8c_html_ae9775769d2a2c71c04649e2bd5eab7af"><div class="ttname"><a href="envelope_8c.html#ae9775769d2a2c71c04649e2bd5eab7af">mutt_autocrypthdr_new</a></div><div class="ttdeci">struct AutocryptHeader * mutt_autocrypthdr_new(void)</div><div class="ttdoc">Create a new AutocryptHeader.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8c_source.html#l00094">envelope.c:94</a></div></div>
<div class="ttc" id="aqueue_8h_html_a16e5fc168e7f3494d4b1df54447d871e"><div class="ttname"><a href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a></div><div class="ttdeci">#define TAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00782">queue.h:782</a></div></div>
<div class="ttc" id="astructAutocryptHeader_html"><div class="ttname"><a href="structAutocryptHeader.html">AutocryptHeader</a></div><div class="ttdoc">Parse Autocrypt header info.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00043">envelope.h:44</a></div></div>
<div class="ttc" id="astructAutocryptHeader_html_a7ab8a3aca782be141dfceb8dae5d6938"><div class="ttname"><a href="structAutocryptHeader.html#a7ab8a3aca782be141dfceb8dae5d6938">AutocryptHeader::invalid</a></div><div class="ttdeci">bool invalid</div><div class="ttdoc">Header is invalid.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00048">envelope.h:48</a></div></div>
<div class="ttc" id="astructAutocryptHeader_html_aacc17a840cd493c68d74c21fd9076176"><div class="ttname"><a href="structAutocryptHeader.html#aacc17a840cd493c68d74c21fd9076176">AutocryptHeader::next</a></div><div class="ttdeci">struct AutocryptHeader * next</div><div class="ttdoc">Linked list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00049">envelope.h:49</a></div></div>
<div class="ttc" id="astructAutocryptHeader_html_ac867aa9322efc89ba78c592bd7c1d9bc"><div class="ttname"><a href="structAutocryptHeader.html#ac867aa9322efc89ba78c592bd7c1d9bc">AutocryptHeader::keydata</a></div><div class="ttdeci">char * keydata</div><div class="ttdoc">PGP Key data.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00046">envelope.h:46</a></div></div>
<div class="ttc" id="astructAutocryptHeader_html_adaf40c7d8ca45c8ca9fce9fe76794f93"><div class="ttname"><a href="structAutocryptHeader.html#adaf40c7d8ca45c8ca9fce9fe76794f93">AutocryptHeader::prefer_encrypt</a></div><div class="ttdeci">bool prefer_encrypt</div><div class="ttdoc">User prefers encryption.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00047">envelope.h:47</a></div></div>
<div class="ttc" id="astructAutocryptHeader_html_aff8c01557e8d51c9fe23f2375535d39f"><div class="ttname"><a href="structAutocryptHeader.html#aff8c01557e8d51c9fe23f2375535d39f">AutocryptHeader::addr</a></div><div class="ttdeci">char * addr</div><div class="ttdoc">Email address.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00045">envelope.h:45</a></div></div>
</div><!-- fragment --><div id="dynsection-29" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a5875b5c866cb7caa2fb55c960bf59f2b_cgraph.svg" width="352" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-30" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-30-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-30-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-30-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a5875b5c866cb7caa2fb55c960bf59f2b_icgraph.svg" width="348" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a60bcab5634e02e9173938bb7ae4fec8b" name="a60bcab5634e02e9173938bb7ae4fec8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60bcab5634e02e9173938bb7ae4fec8b">&#9670;&#160;</a></span>rfc2369_first_mailto()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char * rfc2369_first_mailto </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>body</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract the first mailto: URL from a RFC2369 list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">body</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of the header </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>First mailto: URL found, or NULL if none was found </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00635">635</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  636</span>{</div>
<div class="line"><span class="lineno">  637</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">char</span> *beg = body, *end = NULL; beg; beg = strchr(end, <span class="charliteral">&#39;,&#39;</span>))</div>
<div class="line"><span class="lineno">  638</span>  {</div>
<div class="line"><span class="lineno">  639</span>    beg = strchr(beg, <span class="charliteral">&#39;&lt;&#39;</span>);</div>
<div class="line"><span class="lineno">  640</span>    <span class="keywordflow">if</span> (!beg)</div>
<div class="line"><span class="lineno">  641</span>    {</div>
<div class="line"><span class="lineno">  642</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  643</span>    }</div>
<div class="line"><span class="lineno">  644</span>    beg++;</div>
<div class="line"><span class="lineno">  645</span>    end = strchr(beg, <span class="charliteral">&#39;&gt;&#39;</span>);</div>
<div class="line"><span class="lineno">  646</span>    <span class="keywordflow">if</span> (!end)</div>
<div class="line"><span class="lineno">  647</span>    {</div>
<div class="line"><span class="lineno">  648</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  649</span>    }</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>    <span class="keywordtype">char</span> *mlist = <a class="code hl_function" href="mutt_2string_8c.html#a116d1d2391bc57f2ba3a9d9cfb15db76">mutt_strn_dup</a>(beg, end - beg);</div>
<div class="line"><span class="lineno">  652</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="url_8c.html#a8f42b58bf1296286da36c329472f135f">url_check_scheme</a>(mlist) == <a class="code hl_enumvalue" href="url_8h.html#a10b37ccf31f8e23024ff3ba628aa4243a37e57b950d3261812a4af815c0505411">U_MAILTO</a>)</div>
<div class="line"><span class="lineno">  653</span>    {</div>
<div class="line"><span class="lineno">  654</span>      <span class="keywordflow">return</span> mlist;</div>
<div class="line"><span class="lineno">  655</span>    }</div>
<div class="line"><span class="lineno">  656</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;mlist);</div>
<div class="line"><span class="lineno">  657</span>  }</div>
<div class="line"><span class="lineno">  658</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  659</span>}</div>
<div class="ttc" id="aurl_8c_html_a8f42b58bf1296286da36c329472f135f"><div class="ttname"><a href="url_8c.html#a8f42b58bf1296286da36c329472f135f">url_check_scheme</a></div><div class="ttdeci">enum UrlScheme url_check_scheme(const char *str)</div><div class="ttdoc">Check the protocol of a URL.</div><div class="ttdef"><b>Definition</b> <a href="url_8c_source.html#l00226">url.c:226</a></div></div>
<div class="ttc" id="aurl_8h_html_a10b37ccf31f8e23024ff3ba628aa4243a37e57b950d3261812a4af815c0505411"><div class="ttname"><a href="url_8h.html#a10b37ccf31f8e23024ff3ba628aa4243a37e57b950d3261812a4af815c0505411">U_MAILTO</a></div><div class="ttdeci">@ U_MAILTO</div><div class="ttdoc">Url is mailto://.</div><div class="ttdef"><b>Definition</b> <a href="url_8h_source.html#l00045">url.h:45</a></div></div>
</div><!-- fragment --><div id="dynsection-31" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-31-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-31-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-31-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a60bcab5634e02e9173938bb7ae4fec8b_cgraph.svg" width="338" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-32" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-32-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-32-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-32-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a60bcab5634e02e9173938bb7ae4fec8b_icgraph.svg" width="372" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a012cf883e316be91676a2f589b48f330" name="a012cf883e316be91676a2f589b48f330"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a012cf883e316be91676a2f589b48f330">&#9670;&#160;</a></span>mutt_rfc822_parse_line()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_rfc822_parse_line </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEnvelope.html">Envelope</a> *</td>          <td class="paramname"><span class="paramname"><em>env</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>name_len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>body</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>user_hdrs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>weed</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>do_2047</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse an email header. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">env</td><td><a class="el" href="structEnvelope.html" title="The header of an Email.">Envelope</a> of the email </td></tr>
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> </td></tr>
    <tr><td class="paramname">name</td><td>Header field name, e.g. 'to' </td></tr>
    <tr><td class="paramname">name_len</td><td>Must be equivalent to strlen(name) </td></tr>
    <tr><td class="paramname">body</td><td>Header field body, e.g. '<a href="#" onclick="location.href='mai'+'lto:'+'joh'+'n@'+'exa'+'mp'+'le.'+'co'+'m'; return false;">john@<span class="obfuscator">.nosp@m.</span>exam<span class="obfuscator">.nosp@m.</span>ple.c<span class="obfuscator">.nosp@m.</span>om</a>' </td></tr>
    <tr><td class="paramname">user_hdrs</td><td>If true, save into the <a class="el" href="structEnvelope.html" title="The header of an Email.">Envelope</a>'s userhdrs </td></tr>
    <tr><td class="paramname">weed</td><td>If true, perform header weeding (filtering) </td></tr>
    <tr><td class="paramname">do_2047</td><td>If true, perform RFC2047 decoding of the field </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>The field is recognised </td></tr>
    <tr><td class="paramname">0</td><td>The field is not recognised</td></tr>
  </table>
  </dd>
</dl>
<p>Process a line from an email header. Each line that is recognised is parsed and the information put in the <a class="el" href="structEnvelope.html" title="The header of an Email.">Envelope</a> or Header. </p>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l00677">677</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  680</span>{</div>
<div class="line"><span class="lineno">  681</span>  <span class="keywordflow">if</span> (!env || !name)</div>
<div class="line"><span class="lineno">  682</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>  <span class="keywordtype">bool</span> matched = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>  <span class="keywordflow">switch</span> (name[0] | 0x20)</div>
<div class="line"><span class="lineno">  687</span>  {</div>
<div class="line"><span class="lineno">  688</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div>
<div class="line"><span class="lineno">  689</span>      <span class="keywordflow">if</span> ((name_len == 13) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a8e3c5bfe2f500901470f6cb5fd359e98">eqi12</a>(name + 1, <span class="stringliteral">&quot;pparently-to&quot;</span>))</div>
<div class="line"><span class="lineno">  690</span>      {</div>
<div class="line"><span class="lineno">  691</span>        <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, body);</div>
<div class="line"><span class="lineno">  692</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  693</span>      }</div>
<div class="line"><span class="lineno">  694</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 15) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a31d2760bb472eeb8231a86078adcc372">eqi14</a>(name + 1, <span class="stringliteral">&quot;pparently-from&quot;</span>))</div>
<div class="line"><span class="lineno">  695</span>      {</div>
<div class="line"><span class="lineno">  696</span>        <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, body);</div>
<div class="line"><span class="lineno">  697</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  698</span>      }</div>
<div class="line"><span class="lineno">  699</span><span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div>
<div class="line"><span class="lineno">  700</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 9) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a21bf6a5ca5c452fcba8e508f6330a28e">eqi8</a>(name + 1, <span class="stringliteral">&quot;utocrypt&quot;</span>))</div>
<div class="line"><span class="lineno">  701</span>      {</div>
<div class="line"><span class="lineno">  702</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> c_autocrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;autocrypt&quot;</span>);</div>
<div class="line"><span class="lineno">  703</span>        <span class="keywordflow">if</span> (c_autocrypt)</div>
<div class="line"><span class="lineno">  704</span>        {</div>
<div class="line"><span class="lineno">  705</span>          env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8888ccd1c0b1512c92dd00a9a3a059d8">autocrypt</a> = <a class="code hl_function" href="#a5875b5c866cb7caa2fb55c960bf59f2b">parse_autocrypt</a>(env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8888ccd1c0b1512c92dd00a9a3a059d8">autocrypt</a>, body);</div>
<div class="line"><span class="lineno">  706</span>          matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  707</span>        }</div>
<div class="line"><span class="lineno">  708</span>      }</div>
<div class="line"><span class="lineno">  709</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 16) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#aabf9c83039057253dd99c48fc8637a8c">eqi15</a>(name + 1, <span class="stringliteral">&quot;utocrypt-gossip&quot;</span>))</div>
<div class="line"><span class="lineno">  710</span>      {</div>
<div class="line"><span class="lineno">  711</span>        <span class="keyword">const</span> <span class="keywordtype">bool</span> c_autocrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;autocrypt&quot;</span>);</div>
<div class="line"><span class="lineno">  712</span>        <span class="keywordflow">if</span> (c_autocrypt)</div>
<div class="line"><span class="lineno">  713</span>        {</div>
<div class="line"><span class="lineno">  714</span>          env-&gt;<a class="code hl_variable" href="structEnvelope.html#a59c64138a508cd27c61dc719e7aab5a0">autocrypt_gossip</a> = <a class="code hl_function" href="#a5875b5c866cb7caa2fb55c960bf59f2b">parse_autocrypt</a>(env-&gt;<a class="code hl_variable" href="structEnvelope.html#a59c64138a508cd27c61dc719e7aab5a0">autocrypt_gossip</a>, body);</div>
<div class="line"><span class="lineno">  715</span>          matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  716</span>        }</div>
<div class="line"><span class="lineno">  717</span>      }</div>
<div class="line"><span class="lineno">  718</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  719</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>:</div>
<div class="line"><span class="lineno">  722</span>      <span class="keywordflow">if</span> ((name_len == 3) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#aeab6a50a3ecbb0850f16e4ef6d79afc1">eqi2</a>(name + 1, <span class="stringliteral">&quot;cc&quot;</span>))</div>
<div class="line"><span class="lineno">  723</span>      {</div>
<div class="line"><span class="lineno">  724</span>        <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">bcc</a>, body);</div>
<div class="line"><span class="lineno">  725</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  726</span>      }</div>
<div class="line"><span class="lineno">  727</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line"><span class="lineno">  730</span>      <span class="keywordflow">if</span> ((name_len == 2) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#ac47f5057417a54f3e1381bc4bc3ee6a0">eqi1</a>(name + 1, <span class="stringliteral">&quot;c&quot;</span>))</div>
<div class="line"><span class="lineno">  731</span>      {</div>
<div class="line"><span class="lineno">  732</span>        <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, body);</div>
<div class="line"><span class="lineno">  733</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  734</span>      }</div>
<div class="line"><span class="lineno">  735</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  736</span>      {</div>
<div class="line"><span class="lineno">  737</span>        <span class="keywordflow">if</span> ((name_len &gt;= 12) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a21bf6a5ca5c452fcba8e508f6330a28e">eqi8</a>(name, <span class="stringliteral">&quot;content-&quot;</span>))</div>
<div class="line"><span class="lineno">  738</span>        {</div>
<div class="line"><span class="lineno">  739</span>          <span class="keywordflow">if</span> ((name_len == 12) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a8058f110e504fe7c58007856cc3d0163">eqi4</a>(name + 8, <span class="stringliteral">&quot;type&quot;</span>))</div>
<div class="line"><span class="lineno">  740</span>          {</div>
<div class="line"><span class="lineno">  741</span>            <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno">  742</span>              <a class="code hl_function" href="#a1c0bcb79c2ff930b4131a1ede5828762">mutt_parse_content_type</a>(body, e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div>
<div class="line"><span class="lineno">  743</span>            matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  744</span>          }</div>
<div class="line"><span class="lineno">  745</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 16) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a21bf6a5ca5c452fcba8e508f6330a28e">eqi8</a>(name + 8, <span class="stringliteral">&quot;language&quot;</span>))</div>
<div class="line"><span class="lineno">  746</span>          {</div>
<div class="line"><span class="lineno">  747</span>            <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno">  748</span>              <a class="code hl_function" href="#a74dcb6f4b53adc8cc3f61bcf4168fd51">parse_content_language</a>(body, e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div>
<div class="line"><span class="lineno">  749</span>            matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  750</span>          }</div>
<div class="line"><span class="lineno">  751</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 25) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a03ec1aa881dcbd3cf47ced3ed30b2d50">eqi17</a>(name + 8, <span class="stringliteral">&quot;transfer-encoding&quot;</span>))</div>
<div class="line"><span class="lineno">  752</span>          {</div>
<div class="line"><span class="lineno">  753</span>            <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno">  754</span>              e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = <a class="code hl_function" href="#a8692f01c25d10e357dbeee470ba26c2c">mutt_check_encoding</a>(body);</div>
<div class="line"><span class="lineno">  755</span>            matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  756</span>          }</div>
<div class="line"><span class="lineno">  757</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 14) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a21bf6a5ca5c452fcba8e508f6330a28e">eqi8</a>(name + 6, <span class="stringliteral">&quot;t-length&quot;</span>))</div>
<div class="line"><span class="lineno">  758</span>          {</div>
<div class="line"><span class="lineno">  759</span>            <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno">  760</span>            {</div>
<div class="line"><span class="lineno">  761</span>              <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> len = 0;</div>
<div class="line"><span class="lineno">  762</span>              e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = <a class="code hl_function" href="atoi_8c.html#a7cebdbeebc9b6bb2a1771df84cdf7a2e">mutt_str_atoul</a>(body, &amp;len) ? <a class="code hl_define" href="memory_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(len, <a class="code hl_define" href="#afc8bf29df56e545eff7652964eea6081">CONTENT_TOO_BIG</a>) : -1;</div>
<div class="line"><span class="lineno">  763</span>            }</div>
<div class="line"><span class="lineno">  764</span>            matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  765</span>          }</div>
<div class="line"><span class="lineno">  766</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 19) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a22b741d063082522db4cb1790ceb149a">eqi11</a>(name + 8, <span class="stringliteral">&quot;description&quot;</span>))</div>
<div class="line"><span class="lineno">  767</span>          {</div>
<div class="line"><span class="lineno">  768</span>            <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno">  769</span>            {</div>
<div class="line"><span class="lineno">  770</span>              <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>, body);</div>
<div class="line"><span class="lineno">  771</span>              <a class="code hl_function" href="rfc2047_8c.html#a89c57c82465740567f73641c9397d760">rfc2047_decode</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>);</div>
<div class="line"><span class="lineno">  772</span>            }</div>
<div class="line"><span class="lineno">  773</span>            matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  774</span>          }</div>
<div class="line"><span class="lineno">  775</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 19) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a22b741d063082522db4cb1790ceb149a">eqi11</a>(name + 8, <span class="stringliteral">&quot;disposition&quot;</span>))</div>
<div class="line"><span class="lineno">  776</span>          {</div>
<div class="line"><span class="lineno">  777</span>            <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno">  778</span>              <a class="code hl_function" href="#a870232070405e395193a6c7e00e2df60">parse_content_disposition</a>(body, e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>);</div>
<div class="line"><span class="lineno">  779</span>            matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  780</span>          }</div>
<div class="line"><span class="lineno">  781</span>        }</div>
<div class="line"><span class="lineno">  782</span>      }</div>
<div class="line"><span class="lineno">  783</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  784</span> </div>
<div class="line"><span class="lineno">  785</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div>
<div class="line"><span class="lineno">  786</span>      <span class="keywordflow">if</span> ((name_len != 4) || !<a class="code hl_function" href="eqi_8h.html#a8058f110e504fe7c58007856cc3d0163">eqi4</a>(name, <span class="stringliteral">&quot;date&quot;</span>))</div>
<div class="line"><span class="lineno">  787</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>      <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#adb752a72d48a701571b3c1784bc4b59b">date</a>, body);</div>
<div class="line"><span class="lineno">  790</span>      <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno">  791</span>      {</div>
<div class="line"><span class="lineno">  792</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structTz.html">Tz</a> tz = { 0 };</div>
<div class="line"><span class="lineno">  793</span>        <span class="comment">// the caller will check e-&gt;date_sent for -1</span></div>
<div class="line"><span class="lineno">  794</span>        e-&gt;<a class="code hl_variable" href="structEmail.html#a9e3cda5dab6d53f68cad95d28068d962">date_sent</a> = <a class="code hl_function" href="mutt_2date_8c.html#ad8aaf5118148ed8f6708f32bfab3146f">mutt_date_parse_date</a>(body, &amp;tz);</div>
<div class="line"><span class="lineno">  795</span>        <span class="keywordflow">if</span> (e-&gt;<a class="code hl_variable" href="structEmail.html#a9e3cda5dab6d53f68cad95d28068d962">date_sent</a> &gt; 0)</div>
<div class="line"><span class="lineno">  796</span>        {</div>
<div class="line"><span class="lineno">  797</span>          e-&gt;<a class="code hl_variable" href="structEmail.html#a9e2ba09b444f493916f7289116bd9f1c">zhours</a> = tz.<a class="code hl_variable" href="structTz.html#aef24900adb513ba510b97c4c77426caa">zhours</a>;</div>
<div class="line"><span class="lineno">  798</span>          e-&gt;<a class="code hl_variable" href="structEmail.html#a0ff8541eb15d71d7d9f73e92365a1618">zminutes</a> = tz.<a class="code hl_variable" href="structTz.html#a1282be686c83afb2659e014b855d9335">zminutes</a>;</div>
<div class="line"><span class="lineno">  799</span>          e-&gt;<a class="code hl_variable" href="structEmail.html#a8170a6b34e26ead08a9631f47913f481">zoccident</a> = tz.<a class="code hl_variable" href="structTz.html#a36e79394164d2eb87797dc51797bfea2">zoccident</a>;</div>
<div class="line"><span class="lineno">  800</span>        }</div>
<div class="line"><span class="lineno">  801</span>      }</div>
<div class="line"><span class="lineno">  802</span>      matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  803</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  804</span> </div>
<div class="line"><span class="lineno">  805</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;e&#39;</span>:</div>
<div class="line"><span class="lineno">  806</span>      <span class="keywordflow">if</span> ((name_len == 7) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a2706295d4920e3c736c8db869b2f5ae8">eqi6</a>(name + 1, <span class="stringliteral">&quot;xpires&quot;</span>) &amp;&amp; e)</div>
<div class="line"><span class="lineno">  807</span>      {</div>
<div class="line"><span class="lineno">  808</span>        <span class="keyword">const</span> time_t expired = <a class="code hl_function" href="mutt_2date_8c.html#ad8aaf5118148ed8f6708f32bfab3146f">mutt_date_parse_date</a>(body, NULL);</div>
<div class="line"><span class="lineno">  809</span>        <span class="keywordflow">if</span> ((expired != -1) &amp;&amp; (expired &lt; <a class="code hl_function" href="mutt_2date_8c.html#ad1e6304a91c7b6f3c266a9b17c1740fe">mutt_date_now</a>()))</div>
<div class="line"><span class="lineno">  810</span>        {</div>
<div class="line"><span class="lineno">  811</span>          e-&gt;<a class="code hl_variable" href="structEmail.html#aa72ad88f6a82e49b76a0d0eb790abae8">expired</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  812</span>        }</div>
<div class="line"><span class="lineno">  813</span>      }</div>
<div class="line"><span class="lineno">  814</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  815</span> </div>
<div class="line"><span class="lineno">  816</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:</div>
<div class="line"><span class="lineno">  817</span>      <span class="keywordflow">if</span> ((name_len == 4) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a8058f110e504fe7c58007856cc3d0163">eqi4</a>(name, <span class="stringliteral">&quot;from&quot;</span>))</div>
<div class="line"><span class="lineno">  818</span>      {</div>
<div class="line"><span class="lineno">  819</span>        <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, body);</div>
<div class="line"><span class="lineno">  820</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  821</span>      }</div>
<div class="line"><span class="lineno">  822</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 11) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a1e423a9614c78387b06a96ec36322fc5">eqi10</a>(name + 1, <span class="stringliteral">&quot;ollowup-to&quot;</span>))</div>
<div class="line"><span class="lineno">  823</span>      {</div>
<div class="line"><span class="lineno">  824</span>        <span class="keywordflow">if</span> (!env-&gt;<a class="code hl_variable" href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">followup_to</a>)</div>
<div class="line"><span class="lineno">  825</span>        {</div>
<div class="line"><span class="lineno">  826</span>          env-&gt;<a class="code hl_variable" href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">followup_to</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(<a class="code hl_function" href="mutt_2string_8c.html#aa2fa4dcaf72786b58e825349883f14c2">mutt_str_skip_whitespace</a>(body));</div>
<div class="line"><span class="lineno">  827</span>          <a class="code hl_function" href="mutt_2string_8c.html#a1d343dcbce0482f8979fe2a298913225">mutt_str_remove_trailing_ws</a>(env-&gt;<a class="code hl_variable" href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">followup_to</a>);</div>
<div class="line"><span class="lineno">  828</span>        }</div>
<div class="line"><span class="lineno">  829</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  830</span>      }</div>
<div class="line"><span class="lineno">  831</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:</div>
<div class="line"><span class="lineno">  834</span>      <span class="keywordflow">if</span> ((name_len != 11) || !<a class="code hl_function" href="eqi_8h.html#a1e423a9614c78387b06a96ec36322fc5">eqi10</a>(name + 1, <span class="stringliteral">&quot;n-reply-to&quot;</span>))</div>
<div class="line"><span class="lineno">  835</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>      <a class="code hl_function" href="list_8c.html#ab5c53ce94cc2aafa4299dbc81a37f4a4">mutt_list_free</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">in_reply_to</a>);</div>
<div class="line"><span class="lineno">  838</span>      <span class="keywordtype">char</span> *body2 = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(body); <span class="comment">// Create a mutable copy</span></div>
<div class="line"><span class="lineno">  839</span>      <a class="code hl_function" href="#aeb759563267cc1a4ee017738d8ee3013">mutt_filter_commandline_header_value</a>(body2);</div>
<div class="line"><span class="lineno">  840</span>      <a class="code hl_function" href="#a5b80e3daa9cb6eb8f8ed5adae704ee10">parse_references</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">in_reply_to</a>, body2);</div>
<div class="line"><span class="lineno">  841</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;body2);</div>
<div class="line"><span class="lineno">  842</span>      matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  843</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  844</span> </div>
<div class="line"><span class="lineno">  845</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:</div>
<div class="line"><span class="lineno">  846</span>      <span class="keywordflow">if</span> ((name_len == 5) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a8058f110e504fe7c58007856cc3d0163">eqi4</a>(name + 1, <span class="stringliteral">&quot;ines&quot;</span>))</div>
<div class="line"><span class="lineno">  847</span>      {</div>
<div class="line"><span class="lineno">  848</span>        <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno">  849</span>        {</div>
<div class="line"><span class="lineno">  850</span>          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ui = 0; <span class="comment">// we don&#39;t want a negative number of lines</span></div>
<div class="line"><span class="lineno">  851</span>          <a class="code hl_function" href="atoi_8c.html#ad704fc34b6f2eb2132de8bf992994ac1">mutt_str_atoui</a>(body, &amp;ui);</div>
<div class="line"><span class="lineno">  852</span>          e-&gt;<a class="code hl_variable" href="structEmail.html#a562a3aee45efc37c07dedcc8e1fef93f">lines</a> = ui;</div>
<div class="line"><span class="lineno">  853</span>        }</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  856</span>      }</div>
<div class="line"><span class="lineno">  857</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 9) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a21bf6a5ca5c452fcba8e508f6330a28e">eqi8</a>(name + 1, <span class="stringliteral">&quot;ist-post&quot;</span>))</div>
<div class="line"><span class="lineno">  858</span>      {</div>
<div class="line"><span class="lineno">  859</span>        <span class="comment">/* RFC2369 */</span></div>
<div class="line"><span class="lineno">  860</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="mutt_2string_8c.html#a6f574867aa9db4d434adbc8af1f5f7e7">mutt_strn_equal</a>(<a class="code hl_function" href="mutt_2string_8c.html#aa2fa4dcaf72786b58e825349883f14c2">mutt_str_skip_whitespace</a>(body), <span class="stringliteral">&quot;NO&quot;</span>, 2))</div>
<div class="line"><span class="lineno">  861</span>        {</div>
<div class="line"><span class="lineno">  862</span>          <span class="keywordtype">char</span> *mailto = <a class="code hl_function" href="#a60bcab5634e02e9173938bb7ae4fec8b">rfc2369_first_mailto</a>(body);</div>
<div class="line"><span class="lineno">  863</span>          <span class="keywordflow">if</span> (mailto)</div>
<div class="line"><span class="lineno">  864</span>          {</div>
<div class="line"><span class="lineno">  865</span>            <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#ad0b7bb8cf358dd2d5d1dc5733b3f0be1">list_post</a>);</div>
<div class="line"><span class="lineno">  866</span>            env-&gt;<a class="code hl_variable" href="structEnvelope.html#ad0b7bb8cf358dd2d5d1dc5733b3f0be1">list_post</a> = mailto;</div>
<div class="line"><span class="lineno">  867</span>            <span class="keyword">const</span> <span class="keywordtype">bool</span> c_auto_subscribe = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;auto_subscribe&quot;</span>);</div>
<div class="line"><span class="lineno">  868</span>            <span class="keywordflow">if</span> (c_auto_subscribe)</div>
<div class="line"><span class="lineno">  869</span>              <a class="code hl_function" href="#a2a830caa65e6f462ab0ecae77bce746b">mutt_auto_subscribe</a>(env-&gt;<a class="code hl_variable" href="structEnvelope.html#ad0b7bb8cf358dd2d5d1dc5733b3f0be1">list_post</a>);</div>
<div class="line"><span class="lineno">  870</span>          }</div>
<div class="line"><span class="lineno">  871</span>        }</div>
<div class="line"><span class="lineno">  872</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  873</span>      }</div>
<div class="line"><span class="lineno">  874</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 14) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a69d024777d147c11128c1b68e322a131">eqi13</a>(name + 1, <span class="stringliteral">&quot;ist-subscribe&quot;</span>))</div>
<div class="line"><span class="lineno">  875</span>      {</div>
<div class="line"><span class="lineno">  876</span>        <span class="comment">/* RFC2369 */</span></div>
<div class="line"><span class="lineno">  877</span>        <span class="keywordtype">char</span> *mailto = <a class="code hl_function" href="#a60bcab5634e02e9173938bb7ae4fec8b">rfc2369_first_mailto</a>(body);</div>
<div class="line"><span class="lineno">  878</span>        <span class="keywordflow">if</span> (mailto)</div>
<div class="line"><span class="lineno">  879</span>        {</div>
<div class="line"><span class="lineno">  880</span>          <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a18ca6295a8894d93fe3b44275b62e415">list_subscribe</a>);</div>
<div class="line"><span class="lineno">  881</span>          env-&gt;<a class="code hl_variable" href="structEnvelope.html#a18ca6295a8894d93fe3b44275b62e415">list_subscribe</a> = mailto;</div>
<div class="line"><span class="lineno">  882</span>        }</div>
<div class="line"><span class="lineno">  883</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  884</span>      }</div>
<div class="line"><span class="lineno">  885</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 16) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#aabf9c83039057253dd99c48fc8637a8c">eqi15</a>(name + 1, <span class="stringliteral">&quot;ist-unsubscribe&quot;</span>))</div>
<div class="line"><span class="lineno">  886</span>      {</div>
<div class="line"><span class="lineno">  887</span>        <span class="comment">/* RFC2369 */</span></div>
<div class="line"><span class="lineno">  888</span>        <span class="keywordtype">char</span> *mailto = <a class="code hl_function" href="#a60bcab5634e02e9173938bb7ae4fec8b">rfc2369_first_mailto</a>(body);</div>
<div class="line"><span class="lineno">  889</span>        <span class="keywordflow">if</span> (mailto)</div>
<div class="line"><span class="lineno">  890</span>        {</div>
<div class="line"><span class="lineno">  891</span>          <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#aebaaff2a6132162b227659bba4260574">list_unsubscribe</a>);</div>
<div class="line"><span class="lineno">  892</span>          env-&gt;<a class="code hl_variable" href="structEnvelope.html#aebaaff2a6132162b227659bba4260574">list_unsubscribe</a> = mailto;</div>
<div class="line"><span class="lineno">  893</span>        }</div>
<div class="line"><span class="lineno">  894</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  895</span>      }</div>
<div class="line"><span class="lineno">  896</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:</div>
<div class="line"><span class="lineno">  899</span>      <span class="keywordflow">if</span> ((name_len == 12) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a22b741d063082522db4cb1790ceb149a">eqi11</a>(name + 1, <span class="stringliteral">&quot;ime-version&quot;</span>))</div>
<div class="line"><span class="lineno">  900</span>      {</div>
<div class="line"><span class="lineno">  901</span>        <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno">  902</span>          e-&gt;<a class="code hl_variable" href="structEmail.html#a37098f0a269341bb2c30ab4425207ec5">mime</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  903</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  904</span>      }</div>
<div class="line"><span class="lineno">  905</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 10) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a0b48b9a2c86d85301e1d32c0e8627f83">eqi9</a>(name + 1, <span class="stringliteral">&quot;essage-id&quot;</span>))</div>
<div class="line"><span class="lineno">  906</span>      {</div>
<div class="line"><span class="lineno">  907</span>        <span class="comment">/* We add a new &quot;Message-ID:&quot; when building a message */</span></div>
<div class="line"><span class="lineno">  908</span>        <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a>);</div>
<div class="line"><span class="lineno">  909</span>        env-&gt;<a class="code hl_variable" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a> = <a class="code hl_function" href="#aa7b7d3d9446a52fbc31ef18eea1b52c2">mutt_extract_message_id</a>(body, NULL);</div>
<div class="line"><span class="lineno">  910</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  911</span>      }</div>
<div class="line"><span class="lineno">  912</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  913</span>      {</div>
<div class="line"><span class="lineno">  914</span>        <span class="keywordflow">if</span> ((name_len &gt;= 13) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a8058f110e504fe7c58007856cc3d0163">eqi4</a>(name + 1, <span class="stringliteral">&quot;ail-&quot;</span>))</div>
<div class="line"><span class="lineno">  915</span>        {</div>
<div class="line"><span class="lineno">  916</span>          <span class="keywordflow">if</span> ((name_len == 13) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a21bf6a5ca5c452fcba8e508f6330a28e">eqi8</a>(name + 5, <span class="stringliteral">&quot;reply-to&quot;</span>))</div>
<div class="line"><span class="lineno">  917</span>          {</div>
<div class="line"><span class="lineno">  918</span>            <span class="comment">/* override the Reply-To: field */</span></div>
<div class="line"><span class="lineno">  919</span>            <a class="code hl_function" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>);</div>
<div class="line"><span class="lineno">  920</span>            <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>, body);</div>
<div class="line"><span class="lineno">  921</span>            matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  922</span>          }</div>
<div class="line"><span class="lineno">  923</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 16) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a22b741d063082522db4cb1790ceb149a">eqi11</a>(name + 5, <span class="stringliteral">&quot;followup-to&quot;</span>))</div>
<div class="line"><span class="lineno">  924</span>          {</div>
<div class="line"><span class="lineno">  925</span>            <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>, body);</div>
<div class="line"><span class="lineno">  926</span>            matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  927</span>          }</div>
<div class="line"><span class="lineno">  928</span>        }</div>
<div class="line"><span class="lineno">  929</span>      }</div>
<div class="line"><span class="lineno">  930</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>:</div>
<div class="line"><span class="lineno">  933</span>      <span class="keywordflow">if</span> ((name_len == 10) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a0b48b9a2c86d85301e1d32c0e8627f83">eqi9</a>(name + 1, <span class="stringliteral">&quot;ewsgroups&quot;</span>))</div>
<div class="line"><span class="lineno">  934</span>      {</div>
<div class="line"><span class="lineno">  935</span>        <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a>);</div>
<div class="line"><span class="lineno">  936</span>        env-&gt;<a class="code hl_variable" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(<a class="code hl_function" href="mutt_2string_8c.html#aa2fa4dcaf72786b58e825349883f14c2">mutt_str_skip_whitespace</a>(body));</div>
<div class="line"><span class="lineno">  937</span>        <a class="code hl_function" href="mutt_2string_8c.html#a1d343dcbce0482f8979fe2a298913225">mutt_str_remove_trailing_ws</a>(env-&gt;<a class="code hl_variable" href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">newsgroups</a>);</div>
<div class="line"><span class="lineno">  938</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  939</span>      }</div>
<div class="line"><span class="lineno">  940</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  941</span> </div>
<div class="line"><span class="lineno">  942</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span>:</div>
<div class="line"><span class="lineno">  943</span>      <span class="comment">/* field &#39;Organization:&#39; saves only for pager! */</span></div>
<div class="line"><span class="lineno">  944</span>      <span class="keywordflow">if</span> ((name_len == 12) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a22b741d063082522db4cb1790ceb149a">eqi11</a>(name + 1, <span class="stringliteral">&quot;rganization&quot;</span>))</div>
<div class="line"><span class="lineno">  945</span>      {</div>
<div class="line"><span class="lineno">  946</span>        <span class="keywordflow">if</span> (!env-&gt;<a class="code hl_variable" href="structEnvelope.html#aba7ae50abf7721af736b33dbe29cb152">organization</a> &amp;&amp; !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(body, <span class="stringliteral">&quot;unknown&quot;</span>))</div>
<div class="line"><span class="lineno">  947</span>          env-&gt;<a class="code hl_variable" href="structEnvelope.html#aba7ae50abf7721af736b33dbe29cb152">organization</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(body);</div>
<div class="line"><span class="lineno">  948</span>      }</div>
<div class="line"><span class="lineno">  949</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  950</span> </div>
<div class="line"><span class="lineno">  951</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:</div>
<div class="line"><span class="lineno">  952</span>      <span class="keywordflow">if</span> ((name_len == 10) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a0b48b9a2c86d85301e1d32c0e8627f83">eqi9</a>(name + 1, <span class="stringliteral">&quot;eferences&quot;</span>))</div>
<div class="line"><span class="lineno">  953</span>      {</div>
<div class="line"><span class="lineno">  954</span>        <a class="code hl_function" href="list_8c.html#ab5c53ce94cc2aafa4299dbc81a37f4a4">mutt_list_free</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>);</div>
<div class="line"><span class="lineno">  955</span>        <a class="code hl_function" href="#a5b80e3daa9cb6eb8f8ed5adae704ee10">parse_references</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>, body);</div>
<div class="line"><span class="lineno">  956</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  957</span>      }</div>
<div class="line"><span class="lineno">  958</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 8) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a21bf6a5ca5c452fcba8e508f6330a28e">eqi8</a>(name, <span class="stringliteral">&quot;reply-to&quot;</span>))</div>
<div class="line"><span class="lineno">  959</span>      {</div>
<div class="line"><span class="lineno">  960</span>        <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>, body);</div>
<div class="line"><span class="lineno">  961</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  962</span>      }</div>
<div class="line"><span class="lineno">  963</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 11) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a1e423a9614c78387b06a96ec36322fc5">eqi10</a>(name + 1, <span class="stringliteral">&quot;eturn-path&quot;</span>))</div>
<div class="line"><span class="lineno">  964</span>      {</div>
<div class="line"><span class="lineno">  965</span>        <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a1c204b091d782098fc1efa0c2f3b1e20">return_path</a>, body);</div>
<div class="line"><span class="lineno">  966</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  967</span>      }</div>
<div class="line"><span class="lineno">  968</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 8) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a21bf6a5ca5c452fcba8e508f6330a28e">eqi8</a>(name, <span class="stringliteral">&quot;received&quot;</span>))</div>
<div class="line"><span class="lineno">  969</span>      {</div>
<div class="line"><span class="lineno">  970</span>        <span class="keywordflow">if</span> (e &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#af64bcf33ccd8b0ba248fc8d427c21264">received</a> == 0))</div>
<div class="line"><span class="lineno">  971</span>        {</div>
<div class="line"><span class="lineno">  972</span>          <span class="keywordtype">char</span> *d = strrchr(body, <span class="charliteral">&#39;;&#39;</span>);</div>
<div class="line"><span class="lineno">  973</span>          <span class="keywordflow">if</span> (d)</div>
<div class="line"><span class="lineno">  974</span>          {</div>
<div class="line"><span class="lineno">  975</span>            d = <a class="code hl_function" href="mutt_2string_8c.html#a5bc328ca69776d155059041aaff9435a">mutt_str_skip_email_wsp</a>(d + 1);</div>
<div class="line"><span class="lineno">  976</span>            <span class="comment">// the caller will check e-&gt;received for -1</span></div>
<div class="line"><span class="lineno">  977</span>            e-&gt;<a class="code hl_variable" href="structEmail.html#af64bcf33ccd8b0ba248fc8d427c21264">received</a> = <a class="code hl_function" href="mutt_2date_8c.html#ad8aaf5118148ed8f6708f32bfab3146f">mutt_date_parse_date</a>(d, NULL);</div>
<div class="line"><span class="lineno">  978</span>          }</div>
<div class="line"><span class="lineno">  979</span>        }</div>
<div class="line"><span class="lineno">  980</span>      }</div>
<div class="line"><span class="lineno">  981</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  982</span> </div>
<div class="line"><span class="lineno">  983</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div>
<div class="line"><span class="lineno">  984</span>      <span class="keywordflow">if</span> ((name_len == 7) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a2706295d4920e3c736c8db869b2f5ae8">eqi6</a>(name + 1, <span class="stringliteral">&quot;ubject&quot;</span>))</div>
<div class="line"><span class="lineno">  985</span>      {</div>
<div class="line"><span class="lineno">  986</span>        <span class="keywordflow">if</span> (!env-&gt;<a class="code hl_variable" href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">subject</a>)</div>
<div class="line"><span class="lineno">  987</span>          <a class="code hl_function" href="envelope_8c.html#a91c00f700ee3ca43aa33487591b0d317">mutt_env_set_subject</a>(env, body);</div>
<div class="line"><span class="lineno">  988</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  989</span>      }</div>
<div class="line"><span class="lineno">  990</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 6) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a8d11ae8919aab05633bbf2641c4006fc">eqi5</a>(name + 1, <span class="stringliteral">&quot;ender&quot;</span>))</div>
<div class="line"><span class="lineno">  991</span>      {</div>
<div class="line"><span class="lineno">  992</span>        <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>, body);</div>
<div class="line"><span class="lineno">  993</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  994</span>      }</div>
<div class="line"><span class="lineno">  995</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 6) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a8d11ae8919aab05633bbf2641c4006fc">eqi5</a>(name + 1, <span class="stringliteral">&quot;tatus&quot;</span>))</div>
<div class="line"><span class="lineno">  996</span>      {</div>
<div class="line"><span class="lineno">  997</span>        <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno">  998</span>        {</div>
<div class="line"><span class="lineno">  999</span>          <span class="keywordflow">while</span> (*body)</div>
<div class="line"><span class="lineno"> 1000</span>          {</div>
<div class="line"><span class="lineno"> 1001</span>            <span class="keywordflow">switch</span> (*body)</div>
<div class="line"><span class="lineno"> 1002</span>            {</div>
<div class="line"><span class="lineno"> 1003</span>              <span class="keywordflow">case</span> <span class="charliteral">&#39;O&#39;</span>:</div>
<div class="line"><span class="lineno"> 1004</span>              {</div>
<div class="line"><span class="lineno"> 1005</span>                e-&gt;<a class="code hl_variable" href="structEmail.html#a6d9062408a8c89b19cf25584dd2ffb57">old</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1006</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1007</span>              }</div>
<div class="line"><span class="lineno"> 1008</span>              <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>:</div>
<div class="line"><span class="lineno"> 1009</span>                e-&gt;<a class="code hl_variable" href="structEmail.html#a0bd79550be901d44e50953fb43614e10">read</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1010</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1011</span>              <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:</div>
<div class="line"><span class="lineno"> 1012</span>                e-&gt;<a class="code hl_variable" href="structEmail.html#aa26dd591f92e548bc3c56d0b7fdb3e8c">replied</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1013</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1014</span>            }</div>
<div class="line"><span class="lineno"> 1015</span>            body++;</div>
<div class="line"><span class="lineno"> 1016</span>          }</div>
<div class="line"><span class="lineno"> 1017</span>        }</div>
<div class="line"><span class="lineno"> 1018</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1019</span>      }</div>
<div class="line"><span class="lineno"> 1020</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (e &amp;&amp; (name_len == 10) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#ac47f5057417a54f3e1381bc4bc3ee6a0">eqi1</a>(name + 1, <span class="stringliteral">&quot;u&quot;</span>) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1021</span>               (<a class="code hl_function" href="eqi_8h.html#a21bf6a5ca5c452fcba8e508f6330a28e">eqi8</a>(name + 2, <span class="stringliteral">&quot;persedes&quot;</span>) || <a class="code hl_function" href="eqi_8h.html#a21bf6a5ca5c452fcba8e508f6330a28e">eqi8</a>(name + 2, <span class="stringliteral">&quot;percedes&quot;</span>)))</div>
<div class="line"><span class="lineno"> 1022</span>      {</div>
<div class="line"><span class="lineno"> 1023</span>        <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a09d7a8358a1951c4408fbea46e2e4972">supersedes</a>);</div>
<div class="line"><span class="lineno"> 1024</span>        env-&gt;<a class="code hl_variable" href="structEnvelope.html#a09d7a8358a1951c4408fbea46e2e4972">supersedes</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(body);</div>
<div class="line"><span class="lineno"> 1025</span>      }</div>
<div class="line"><span class="lineno"> 1026</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1027</span> </div>
<div class="line"><span class="lineno"> 1028</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div>
<div class="line"><span class="lineno"> 1029</span>      <span class="keywordflow">if</span> ((name_len == 2) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#ac47f5057417a54f3e1381bc4bc3ee6a0">eqi1</a>(name + 1, <span class="stringliteral">&quot;o&quot;</span>))</div>
<div class="line"><span class="lineno"> 1030</span>      {</div>
<div class="line"><span class="lineno"> 1031</span>        <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, body);</div>
<div class="line"><span class="lineno"> 1032</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1033</span>      }</div>
<div class="line"><span class="lineno"> 1034</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1035</span> </div>
<div class="line"><span class="lineno"> 1036</span>    <span class="keywordflow">case</span> <span class="charliteral">&#39;x&#39;</span>:</div>
<div class="line"><span class="lineno"> 1037</span>      <span class="keywordflow">if</span> ((name_len == 8) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a21bf6a5ca5c452fcba8e508f6330a28e">eqi8</a>(name, <span class="stringliteral">&quot;x-status&quot;</span>))</div>
<div class="line"><span class="lineno"> 1038</span>      {</div>
<div class="line"><span class="lineno"> 1039</span>        <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno"> 1040</span>        {</div>
<div class="line"><span class="lineno"> 1041</span>          <span class="keywordflow">while</span> (*body)</div>
<div class="line"><span class="lineno"> 1042</span>          {</div>
<div class="line"><span class="lineno"> 1043</span>            <span class="keywordflow">switch</span> (*body)</div>
<div class="line"><span class="lineno"> 1044</span>            {</div>
<div class="line"><span class="lineno"> 1045</span>              <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>:</div>
<div class="line"><span class="lineno"> 1046</span>                e-&gt;<a class="code hl_variable" href="structEmail.html#aa26dd591f92e548bc3c56d0b7fdb3e8c">replied</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1047</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1048</span>              <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>:</div>
<div class="line"><span class="lineno"> 1049</span>                e-&gt;<a class="code hl_variable" href="structEmail.html#ac5db33e3d6d9723d8e496078d5769567">deleted</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1050</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1051</span>              <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>:</div>
<div class="line"><span class="lineno"> 1052</span>                e-&gt;<a class="code hl_variable" href="structEmail.html#a8e810bc67ce7fea04bfe8a3739093d78">flagged</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1053</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1054</span>              <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1055</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1056</span>            }</div>
<div class="line"><span class="lineno"> 1057</span>            body++;</div>
<div class="line"><span class="lineno"> 1058</span>          }</div>
<div class="line"><span class="lineno"> 1059</span>        }</div>
<div class="line"><span class="lineno"> 1060</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1061</span>      }</div>
<div class="line"><span class="lineno"> 1062</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 7) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a2706295d4920e3c736c8db869b2f5ae8">eqi6</a>(name + 1, <span class="stringliteral">&quot;-label&quot;</span>))</div>
<div class="line"><span class="lineno"> 1063</span>      {</div>
<div class="line"><span class="lineno"> 1064</span>        <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#ac7bed8a507227756030c035a7aad198e">x_label</a>);</div>
<div class="line"><span class="lineno"> 1065</span>        env-&gt;<a class="code hl_variable" href="structEnvelope.html#ac7bed8a507227756030c035a7aad198e">x_label</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(body);</div>
<div class="line"><span class="lineno"> 1066</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1067</span>      }</div>
<div class="line"><span class="lineno"> 1068</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 12) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a22b741d063082522db4cb1790ceb149a">eqi11</a>(name + 1, <span class="stringliteral">&quot;-comment-to&quot;</span>))</div>
<div class="line"><span class="lineno"> 1069</span>      {</div>
<div class="line"><span class="lineno"> 1070</span>        <span class="keywordflow">if</span> (!env-&gt;<a class="code hl_variable" href="structEnvelope.html#a52153c6e4fdb551233e26d4fdb48fb78">x_comment_to</a>)</div>
<div class="line"><span class="lineno"> 1071</span>          env-&gt;<a class="code hl_variable" href="structEnvelope.html#a52153c6e4fdb551233e26d4fdb48fb78">x_comment_to</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(body);</div>
<div class="line"><span class="lineno"> 1072</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1073</span>      }</div>
<div class="line"><span class="lineno"> 1074</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 4) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a8058f110e504fe7c58007856cc3d0163">eqi4</a>(name, <span class="stringliteral">&quot;xref&quot;</span>))</div>
<div class="line"><span class="lineno"> 1075</span>      {</div>
<div class="line"><span class="lineno"> 1076</span>        <span class="keywordflow">if</span> (!env-&gt;<a class="code hl_variable" href="structEnvelope.html#aafcabc33a66b5edfa91bbdc922515c2e">xref</a>)</div>
<div class="line"><span class="lineno"> 1077</span>          env-&gt;<a class="code hl_variable" href="structEnvelope.html#aafcabc33a66b5edfa91bbdc922515c2e">xref</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(body);</div>
<div class="line"><span class="lineno"> 1078</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1079</span>      }</div>
<div class="line"><span class="lineno"> 1080</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((name_len == 13) &amp;&amp; <a class="code hl_function" href="eqi_8h.html#a8e3c5bfe2f500901470f6cb5fd359e98">eqi12</a>(name + 1, <span class="stringliteral">&quot;-original-to&quot;</span>))</div>
<div class="line"><span class="lineno"> 1081</span>      {</div>
<div class="line"><span class="lineno"> 1082</span>        <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">x_original_to</a>, body);</div>
<div class="line"><span class="lineno"> 1083</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1084</span>      }</div>
<div class="line"><span class="lineno"> 1085</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1088</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1089</span>  }</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>  <span class="comment">/* Keep track of the user-defined headers */</span></div>
<div class="line"><span class="lineno"> 1092</span>  <span class="keywordflow">if</span> (!matched &amp;&amp; user_hdrs)</div>
<div class="line"><span class="lineno"> 1093</span>  {</div>
<div class="line"><span class="lineno"> 1094</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_weed = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;weed&quot;</span>);</div>
<div class="line"><span class="lineno"> 1095</span>    <span class="keywordtype">char</span> *dup = NULL;</div>
<div class="line"><span class="lineno"> 1096</span>    <a class="code hl_function" href="mutt_2string_8c.html#a4388c16988fac9a7596dee4d4af89595">mutt_str_asprintf</a>(&amp;dup, <span class="stringliteral">&quot;%s: %s&quot;</span>, name, body);</div>
<div class="line"><span class="lineno"> 1097</span> </div>
<div class="line"><span class="lineno"> 1098</span>    <span class="keywordflow">if</span> (!weed || !c_weed || !<a class="code hl_function" href="#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(dup))</div>
<div class="line"><span class="lineno"> 1099</span>    {</div>
<div class="line"><span class="lineno"> 1100</span>      <span class="keyword">struct </span><a class="code hl_struct" href="structListNode.html">ListNode</a> *np = <a class="code hl_function" href="list_8c.html#a47252e2b00de607c64a5fec8dc16058d">mutt_list_insert_tail</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a005f4bd665ae1ae362add27948753fe1">userhdrs</a>, dup);</div>
<div class="line"><span class="lineno"> 1101</span>      <span class="keywordflow">if</span> (do_2047)</div>
<div class="line"><span class="lineno"> 1102</span>      {</div>
<div class="line"><span class="lineno"> 1103</span>        <a class="code hl_function" href="rfc2047_8c.html#a89c57c82465740567f73641c9397d760">rfc2047_decode</a>(&amp;np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>);</div>
<div class="line"><span class="lineno"> 1104</span>      }</div>
<div class="line"><span class="lineno"> 1105</span>    }</div>
<div class="line"><span class="lineno"> 1106</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1107</span>    {</div>
<div class="line"><span class="lineno"> 1108</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;dup);</div>
<div class="line"><span class="lineno"> 1109</span>    }</div>
<div class="line"><span class="lineno"> 1110</span>  }</div>
<div class="line"><span class="lineno"> 1111</span> </div>
<div class="line"><span class="lineno"> 1112</span>  <span class="keywordflow">return</span> matched;</div>
<div class="line"><span class="lineno"> 1113</span>}</div>
<div class="ttc" id="aaddress_2address_8c_html_a396bcf6adfff6663096fa6ae99c31c9a"><div class="ttname"><a href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a></div><div class="ttdeci">void mutt_addrlist_clear(struct AddressList *al)</div><div class="ttdoc">Unlink and free all Address in an AddressList.</div><div class="ttdef"><b>Definition</b> <a href="address_2address_8c_source.html#l01460">address.c:1460</a></div></div>
<div class="ttc" id="aaddress_2address_8c_html_a9bb4abe92405bac67f03e36936a29b6e"><div class="ttname"><a href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a></div><div class="ttdeci">int mutt_addrlist_parse(struct AddressList *al, const char *s)</div><div class="ttdoc">Parse a list of email addresses.</div><div class="ttdef"><b>Definition</b> <a href="address_2address_8c_source.html#l00480">address.c:480</a></div></div>
<div class="ttc" id="aatoi_8c_html_a7cebdbeebc9b6bb2a1771df84cdf7a2e"><div class="ttname"><a href="atoi_8c.html#a7cebdbeebc9b6bb2a1771df84cdf7a2e">mutt_str_atoul</a></div><div class="ttdeci">const char * mutt_str_atoul(const char *str, unsigned long *dst)</div><div class="ttdoc">Convert ASCII string to an unsigned long.</div><div class="ttdef"><b>Definition</b> <a href="atoi_8c_source.html#l00243">atoi.c:243</a></div></div>
<div class="ttc" id="aatoi_8c_html_ad704fc34b6f2eb2132de8bf992994ac1"><div class="ttname"><a href="atoi_8c.html#ad704fc34b6f2eb2132de8bf992994ac1">mutt_str_atoui</a></div><div class="ttdeci">const char * mutt_str_atoui(const char *str, unsigned int *dst)</div><div class="ttdoc">Convert ASCII string to an unsigned integer.</div><div class="ttdef"><b>Definition</b> <a href="atoi_8c_source.html#l00217">atoi.c:217</a></div></div>
<div class="ttc" id="aconfig_2helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00047">helpers.c:47</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a1c0bcb79c2ff930b4131a1ede5828762"><div class="ttname"><a href="#a1c0bcb79c2ff930b4131a1ede5828762">mutt_parse_content_type</a></div><div class="ttdeci">void mutt_parse_content_type(const char *s, struct Body *b)</div><div class="ttdoc">Parse a content type.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00462">parse.c:462</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a2a830caa65e6f462ab0ecae77bce746b"><div class="ttname"><a href="#a2a830caa65e6f462ab0ecae77bce746b">mutt_auto_subscribe</a></div><div class="ttdeci">void mutt_auto_subscribe(const char *mailto)</div><div class="ttdoc">Check if user is subscribed to mailing list.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00108">parse.c:108</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a5875b5c866cb7caa2fb55c960bf59f2b"><div class="ttname"><a href="#a5875b5c866cb7caa2fb55c960bf59f2b">parse_autocrypt</a></div><div class="ttdeci">static struct AutocryptHeader * parse_autocrypt(struct AutocryptHeader *head, const char *s)</div><div class="ttdoc">Parse an Autocrypt header line.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00571">parse.c:571</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a5b80e3daa9cb6eb8f8ed5adae704ee10"><div class="ttname"><a href="#a5b80e3daa9cb6eb8f8ed5adae704ee10">parse_references</a></div><div class="ttdeci">static void parse_references(struct ListHead *head, const char *s)</div><div class="ttdoc">Parse references from an email header.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00322">parse.c:322</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a5f2728949322a1a6210d61d9629005d1"><div class="ttname"><a href="#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a></div><div class="ttdeci">bool mutt_matches_ignore(const char *s)</div><div class="ttdoc">Does the string match the ignore list.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00355">parse.c:355</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a60bcab5634e02e9173938bb7ae4fec8b"><div class="ttname"><a href="#a60bcab5634e02e9173938bb7ae4fec8b">rfc2369_first_mailto</a></div><div class="ttdeci">static char * rfc2369_first_mailto(const char *body)</div><div class="ttdoc">Extract the first mailto: URL from a RFC2369 list.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00635">parse.c:635</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a74dcb6f4b53adc8cc3f61bcf4168fd51"><div class="ttname"><a href="#a74dcb6f4b53adc8cc3f61bcf4168fd51">parse_content_language</a></div><div class="ttdeci">static void parse_content_language(const char *s, struct Body *b)</div><div class="ttdoc">Read the content&#39;s language.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00339">parse.c:339</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a870232070405e395193a6c7e00e2df60"><div class="ttname"><a href="#a870232070405e395193a6c7e00e2df60">parse_content_disposition</a></div><div class="ttdeci">static void parse_content_disposition(const char *s, struct Body *b)</div><div class="ttdoc">Parse a content disposition.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00290">parse.c:290</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_aeb759563267cc1a4ee017738d8ee3013"><div class="ttname"><a href="#aeb759563267cc1a4ee017738d8ee3013">mutt_filter_commandline_header_value</a></div><div class="ttdeci">void mutt_filter_commandline_header_value(char *header)</div><div class="ttdoc">Sanitise characters in a header value.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00092">parse.c:92</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_afc8bf29df56e545eff7652964eea6081"><div class="ttname"><a href="#afc8bf29df56e545eff7652964eea6081">CONTENT_TOO_BIG</a></div><div class="ttdeci">#define CONTENT_TOO_BIG</div><div class="ttdoc">Maximum reasonable Content-Length value (1 GiB) to prevent overflow.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00061">parse.c:61</a></div></div>
<div class="ttc" id="aenvelope_8c_html_a91c00f700ee3ca43aa33487591b0d317"><div class="ttname"><a href="envelope_8c.html#a91c00f700ee3ca43aa33487591b0d317">mutt_env_set_subject</a></div><div class="ttdeci">void mutt_env_set_subject(struct Envelope *env, const char *subj)</div><div class="ttdoc">Set both subject and real_subj to subj.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8c_source.html#l00068">envelope.c:68</a></div></div>
<div class="ttc" id="aeqi_8h_html_a03ec1aa881dcbd3cf47ced3ed30b2d50"><div class="ttname"><a href="eqi_8h.html#a03ec1aa881dcbd3cf47ced3ed30b2d50">eqi17</a></div><div class="ttdeci">static bool eqi17(const char *a, const char b[17])</div><div class="ttdoc">eqi17 - Compare two 17-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00207">eqi.h:207</a></div></div>
<div class="ttc" id="aeqi_8h_html_a0b48b9a2c86d85301e1d32c0e8627f83"><div class="ttname"><a href="eqi_8h.html#a0b48b9a2c86d85301e1d32c0e8627f83">eqi9</a></div><div class="ttdeci">static bool eqi9(const char *a, const char b[9])</div><div class="ttdoc">eqi9 - Compare two 9-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00159">eqi.h:159</a></div></div>
<div class="ttc" id="aeqi_8h_html_a1e423a9614c78387b06a96ec36322fc5"><div class="ttname"><a href="eqi_8h.html#a1e423a9614c78387b06a96ec36322fc5">eqi10</a></div><div class="ttdeci">static bool eqi10(const char *a, const char b[10])</div><div class="ttdoc">eqi10 - Compare two 10-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00165">eqi.h:165</a></div></div>
<div class="ttc" id="aeqi_8h_html_a21bf6a5ca5c452fcba8e508f6330a28e"><div class="ttname"><a href="eqi_8h.html#a21bf6a5ca5c452fcba8e508f6330a28e">eqi8</a></div><div class="ttdeci">static bool eqi8(const char *a, const char b[8])</div><div class="ttdoc">Compare two 8-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons.</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00124">eqi.h:124</a></div></div>
<div class="ttc" id="aeqi_8h_html_a22b741d063082522db4cb1790ceb149a"><div class="ttname"><a href="eqi_8h.html#a22b741d063082522db4cb1790ceb149a">eqi11</a></div><div class="ttdeci">static bool eqi11(const char *a, const char b[11])</div><div class="ttdoc">eqi11 - Compare two 11-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00171">eqi.h:171</a></div></div>
<div class="ttc" id="aeqi_8h_html_a2706295d4920e3c736c8db869b2f5ae8"><div class="ttname"><a href="eqi_8h.html#a2706295d4920e3c736c8db869b2f5ae8">eqi6</a></div><div class="ttdeci">static bool eqi6(const char *a, const char b[6])</div><div class="ttdoc">eqi6 - Compare two 6-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00151">eqi.h:151</a></div></div>
<div class="ttc" id="aeqi_8h_html_a31d2760bb472eeb8231a86078adcc372"><div class="ttname"><a href="eqi_8h.html#a31d2760bb472eeb8231a86078adcc372">eqi14</a></div><div class="ttdeci">static bool eqi14(const char *a, const char b[14])</div><div class="ttdoc">eqi14 - Compare two 14-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00189">eqi.h:189</a></div></div>
<div class="ttc" id="aeqi_8h_html_a69d024777d147c11128c1b68e322a131"><div class="ttname"><a href="eqi_8h.html#a69d024777d147c11128c1b68e322a131">eqi13</a></div><div class="ttdeci">static bool eqi13(const char *a, const char b[13])</div><div class="ttdoc">eqi13 - Compare two 13-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00183">eqi.h:183</a></div></div>
<div class="ttc" id="aeqi_8h_html_a8058f110e504fe7c58007856cc3d0163"><div class="ttname"><a href="eqi_8h.html#a8058f110e504fe7c58007856cc3d0163">eqi4</a></div><div class="ttdeci">static bool eqi4(const char *a, const char b[4])</div><div class="ttdoc">Compare two 4-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons.</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00106">eqi.h:106</a></div></div>
<div class="ttc" id="aeqi_8h_html_a8d11ae8919aab05633bbf2641c4006fc"><div class="ttname"><a href="eqi_8h.html#a8d11ae8919aab05633bbf2641c4006fc">eqi5</a></div><div class="ttdeci">static bool eqi5(const char *a, const char b[5])</div><div class="ttdoc">eqi5 - Compare two 5-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00145">eqi.h:145</a></div></div>
<div class="ttc" id="aeqi_8h_html_a8e3c5bfe2f500901470f6cb5fd359e98"><div class="ttname"><a href="eqi_8h.html#a8e3c5bfe2f500901470f6cb5fd359e98">eqi12</a></div><div class="ttdeci">static bool eqi12(const char *a, const char b[12])</div><div class="ttdoc">eqi12 - Compare two 12-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00177">eqi.h:177</a></div></div>
<div class="ttc" id="aeqi_8h_html_aabf9c83039057253dd99c48fc8637a8c"><div class="ttname"><a href="eqi_8h.html#aabf9c83039057253dd99c48fc8637a8c">eqi15</a></div><div class="ttdeci">static bool eqi15(const char *a, const char b[15])</div><div class="ttdoc">eqi15 - Compare two 15-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00195">eqi.h:195</a></div></div>
<div class="ttc" id="aeqi_8h_html_ac47f5057417a54f3e1381bc4bc3ee6a0"><div class="ttname"><a href="eqi_8h.html#ac47f5057417a54f3e1381bc4bc3ee6a0">eqi1</a></div><div class="ttdeci">static bool eqi1(const char *a, const char b[1])</div><div class="ttdoc">Compare two 1-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons.</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00078">eqi.h:78</a></div></div>
<div class="ttc" id="aeqi_8h_html_aeab6a50a3ecbb0850f16e4ef6d79afc1"><div class="ttname"><a href="eqi_8h.html#aeab6a50a3ecbb0850f16e4ef6d79afc1">eqi2</a></div><div class="ttdeci">static bool eqi2(const char *a, const char b[2])</div><div class="ttdoc">Compare two 2-byte strings, ignoring case - See: Case-insensitive fixed-chunk comparisons.</div><div class="ttdef"><b>Definition</b> <a href="eqi_8h_source.html#l00090">eqi.h:90</a></div></div>
<div class="ttc" id="alist_8c_html_a47252e2b00de607c64a5fec8dc16058d"><div class="ttname"><a href="list_8c.html#a47252e2b00de607c64a5fec8dc16058d">mutt_list_insert_tail</a></div><div class="ttdeci">struct ListNode * mutt_list_insert_tail(struct ListHead *h, char *s)</div><div class="ttdoc">Append a string to the end of a List.</div><div class="ttdef"><b>Definition</b> <a href="list_8c_source.html#l00065">list.c:65</a></div></div>
<div class="ttc" id="alist_8c_html_ab5c53ce94cc2aafa4299dbc81a37f4a4"><div class="ttname"><a href="list_8c.html#ab5c53ce94cc2aafa4299dbc81a37f4a4">mutt_list_free</a></div><div class="ttdeci">void mutt_list_free(struct ListHead *h)</div><div class="ttdoc">Free a List AND its strings.</div><div class="ttdef"><b>Definition</b> <a href="list_8c_source.html#l00123">list.c:123</a></div></div>
<div class="ttc" id="amemory_8h_html_a3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="memory_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdoc">Return the minimum of two values.</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00040">memory.h:40</a></div></div>
<div class="ttc" id="amutt_2date_8c_html_ad1e6304a91c7b6f3c266a9b17c1740fe"><div class="ttname"><a href="mutt_2date_8c.html#ad1e6304a91c7b6f3c266a9b17c1740fe">mutt_date_now</a></div><div class="ttdeci">time_t mutt_date_now(void)</div><div class="ttdoc">Return the number of seconds since the Unix epoch.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2date_8c_source.html#l00457">date.c:457</a></div></div>
<div class="ttc" id="amutt_2date_8c_html_ad8aaf5118148ed8f6708f32bfab3146f"><div class="ttname"><a href="mutt_2date_8c.html#ad8aaf5118148ed8f6708f32bfab3146f">mutt_date_parse_date</a></div><div class="ttdeci">time_t mutt_date_parse_date(const char *s, struct Tz *tz_out)</div><div class="ttdoc">Parse a date string in RFC822 format.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2date_8c_source.html#l00717">date.c:717</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a1d343dcbce0482f8979fe2a298913225"><div class="ttname"><a href="mutt_2string_8c.html#a1d343dcbce0482f8979fe2a298913225">mutt_str_remove_trailing_ws</a></div><div class="ttdeci">void mutt_str_remove_trailing_ws(char *s)</div><div class="ttdoc">Trim trailing whitespace from a string.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00567">string.c:567</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a4388c16988fac9a7596dee4d4af89595"><div class="ttname"><a href="mutt_2string_8c.html#a4388c16988fac9a7596dee4d4af89595">mutt_str_asprintf</a></div><div class="ttdeci">int mutt_str_asprintf(char **strp, const char *fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00805">string.c:805</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a6f574867aa9db4d434adbc8af1f5f7e7"><div class="ttname"><a href="mutt_2string_8c.html#a6f574867aa9db4d434adbc8af1f5f7e7">mutt_strn_equal</a></div><div class="ttdeci">bool mutt_strn_equal(const char *a, const char *b, size_t num)</div><div class="ttdoc">Check for equality of two strings (to a maximum), safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00429">string.c:429</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_aa2fa4dcaf72786b58e825349883f14c2"><div class="ttname"><a href="mutt_2string_8c.html#aa2fa4dcaf72786b58e825349883f14c2">mutt_str_skip_whitespace</a></div><div class="ttdeci">char * mutt_str_skip_whitespace(const char *p)</div><div class="ttdoc">Find the first non-whitespace character in a string.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00553">string.c:553</a></div></div>
<div class="ttc" id="astructBody_html_a90db5151872e23e56a8f31d68925c121"><div class="ttname"><a href="structBody.html#a90db5151872e23e56a8f31d68925c121">Body::description</a></div><div class="ttdeci">char * description</div><div class="ttdoc">content-description</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00055">body.h:55</a></div></div>
<div class="ttc" id="astructEmail_html_a0bd79550be901d44e50953fb43614e10"><div class="ttname"><a href="structEmail.html#a0bd79550be901d44e50953fb43614e10">Email::read</a></div><div class="ttdeci">bool read</div><div class="ttdoc">Email is read.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00050">email.h:50</a></div></div>
<div class="ttc" id="astructEmail_html_a0ff8541eb15d71d7d9f73e92365a1618"><div class="ttname"><a href="structEmail.html#a0ff8541eb15d71d7d9f73e92365a1618">Email::zminutes</a></div><div class="ttdeci">unsigned int zminutes</div><div class="ttdoc">Minutes away from UTC.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00057">email.h:57</a></div></div>
<div class="ttc" id="astructEmail_html_a37098f0a269341bb2c30ab4425207ec5"><div class="ttname"><a href="structEmail.html#a37098f0a269341bb2c30ab4425207ec5">Email::mime</a></div><div class="ttdeci">bool mime</div><div class="ttdoc">Has a MIME-Version header?</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00048">email.h:48</a></div></div>
<div class="ttc" id="astructEmail_html_a562a3aee45efc37c07dedcc8e1fef93f"><div class="ttname"><a href="structEmail.html#a562a3aee45efc37c07dedcc8e1fef93f">Email::lines</a></div><div class="ttdeci">int lines</div><div class="ttdoc">How many lines in the body of this message?</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00062">email.h:62</a></div></div>
<div class="ttc" id="astructEmail_html_a6d9062408a8c89b19cf25584dd2ffb57"><div class="ttname"><a href="structEmail.html#a6d9062408a8c89b19cf25584dd2ffb57">Email::old</a></div><div class="ttdeci">bool old</div><div class="ttdoc">Email is seen, but unread.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00049">email.h:49</a></div></div>
<div class="ttc" id="astructEmail_html_a8170a6b34e26ead08a9631f47913f481"><div class="ttname"><a href="structEmail.html#a8170a6b34e26ead08a9631f47913f481">Email::zoccident</a></div><div class="ttdeci">bool zoccident</div><div class="ttdoc">True, if west of UTC, False if east.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00058">email.h:58</a></div></div>
<div class="ttc" id="astructEmail_html_a8e810bc67ce7fea04bfe8a3739093d78"><div class="ttname"><a href="structEmail.html#a8e810bc67ce7fea04bfe8a3739093d78">Email::flagged</a></div><div class="ttdeci">bool flagged</div><div class="ttdoc">Marked important?</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00047">email.h:47</a></div></div>
<div class="ttc" id="astructEmail_html_a9e2ba09b444f493916f7289116bd9f1c"><div class="ttname"><a href="structEmail.html#a9e2ba09b444f493916f7289116bd9f1c">Email::zhours</a></div><div class="ttdeci">unsigned int zhours</div><div class="ttdoc">Hours away from UTC.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00056">email.h:56</a></div></div>
<div class="ttc" id="astructEmail_html_a9e3cda5dab6d53f68cad95d28068d962"><div class="ttname"><a href="structEmail.html#a9e3cda5dab6d53f68cad95d28068d962">Email::date_sent</a></div><div class="ttdeci">time_t date_sent</div><div class="ttdoc">Time when the message was sent (UTC)</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00060">email.h:60</a></div></div>
<div class="ttc" id="astructEmail_html_aa26dd591f92e548bc3c56d0b7fdb3e8c"><div class="ttname"><a href="structEmail.html#aa26dd591f92e548bc3c56d0b7fdb3e8c">Email::replied</a></div><div class="ttdeci">bool replied</div><div class="ttdoc">Email has been replied to.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00051">email.h:51</a></div></div>
<div class="ttc" id="astructEmail_html_aa72ad88f6a82e49b76a0d0eb790abae8"><div class="ttname"><a href="structEmail.html#aa72ad88f6a82e49b76a0d0eb790abae8">Email::expired</a></div><div class="ttdeci">bool expired</div><div class="ttdoc">Already expired?</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00046">email.h:46</a></div></div>
<div class="ttc" id="astructEmail_html_ac5db33e3d6d9723d8e496078d5769567"><div class="ttname"><a href="structEmail.html#ac5db33e3d6d9723d8e496078d5769567">Email::deleted</a></div><div class="ttdeci">bool deleted</div><div class="ttdoc">Email is deleted.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00078">email.h:78</a></div></div>
<div class="ttc" id="astructEmail_html_af64bcf33ccd8b0ba248fc8d427c21264"><div class="ttname"><a href="structEmail.html#af64bcf33ccd8b0ba248fc8d427c21264">Email::received</a></div><div class="ttdeci">time_t received</div><div class="ttdoc">Time when the message was placed in the mailbox.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00061">email.h:61</a></div></div>
<div class="ttc" id="astructEnvelope_html_a005f4bd665ae1ae362add27948753fe1"><div class="ttname"><a href="structEnvelope.html#a005f4bd665ae1ae362add27948753fe1">Envelope::userhdrs</a></div><div class="ttdeci">struct ListHead userhdrs</div><div class="ttdoc">user defined headers</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00085">envelope.h:85</a></div></div>
<div class="ttc" id="astructEnvelope_html_a09d7a8358a1951c4408fbea46e2e4972"><div class="ttname"><a href="structEnvelope.html#a09d7a8358a1951c4408fbea46e2e4972">Envelope::supersedes</a></div><div class="ttdeci">char * supersedes</div><div class="ttdoc">Supersedes header.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00074">envelope.h:74</a></div></div>
<div class="ttc" id="astructEnvelope_html_a18ca6295a8894d93fe3b44275b62e415"><div class="ttname"><a href="structEnvelope.html#a18ca6295a8894d93fe3b44275b62e415">Envelope::list_subscribe</a></div><div class="ttdeci">char * list_subscribe</div><div class="ttdoc">This stores a mailto URL, or nothing.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00068">envelope.h:68</a></div></div>
<div class="ttc" id="astructEnvelope_html_a1c204b091d782098fc1efa0c2f3b1e20"><div class="ttname"><a href="structEnvelope.html#a1c204b091d782098fc1efa0c2f3b1e20">Envelope::return_path</a></div><div class="ttdeci">struct AddressList return_path</div><div class="ttdoc">Return path for the Email.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00058">envelope.h:58</a></div></div>
<div class="ttc" id="astructEnvelope_html_a20d5ccf675db375e011a7791151fa09d"><div class="ttname"><a href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">Envelope::subject</a></div><div class="ttdeci">char *const subject</div><div class="ttdoc">Email&#39;s subject.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00070">envelope.h:70</a></div></div>
<div class="ttc" id="astructEnvelope_html_a46a9e33786aa5394ad768cbcc2357d65"><div class="ttname"><a href="structEnvelope.html#a46a9e33786aa5394ad768cbcc2357d65">Envelope::followup_to</a></div><div class="ttdeci">char * followup_to</div><div class="ttdoc">List of &#39;followup-to&#39; fields.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00080">envelope.h:80</a></div></div>
<div class="ttc" id="astructEnvelope_html_a4b75ab1853f95878dec079371bb0d799"><div class="ttname"><a href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">Envelope::reply_to</a></div><div class="ttdeci">struct AddressList reply_to</div><div class="ttdoc">Email&#39;s &#39;reply-to&#39;.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00064">envelope.h:64</a></div></div>
<div class="ttc" id="astructEnvelope_html_a50418c13a849bf27b22922bd5867e5e1"><div class="ttname"><a href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">Envelope::message_id</a></div><div class="ttdeci">char * message_id</div><div class="ttdoc">Message ID.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00073">envelope.h:73</a></div></div>
<div class="ttc" id="astructEnvelope_html_a52153c6e4fdb551233e26d4fdb48fb78"><div class="ttname"><a href="structEnvelope.html#a52153c6e4fdb551233e26d4fdb48fb78">Envelope::x_comment_to</a></div><div class="ttdeci">char * x_comment_to</div><div class="ttdoc">List of &#39;X-comment-to&#39; fields.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00081">envelope.h:81</a></div></div>
<div class="ttc" id="astructEnvelope_html_a525bd5213606067d5c2be2e17fbe956b"><div class="ttname"><a href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">Envelope::x_original_to</a></div><div class="ttdeci">struct AddressList x_original_to</div><div class="ttdoc">Email&#39;s &#39;X-Original-to&#39;.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00066">envelope.h:66</a></div></div>
<div class="ttc" id="astructEnvelope_html_a59c64138a508cd27c61dc719e7aab5a0"><div class="ttname"><a href="structEnvelope.html#a59c64138a508cd27c61dc719e7aab5a0">Envelope::autocrypt_gossip</a></div><div class="ttdeci">struct AutocryptHeader * autocrypt_gossip</div><div class="ttdoc">Autocrypt Gossip header.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00088">envelope.h:88</a></div></div>
<div class="ttc" id="astructEnvelope_html_a5f680f60f1713477a879877dcbd21a5c"><div class="ttname"><a href="structEnvelope.html#a5f680f60f1713477a879877dcbd21a5c">Envelope::newsgroups</a></div><div class="ttdeci">char * newsgroups</div><div class="ttdoc">List of newsgroups.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00078">envelope.h:78</a></div></div>
<div class="ttc" id="astructEnvelope_html_a6044b60220b8029a6a505e5b61f1cadc"><div class="ttname"><a href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">Envelope::mail_followup_to</a></div><div class="ttdeci">struct AddressList mail_followup_to</div><div class="ttdoc">Email&#39;s &#39;mail-followup-to&#39;.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00065">envelope.h:65</a></div></div>
<div class="ttc" id="astructEnvelope_html_a6b00837b3cb4b41898b42307135be8b6"><div class="ttname"><a href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">Envelope::cc</a></div><div class="ttdeci">struct AddressList cc</div><div class="ttdoc">Email&#39;s &#39;Cc&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00061">envelope.h:61</a></div></div>
<div class="ttc" id="astructEnvelope_html_a72ee5c0af4f94f83aeb8d31183261611"><div class="ttname"><a href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">Envelope::sender</a></div><div class="ttdeci">struct AddressList sender</div><div class="ttdoc">Email&#39;s sender.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00063">envelope.h:63</a></div></div>
<div class="ttc" id="astructEnvelope_html_a832eec73356a806761e26f0bc40d9083"><div class="ttname"><a href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">Envelope::references</a></div><div class="ttdeci">struct ListHead references</div><div class="ttdoc">message references (in reverse order)</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00083">envelope.h:83</a></div></div>
<div class="ttc" id="astructEnvelope_html_a8888ccd1c0b1512c92dd00a9a3a059d8"><div class="ttname"><a href="structEnvelope.html#a8888ccd1c0b1512c92dd00a9a3a059d8">Envelope::autocrypt</a></div><div class="ttdeci">struct AutocryptHeader * autocrypt</div><div class="ttdoc">Autocrypt header.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00087">envelope.h:87</a></div></div>
<div class="ttc" id="astructEnvelope_html_a9ae6d450b2f012c37d3350f4305fbb90"><div class="ttname"><a href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">Envelope::in_reply_to</a></div><div class="ttdeci">struct ListHead in_reply_to</div><div class="ttdoc">in-reply-to header content</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00084">envelope.h:84</a></div></div>
<div class="ttc" id="astructEnvelope_html_aad427832f4ae422f1b16d0896c1d3af6"><div class="ttname"><a href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">Envelope::bcc</a></div><div class="ttdeci">struct AddressList bcc</div><div class="ttdoc">Email&#39;s &#39;Bcc&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00062">envelope.h:62</a></div></div>
<div class="ttc" id="astructEnvelope_html_aafcabc33a66b5edfa91bbdc922515c2e"><div class="ttname"><a href="structEnvelope.html#aafcabc33a66b5edfa91bbdc922515c2e">Envelope::xref</a></div><div class="ttdeci">char * xref</div><div class="ttdoc">List of cross-references.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00079">envelope.h:79</a></div></div>
<div class="ttc" id="astructEnvelope_html_aba7ae50abf7721af736b33dbe29cb152"><div class="ttname"><a href="structEnvelope.html#aba7ae50abf7721af736b33dbe29cb152">Envelope::organization</a></div><div class="ttdeci">char * organization</div><div class="ttdoc">Organisation header.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00077">envelope.h:77</a></div></div>
<div class="ttc" id="astructEnvelope_html_ac7bed8a507227756030c035a7aad198e"><div class="ttname"><a href="structEnvelope.html#ac7bed8a507227756030c035a7aad198e">Envelope::x_label</a></div><div class="ttdeci">char * x_label</div><div class="ttdoc">X-Label.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00076">envelope.h:76</a></div></div>
<div class="ttc" id="astructEnvelope_html_ad0b7bb8cf358dd2d5d1dc5733b3f0be1"><div class="ttname"><a href="structEnvelope.html#ad0b7bb8cf358dd2d5d1dc5733b3f0be1">Envelope::list_post</a></div><div class="ttdeci">char * list_post</div><div class="ttdoc">This stores a mailto URL, or nothing.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00067">envelope.h:67</a></div></div>
<div class="ttc" id="astructEnvelope_html_adb752a72d48a701571b3c1784bc4b59b"><div class="ttname"><a href="structEnvelope.html#adb752a72d48a701571b3c1784bc4b59b">Envelope::date</a></div><div class="ttdeci">char * date</div><div class="ttdoc">Sent date.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00075">envelope.h:75</a></div></div>
<div class="ttc" id="astructEnvelope_html_aebaaff2a6132162b227659bba4260574"><div class="ttname"><a href="structEnvelope.html#aebaaff2a6132162b227659bba4260574">Envelope::list_unsubscribe</a></div><div class="ttdeci">char * list_unsubscribe</div><div class="ttdoc">This stores a mailto URL, or nothing.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00069">envelope.h:69</a></div></div>
<div class="ttc" id="astructEnvelope_html_af1aa00aed4b8767cf98f08e45a432ad8"><div class="ttname"><a href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">Envelope::from</a></div><div class="ttdeci">struct AddressList from</div><div class="ttdoc">Email&#39;s &#39;From&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00059">envelope.h:59</a></div></div>
<div class="ttc" id="astructListNode_html"><div class="ttname"><a href="structListNode.html">ListNode</a></div><div class="ttdoc">A List node for strings.</div><div class="ttdef"><b>Definition</b> <a href="list_8h_source.html#l00036">list.h:37</a></div></div>
<div class="ttc" id="astructListNode_html_aafe688d670318196766392d8235d00a7"><div class="ttname"><a href="structListNode.html#aafe688d670318196766392d8235d00a7">ListNode::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">String.</div><div class="ttdef"><b>Definition</b> <a href="list_8h_source.html#l00038">list.h:38</a></div></div>
<div class="ttc" id="astructNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00127">neomutt.h:128</a></div></div>
<div class="ttc" id="astructNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00134">neomutt.h:134</a></div></div>
<div class="ttc" id="astructTz_html"><div class="ttname"><a href="structTz.html">Tz</a></div><div class="ttdoc">List of recognised Timezones.</div><div class="ttdef"><b>Definition</b> <a href="date_8h_source.html#l00052">date.h:53</a></div></div>
<div class="ttc" id="astructTz_html_a1282be686c83afb2659e014b855d9335"><div class="ttname"><a href="structTz.html#a1282be686c83afb2659e014b855d9335">Tz::zminutes</a></div><div class="ttdeci">unsigned char zminutes</div><div class="ttdoc">Minutes away from UTC.</div><div class="ttdef"><b>Definition</b> <a href="date_8h_source.html#l00056">date.h:56</a></div></div>
<div class="ttc" id="astructTz_html_a36e79394164d2eb87797dc51797bfea2"><div class="ttname"><a href="structTz.html#a36e79394164d2eb87797dc51797bfea2">Tz::zoccident</a></div><div class="ttdeci">bool zoccident</div><div class="ttdoc">True if west of UTC, False if East.</div><div class="ttdef"><b>Definition</b> <a href="date_8h_source.html#l00057">date.h:57</a></div></div>
<div class="ttc" id="astructTz_html_aef24900adb513ba510b97c4c77426caa"><div class="ttname"><a href="structTz.html#aef24900adb513ba510b97c4c77426caa">Tz::zhours</a></div><div class="ttdeci">unsigned char zhours</div><div class="ttdoc">Hours away from UTC.</div><div class="ttdef"><b>Definition</b> <a href="date_8h_source.html#l00055">date.h:55</a></div></div>
</div><!-- fragment --><div id="dynsection-33" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-33-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-33-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-33-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a012cf883e316be91676a2f589b48f330_cgraph.svg" width="991" height="2318"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-34" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-34-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-34-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-34-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a012cf883e316be91676a2f589b48f330_icgraph.svg" width="410" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2b38814d1731678ff2a62299a565e0d2" name="a2b38814d1731678ff2a62299a565e0d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b38814d1731678ff2a62299a565e0d2">&#9670;&#160;</a></span>mutt_rfc822_read_line()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t mutt_rfc822_read_line </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBuffer.html">Buffer</a> *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a header line from a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>File to read from </td></tr>
    <tr><td class="paramname">buf</td><td><a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> to store the result </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>Number of bytes read from fp</td></tr>
  </table>
  </dd>
</dl>
<p>Reads an arbitrarily long header field, and looks ahead for continuation lines. </p>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l01124">1124</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1125</span>{</div>
<div class="line"><span class="lineno"> 1126</span>  <span class="keywordflow">if</span> (!fp || !buf)</div>
<div class="line"><span class="lineno"> 1127</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>  <span class="keywordtype">size_t</span> read = 0;</div>
<div class="line"><span class="lineno"> 1130</span>  <span class="keywordtype">char</span> line[1024] = { 0 }; <span class="comment">/* RFC2822 specifies a maximum line length of 998 */</span></div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>  <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(buf);</div>
<div class="line"><span class="lineno"> 1133</span>  <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno"> 1134</span>  {</div>
<div class="line"><span class="lineno"> 1135</span>    <span class="keywordflow">if</span> (!fgets(line, <span class="keyword">sizeof</span>(line), fp))</div>
<div class="line"><span class="lineno"> 1136</span>    {</div>
<div class="line"><span class="lineno"> 1137</span>      <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1138</span>    }</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> linelen = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(line);</div>
<div class="line"><span class="lineno"> 1141</span>    <span class="keywordflow">if</span> (linelen == 0)</div>
<div class="line"><span class="lineno"> 1142</span>    {</div>
<div class="line"><span class="lineno"> 1143</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1144</span>    }</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="string2_8h.html#ad5d1decff25d97de6e53c4e5fe184fba">mutt_str_is_email_wsp</a>(line[0]) &amp;&amp; <a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(buf))</div>
<div class="line"><span class="lineno"> 1147</span>    {</div>
<div class="line"><span class="lineno"> 1148</span>      read = linelen;</div>
<div class="line"><span class="lineno"> 1149</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1150</span>    }</div>
<div class="line"><span class="lineno"> 1151</span> </div>
<div class="line"><span class="lineno"> 1152</span>    read += linelen;</div>
<div class="line"><span class="lineno"> 1153</span> </div>
<div class="line"><span class="lineno"> 1154</span>    <span class="keywordtype">size_t</span> off = linelen - 1;</div>
<div class="line"><span class="lineno"> 1155</span>    <span class="keywordflow">if</span> (line[off] == <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line"><span class="lineno"> 1156</span>    {</div>
<div class="line"><span class="lineno"> 1157</span>      <span class="comment">/* We did get a full line: remove trailing space */</span></div>
<div class="line"><span class="lineno"> 1158</span>      <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno"> 1159</span>      {</div>
<div class="line"><span class="lineno"> 1160</span>        line[off] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1161</span>      } <span class="keywordflow">while</span> (off &amp;&amp; <a class="code hl_function" href="string2_8h.html#ad5d1decff25d97de6e53c4e5fe184fba">mutt_str_is_email_wsp</a>(line[--off]));</div>
<div class="line"><span class="lineno"> 1162</span> </div>
<div class="line"><span class="lineno"> 1163</span>      <span class="comment">/* check to see if the next line is a continuation line */</span></div>
<div class="line"><span class="lineno"> 1164</span>      <span class="keywordtype">int</span> ch = fgetc(fp);</div>
<div class="line"><span class="lineno"> 1165</span>      <span class="keywordflow">if</span> ((ch != <span class="charliteral">&#39; &#39;</span>) &amp;&amp; (ch != <span class="charliteral">&#39;\t&#39;</span>))</div>
<div class="line"><span class="lineno"> 1166</span>      {</div>
<div class="line"><span class="lineno"> 1167</span>        <span class="comment">/* next line is a separate header field or EOH */</span></div>
<div class="line"><span class="lineno"> 1168</span>        ungetc(ch, fp);</div>
<div class="line"><span class="lineno"> 1169</span>        <a class="code hl_function" href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a>(buf, line);</div>
<div class="line"><span class="lineno"> 1170</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1171</span>      }</div>
<div class="line"><span class="lineno"> 1172</span>      read++;</div>
<div class="line"><span class="lineno"> 1173</span> </div>
<div class="line"><span class="lineno"> 1174</span>      <span class="comment">/* eat tabs and spaces from the beginning of the continuation line */</span></div>
<div class="line"><span class="lineno"> 1175</span>      <span class="keywordflow">while</span> (((ch = fgetc(fp)) == <span class="charliteral">&#39; &#39;</span>) || (ch == <span class="charliteral">&#39;\t&#39;</span>))</div>
<div class="line"><span class="lineno"> 1176</span>      {</div>
<div class="line"><span class="lineno"> 1177</span>        read++;</div>
<div class="line"><span class="lineno"> 1178</span>      }</div>
<div class="line"><span class="lineno"> 1179</span> </div>
<div class="line"><span class="lineno"> 1180</span>      ungetc(ch, fp);</div>
<div class="line"><span class="lineno"> 1181</span>      line[off + 1] = <span class="charliteral">&#39; &#39;</span>; <span class="comment">/* string is still terminated because we removed</span></div>
<div class="line"><span class="lineno"> 1182</span><span class="comment">                              at least one whitespace char above */</span></div>
<div class="line"><span class="lineno"> 1183</span>    }</div>
<div class="line"><span class="lineno"> 1184</span> </div>
<div class="line"><span class="lineno"> 1185</span>    <a class="code hl_function" href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a>(buf, line);</div>
<div class="line"><span class="lineno"> 1186</span>  }</div>
<div class="line"><span class="lineno"> 1187</span> </div>
<div class="line"><span class="lineno"> 1188</span>  <span class="keywordflow">return</span> read;</div>
<div class="line"><span class="lineno"> 1189</span>}</div>
<div class="ttc" id="abuffer_8c_html_a4245e227baa2a9beb6991917404aab0d"><div class="ttname"><a href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a></div><div class="ttdeci">bool buf_is_empty(const struct Buffer *buf)</div><div class="ttdoc">Is the Buffer empty?</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00291">buffer.c:291</a></div></div>
<div class="ttc" id="abuffer_8c_html_a9924e74ddcb5280ab380e4627d1fba99"><div class="ttname"><a href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a></div><div class="ttdeci">size_t buf_addstr(struct Buffer *buf, const char *s)</div><div class="ttdoc">Add a string to a Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00226">buffer.c:226</a></div></div>
</div><!-- fragment --><div id="dynsection-35" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-35-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-35-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-35-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a2b38814d1731678ff2a62299a565e0d2_cgraph.svg" width="526" height="275"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-36" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-36-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-36-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-36-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a2b38814d1731678ff2a62299a565e0d2_icgraph.svg" width="403" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a709f7f23d8a54a0f75abc28a0b365ace" name="a709f7f23d8a54a0f75abc28a0b365ace"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a709f7f23d8a54a0f75abc28a0b365ace">&#9670;&#160;</a></span>mutt_rfc822_read_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structEnvelope.html">Envelope</a> * mutt_rfc822_read_header </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>user_hdrs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>weed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses an RFC822 header. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>Stream to read from </td></tr>
    <tr><td class="paramname">e</td><td>Current <a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> (optional) </td></tr>
    <tr><td class="paramname">user_hdrs</td><td>If set, store user headers Used for recall-message and postpone modes </td></tr>
    <tr><td class="paramname">weed</td><td>If this parameter is set and the user has activated the $weed option, honor the header weed list for user headers. Used for recall-message </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Newly allocated envelope structure</td></tr>
  </table>
  </dd>
</dl>
<p>Caller should free the <a class="el" href="structEnvelope.html" title="The header of an Email.">Envelope</a> using <a class="el" href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f" title="Free an Envelope.">mutt_env_free()</a>. </p>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l01204">1204</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1205</span>{</div>
<div class="line"><span class="lineno"> 1206</span>  <span class="keywordflow">if</span> (!fp)</div>
<div class="line"><span class="lineno"> 1207</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1208</span> </div>
<div class="line"><span class="lineno"> 1209</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structEnvelope.html">Envelope</a> *env = <a class="code hl_function" href="envelope_8c.html#a406e6f76001e7604ce65ffe972fc19c1">mutt_env_new</a>();</div>
<div class="line"><span class="lineno"> 1210</span>  <span class="keywordtype">char</span> *p = NULL;</div>
<div class="line"><span class="lineno"> 1211</span>  LOFF_T loc = e ? e-&gt;<a class="code hl_variable" href="structEmail.html#a8d35ff6f232f83e89e2d46af416708cc">offset</a> : ftello(fp);</div>
<div class="line"><span class="lineno"> 1212</span>  <span class="keywordflow">if</span> (loc &lt; 0)</div>
<div class="line"><span class="lineno"> 1213</span>  {</div>
<div class="line"><span class="lineno"> 1214</span>    <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;ftello: %s (errno %d)\n&quot;</span>, strerror(errno), errno);</div>
<div class="line"><span class="lineno"> 1215</span>    loc = 0;</div>
<div class="line"><span class="lineno"> 1216</span>  }</div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *line = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>  <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno"> 1221</span>  {</div>
<div class="line"><span class="lineno"> 1222</span>    <span class="keywordflow">if</span> (!e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>)</div>
<div class="line"><span class="lineno"> 1223</span>    {</div>
<div class="line"><span class="lineno"> 1224</span>      e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = <a class="code hl_function" href="email_2body_8c.html#a37b346253e3b97aa64bb38ffc8d1ea0c">mutt_body_new</a>();</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span>      <span class="comment">/* set the defaults from RFC1521 */</span></div>
<div class="line"><span class="lineno"> 1227</span>      e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> = <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>;</div>
<div class="line"><span class="lineno"> 1228</span>      e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(<span class="stringliteral">&quot;plain&quot;</span>);</div>
<div class="line"><span class="lineno"> 1229</span>      e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e">ENC_7BIT</a>;</div>
<div class="line"><span class="lineno"> 1230</span>      e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = -1;</div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span>      <span class="comment">/* RFC2183 says this is arbitrary */</span></div>
<div class="line"><span class="lineno"> 1233</span>      e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a99aff302b287a47c407a7412a99630f5">disposition</a> = <a class="code hl_enumvalue" href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073">DISP_INLINE</a>;</div>
<div class="line"><span class="lineno"> 1234</span>    }</div>
<div class="line"><span class="lineno"> 1235</span>  }</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>  <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno"> 1238</span>  {</div>
<div class="line"><span class="lineno"> 1239</span>    LOFF_T line_start_loc = loc;</div>
<div class="line"><span class="lineno"> 1240</span>    <span class="keywordtype">size_t</span> len = <a class="code hl_function" href="#a2b38814d1731678ff2a62299a565e0d2">mutt_rfc822_read_line</a>(fp, line);</div>
<div class="line"><span class="lineno"> 1241</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(line))</div>
<div class="line"><span class="lineno"> 1242</span>    {</div>
<div class="line"><span class="lineno"> 1243</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1244</span>    }</div>
<div class="line"><span class="lineno"> 1245</span>    loc += len;</div>
<div class="line"><span class="lineno"> 1246</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *lines = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(line);</div>
<div class="line"><span class="lineno"> 1247</span>    p = strpbrk(lines, <span class="stringliteral">&quot;: \t&quot;</span>);</div>
<div class="line"><span class="lineno"> 1248</span>    <span class="keywordflow">if</span> (!p || (*p != <span class="charliteral">&#39;:&#39;</span>))</div>
<div class="line"><span class="lineno"> 1249</span>    {</div>
<div class="line"><span class="lineno"> 1250</span>      <span class="keywordtype">char</span> return_path[1024] = { 0 };</div>
<div class="line"><span class="lineno"> 1251</span>      time_t t = 0;</div>
<div class="line"><span class="lineno"> 1252</span> </div>
<div class="line"><span class="lineno"> 1253</span>      <span class="comment">/* some bogus MTAs will quote the original &quot;From &quot; line */</span></div>
<div class="line"><span class="lineno"> 1254</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a>(lines, <span class="stringliteral">&quot;&gt;From &quot;</span>))</div>
<div class="line"><span class="lineno"> 1255</span>      {</div>
<div class="line"><span class="lineno"> 1256</span>        <span class="keywordflow">continue</span>; <span class="comment">/* just ignore */</span></div>
<div class="line"><span class="lineno"> 1257</span>      }</div>
<div class="line"><span class="lineno"> 1258</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="from_8c.html#af485f9451b398a9beb14a61aaa68ddeb">is_from</a>(lines, return_path, <span class="keyword">sizeof</span>(return_path), &amp;t))</div>
<div class="line"><span class="lineno"> 1259</span>      {</div>
<div class="line"><span class="lineno"> 1260</span>        <span class="comment">/* MH sometimes has the From_ line in the middle of the header! */</span></div>
<div class="line"><span class="lineno"> 1261</span>        <span class="keywordflow">if</span> (e &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#af64bcf33ccd8b0ba248fc8d427c21264">received</a> == 0))</div>
<div class="line"><span class="lineno"> 1262</span>          e-&gt;<a class="code hl_variable" href="structEmail.html#af64bcf33ccd8b0ba248fc8d427c21264">received</a> = t - <a class="code hl_function" href="mutt_2date_8c.html#abba12f7ad4dc9c7e2d836742d360a81e">mutt_date_local_tz</a>(t);</div>
<div class="line"><span class="lineno"> 1263</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1264</span>      }</div>
<div class="line"><span class="lineno"> 1265</span> </div>
<div class="line"><span class="lineno"> 1266</span>      <span class="comment">/* We need to seek back to the start of the body. Note that we</span></div>
<div class="line"><span class="lineno"> 1267</span><span class="comment">       * keep track of loc ourselves, since calling ftello() incurs</span></div>
<div class="line"><span class="lineno"> 1268</span><span class="comment">       * a syscall, which can be expensive to do for every single line */</span></div>
<div class="line"><span class="lineno"> 1269</span>      (void) <a class="code hl_function" href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a>(fp, line_start_loc, SEEK_SET);</div>
<div class="line"><span class="lineno"> 1270</span>      <span class="keywordflow">break</span>; <span class="comment">/* end of header */</span></div>
<div class="line"><span class="lineno"> 1271</span>    }</div>
<div class="line"><span class="lineno"> 1272</span>    <span class="keywordtype">size_t</span> name_len = p - lines;</div>
<div class="line"><span class="lineno"> 1273</span> </div>
<div class="line"><span class="lineno"> 1274</span>    <span class="keywordtype">char</span> buf[1024] = { 0 };</div>
<div class="line"><span class="lineno"> 1275</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2regex_8c.html#a5c1dc418529747116226ffa8f97e9e88">mutt_replacelist_match</a>(&amp;<a class="code hl_variable" href="email_2globals_8c.html#a06af023ff2bcf95bde2927fe57a02343">SpamList</a>, buf, <span class="keyword">sizeof</span>(buf), lines))</div>
<div class="line"><span class="lineno"> 1276</span>    {</div>
<div class="line"><span class="lineno"> 1277</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="mutt_2regex_8c.html#ab0efb83f9190881306c558339efb250a">mutt_regexlist_match</a>(&amp;<a class="code hl_variable" href="email_2globals_8c.html#ac34f386d975c81dc32e3b0bc079dba40">NoSpamList</a>, lines))</div>
<div class="line"><span class="lineno"> 1278</span>      {</div>
<div class="line"><span class="lineno"> 1279</span>        <span class="comment">/* if spam tag already exists, figure out how to amend it */</span></div>
<div class="line"><span class="lineno"> 1280</span>        <span class="keywordflow">if</span> ((!<a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8c023e9cdf8773723b894efda0a56a72">spam</a>)) &amp;&amp; (*buf != <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line"><span class="lineno"> 1281</span>        {</div>
<div class="line"><span class="lineno"> 1282</span>          <span class="comment">/* If `$spam_separator` defined, append with separator */</span></div>
<div class="line"><span class="lineno"> 1283</span>          <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_spam_separator = <a class="code hl_function" href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;spam_separator&quot;</span>);</div>
<div class="line"><span class="lineno"> 1284</span>          <span class="keywordflow">if</span> (c_spam_separator)</div>
<div class="line"><span class="lineno"> 1285</span>          {</div>
<div class="line"><span class="lineno"> 1286</span>            <a class="code hl_function" href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8c023e9cdf8773723b894efda0a56a72">spam</a>, c_spam_separator);</div>
<div class="line"><span class="lineno"> 1287</span>            <a class="code hl_function" href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8c023e9cdf8773723b894efda0a56a72">spam</a>, buf);</div>
<div class="line"><span class="lineno"> 1288</span>          }</div>
<div class="line"><span class="lineno"> 1289</span>          <span class="keywordflow">else</span> <span class="comment">/* overwrite */</span></div>
<div class="line"><span class="lineno"> 1290</span>          {</div>
<div class="line"><span class="lineno"> 1291</span>            <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8c023e9cdf8773723b894efda0a56a72">spam</a>);</div>
<div class="line"><span class="lineno"> 1292</span>            <a class="code hl_function" href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8c023e9cdf8773723b894efda0a56a72">spam</a>, buf);</div>
<div class="line"><span class="lineno"> 1293</span>          }</div>
<div class="line"><span class="lineno"> 1294</span>        }</div>
<div class="line"><span class="lineno"> 1295</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8c023e9cdf8773723b894efda0a56a72">spam</a>) &amp;&amp; (*buf != <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line"><span class="lineno"> 1296</span>        {</div>
<div class="line"><span class="lineno"> 1297</span>          <span class="comment">/* spam tag is new, and match expr is non-empty; copy */</span></div>
<div class="line"><span class="lineno"> 1298</span>          <a class="code hl_function" href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8c023e9cdf8773723b894efda0a56a72">spam</a>, buf);</div>
<div class="line"><span class="lineno"> 1299</span>        }</div>
<div class="line"><span class="lineno"> 1300</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8c023e9cdf8773723b894efda0a56a72">spam</a>))</div>
<div class="line"><span class="lineno"> 1301</span>        {</div>
<div class="line"><span class="lineno"> 1302</span>          <span class="comment">/* match expr is empty; plug in null string if no existing tag */</span></div>
<div class="line"><span class="lineno"> 1303</span>          <a class="code hl_function" href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8c023e9cdf8773723b894efda0a56a72">spam</a>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 1304</span>        }</div>
<div class="line"><span class="lineno"> 1305</span> </div>
<div class="line"><span class="lineno"> 1306</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8c023e9cdf8773723b894efda0a56a72">spam</a>))</div>
<div class="line"><span class="lineno"> 1307</span>          <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a678d278eb301551ba0b3e0dbcfcee630">LL_DEBUG5</a>, <span class="stringliteral">&quot;spam = %s\n&quot;</span>, env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8c023e9cdf8773723b894efda0a56a72">spam</a>.<a class="code hl_variable" href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">data</a>);</div>
<div class="line"><span class="lineno"> 1308</span>      }</div>
<div class="line"><span class="lineno"> 1309</span>    }</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span>    *p = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1312</span>    p = <a class="code hl_function" href="mutt_2string_8c.html#a5bc328ca69776d155059041aaff9435a">mutt_str_skip_email_wsp</a>(p + 1);</div>
<div class="line"><span class="lineno"> 1313</span>    <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno"> 1314</span>      <span class="keywordflow">continue</span>; <span class="comment">/* skip empty header fields */</span></div>
<div class="line"><span class="lineno"> 1315</span> </div>
<div class="line"><span class="lineno"> 1316</span>    <a class="code hl_function" href="#a012cf883e316be91676a2f589b48f330">mutt_rfc822_parse_line</a>(env, e, lines, name_len, p, user_hdrs, weed, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1317</span>  }</div>
<div class="line"><span class="lineno"> 1318</span> </div>
<div class="line"><span class="lineno"> 1319</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;line);</div>
<div class="line"><span class="lineno"> 1320</span> </div>
<div class="line"><span class="lineno"> 1321</span>  <span class="keywordflow">if</span> (e)</div>
<div class="line"><span class="lineno"> 1322</span>  {</div>
<div class="line"><span class="lineno"> 1323</span>    e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#ae6ebb9758689003ed9ae055272420dd9">hdr_offset</a> = e-&gt;<a class="code hl_variable" href="structEmail.html#a8d35ff6f232f83e89e2d46af416708cc">offset</a>;</div>
<div class="line"><span class="lineno"> 1324</span>    e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a> = ftello(fp);</div>
<div class="line"><span class="lineno"> 1325</span> </div>
<div class="line"><span class="lineno"> 1326</span>    <a class="code hl_function" href="rfc2047_8c.html#a79026f5cfec0b561058f7021e19b9601">rfc2047_decode_envelope</a>(env);</div>
<div class="line"><span class="lineno"> 1327</span> </div>
<div class="line"><span class="lineno"> 1328</span>    <span class="keywordflow">if</span> (e-&gt;<a class="code hl_variable" href="structEmail.html#af64bcf33ccd8b0ba248fc8d427c21264">received</a> &lt; 0)</div>
<div class="line"><span class="lineno"> 1329</span>    {</div>
<div class="line"><span class="lineno"> 1330</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;resetting invalid received time to 0\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1331</span>      e-&gt;<a class="code hl_variable" href="structEmail.html#af64bcf33ccd8b0ba248fc8d427c21264">received</a> = 0;</div>
<div class="line"><span class="lineno"> 1332</span>    }</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>    <span class="comment">/* check for missing or invalid date */</span></div>
<div class="line"><span class="lineno"> 1335</span>    <span class="keywordflow">if</span> (e-&gt;<a class="code hl_variable" href="structEmail.html#a9e3cda5dab6d53f68cad95d28068d962">date_sent</a> &lt;= 0)</div>
<div class="line"><span class="lineno"> 1336</span>    {</div>
<div class="line"><span class="lineno"> 1337</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;no date found, using received time from msg separator\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1338</span>      e-&gt;<a class="code hl_variable" href="structEmail.html#a9e3cda5dab6d53f68cad95d28068d962">date_sent</a> = e-&gt;<a class="code hl_variable" href="structEmail.html#af64bcf33ccd8b0ba248fc8d427c21264">received</a>;</div>
<div class="line"><span class="lineno"> 1339</span>    }</div>
<div class="line"><span class="lineno"> 1340</span> </div>
<div class="line"><span class="lineno"> 1341</span><span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div>
<div class="line"><span class="lineno"> 1342</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_autocrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;autocrypt&quot;</span>);</div>
<div class="line"><span class="lineno"> 1343</span>    <span class="keywordflow">if</span> (c_autocrypt)</div>
<div class="line"><span class="lineno"> 1344</span>    {</div>
<div class="line"><span class="lineno"> 1345</span>      <a class="code hl_function" href="autocrypt_8c.html#a0477a928cf8c6b79a25b42e63f4647b8">mutt_autocrypt_process_autocrypt_header</a>(e, env);</div>
<div class="line"><span class="lineno"> 1346</span>      <span class="comment">/* No sense in taking up memory after the header is processed */</span></div>
<div class="line"><span class="lineno"> 1347</span>      <a class="code hl_function" href="envelope_8c.html#aeb4e0ebb67680c74374f046bce5bc84a">mutt_autocrypthdr_free</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a8888ccd1c0b1512c92dd00a9a3a059d8">autocrypt</a>);</div>
<div class="line"><span class="lineno"> 1348</span>    }</div>
<div class="line"><span class="lineno"> 1349</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1350</span>  }</div>
<div class="line"><span class="lineno"> 1351</span> </div>
<div class="line"><span class="lineno"> 1352</span>  <span class="keywordflow">return</span> env;</div>
<div class="line"><span class="lineno"> 1353</span>}</div>
<div class="ttc" id="aautocrypt_8c_html_a0477a928cf8c6b79a25b42e63f4647b8"><div class="ttname"><a href="autocrypt_8c.html#a0477a928cf8c6b79a25b42e63f4647b8">mutt_autocrypt_process_autocrypt_header</a></div><div class="ttdeci">int mutt_autocrypt_process_autocrypt_header(struct Email *e, struct Envelope *env)</div><div class="ttdoc">Parse an Autocrypt email header.</div><div class="ttdef"><b>Definition</b> <a href="autocrypt_8c_source.html#l00256">autocrypt.c:256</a></div></div>
<div class="ttc" id="aconfig_2helpers_8c_html_a6b1589ee93ff51ef31f1d9324e138078"><div class="ttname"><a href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00291">helpers.c:291</a></div></div>
<div class="ttc" id="aemail_2body_8c_html_a37b346253e3b97aa64bb38ffc8d1ea0c"><div class="ttname"><a href="email_2body_8c.html#a37b346253e3b97aa64bb38ffc8d1ea0c">mutt_body_new</a></div><div class="ttdeci">struct Body * mutt_body_new(void)</div><div class="ttdoc">Create a new Body.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8c_source.html#l00044">body.c:44</a></div></div>
<div class="ttc" id="aemail_2globals_8c_html_a06af023ff2bcf95bde2927fe57a02343"><div class="ttname"><a href="email_2globals_8c.html#a06af023ff2bcf95bde2927fe57a02343">SpamList</a></div><div class="ttdeci">struct ReplaceList SpamList</div><div class="ttdoc">List of regexes to match subscribed mailing lists.</div><div class="ttdef"><b>Definition</b> <a href="email_2globals_8c_source.html#l00046">globals.c:46</a></div></div>
<div class="ttc" id="aemail_2globals_8c_html_ac34f386d975c81dc32e3b0bc079dba40"><div class="ttname"><a href="email_2globals_8c.html#ac34f386d975c81dc32e3b0bc079dba40">NoSpamList</a></div><div class="ttdeci">struct RegexList NoSpamList</div><div class="ttdoc">List of regexes and patterns to match spam emails.</div><div class="ttdef"><b>Definition</b> <a href="email_2globals_8c_source.html#l00044">globals.c:44</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a012cf883e316be91676a2f589b48f330"><div class="ttname"><a href="#a012cf883e316be91676a2f589b48f330">mutt_rfc822_parse_line</a></div><div class="ttdeci">int mutt_rfc822_parse_line(struct Envelope *env, struct Email *e, const char *name, size_t name_len, const char *body, bool user_hdrs, bool weed, bool do_2047)</div><div class="ttdoc">Parse an email header.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00677">parse.c:677</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a2b38814d1731678ff2a62299a565e0d2"><div class="ttname"><a href="#a2b38814d1731678ff2a62299a565e0d2">mutt_rfc822_read_line</a></div><div class="ttdeci">size_t mutt_rfc822_read_line(FILE *fp, struct Buffer *buf)</div><div class="ttdoc">Read a header line from a file.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01124">parse.c:1124</a></div></div>
<div class="ttc" id="aenvelope_8c_html_aeb4e0ebb67680c74374f046bce5bc84a"><div class="ttname"><a href="envelope_8c.html#aeb4e0ebb67680c74374f046bce5bc84a">mutt_autocrypthdr_free</a></div><div class="ttdeci">void mutt_autocrypthdr_free(struct AutocryptHeader **ptr)</div><div class="ttdoc">Free an AutocryptHeader.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8c_source.html#l00103">envelope.c:103</a></div></div>
<div class="ttc" id="afrom_8c_html_af485f9451b398a9beb14a61aaa68ddeb"><div class="ttname"><a href="from_8c.html#af485f9451b398a9beb14a61aaa68ddeb">is_from</a></div><div class="ttdeci">bool is_from(const char *s, char *path, size_t pathlen, time_t *tp)</div><div class="ttdoc">Is a string a &#39;From&#39; header line?</div><div class="ttdef"><b>Definition</b> <a href="from_8c_source.html#l00049">from.c:49</a></div></div>
<div class="ttc" id="alogging2_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a678d278eb301551ba0b3e0dbcfcee630"><div class="ttname"><a href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a678d278eb301551ba0b3e0dbcfcee630">LL_DEBUG5</a></div><div class="ttdeci">@ LL_DEBUG5</div><div class="ttdoc">Log at debug level 5.</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00049">logging2.h:49</a></div></div>
<div class="ttc" id="amutt_2date_8c_html_abba12f7ad4dc9c7e2d836742d360a81e"><div class="ttname"><a href="mutt_2date_8c.html#abba12f7ad4dc9c7e2d836742d360a81e">mutt_date_local_tz</a></div><div class="ttdeci">int mutt_date_local_tz(time_t t)</div><div class="ttdoc">Calculate the local timezone in seconds east of UTC.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2date_8c_source.html#l00220">date.c:220</a></div></div>
<div class="ttc" id="amutt_2regex_8c_html_a5c1dc418529747116226ffa8f97e9e88"><div class="ttname"><a href="mutt_2regex_8c.html#a5c1dc418529747116226ffa8f97e9e88">mutt_replacelist_match</a></div><div class="ttdeci">bool mutt_replacelist_match(struct ReplaceList *rl, char *buf, size_t buflen, const char *str)</div><div class="ttdoc">Does a string match a pattern?</div><div class="ttdef"><b>Definition</b> <a href="mutt_2regex_8c_source.html#l00478">regex.c:478</a></div></div>
<div class="ttc" id="arfc2047_8c_html_a79026f5cfec0b561058f7021e19b9601"><div class="ttname"><a href="rfc2047_8c.html#a79026f5cfec0b561058f7021e19b9601">rfc2047_decode_envelope</a></div><div class="ttdeci">void rfc2047_decode_envelope(struct Envelope *env)</div><div class="ttdoc">Decode the fields of an Envelope.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00836">rfc2047.c:836</a></div></div>
<div class="ttc" id="astructBody_html_ae6ebb9758689003ed9ae055272420dd9"><div class="ttname"><a href="structBody.html#ae6ebb9758689003ed9ae055272420dd9">Body::hdr_offset</a></div><div class="ttdeci">long hdr_offset</div><div class="ttdoc">Offset in stream where the headers begin.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00081">body.h:81</a></div></div>
<div class="ttc" id="astructBuffer_html_aeec1fd4af0ddf6765b0187466d4361b8"><div class="ttname"><a href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">Buffer::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">Pointer to data.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00037">buffer.h:37</a></div></div>
<div class="ttc" id="astructEnvelope_html_a8c023e9cdf8773723b894efda0a56a72"><div class="ttname"><a href="structEnvelope.html#a8c023e9cdf8773723b894efda0a56a72">Envelope::spam</a></div><div class="ttdeci">struct Buffer spam</div><div class="ttdoc">Spam header.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00082">envelope.h:82</a></div></div>
</div><!-- fragment --><div id="dynsection-37" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-37-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-37-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-37-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a709f7f23d8a54a0f75abc28a0b365ace_cgraph.svg" width="779" height="1220"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-38" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-38-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-38-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-38-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a709f7f23d8a54a0f75abc28a0b365ace_icgraph.svg" width="632" height="891"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2cfe061d82e6381b14e355c0937ecfc1" name="a2cfe061d82e6381b14e355c0937ecfc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cfe061d82e6381b14e355c0937ecfc1">&#9670;&#160;</a></span>mutt_read_mime_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structBody.html">Body</a> * mutt_read_mime_header </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>digest</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a MIME header. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>stream to read from </td></tr>
    <tr><td class="paramname">digest</td><td>true if reading subparts of a multipart/digest </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>New <a class="el" href="structBody.html" title="The body of an email.">Body</a> containing parsed structure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l01361">1361</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1362</span>{</div>
<div class="line"><span class="lineno"> 1363</span>  <span class="keywordflow">if</span> (!fp)</div>
<div class="line"><span class="lineno"> 1364</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1365</span> </div>
<div class="line"><span class="lineno"> 1366</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *b = <a class="code hl_function" href="email_2body_8c.html#a37b346253e3b97aa64bb38ffc8d1ea0c">mutt_body_new</a>();</div>
<div class="line"><span class="lineno"> 1367</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structEnvelope.html">Envelope</a> *env = <a class="code hl_function" href="envelope_8c.html#a406e6f76001e7604ce65ffe972fc19c1">mutt_env_new</a>();</div>
<div class="line"><span class="lineno"> 1368</span>  <span class="keywordtype">char</span> *c = NULL;</div>
<div class="line"><span class="lineno"> 1369</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *buf = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno"> 1370</span>  <span class="keywordtype">bool</span> matched = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1371</span> </div>
<div class="line"><span class="lineno"> 1372</span>  b-&gt;<a class="code hl_variable" href="structBody.html#ae6ebb9758689003ed9ae055272420dd9">hdr_offset</a> = ftello(fp);</div>
<div class="line"><span class="lineno"> 1373</span> </div>
<div class="line"><span class="lineno"> 1374</span>  b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e">ENC_7BIT</a>; <span class="comment">/* default from RFC1521 */</span></div>
<div class="line"><span class="lineno"> 1375</span>  b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> = digest ? <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a> : <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>;</div>
<div class="line"><span class="lineno"> 1376</span>  b-&gt;<a class="code hl_variable" href="structBody.html#a99aff302b287a47c407a7412a99630f5">disposition</a> = <a class="code hl_enumvalue" href="mime_8h.html#a5f93dab7807282e699a6bc1b2d18a2d8a691faf938d6b4cec05ea5e03d9dee073">DISP_INLINE</a>;</div>
<div class="line"><span class="lineno"> 1377</span> </div>
<div class="line"><span class="lineno"> 1378</span>  <span class="keywordflow">while</span> (<a class="code hl_function" href="#a2b38814d1731678ff2a62299a565e0d2">mutt_rfc822_read_line</a>(fp, buf) != 0)</div>
<div class="line"><span class="lineno"> 1379</span>  {</div>
<div class="line"><span class="lineno"> 1380</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *line = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf);</div>
<div class="line"><span class="lineno"> 1381</span>    <span class="comment">/* Find the value of the current header */</span></div>
<div class="line"><span class="lineno"> 1382</span>    c = strchr(line, <span class="charliteral">&#39;:&#39;</span>);</div>
<div class="line"><span class="lineno"> 1383</span>    <span class="keywordflow">if</span> (c)</div>
<div class="line"><span class="lineno"> 1384</span>    {</div>
<div class="line"><span class="lineno"> 1385</span>      *c = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1386</span>      c = <a class="code hl_function" href="mutt_2string_8c.html#a5bc328ca69776d155059041aaff9435a">mutt_str_skip_email_wsp</a>(c + 1);</div>
<div class="line"><span class="lineno"> 1387</span>      <span class="keywordflow">if</span> (*c == <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno"> 1388</span>      {</div>
<div class="line"><span class="lineno"> 1389</span>        <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;skipping empty header field: %s\n&quot;</span>, line);</div>
<div class="line"><span class="lineno"> 1390</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1391</span>      }</div>
<div class="line"><span class="lineno"> 1392</span>    }</div>
<div class="line"><span class="lineno"> 1393</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1394</span>    {</div>
<div class="line"><span class="lineno"> 1395</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;bogus MIME header: %s\n&quot;</span>, line);</div>
<div class="line"><span class="lineno"> 1396</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1397</span>    }</div>
<div class="line"><span class="lineno"> 1398</span> </div>
<div class="line"><span class="lineno"> 1399</span>    <span class="keywordtype">size_t</span> plen = <a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(line, <span class="stringliteral">&quot;content-&quot;</span>);</div>
<div class="line"><span class="lineno"> 1400</span>    <span class="keywordflow">if</span> (plen != 0)</div>
<div class="line"><span class="lineno"> 1401</span>    {</div>
<div class="line"><span class="lineno"> 1402</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;type&quot;</span>, line + plen))</div>
<div class="line"><span class="lineno"> 1403</span>      {</div>
<div class="line"><span class="lineno"> 1404</span>        <a class="code hl_function" href="#a1c0bcb79c2ff930b4131a1ede5828762">mutt_parse_content_type</a>(c, b);</div>
<div class="line"><span class="lineno"> 1405</span>      }</div>
<div class="line"><span class="lineno"> 1406</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;language&quot;</span>, line + plen))</div>
<div class="line"><span class="lineno"> 1407</span>      {</div>
<div class="line"><span class="lineno"> 1408</span>        <a class="code hl_function" href="#a74dcb6f4b53adc8cc3f61bcf4168fd51">parse_content_language</a>(c, b);</div>
<div class="line"><span class="lineno"> 1409</span>      }</div>
<div class="line"><span class="lineno"> 1410</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;transfer-encoding&quot;</span>, line + plen))</div>
<div class="line"><span class="lineno"> 1411</span>      {</div>
<div class="line"><span class="lineno"> 1412</span>        b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = <a class="code hl_function" href="#a8692f01c25d10e357dbeee470ba26c2c">mutt_check_encoding</a>(c);</div>
<div class="line"><span class="lineno"> 1413</span>      }</div>
<div class="line"><span class="lineno"> 1414</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;disposition&quot;</span>, line + plen))</div>
<div class="line"><span class="lineno"> 1415</span>      {</div>
<div class="line"><span class="lineno"> 1416</span>        <a class="code hl_function" href="#a870232070405e395193a6c7e00e2df60">parse_content_disposition</a>(c, b);</div>
<div class="line"><span class="lineno"> 1417</span>      }</div>
<div class="line"><span class="lineno"> 1418</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;description&quot;</span>, line + plen))</div>
<div class="line"><span class="lineno"> 1419</span>      {</div>
<div class="line"><span class="lineno"> 1420</span>        <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>, c);</div>
<div class="line"><span class="lineno"> 1421</span>        <a class="code hl_function" href="rfc2047_8c.html#a89c57c82465740567f73641c9397d760">rfc2047_decode</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>);</div>
<div class="line"><span class="lineno"> 1422</span>      }</div>
<div class="line"><span class="lineno"> 1423</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;id&quot;</span>, line + plen))</div>
<div class="line"><span class="lineno"> 1424</span>      {</div>
<div class="line"><span class="lineno"> 1425</span>        <span class="comment">// strip &lt;angle braces&gt; from Content-ID: header</span></div>
<div class="line"><span class="lineno"> 1426</span>        <span class="keywordtype">char</span> *<span class="keywordtype">id</span> = c;</div>
<div class="line"><span class="lineno"> 1427</span>        <span class="keywordtype">int</span> cid_len = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(c);</div>
<div class="line"><span class="lineno"> 1428</span>        <span class="keywordflow">if</span> (cid_len &gt; 2)</div>
<div class="line"><span class="lineno"> 1429</span>        {</div>
<div class="line"><span class="lineno"> 1430</span>          <span class="keywordflow">if</span> (<span class="keywordtype">id</span>[0] == <span class="charliteral">&#39;&lt;&#39;</span>)</div>
<div class="line"><span class="lineno"> 1431</span>          {</div>
<div class="line"><span class="lineno"> 1432</span>            <span class="keywordtype">id</span>++;</div>
<div class="line"><span class="lineno"> 1433</span>            cid_len--;</div>
<div class="line"><span class="lineno"> 1434</span>          }</div>
<div class="line"><span class="lineno"> 1435</span>          <span class="keywordflow">if</span> (<span class="keywordtype">id</span>[cid_len - 1] == <span class="charliteral">&#39;&gt;&#39;</span>)</div>
<div class="line"><span class="lineno"> 1436</span>            <span class="keywordtype">id</span>[cid_len - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1437</span>        }</div>
<div class="line"><span class="lineno"> 1438</span>        <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a04d719ada605ac008d4bf548db758480">content_id</a>, <span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno"> 1439</span>      }</div>
<div class="line"><span class="lineno"> 1440</span>    }</div>
<div class="line"><span class="lineno"> 1441</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((plen = <a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(line, <span class="stringliteral">&quot;x-sun-&quot;</span>)))</div>
<div class="line"><span class="lineno"> 1442</span>    {</div>
<div class="line"><span class="lineno"> 1443</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;data-type&quot;</span>, line + plen))</div>
<div class="line"><span class="lineno"> 1444</span>      {</div>
<div class="line"><span class="lineno"> 1445</span>        <a class="code hl_function" href="#a1c0bcb79c2ff930b4131a1ede5828762">mutt_parse_content_type</a>(c, b);</div>
<div class="line"><span class="lineno"> 1446</span>      }</div>
<div class="line"><span class="lineno"> 1447</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;encoding-info&quot;</span>, line + plen))</div>
<div class="line"><span class="lineno"> 1448</span>      {</div>
<div class="line"><span class="lineno"> 1449</span>        b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = <a class="code hl_function" href="#a8692f01c25d10e357dbeee470ba26c2c">mutt_check_encoding</a>(c);</div>
<div class="line"><span class="lineno"> 1450</span>      }</div>
<div class="line"><span class="lineno"> 1451</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;content-lines&quot;</span>, line + plen))</div>
<div class="line"><span class="lineno"> 1452</span>      {</div>
<div class="line"><span class="lineno"> 1453</span>        <a class="code hl_function" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;content-lines&quot;</span>, c);</div>
<div class="line"><span class="lineno"> 1454</span>      }</div>
<div class="line"><span class="lineno"> 1455</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;data-description&quot;</span>, line + plen))</div>
<div class="line"><span class="lineno"> 1456</span>      {</div>
<div class="line"><span class="lineno"> 1457</span>        <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>, c);</div>
<div class="line"><span class="lineno"> 1458</span>        <a class="code hl_function" href="rfc2047_8c.html#a89c57c82465740567f73641c9397d760">rfc2047_decode</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>);</div>
<div class="line"><span class="lineno"> 1459</span>      }</div>
<div class="line"><span class="lineno"> 1460</span>    }</div>
<div class="line"><span class="lineno"> 1461</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1462</span>    {</div>
<div class="line"><span class="lineno"> 1463</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="#a012cf883e316be91676a2f589b48f330">mutt_rfc822_parse_line</a>(env, NULL, line, strlen(line), c, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>))</div>
<div class="line"><span class="lineno"> 1464</span>      {</div>
<div class="line"><span class="lineno"> 1465</span>        matched = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1466</span>      }</div>
<div class="line"><span class="lineno"> 1467</span>    }</div>
<div class="line"><span class="lineno"> 1468</span>  }</div>
<div class="line"><span class="lineno"> 1469</span>  b-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a> = ftello(fp); <span class="comment">/* Mark the start of the real data */</span></div>
<div class="line"><span class="lineno"> 1470</span>  <span class="keywordflow">if</span> ((b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) &amp;&amp; !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>)</div>
<div class="line"><span class="lineno"> 1471</span>    b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(<span class="stringliteral">&quot;plain&quot;</span>);</div>
<div class="line"><span class="lineno"> 1472</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a>) &amp;&amp; !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>)</div>
<div class="line"><span class="lineno"> 1473</span>    b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(<span class="stringliteral">&quot;rfc822&quot;</span>);</div>
<div class="line"><span class="lineno"> 1474</span> </div>
<div class="line"><span class="lineno"> 1475</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;buf);</div>
<div class="line"><span class="lineno"> 1476</span> </div>
<div class="line"><span class="lineno"> 1477</span>  <span class="keywordflow">if</span> (matched)</div>
<div class="line"><span class="lineno"> 1478</span>  {</div>
<div class="line"><span class="lineno"> 1479</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a> = env;</div>
<div class="line"><span class="lineno"> 1480</span>    <a class="code hl_function" href="rfc2047_8c.html#a79026f5cfec0b561058f7021e19b9601">rfc2047_decode_envelope</a>(b-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>);</div>
<div class="line"><span class="lineno"> 1481</span>  }</div>
<div class="line"><span class="lineno"> 1482</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1483</span>  {</div>
<div class="line"><span class="lineno"> 1484</span>    <a class="code hl_function" href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;env);</div>
<div class="line"><span class="lineno"> 1485</span>  }</div>
<div class="line"><span class="lineno"> 1486</span> </div>
<div class="line"><span class="lineno"> 1487</span>  <span class="keywordflow">return</span> b;</div>
<div class="line"><span class="lineno"> 1488</span>}</div>
<div class="ttc" id="astructBody_html_a04d719ada605ac008d4bf548db758480"><div class="ttname"><a href="structBody.html#a04d719ada605ac008d4bf548db758480">Body::content_id</a></div><div class="ttdeci">char * content_id</div><div class="ttdoc">Content-Id (RFC2392)</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00058">body.h:58</a></div></div>
<div class="ttc" id="astructBody_html_a62f6c9b4245ed3b6b9296adb45aa4010"><div class="ttname"><a href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">Body::mime_headers</a></div><div class="ttdeci">struct Envelope * mime_headers</div><div class="ttdoc">Memory hole protected headers.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00076">body.h:76</a></div></div>
</div><!-- fragment --><div id="dynsection-39" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-39-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-39-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-39-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a2cfe061d82e6381b14e355c0937ecfc1_cgraph.svg" width="1219" height="1383"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-40" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-40-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-40-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-40-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a2cfe061d82e6381b14e355c0937ecfc1_icgraph.svg" width="563" height="304"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="adcc90fb584fec1be116777c533e9b3d4" name="adcc90fb584fec1be116777c533e9b3d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcc90fb584fec1be116777c533e9b3d4">&#9670;&#160;</a></span>mutt_is_message_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mutt_is_message_type </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>subtype</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine if a mime type matches a message or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> type enum value </td></tr>
    <tr><td class="paramname">subtype</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> subtype </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Type is message/news or message/rfc822 </td></tr>
    <tr><td class="paramname">false</td><td>Otherwise </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l01497">1497</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1498</span>{</div>
<div class="line"><span class="lineno"> 1499</span>  <span class="keywordflow">if</span> (type != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a>)</div>
<div class="line"><span class="lineno"> 1500</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1501</span> </div>
<div class="line"><span class="lineno"> 1502</span>  subtype = <a class="code hl_define" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(subtype);</div>
<div class="line"><span class="lineno"> 1503</span>  <span class="keywordflow">return</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(subtype, <span class="stringliteral">&quot;rfc822&quot;</span>) ||</div>
<div class="line"><span class="lineno"> 1504</span>          <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(subtype, <span class="stringliteral">&quot;news&quot;</span>) || <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(subtype, <span class="stringliteral">&quot;global&quot;</span>));</div>
<div class="line"><span class="lineno"> 1505</span>}</div>
<div class="ttc" id="astring2_8h_html_a7e0481bed27661ea2679f256b24e0283"><div class="ttname"><a href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a></div><div class="ttdeci">#define NONULL(x)</div><div class="ttdef"><b>Definition</b> <a href="string2_8h_source.html#l00044">string2.h:44</a></div></div>
</div><!-- fragment --><div id="dynsection-41" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-41-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-41-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-41-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_adcc90fb584fec1be116777c533e9b3d4_cgraph.svg" width="338" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-42" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-42-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-42-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-42-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_adcc90fb584fec1be116777c533e9b3d4_icgraph.svg" width="638" height="670"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a779380b3b7d9a2948d1b21b99f2f9532" name="a779380b3b7d9a2948d1b21b99f2f9532"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a779380b3b7d9a2948d1b21b99f2f9532">&#9670;&#160;</a></span>mailto_header_allowed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool mailto_header_allowed </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct ListHead *</td>          <td class="paramname"><span class="paramname"><em>h</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is the string in the list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>String to match </td></tr>
    <tr><td class="paramname">h</td><td>Head of the List </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>String matches a List item (or List contains "*")</td></tr>
  </table>
  </dd>
</dl>
<p>This is a very specific function. It searches a List of strings looking for a match. If the list contains a string "*", then it match any input string.</p>
<p>This is similar to <a class="el" href="list_8c.html#ae6e78596bbf371c69064967d7386def0" title="Is the string in the list (see notes)">mutt_list_match()</a>, except that it doesn't allow prefix matches.</p>
<dl class="section note"><dt>Note</dt><dd>The case of the strings is ignored. </dd></dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l01731">1731</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1732</span>{</div>
<div class="line"><span class="lineno"> 1733</span>  <span class="keywordflow">if</span> (!h)</div>
<div class="line"><span class="lineno"> 1734</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1735</span> </div>
<div class="line"><span class="lineno"> 1736</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structListNode.html">ListNode</a> *np = NULL;</div>
<div class="line"><span class="lineno"> 1737</span>  <a class="code hl_define" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(np, h, entries)</div>
<div class="line"><span class="lineno"> 1738</span>  {</div>
<div class="line"><span class="lineno"> 1739</span>    <span class="keywordflow">if</span> ((*np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a> == <span class="charliteral">&#39;*&#39;</span>) || <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(s, np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>))</div>
<div class="line"><span class="lineno"> 1740</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1741</span>  }</div>
<div class="line"><span class="lineno"> 1742</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1743</span>}</div>
<div class="ttc" id="aqueue_8h_html_a77999ebdf5aaf7af8b8ea22bf208c432"><div class="ttname"><a href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a></div><div class="ttdeci">#define STAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00390">queue.h:390</a></div></div>
</div><!-- fragment --><div id="dynsection-43" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-43-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-43-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-43-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a779380b3b7d9a2948d1b21b99f2f9532_cgraph.svg" width="340" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-44" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-44-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-44-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-44-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a779380b3b7d9a2948d1b21b99f2f9532_icgraph.svg" width="359" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a85f5f11a70b04f611f3e131f67644fbf" name="a85f5f11a70b04f611f3e131f67644fbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85f5f11a70b04f611f3e131f67644fbf">&#9670;&#160;</a></span>mutt_parse_mailto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mutt_parse_mailto </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEnvelope.html">Envelope</a> *</td>          <td class="paramname"><span class="paramname"><em>env</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>body</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>src</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a mailto:// url. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">env</td><td><a class="el" href="structEnvelope.html" title="The header of an Email.">Envelope</a> to fill </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">body</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src</td><td>String to parse </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Success </td></tr>
    <tr><td class="paramname">false</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l01753">1753</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1754</span>{</div>
<div class="line"><span class="lineno"> 1755</span>  <span class="keywordflow">if</span> (!env || !src)</div>
<div class="line"><span class="lineno"> 1756</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1757</span> </div>
<div class="line"><span class="lineno"> 1758</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structUrl.html">Url</a> *url = <a class="code hl_function" href="url_8c.html#a3030b91052fa1a5fee0ca7b1d4d94f93">url_parse</a>(<a class="code hl_variable" href="structUrl.html#a9e7df736f4e72353af3360b8e2b2c9cf">src</a>);</div>
<div class="line"><span class="lineno"> 1759</span>  <span class="keywordflow">if</span> (!url)</div>
<div class="line"><span class="lineno"> 1760</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1761</span> </div>
<div class="line"><span class="lineno"> 1762</span>  <span class="keywordflow">if</span> (url-&gt;<a class="code hl_variable" href="structUrl.html#a565d3391c8b8114a97ad6f1b7c75b5f6">host</a>)</div>
<div class="line"><span class="lineno"> 1763</span>  {</div>
<div class="line"><span class="lineno"> 1764</span>    <span class="comment">/* this is not a path-only URL */</span></div>
<div class="line"><span class="lineno"> 1765</span>    <a class="code hl_function" href="url_8c.html#a7b05825b8bb8f87657713fe5bc6edfaa">url_free</a>(&amp;url);</div>
<div class="line"><span class="lineno"> 1766</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1767</span>  }</div>
<div class="line"><span class="lineno"> 1768</span> </div>
<div class="line"><span class="lineno"> 1769</span>  <a class="code hl_function" href="address_2address_8c.html#a9bb4abe92405bac67f03e36936a29b6e">mutt_addrlist_parse</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, url-&gt;<a class="code hl_variable" href="structUrl.html#ad4b772878b40b204a7e91520b0bcbed4">path</a>);</div>
<div class="line"><span class="lineno"> 1770</span> </div>
<div class="line"><span class="lineno"> 1771</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structUrlQuery.html">UrlQuery</a> *np;</div>
<div class="line"><span class="lineno"> 1772</span>  <a class="code hl_define" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(np, &amp;url-&gt;<a class="code hl_variable" href="structUrl.html#a30ca5136a9649e6df583a48cbdee35d2">query_strings</a>, entries)</div>
<div class="line"><span class="lineno"> 1773</span>  {</div>
<div class="line"><span class="lineno"> 1774</span>    <a class="code hl_function" href="#aa024a4cce886fe1fb4a32ed8f1b8d9b9">mutt_filter_commandline_header_tag</a>(np-&gt;<a class="code hl_variable" href="structUrlQuery.html#a5e84f8d3d31c6f77cd662a9db2bae336">name</a>);</div>
<div class="line"><span class="lineno"> 1775</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *tag = np-&gt;<a class="code hl_variable" href="structUrlQuery.html#a5e84f8d3d31c6f77cd662a9db2bae336">name</a>;</div>
<div class="line"><span class="lineno"> 1776</span>    <span class="keywordtype">char</span> *<a class="code hl_variable" href="structUrlQuery.html#a6e66e3d6d751fdadc6697177649a9dad">value</a> = np-&gt;<a class="code hl_variable" href="structUrlQuery.html#a6e66e3d6d751fdadc6697177649a9dad">value</a>;</div>
<div class="line"><span class="lineno"> 1777</span>    <span class="comment">/* Determine if this header field is on the allowed list.  Since NeoMutt</span></div>
<div class="line"><span class="lineno"> 1778</span><span class="comment">     * interprets some header fields specially (such as</span></div>
<div class="line"><span class="lineno"> 1779</span><span class="comment">     * &quot;Attach: ~/.gnupg/secring.gpg&quot;), care must be taken to ensure that</span></div>
<div class="line"><span class="lineno"> 1780</span><span class="comment">     * only safe fields are allowed.</span></div>
<div class="line"><span class="lineno"> 1781</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 1782</span><span class="comment">     * RFC2368, &quot;4. Unsafe headers&quot;</span></div>
<div class="line"><span class="lineno"> 1783</span><span class="comment">     * The user agent interpreting a mailto URL SHOULD choose not to create</span></div>
<div class="line"><span class="lineno"> 1784</span><span class="comment">     * a message if any of the headers are considered dangerous; it may also</span></div>
<div class="line"><span class="lineno"> 1785</span><span class="comment">     * choose to create a message with only a subset of the headers given in</span></div>
<div class="line"><span class="lineno"> 1786</span><span class="comment">     * the URL.  */</span></div>
<div class="line"><span class="lineno"> 1787</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="#a779380b3b7d9a2948d1b21b99f2f9532">mailto_header_allowed</a>(tag, &amp;<a class="code hl_variable" href="email_2globals_8c.html#aa8be145875932a3f9ccbe4099892bced">MailToAllow</a>))</div>
<div class="line"><span class="lineno"> 1788</span>    {</div>
<div class="line"><span class="lineno"> 1789</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(tag, <span class="stringliteral">&quot;body&quot;</span>))</div>
<div class="line"><span class="lineno"> 1790</span>      {</div>
<div class="line"><span class="lineno"> 1791</span>        <span class="keywordflow">if</span> (body)</div>
<div class="line"><span class="lineno"> 1792</span>          <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(body, <a class="code hl_variable" href="structUrlQuery.html#a6e66e3d6d751fdadc6697177649a9dad">value</a>);</div>
<div class="line"><span class="lineno"> 1793</span>      }</div>
<div class="line"><span class="lineno"> 1794</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1795</span>      {</div>
<div class="line"><span class="lineno"> 1796</span>        <span class="keywordtype">char</span> *scratch = NULL;</div>
<div class="line"><span class="lineno"> 1797</span>        <span class="keywordtype">size_t</span> taglen = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(tag);</div>
<div class="line"><span class="lineno"> 1798</span> </div>
<div class="line"><span class="lineno"> 1799</span>        <a class="code hl_function" href="#aeb759563267cc1a4ee017738d8ee3013">mutt_filter_commandline_header_value</a>(<a class="code hl_variable" href="structUrlQuery.html#a6e66e3d6d751fdadc6697177649a9dad">value</a>);</div>
<div class="line"><span class="lineno"> 1800</span>        <a class="code hl_function" href="mutt_2string_8c.html#a4388c16988fac9a7596dee4d4af89595">mutt_str_asprintf</a>(&amp;scratch, <span class="stringliteral">&quot;%s: %s&quot;</span>, tag, <a class="code hl_variable" href="structUrlQuery.html#a6e66e3d6d751fdadc6697177649a9dad">value</a>);</div>
<div class="line"><span class="lineno"> 1801</span>        scratch[taglen] = 0; <span class="comment">/* overwrite the colon as mutt_rfc822_parse_line expects */</span></div>
<div class="line"><span class="lineno"> 1802</span>        <a class="code hl_variable" href="structUrlQuery.html#a6e66e3d6d751fdadc6697177649a9dad">value</a> = <a class="code hl_function" href="mutt_2string_8c.html#a5bc328ca69776d155059041aaff9435a">mutt_str_skip_email_wsp</a>(&amp;scratch[taglen + 1]);</div>
<div class="line"><span class="lineno"> 1803</span>        <a class="code hl_function" href="#a012cf883e316be91676a2f589b48f330">mutt_rfc822_parse_line</a>(env, NULL, scratch, taglen, <a class="code hl_variable" href="structUrlQuery.html#a6e66e3d6d751fdadc6697177649a9dad">value</a>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1804</span>        <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;scratch);</div>
<div class="line"><span class="lineno"> 1805</span>      }</div>
<div class="line"><span class="lineno"> 1806</span>    }</div>
<div class="line"><span class="lineno"> 1807</span>  }</div>
<div class="line"><span class="lineno"> 1808</span> </div>
<div class="line"><span class="lineno"> 1809</span>  <span class="comment">/* RFC2047 decode after the RFC822 parsing */</span></div>
<div class="line"><span class="lineno"> 1810</span>  <a class="code hl_function" href="rfc2047_8c.html#a79026f5cfec0b561058f7021e19b9601">rfc2047_decode_envelope</a>(env);</div>
<div class="line"><span class="lineno"> 1811</span> </div>
<div class="line"><span class="lineno"> 1812</span>  <a class="code hl_function" href="url_8c.html#a7b05825b8bb8f87657713fe5bc6edfaa">url_free</a>(&amp;url);</div>
<div class="line"><span class="lineno"> 1813</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1814</span>}</div>
<div class="ttc" id="aemail_2globals_8c_html_aa8be145875932a3f9ccbe4099892bced"><div class="ttname"><a href="email_2globals_8c.html#aa8be145875932a3f9ccbe4099892bced">MailToAllow</a></div><div class="ttdeci">struct ListHead MailToAllow</div><div class="ttdoc">List of regexes to identify non-spam emails.</div><div class="ttdef"><b>Definition</b> <a href="email_2globals_8c_source.html#l00042">globals.c:42</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a779380b3b7d9a2948d1b21b99f2f9532"><div class="ttname"><a href="#a779380b3b7d9a2948d1b21b99f2f9532">mailto_header_allowed</a></div><div class="ttdeci">static bool mailto_header_allowed(const char *s, struct ListHead *h)</div><div class="ttdoc">Is the string in the list.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01731">parse.c:1731</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_aa024a4cce886fe1fb4a32ed8f1b8d9b9"><div class="ttname"><a href="#aa024a4cce886fe1fb4a32ed8f1b8d9b9">mutt_filter_commandline_header_tag</a></div><div class="ttdeci">void mutt_filter_commandline_header_tag(char *header)</div><div class="ttdoc">Sanitise characters in a header tag.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00072">parse.c:72</a></div></div>
<div class="ttc" id="astructUrlQuery_html"><div class="ttname"><a href="structUrlQuery.html">UrlQuery</a></div><div class="ttdoc">Parsed Query String.</div><div class="ttdef"><b>Definition</b> <a href="url_8h_source.html#l00057">url.h:58</a></div></div>
<div class="ttc" id="astructUrlQuery_html_a5e84f8d3d31c6f77cd662a9db2bae336"><div class="ttname"><a href="structUrlQuery.html#a5e84f8d3d31c6f77cd662a9db2bae336">UrlQuery::name</a></div><div class="ttdeci">char * name</div><div class="ttdoc">Query name.</div><div class="ttdef"><b>Definition</b> <a href="url_8h_source.html#l00059">url.h:59</a></div></div>
<div class="ttc" id="astructUrlQuery_html_a6e66e3d6d751fdadc6697177649a9dad"><div class="ttname"><a href="structUrlQuery.html#a6e66e3d6d751fdadc6697177649a9dad">UrlQuery::value</a></div><div class="ttdeci">char * value</div><div class="ttdoc">Query value.</div><div class="ttdef"><b>Definition</b> <a href="url_8h_source.html#l00060">url.h:60</a></div></div>
<div class="ttc" id="astructUrl_html"><div class="ttname"><a href="structUrl.html">Url</a></div><div class="ttdoc">A parsed URL proto://user:password@host:port/path?a=1&amp;b=2</div><div class="ttdef"><b>Definition</b> <a href="url_8h_source.html#l00068">url.h:69</a></div></div>
<div class="ttc" id="astructUrl_html_a30ca5136a9649e6df583a48cbdee35d2"><div class="ttname"><a href="structUrl.html#a30ca5136a9649e6df583a48cbdee35d2">Url::query_strings</a></div><div class="ttdeci">struct UrlQueryList query_strings</div><div class="ttdoc">List of query strings.</div><div class="ttdef"><b>Definition</b> <a href="url_8h_source.html#l00076">url.h:76</a></div></div>
<div class="ttc" id="astructUrl_html_a565d3391c8b8114a97ad6f1b7c75b5f6"><div class="ttname"><a href="structUrl.html#a565d3391c8b8114a97ad6f1b7c75b5f6">Url::host</a></div><div class="ttdeci">char * host</div><div class="ttdoc">Host.</div><div class="ttdef"><b>Definition</b> <a href="url_8h_source.html#l00073">url.h:73</a></div></div>
<div class="ttc" id="astructUrl_html_a9e7df736f4e72353af3360b8e2b2c9cf"><div class="ttname"><a href="structUrl.html#a9e7df736f4e72353af3360b8e2b2c9cf">Url::src</a></div><div class="ttdeci">char * src</div><div class="ttdoc">Raw URL string.</div><div class="ttdef"><b>Definition</b> <a href="url_8h_source.html#l00077">url.h:77</a></div></div>
<div class="ttc" id="astructUrl_html_ad4b772878b40b204a7e91520b0bcbed4"><div class="ttname"><a href="structUrl.html#ad4b772878b40b204a7e91520b0bcbed4">Url::path</a></div><div class="ttdeci">char * path</div><div class="ttdoc">Path.</div><div class="ttdef"><b>Definition</b> <a href="url_8h_source.html#l00075">url.h:75</a></div></div>
<div class="ttc" id="aurl_8c_html_a3030b91052fa1a5fee0ca7b1d4d94f93"><div class="ttname"><a href="url_8c.html#a3030b91052fa1a5fee0ca7b1d4d94f93">url_parse</a></div><div class="ttdeci">struct Url * url_parse(const char *src)</div><div class="ttdoc">Fill in Url.</div><div class="ttdef"><b>Definition</b> <a href="url_8c_source.html#l00239">url.c:239</a></div></div>
<div class="ttc" id="aurl_8c_html_a7b05825b8bb8f87657713fe5bc6edfaa"><div class="ttname"><a href="url_8c.html#a7b05825b8bb8f87657713fe5bc6edfaa">url_free</a></div><div class="ttdeci">void url_free(struct Url **ptr)</div><div class="ttdoc">Free the contents of a URL.</div><div class="ttdef"><b>Definition</b> <a href="url_8c_source.html#l00124">url.c:124</a></div></div>
</div><!-- fragment --><div id="dynsection-45" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-45-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-45-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-45-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a85f5f11a70b04f611f3e131f67644fbf_cgraph.svg" width="827" height="668"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-46" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-46-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-46-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-46-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a85f5f11a70b04f611f3e131f67644fbf_icgraph.svg" width="530" height="142"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0b38ac4f44b3414d0e18d26324861369" name="a0b38ac4f44b3414d0e18d26324861369"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b38ac4f44b3414d0e18d26324861369">&#9670;&#160;</a></span>mutt_parse_part()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_parse_part </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a MIME part. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>File to read from </td></tr>
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> to store the results in </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l01821">1821</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1822</span>{</div>
<div class="line"><span class="lineno"> 1823</span>  <span class="keywordtype">int</span> counter = 0;</div>
<div class="line"><span class="lineno"> 1824</span> </div>
<div class="line"><span class="lineno"> 1825</span>  <a class="code hl_function" href="#aa9d682d64619becd7ca5e03de02f6f18">parse_part</a>(fp, b, &amp;counter);</div>
<div class="line"><span class="lineno"> 1826</span>}</div>
</div><!-- fragment --><div id="dynsection-47" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-47-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-47-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-47-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a0b38ac4f44b3414d0e18d26324861369_cgraph.svg" width="272" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-48" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-48-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-48-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-48-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a0b38ac4f44b3414d0e18d26324861369_icgraph.svg" width="398" height="414"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0a62f0f03006788df8c7bdd6f687457f" name="a0a62f0f03006788df8c7bdd6f687457f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a62f0f03006788df8c7bdd6f687457f">&#9670;&#160;</a></span>mutt_rfc822_parse_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structBody.html">Body</a> * mutt_rfc822_parse_message </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a Message/RFC822 body. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>Stream to read from </td></tr>
    <tr><td class="paramname">b</td><td>Info about the message/rfc822 body part </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>New <a class="el" href="structBody.html" title="The body of an email.">Body</a> containing parsed message</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This assumes that 'b-&gt;length' has been set! </dd></dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l01836">1836</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1837</span>{</div>
<div class="line"><span class="lineno"> 1838</span>  <span class="keywordtype">int</span> counter = 0;</div>
<div class="line"><span class="lineno"> 1839</span> </div>
<div class="line"><span class="lineno"> 1840</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="#a6f9e27e3cd898ef0935029da9c3dcefd">rfc822_parse_message</a>(fp, b, &amp;counter);</div>
<div class="line"><span class="lineno"> 1841</span>}</div>
</div><!-- fragment --><div id="dynsection-49" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-49-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-49-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-49-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a0a62f0f03006788df8c7bdd6f687457f_cgraph.svg" width="424" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-50" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-50-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-50-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-50-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a0a62f0f03006788df8c7bdd6f687457f_icgraph.svg" width="420" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a9c098e697548d0ad0809a1ac49b91f8e" name="a9c098e697548d0ad0809a1ac49b91f8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c098e697548d0ad0809a1ac49b91f8e">&#9670;&#160;</a></span>mutt_parse_multipart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structBody.html">Body</a> * mutt_parse_multipart </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>boundary</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LOFF_T</td>          <td class="paramname"><span class="paramname"><em>end_off</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>digest</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse a multipart structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>Stream to read from </td></tr>
    <tr><td class="paramname">boundary</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> separator </td></tr>
    <tr><td class="paramname">end_off</td><td>Length of the multipart body (used when the final boundary is missing to avoid reading too far) </td></tr>
    <tr><td class="paramname">digest</td><td>true if reading a multipart/digest </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>New <a class="el" href="structBody.html" title="The body of an email.">Body</a> containing parsed structure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="email_2parse_8c_source.html#l01852">1852</a> of file <a class="el" href="email_2parse_8c_source.html">parse.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1853</span>{</div>
<div class="line"><span class="lineno"> 1854</span>  <span class="keywordtype">int</span> counter = 0;</div>
<div class="line"><span class="lineno"> 1855</span> </div>
<div class="line"><span class="lineno"> 1856</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="#ac20b6c54dff7929453167e30d9dcc1a3">parse_multipart</a>(fp, boundary, end_off, digest, &amp;counter);</div>
<div class="line"><span class="lineno"> 1857</span>}</div>
</div><!-- fragment --><div id="dynsection-51" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-51-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-51-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-51-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a9c098e697548d0ad0809a1ac49b91f8e_cgraph.svg" width="334" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-52" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-52-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-52-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-52-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="email_2parse_8c_a9c098e697548d0ad0809a1ac49b91f8e_icgraph.svg" width="360" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
