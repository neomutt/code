<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: mutt/charset.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><a href="https://neomutt.org"><img alt="Logo" src="neomutt-64.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <a style="color: black; text-decoration: none;" href="https://neomutt.org">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">2025-09-05-43-g177ed6</span>
   </div>
   <div id="projectbrief">Teaching an old dog new tricks</div>
   </a>
   <a href="https://github.com/neomutt/neomutt" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000000; color:#fff; position: fixed; top: 0; border: 0; right: 0; z-index: 9999;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </td>
   <td><a style="text-decoration: none; position: absolute; right: 0; top: 25px; margin-right: 100px; color: #66d866; font-size: 400%;" href="http://www.doxygen.org/index.html">DOXYGEN</a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('mutt_2charset_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">charset.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Conversion between different character encodings.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;iconv.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for charset.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h__incl.svg" width="455" height="119"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h__dep__incl.svg" width="591" height="119"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="mutt_2charset_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structFgetConv.html">FgetConv</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cursor for converting a file's encoding.  <a href="structFgetConv.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7e8b71716e5c874b2997a2304be23081" id="r_a7e8b71716e5c874b2997a2304be23081"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7e8b71716e5c874b2997a2304be23081">MUTT_ICONV_NO_FLAGS</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a7e8b71716e5c874b2997a2304be23081"><td class="mdescLeft">&#160;</td><td class="mdescRight">No flags are set.  <br /></td></tr>
<tr class="separator:a7e8b71716e5c874b2997a2304be23081"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1807a22585916adccafa5e09bda9b6a7" id="r_a1807a22585916adccafa5e09bda9b6a7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1807a22585916adccafa5e09bda9b6a7">MUTT_ICONV_HOOK_FROM</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:a1807a22585916adccafa5e09bda9b6a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">apply charset-hooks to fromcode  <br /></td></tr>
<tr class="separator:a1807a22585916adccafa5e09bda9b6a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56cbec4a6366d637d41d151d10dc5b87" id="r_a56cbec4a6366d637d41d151d10dc5b87"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56cbec4a6366d637d41d151d10dc5b87">mutt_ch_is_utf8</a>(str)</td></tr>
<tr class="separator:a56cbec4a6366d637d41d151d10dc5b87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ef43eece2b49fd708887669f556a15b" id="r_a3ef43eece2b49fd708887669f556a15b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ef43eece2b49fd708887669f556a15b">mutt_ch_is_us_ascii</a>(str)</td></tr>
<tr class="separator:a3ef43eece2b49fd708887669f556a15b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a343b22f930dd486990858724937bb6cd" id="r_a343b22f930dd486990858724937bb6cd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a343b22f930dd486990858724937bb6cd">ICONV_T_INVALID</a>&#160;&#160;&#160;((iconv_t) -1)</td></tr>
<tr class="memdesc:a343b22f930dd486990858724937bb6cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error value for iconv functions.  <br /></td></tr>
<tr class="separator:a343b22f930dd486990858724937bb6cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa492c8da74811c680daecd5cc99fd506" id="r_aa492c8da74811c680daecd5cc99fd506"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa492c8da74811c680daecd5cc99fd506">ICONV_ILLEGAL_SEQ</a>&#160;&#160;&#160;((size_t) -1)</td></tr>
<tr class="memdesc:aa492c8da74811c680daecd5cc99fd506"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error value for iconv() - Illegal sequence.  <br /></td></tr>
<tr class="separator:aa492c8da74811c680daecd5cc99fd506"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4563ada344f551c4f386fc42127579a7" id="r_a4563ada344f551c4f386fc42127579a7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4563ada344f551c4f386fc42127579a7">ICONV_BUF_TOO_SMALL</a>&#160;&#160;&#160;((size_t) -2)</td></tr>
<tr class="memdesc:a4563ada344f551c4f386fc42127579a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error value for iconv() - <a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> too small.  <br /></td></tr>
<tr class="separator:a4563ada344f551c4f386fc42127579a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a677743e89f8cc2c57a0e6e91a47bdc4a" id="r_a677743e89f8cc2c57a0e6e91a47bdc4a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a677743e89f8cc2c57a0e6e91a47bdc4a">LookupType</a> { <a class="el" href="#a677743e89f8cc2c57a0e6e91a47bdc4aaf70d36a04a9e6e5ecd554392626886d4">MUTT_LOOKUP_CHARSET</a>
, <a class="el" href="#a677743e89f8cc2c57a0e6e91a47bdc4aadb54e12de4bd2494e86573e4728b4956">MUTT_LOOKUP_ICONV</a>
 }</td></tr>
<tr class="memdesc:a677743e89f8cc2c57a0e6e91a47bdc4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Types of character set lookups.  <a href="#a677743e89f8cc2c57a0e6e91a47bdc4a">More...</a><br /></td></tr>
<tr class="separator:a677743e89f8cc2c57a0e6e91a47bdc4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4b347dd75af05a18dbe328c354c18fe8" id="r_a4b347dd75af05a18dbe328c354c18fe8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4b347dd75af05a18dbe328c354c18fe8">mutt_ch_canonical_charset</a> (char *buf, size_t buflen, const char *name)</td></tr>
<tr class="memdesc:a4b347dd75af05a18dbe328c354c18fe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Canonicalise the charset of a string.  <br /></td></tr>
<tr class="separator:a4b347dd75af05a18dbe328c354c18fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82415c52a83b63f4a8ce5110e86525a2" id="r_a82415c52a83b63f4a8ce5110e86525a2"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a82415c52a83b63f4a8ce5110e86525a2">mutt_ch_charset_lookup</a> (const char *chs)</td></tr>
<tr class="memdesc:a82415c52a83b63f4a8ce5110e86525a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Look for a replacement character set.  <br /></td></tr>
<tr class="separator:a82415c52a83b63f4a8ce5110e86525a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81959a5c114f585575d5116c50a51638" id="r_a81959a5c114f585575d5116c50a51638"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a81959a5c114f585575d5116c50a51638">mutt_ch_check</a> (const char *s, size_t slen, const char *from, const char *to)</td></tr>
<tr class="memdesc:a81959a5c114f585575d5116c50a51638"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether a string can be converted between encodings.  <br /></td></tr>
<tr class="separator:a81959a5c114f585575d5116c50a51638"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05daa8adc69c533f5ab46ae98a2b71bc" id="r_a05daa8adc69c533f5ab46ae98a2b71bc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a05daa8adc69c533f5ab46ae98a2b71bc">mutt_ch_check_charset</a> (const char *cs, bool strict)</td></tr>
<tr class="memdesc:a05daa8adc69c533f5ab46ae98a2b71bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does iconv understand a character set?  <br /></td></tr>
<tr class="separator:a05daa8adc69c533f5ab46ae98a2b71bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a285a4fac32f6564ee4682edec23142fe" id="r_a285a4fac32f6564ee4682edec23142fe"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a285a4fac32f6564ee4682edec23142fe">mutt_ch_choose</a> (const char *fromcode, const struct <a class="el" href="structSlist.html">Slist</a> *charsets, const char *u, size_t ulen, char **d, size_t *dlen)</td></tr>
<tr class="memdesc:a285a4fac32f6564ee4682edec23142fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Figure the best charset to encode a string.  <br /></td></tr>
<tr class="separator:a285a4fac32f6564ee4682edec23142fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea5561f6489bbbbdfcdfb29e6f22b688" id="r_aea5561f6489bbbbdfcdfb29e6f22b688"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aea5561f6489bbbbdfcdfb29e6f22b688">mutt_ch_chscmp</a> (const char *cs1, const char *cs2)</td></tr>
<tr class="memdesc:aea5561f6489bbbbdfcdfb29e6f22b688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Are the names of two character sets equivalent?  <br /></td></tr>
<tr class="separator:aea5561f6489bbbbdfcdfb29e6f22b688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a328973bb86fd341ba82021d540c0cc0b" id="r_a328973bb86fd341ba82021d540c0cc0b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a328973bb86fd341ba82021d540c0cc0b">mutt_ch_convert_nonmime_string</a> (const struct <a class="el" href="structSlist.html">Slist</a> *const assumed_charset, const char *charset, char **ps)</td></tr>
<tr class="memdesc:a328973bb86fd341ba82021d540c0cc0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to convert a string using a list of character sets.  <br /></td></tr>
<tr class="separator:a328973bb86fd341ba82021d540c0cc0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6304403ed915a40228aeda4082920a42" id="r_a6304403ed915a40228aeda4082920a42"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6304403ed915a40228aeda4082920a42">mutt_ch_convert_string</a> (char **ps, const char *from, const char *to, uint8_t flags)</td></tr>
<tr class="memdesc:a6304403ed915a40228aeda4082920a42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a string between encodings.  <br /></td></tr>
<tr class="separator:a6304403ed915a40228aeda4082920a42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90191f2589de2c605dd8c13b496ad3e1" id="r_a90191f2589de2c605dd8c13b496ad3e1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a90191f2589de2c605dd8c13b496ad3e1">mutt_ch_fgetconv</a> (struct <a class="el" href="structFgetConv.html">FgetConv</a> *fc)</td></tr>
<tr class="memdesc:a90191f2589de2c605dd8c13b496ad3e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a file's character set.  <br /></td></tr>
<tr class="separator:a90191f2589de2c605dd8c13b496ad3e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3ab5375dc558a241b9e0d5787954dc5" id="r_af3ab5375dc558a241b9e0d5787954dc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af3ab5375dc558a241b9e0d5787954dc5">mutt_ch_fgetconv_close</a> (struct <a class="el" href="structFgetConv.html">FgetConv</a> **ptr)</td></tr>
<tr class="memdesc:af3ab5375dc558a241b9e0d5787954dc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close an fgetconv handle.  <br /></td></tr>
<tr class="separator:af3ab5375dc558a241b9e0d5787954dc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf9480125d36a09af9c0e5c8c13eaed1" id="r_acf9480125d36a09af9c0e5c8c13eaed1"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structFgetConv.html">FgetConv</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf9480125d36a09af9c0e5c8c13eaed1">mutt_ch_fgetconv_open</a> (FILE *fp, const char *from, const char *to, uint8_t flags)</td></tr>
<tr class="memdesc:acf9480125d36a09af9c0e5c8c13eaed1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare a file for charset conversion.  <br /></td></tr>
<tr class="separator:acf9480125d36a09af9c0e5c8c13eaed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ccef550daaa86a0276dbfae78a1c1a" id="r_ae9ccef550daaa86a0276dbfae78a1c1a"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae9ccef550daaa86a0276dbfae78a1c1a">mutt_ch_fgetconvs</a> (char *buf, size_t buflen, struct <a class="el" href="structFgetConv.html">FgetConv</a> *fc)</td></tr>
<tr class="memdesc:ae9ccef550daaa86a0276dbfae78a1c1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert a file's charset into a string buffer.  <br /></td></tr>
<tr class="separator:ae9ccef550daaa86a0276dbfae78a1c1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af919f6cab94a1ff6ba6fa6b9b9c2f8f8" id="r_af919f6cab94a1ff6ba6fa6b9b9c2f8f8"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af919f6cab94a1ff6ba6fa6b9b9c2f8f8">mutt_ch_get_default_charset</a> (const struct <a class="el" href="structSlist.html">Slist</a> *const assumed_charset)</td></tr>
<tr class="memdesc:af919f6cab94a1ff6ba6fa6b9b9c2f8f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the default character set.  <br /></td></tr>
<tr class="separator:af919f6cab94a1ff6ba6fa6b9b9c2f8f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4406d5ba8ac279c5060e81257320b165" id="r_a4406d5ba8ac279c5060e81257320b165"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4406d5ba8ac279c5060e81257320b165">mutt_ch_get_langinfo_charset</a> (void)</td></tr>
<tr class="memdesc:a4406d5ba8ac279c5060e81257320b165"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the user's choice of character set.  <br /></td></tr>
<tr class="separator:a4406d5ba8ac279c5060e81257320b165"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a161c342ed0b417b1f931b15463fe091b" id="r_a161c342ed0b417b1f931b15463fe091b"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a161c342ed0b417b1f931b15463fe091b">mutt_ch_iconv</a> (iconv_t cd, const char **inbuf, size_t *inbytesleft, char **outbuf, size_t *outbytesleft, const char **inrepls, const char *outrepl, int *iconverrno)</td></tr>
<tr class="memdesc:a161c342ed0b417b1f931b15463fe091b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the encoding of a string.  <br /></td></tr>
<tr class="separator:a161c342ed0b417b1f931b15463fe091b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54a6b32746302571e3a61b1daa22c512" id="r_a54a6b32746302571e3a61b1daa22c512"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a54a6b32746302571e3a61b1daa22c512">mutt_ch_iconv_lookup</a> (const char *chs)</td></tr>
<tr class="memdesc:a54a6b32746302571e3a61b1daa22c512"><td class="mdescLeft">&#160;</td><td class="mdescRight">Look for a replacement character set.  <br /></td></tr>
<tr class="separator:a54a6b32746302571e3a61b1daa22c512"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7380ef31de4a56ab644b71f0a010ed9" id="r_af7380ef31de4a56ab644b71f0a010ed9"><td class="memItemLeft" align="right" valign="top">iconv_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7380ef31de4a56ab644b71f0a010ed9">mutt_ch_iconv_open</a> (const char *tocode, const char *fromcode, uint8_t flags)</td></tr>
<tr class="memdesc:af7380ef31de4a56ab644b71f0a010ed9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up iconv for conversions.  <br /></td></tr>
<tr class="separator:af7380ef31de4a56ab644b71f0a010ed9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a495d768c7996bc40c64980efbbb191c8" id="r_a495d768c7996bc40c64980efbbb191c8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a495d768c7996bc40c64980efbbb191c8">mutt_ch_lookup_add</a> (enum <a class="el" href="#a677743e89f8cc2c57a0e6e91a47bdc4a">LookupType</a> type, const char *pat, const char *replace, struct <a class="el" href="structBuffer.html">Buffer</a> *err)</td></tr>
<tr class="memdesc:a495d768c7996bc40c64980efbbb191c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a new character set lookup.  <br /></td></tr>
<tr class="separator:a495d768c7996bc40c64980efbbb191c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b4218535731ab6b94715522af613e00" id="r_a1b4218535731ab6b94715522af613e00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1b4218535731ab6b94715522af613e00">mutt_ch_lookup_remove</a> (void)</td></tr>
<tr class="memdesc:a1b4218535731ab6b94715522af613e00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove all the character set lookups.  <br /></td></tr>
<tr class="separator:a1b4218535731ab6b94715522af613e00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bb46d6d31e21e8390de490c5894bfda" id="r_a7bb46d6d31e21e8390de490c5894bfda"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7bb46d6d31e21e8390de490c5894bfda">mutt_ch_set_charset</a> (const char *charset)</td></tr>
<tr class="memdesc:a7bb46d6d31e21e8390de490c5894bfda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the records for a new character set.  <br /></td></tr>
<tr class="separator:a7bb46d6d31e21e8390de490c5894bfda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52a634eff18853e0a34a06876717fa4c" id="r_a52a634eff18853e0a34a06876717fa4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a52a634eff18853e0a34a06876717fa4c">mutt_ch_cache_cleanup</a> (void)</td></tr>
<tr class="memdesc:a52a634eff18853e0a34a06876717fa4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up the cached iconv handles and charset strings.  <br /></td></tr>
<tr class="separator:a52a634eff18853e0a34a06876717fa4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af99f0dca1b479b94f1287bc8aa050e4c" id="r_af99f0dca1b479b94f1287bc8aa050e4c"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a> (const iconv_t cd)</td></tr>
<tr class="memdesc:af99f0dca1b479b94f1287bc8aa050e4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is the conversion descriptor valid?  <br /></td></tr>
<tr class="separator:af99f0dca1b479b94f1287bc8aa050e4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7bcd93869f482805be7e6d437d29f54d" id="r_a7bcd93869f482805be7e6d437d29f54d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7bcd93869f482805be7e6d437d29f54d">CharsetIsUtf8</a></td></tr>
<tr class="memdesc:a7bcd93869f482805be7e6d437d29f54d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is the user's current character set utf-8?  <br /></td></tr>
<tr class="separator:a7bcd93869f482805be7e6d437d29f54d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac31e11b5fb12abda40361188af9105ef" id="r_ac31e11b5fb12abda40361188af9105ef"><td class="memItemLeft" align="right" valign="top">wchar_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac31e11b5fb12abda40361188af9105ef">ReplacementChar</a></td></tr>
<tr class="memdesc:ac31e11b5fb12abda40361188af9105ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">When a Unicode character can't be displayed, use this instead.  <br /></td></tr>
<tr class="separator:ac31e11b5fb12abda40361188af9105ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Conversion between different character encodings. </p>
<dl class="section author"><dt>Authors</dt><dd><ul>
<li>Richard Russon</li>
<li>Pietro Cerutti</li>
</ul>
</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 2 of the License, or (at your option) any later version.</dd></dl>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>

<p class="definition">Definition in file <a class="el" href="mutt_2charset_8h_source.html">charset.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a7e8b71716e5c874b2997a2304be23081" name="a7e8b71716e5c874b2997a2304be23081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e8b71716e5c874b2997a2304be23081">&#9670;&#160;</a></span>MUTT_ICONV_NO_FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MUTT_ICONV_NO_FLAGS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>No flags are set. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8h_source.html#l00064">64</a> of file <a class="el" href="mutt_2charset_8h_source.html">charset.h</a>.</p>

</div>
</div>
<a id="a1807a22585916adccafa5e09bda9b6a7" name="a1807a22585916adccafa5e09bda9b6a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1807a22585916adccafa5e09bda9b6a7">&#9670;&#160;</a></span>MUTT_ICONV_HOOK_FROM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MUTT_ICONV_HOOK_FROM&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>apply charset-hooks to fromcode </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8h_source.html#l00065">65</a> of file <a class="el" href="mutt_2charset_8h_source.html">charset.h</a>.</p>

</div>
</div>
<a id="a56cbec4a6366d637d41d151d10dc5b87" name="a56cbec4a6366d637d41d151d10dc5b87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56cbec4a6366d637d41d151d10dc5b87">&#9670;&#160;</a></span>mutt_ch_is_utf8</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mutt_ch_is_utf8</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>str</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><a class="code hl_function" href="mutt_2charset_8c.html#aea5561f6489bbbbdfcdfb29e6f22b688">mutt_ch_chscmp</a>(str, <span class="stringliteral">&quot;utf-8&quot;</span>)</div>
<div class="ttc" id="amutt_2charset_8c_html_aea5561f6489bbbbdfcdfb29e6f22b688"><div class="ttname"><a href="mutt_2charset_8c.html#aea5561f6489bbbbdfcdfb29e6f22b688">mutt_ch_chscmp</a></div><div class="ttdeci">bool mutt_ch_chscmp(const char *cs1, const char *cs2)</div><div class="ttdoc">Are the names of two character sets equivalent?</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00442">charset.c:442</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="mutt_2charset_8h_source.html#l00089">89</a> of file <a class="el" href="mutt_2charset_8h_source.html">charset.h</a>.</p>

</div>
</div>
<a id="a3ef43eece2b49fd708887669f556a15b" name="a3ef43eece2b49fd708887669f556a15b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ef43eece2b49fd708887669f556a15b">&#9670;&#160;</a></span>mutt_ch_is_us_ascii</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mutt_ch_is_us_ascii</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>str</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><a class="code hl_function" href="mutt_2charset_8c.html#aea5561f6489bbbbdfcdfb29e6f22b688">mutt_ch_chscmp</a>(str, <span class="stringliteral">&quot;us-ascii&quot;</span>)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="mutt_2charset_8h_source.html#l00090">90</a> of file <a class="el" href="mutt_2charset_8h_source.html">charset.h</a>.</p>

</div>
</div>
<a id="a343b22f930dd486990858724937bb6cd" name="a343b22f930dd486990858724937bb6cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a343b22f930dd486990858724937bb6cd">&#9670;&#160;</a></span>ICONV_T_INVALID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ICONV_T_INVALID&#160;&#160;&#160;((iconv_t) -1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error value for iconv functions. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8h_source.html#l00093">93</a> of file <a class="el" href="mutt_2charset_8h_source.html">charset.h</a>.</p>

</div>
</div>
<a id="aa492c8da74811c680daecd5cc99fd506" name="aa492c8da74811c680daecd5cc99fd506"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa492c8da74811c680daecd5cc99fd506">&#9670;&#160;</a></span>ICONV_ILLEGAL_SEQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ICONV_ILLEGAL_SEQ&#160;&#160;&#160;((size_t) -1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error value for iconv() - Illegal sequence. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8h_source.html#l00096">96</a> of file <a class="el" href="mutt_2charset_8h_source.html">charset.h</a>.</p>

</div>
</div>
<a id="a4563ada344f551c4f386fc42127579a7" name="a4563ada344f551c4f386fc42127579a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4563ada344f551c4f386fc42127579a7">&#9670;&#160;</a></span>ICONV_BUF_TOO_SMALL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ICONV_BUF_TOO_SMALL&#160;&#160;&#160;((size_t) -2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error value for iconv() - <a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> too small. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8h_source.html#l00098">98</a> of file <a class="el" href="mutt_2charset_8h_source.html">charset.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a677743e89f8cc2c57a0e6e91a47bdc4a" name="a677743e89f8cc2c57a0e6e91a47bdc4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a677743e89f8cc2c57a0e6e91a47bdc4a">&#9670;&#160;</a></span>LookupType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a677743e89f8cc2c57a0e6e91a47bdc4a">LookupType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Types of character set lookups. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a677743e89f8cc2c57a0e6e91a47bdc4aaf70d36a04a9e6e5ecd554392626886d4" name="a677743e89f8cc2c57a0e6e91a47bdc4aaf70d36a04a9e6e5ecd554392626886d4"></a>MUTT_LOOKUP_CHARSET&#160;</td><td class="fielddoc"><p><a class="el" href="structAlias.html" title="A shortcut for an email address or addresses.">Alias</a> for another character set. </p>
</td></tr>
<tr><td class="fieldname"><a id="a677743e89f8cc2c57a0e6e91a47bdc4aadb54e12de4bd2494e86573e4728b4956" name="a677743e89f8cc2c57a0e6e91a47bdc4aadb54e12de4bd2494e86573e4728b4956"></a>MUTT_LOOKUP_ICONV&#160;</td><td class="fielddoc"><p>Character set conversion. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8h_source.html#l00058">58</a> of file <a class="el" href="mutt_2charset_8h_source.html">charset.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   59</span>{</div>
<div class="line"><span class="lineno">   60</span>  <a class="code hl_enumvalue" href="#a677743e89f8cc2c57a0e6e91a47bdc4aaf70d36a04a9e6e5ecd554392626886d4">MUTT_LOOKUP_CHARSET</a>, </div>
<div class="line"><span class="lineno">   61</span>  <a class="code hl_enumvalue" href="#a677743e89f8cc2c57a0e6e91a47bdc4aadb54e12de4bd2494e86573e4728b4956">MUTT_LOOKUP_ICONV</a>,   </div>
<div class="line"><span class="lineno">   62</span>};</div>
<div class="ttc" id="amutt_2charset_8h_html_a677743e89f8cc2c57a0e6e91a47bdc4aadb54e12de4bd2494e86573e4728b4956"><div class="ttname"><a href="#a677743e89f8cc2c57a0e6e91a47bdc4aadb54e12de4bd2494e86573e4728b4956">MUTT_LOOKUP_ICONV</a></div><div class="ttdeci">@ MUTT_LOOKUP_ICONV</div><div class="ttdoc">Character set conversion.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00061">charset.h:61</a></div></div>
<div class="ttc" id="amutt_2charset_8h_html_a677743e89f8cc2c57a0e6e91a47bdc4aaf70d36a04a9e6e5ecd554392626886d4"><div class="ttname"><a href="#a677743e89f8cc2c57a0e6e91a47bdc4aaf70d36a04a9e6e5ecd554392626886d4">MUTT_LOOKUP_CHARSET</a></div><div class="ttdeci">@ MUTT_LOOKUP_CHARSET</div><div class="ttdoc">Alias for another character set.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00060">charset.h:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4b347dd75af05a18dbe328c354c18fe8" name="a4b347dd75af05a18dbe328c354c18fe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b347dd75af05a18dbe328c354c18fe8">&#9670;&#160;</a></span>mutt_ch_canonical_charset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_ch_canonical_charset </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>buflen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Canonicalise the charset of a string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td><a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> for canonical character set name </td></tr>
    <tr><td class="paramname">buflen</td><td>Length of buffer </td></tr>
    <tr><td class="paramname">name</td><td>Name to be canonicalised</td></tr>
  </table>
  </dd>
</dl>
<p>This first ties off any charset extension such as "//TRANSLIT", canonicalizes the charset and re-adds the extension </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00374">374</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  375</span>{</div>
<div class="line"><span class="lineno">  376</span>  <span class="keywordflow">if</span> (!buf || !name)</div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>  <span class="keywordtype">char</span> in[1024] = { 0 };</div>
<div class="line"><span class="lineno">  380</span>  <span class="keywordtype">char</span> scratch[1024 + 10] = { 0 };</div>
<div class="line"><span class="lineno">  381</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *canon = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>  <a class="code hl_function" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(in, name, <span class="keyword">sizeof</span>(in));</div>
<div class="line"><span class="lineno">  384</span>  <span class="keywordtype">char</span> *ext = strchr(in, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  385</span>  <span class="keywordflow">if</span> (ext)</div>
<div class="line"><span class="lineno">  386</span>    *ext++ = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(in, <span class="stringliteral">&quot;utf-8&quot;</span>) || <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(in, <span class="stringliteral">&quot;utf8&quot;</span>))</div>
<div class="line"><span class="lineno">  389</span>  {</div>
<div class="line"><span class="lineno">  390</span>    <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(canon, <span class="stringliteral">&quot;utf-8&quot;</span>);</div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno">  392</span>  }</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>  <span class="comment">/* catch some common iso-8859-something misspellings */</span></div>
<div class="line"><span class="lineno">  395</span>  <span class="keywordtype">size_t</span> plen;</div>
<div class="line"><span class="lineno">  396</span>  <span class="keywordflow">if</span> ((plen = <a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(in, <span class="stringliteral">&quot;8859&quot;</span>)) &amp;&amp; (in[plen] != <span class="charliteral">&#39;-&#39;</span>))</div>
<div class="line"><span class="lineno">  397</span>    snprintf(scratch, <span class="keyword">sizeof</span>(scratch), <span class="stringliteral">&quot;iso-8859-%s&quot;</span>, in + plen);</div>
<div class="line"><span class="lineno">  398</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((plen = <a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(in, <span class="stringliteral">&quot;8859-&quot;</span>)))</div>
<div class="line"><span class="lineno">  399</span>    snprintf(scratch, <span class="keyword">sizeof</span>(scratch), <span class="stringliteral">&quot;iso-8859-%s&quot;</span>, in + plen);</div>
<div class="line"><span class="lineno">  400</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((plen = <a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(in, <span class="stringliteral">&quot;iso8859&quot;</span>)) &amp;&amp; (in[plen] != <span class="charliteral">&#39;-&#39;</span>))</div>
<div class="line"><span class="lineno">  401</span>    snprintf(scratch, <span class="keyword">sizeof</span>(scratch), <span class="stringliteral">&quot;iso_8859-%s&quot;</span>, in + plen);</div>
<div class="line"><span class="lineno">  402</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((plen = <a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(in, <span class="stringliteral">&quot;iso8859-&quot;</span>)))</div>
<div class="line"><span class="lineno">  403</span>    snprintf(scratch, <span class="keyword">sizeof</span>(scratch), <span class="stringliteral">&quot;iso_8859-%s&quot;</span>, in + plen);</div>
<div class="line"><span class="lineno">  404</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  405</span>    <a class="code hl_function" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(scratch, in, <span class="keyword">sizeof</span>(scratch));</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; <a class="code hl_variable" href="mutt_2charset_8c.html#a47beed716c9bc8caa77714aeb8a20d7f">PreferredMimeNames</a>[i].key; i++)</div>
<div class="line"><span class="lineno">  408</span>  {</div>
<div class="line"><span class="lineno">  409</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(scratch, <a class="code hl_variable" href="mutt_2charset_8c.html#a47beed716c9bc8caa77714aeb8a20d7f">PreferredMimeNames</a>[i].key))</div>
<div class="line"><span class="lineno">  410</span>    {</div>
<div class="line"><span class="lineno">  411</span>      <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(canon, <a class="code hl_variable" href="mutt_2charset_8c.html#a47beed716c9bc8caa77714aeb8a20d7f">PreferredMimeNames</a>[i].pref);</div>
<div class="line"><span class="lineno">  412</span>      <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno">  413</span>    }</div>
<div class="line"><span class="lineno">  414</span>  }</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>  <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(canon, scratch);</div>
<div class="line"><span class="lineno">  417</span>  <a class="code hl_function" href="buffer_8c.html#adb0a54db83f68bc183a8c66eaf985b61">buf_lower</a>(canon); <span class="comment">// for cosmetics&#39; sake</span></div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>out:</div>
<div class="line"><span class="lineno">  420</span>  <span class="keywordflow">if</span> (ext &amp;&amp; (*ext != <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line"><span class="lineno">  421</span>  {</div>
<div class="line"><span class="lineno">  422</span>    <a class="code hl_function" href="buffer_8c.html#a9765efbb7f2c32e46fb1cb271a02ba20">buf_addch</a>(canon, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  423</span>    <a class="code hl_function" href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a>(canon, ext);</div>
<div class="line"><span class="lineno">  424</span>  }</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>  <a class="code hl_function" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(buf, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(canon), buflen);</div>
<div class="line"><span class="lineno">  427</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;canon);</div>
<div class="line"><span class="lineno">  428</span>}</div>
<div class="ttc" id="abuffer_8c_html_a9765efbb7f2c32e46fb1cb271a02ba20"><div class="ttname"><a href="buffer_8c.html#a9765efbb7f2c32e46fb1cb271a02ba20">buf_addch</a></div><div class="ttdeci">size_t buf_addch(struct Buffer *buf, char c)</div><div class="ttdoc">Add a single character to a Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00241">buffer.c:241</a></div></div>
<div class="ttc" id="abuffer_8c_html_a9924e74ddcb5280ab380e4627d1fba99"><div class="ttname"><a href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a></div><div class="ttdeci">size_t buf_addstr(struct Buffer *buf, const char *s)</div><div class="ttdoc">Add a string to a Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00226">buffer.c:226</a></div></div>
<div class="ttc" id="abuffer_8c_html_ac958acbd189e463a2c3bbc2f23aaeb1e"><div class="ttname"><a href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a></div><div class="ttdeci">size_t buf_strcpy(struct Buffer *buf, const char *s)</div><div class="ttdoc">Copy a string into a Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00395">buffer.c:395</a></div></div>
<div class="ttc" id="abuffer_8c_html_adb0a54db83f68bc183a8c66eaf985b61"><div class="ttname"><a href="buffer_8c.html#adb0a54db83f68bc183a8c66eaf985b61">buf_lower</a></div><div class="ttdeci">void buf_lower(struct Buffer *buf)</div><div class="ttdoc">Sets a buffer to lowercase.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00734">buffer.c:734</a></div></div>
<div class="ttc" id="abuffer_8h_html_a728ebc5a947b77c8d56db44ce553a7ab"><div class="ttname"><a href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a></div><div class="ttdeci">static const char * buf_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00096">buffer.h:96</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_a47beed716c9bc8caa77714aeb8a20d7f"><div class="ttname"><a href="mutt_2charset_8c.html#a47beed716c9bc8caa77714aeb8a20d7f">PreferredMimeNames</a></div><div class="ttdeci">static const struct MimeNames PreferredMimeNames[]</div><div class="ttdoc">Lookup table of preferred charsets.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00121">charset.c:121</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00672">string.c:672</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_ad20e00309de897a1e882fc7400335b83"><div class="ttname"><a href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a></div><div class="ttdeci">size_t mutt_str_copy(char *dest, const char *src, size_t dsize)</div><div class="ttdoc">Copy a string into a buffer (guaranteeing NUL-termination)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00581">string.c:581</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_aebd2a8a3f8a30062c31fa1474d87cc41"><div class="ttname"><a href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a></div><div class="ttdeci">size_t mutt_istr_startswith(const char *str, const char *prefix)</div><div class="ttdoc">Check whether a string starts with a prefix, ignoring case.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00244">string.c:244</a></div></div>
<div class="ttc" id="apool_8c_html_a41cba27c25d33cb6822789a2856093f2"><div class="ttname"><a href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a></div><div class="ttdeci">struct Buffer * buf_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00082">pool.c:82</a></div></div>
<div class="ttc" id="apool_8c_html_a4cc6068279461cb8628219586dfa35a1"><div class="ttname"><a href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a></div><div class="ttdeci">void buf_pool_release(struct Buffer **ptr)</div><div class="ttdoc">Return a Buffer to the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00096">pool.c:96</a></div></div>
<div class="ttc" id="astructBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00035">buffer.h:36</a></div></div>
</div><!-- fragment --><div id="dynsection-2" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a4b347dd75af05a18dbe328c354c18fe8_cgraph.svg" width="526" height="542"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-3" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a4b347dd75af05a18dbe328c354c18fe8_icgraph.svg" width="412" height="432"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a82415c52a83b63f4a8ce5110e86525a2" name="a82415c52a83b63f4a8ce5110e86525a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82415c52a83b63f4a8ce5110e86525a2">&#9670;&#160;</a></span>mutt_ch_charset_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * mutt_ch_charset_lookup </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>chs</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Look for a replacement character set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chs</td><td>Character set to lookup </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Replacement character set (if a 'charset-hook' matches) </td></tr>
    <tr><td class="paramname">NULL</td><td>No matching hook</td></tr>
  </table>
  </dd>
</dl>
<p>Look through all the 'charset-hook's. If one matches return the replacement character set. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00562">562</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  563</span>{</div>
<div class="line"><span class="lineno">  564</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="mutt_2charset_8c.html#a7f43e095c200569d3434021bc8ce13d1">lookup_charset</a>(<a class="code hl_enumvalue" href="#a677743e89f8cc2c57a0e6e91a47bdc4aaf70d36a04a9e6e5ecd554392626886d4">MUTT_LOOKUP_CHARSET</a>, chs);</div>
<div class="line"><span class="lineno">  565</span>}</div>
<div class="ttc" id="amutt_2charset_8c_html_a7f43e095c200569d3434021bc8ce13d1"><div class="ttname"><a href="mutt_2charset_8c.html#a7f43e095c200569d3434021bc8ce13d1">lookup_charset</a></div><div class="ttdeci">static const char * lookup_charset(enum LookupType type, const char *cs)</div><div class="ttdoc">Look for a preferred character set name.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00303">charset.c:303</a></div></div>
</div><!-- fragment --><div id="dynsection-4" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a82415c52a83b63f4a8ce5110e86525a2_cgraph.svg" width="346" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-5" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a82415c52a83b63f4a8ce5110e86525a2_icgraph.svg" width="378" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a81959a5c114f585575d5116c50a51638" name="a81959a5c114f585575d5116c50a51638"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81959a5c114f585575d5116c50a51638">&#9670;&#160;</a></span>mutt_ch_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_ch_check </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>slen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>from</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>to</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check whether a string can be converted between encodings. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>String to check </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slen</td><td>Length of the string to check </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">from</td><td>Current character set </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to</td><td>Target character set </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error in iconv_open() </td></tr>
    <tr><td class="paramname">&gt;0</td><td>Errno as set by iconv() </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00796">796</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  797</span>{</div>
<div class="line"><span class="lineno">  798</span>  <span class="keywordflow">if</span> (!s || !from || !to)</div>
<div class="line"><span class="lineno">  799</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  800</span> </div>
<div class="line"><span class="lineno">  801</span>  <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><span class="lineno">  802</span>  iconv_t cd = <a class="code hl_function" href="mutt_2charset_8c.html#af7380ef31de4a56ab644b71f0a010ed9">mutt_ch_iconv_open</a>(to, from, <a class="code hl_define" href="#a7e8b71716e5c874b2997a2304be23081">MUTT_ICONV_NO_FLAGS</a>);</div>
<div class="line"><span class="lineno">  803</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a>(cd))</div>
<div class="line"><span class="lineno">  804</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  805</span> </div>
<div class="line"><span class="lineno">  806</span>  <span class="keywordtype">size_t</span> outlen = MB_LEN_MAX * slen;</div>
<div class="line"><span class="lineno">  807</span>  <span class="keywordtype">char</span> *out = <a class="code hl_define" href="memory_8h.html#af997cb3719dc7abbeabae655d0ee1b9e">MUTT_MEM_MALLOC</a>(outlen + 1, <span class="keywordtype">char</span>);</div>
<div class="line"><span class="lineno">  808</span>  <span class="keywordtype">char</span> *saved_out = out;</div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> convlen = iconv(cd, (ICONV_CONST <span class="keywordtype">char</span> **) &amp;s, &amp;slen, &amp;out, &amp;outlen);</div>
<div class="line"><span class="lineno">  811</span>  <span class="keywordflow">if</span> (convlen == <a class="code hl_define" href="#aa492c8da74811c680daecd5cc99fd506">ICONV_ILLEGAL_SEQ</a>)</div>
<div class="line"><span class="lineno">  812</span>    rc = errno;</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;saved_out);</div>
<div class="line"><span class="lineno">  815</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  816</span>}</div>
<div class="ttc" id="amemory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00062">memory.h:62</a></div></div>
<div class="ttc" id="amemory_8h_html_af997cb3719dc7abbeabae655d0ee1b9e"><div class="ttname"><a href="memory_8h.html#af997cb3719dc7abbeabae655d0ee1b9e">MUTT_MEM_MALLOC</a></div><div class="ttdeci">#define MUTT_MEM_MALLOC(n, type)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00048">memory.h:48</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_af7380ef31de4a56ab644b71f0a010ed9"><div class="ttname"><a href="mutt_2charset_8c.html#af7380ef31de4a56ab644b71f0a010ed9">mutt_ch_iconv_open</a></div><div class="ttdeci">iconv_t mutt_ch_iconv_open(const char *tocode, const char *fromcode, uint8_t flags)</div><div class="ttdoc">Set up iconv for conversions.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00594">charset.c:594</a></div></div>
<div class="ttc" id="amutt_2charset_8h_html_a7e8b71716e5c874b2997a2304be23081"><div class="ttname"><a href="#a7e8b71716e5c874b2997a2304be23081">MUTT_ICONV_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_ICONV_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00064">charset.h:64</a></div></div>
<div class="ttc" id="amutt_2charset_8h_html_aa492c8da74811c680daecd5cc99fd506"><div class="ttname"><a href="#aa492c8da74811c680daecd5cc99fd506">ICONV_ILLEGAL_SEQ</a></div><div class="ttdeci">#define ICONV_ILLEGAL_SEQ</div><div class="ttdoc">Error value for iconv() - Illegal sequence.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00096">charset.h:96</a></div></div>
<div class="ttc" id="amutt_2charset_8h_html_af99f0dca1b479b94f1287bc8aa050e4c"><div class="ttname"><a href="#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a></div><div class="ttdeci">static bool iconv_t_valid(const iconv_t cd)</div><div class="ttdoc">Is the conversion descriptor valid?</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00105">charset.h:105</a></div></div>
</div><!-- fragment --><div id="dynsection-6" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a81959a5c114f585575d5116c50a51638_cgraph.svg" width="466" height="66"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-7" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a81959a5c114f585575d5116c50a51638_icgraph.svg" width="292" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a05daa8adc69c533f5ab46ae98a2b71bc" name="a05daa8adc69c533f5ab46ae98a2b71bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05daa8adc69c533f5ab46ae98a2b71bc">&#9670;&#160;</a></span>mutt_ch_check_charset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mutt_ch_check_charset </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>cs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>strict</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does iconv understand a character set? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cs</td><td>Character set to check </td></tr>
    <tr><td class="paramname">strict</td><td>Check strictly by using iconv </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Character set is valid</td></tr>
  </table>
  </dd>
</dl>
<p>If <code>strict</code> is false, then finding a matching character set in <a class="el" href="mutt_2charset_8c.html#a47beed716c9bc8caa77714aeb8a20d7f" title="Lookup table of preferred charsets.">PreferredMimeNames</a> will be enough. If <code>strict</code> is true, or the charset is not in <a class="el" href="mutt_2charset_8c.html#a47beed716c9bc8caa77714aeb8a20d7f" title="Lookup table of preferred charsets.">PreferredMimeNames</a>, then iconv() with be run. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00894">894</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  895</span>{</div>
<div class="line"><span class="lineno">  896</span>  <span class="keywordflow">if</span> (!cs)</div>
<div class="line"><span class="lineno">  897</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  898</span> </div>
<div class="line"><span class="lineno">  899</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="#a56cbec4a6366d637d41d151d10dc5b87">mutt_ch_is_utf8</a>(cs))</div>
<div class="line"><span class="lineno">  900</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  901</span> </div>
<div class="line"><span class="lineno">  902</span>  <span class="keywordflow">if</span> (!strict)</div>
<div class="line"><span class="lineno">  903</span>  {</div>
<div class="line"><span class="lineno">  904</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; <a class="code hl_variable" href="mutt_2charset_8c.html#a47beed716c9bc8caa77714aeb8a20d7f">PreferredMimeNames</a>[i].key; i++)</div>
<div class="line"><span class="lineno">  905</span>    {</div>
<div class="line"><span class="lineno">  906</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<a class="code hl_variable" href="mutt_2charset_8c.html#a47beed716c9bc8caa77714aeb8a20d7f">PreferredMimeNames</a>[i].key, cs) ||</div>
<div class="line"><span class="lineno">  907</span>          <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<a class="code hl_variable" href="mutt_2charset_8c.html#a47beed716c9bc8caa77714aeb8a20d7f">PreferredMimeNames</a>[i].pref, cs))</div>
<div class="line"><span class="lineno">  908</span>      {</div>
<div class="line"><span class="lineno">  909</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  910</span>      }</div>
<div class="line"><span class="lineno">  911</span>    }</div>
<div class="line"><span class="lineno">  912</span>  }</div>
<div class="line"><span class="lineno">  913</span> </div>
<div class="line"><span class="lineno">  914</span>  iconv_t cd = <a class="code hl_function" href="mutt_2charset_8c.html#af7380ef31de4a56ab644b71f0a010ed9">mutt_ch_iconv_open</a>(cs, cs, <a class="code hl_define" href="#a7e8b71716e5c874b2997a2304be23081">MUTT_ICONV_NO_FLAGS</a>);</div>
<div class="line"><span class="lineno">  915</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a>(cd))</div>
<div class="line"><span class="lineno">  916</span>  {</div>
<div class="line"><span class="lineno">  917</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  918</span>  }</div>
<div class="line"><span class="lineno">  919</span> </div>
<div class="line"><span class="lineno">  920</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  921</span>}</div>
<div class="ttc" id="amutt_2charset_8h_html_a56cbec4a6366d637d41d151d10dc5b87"><div class="ttname"><a href="#a56cbec4a6366d637d41d151d10dc5b87">mutt_ch_is_utf8</a></div><div class="ttdeci">#define mutt_ch_is_utf8(str)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00089">charset.h:89</a></div></div>
</div><!-- fragment --><div id="dynsection-8" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a05daa8adc69c533f5ab46ae98a2b71bc_cgraph.svg" width="518" height="119"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-9" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a05daa8adc69c533f5ab46ae98a2b71bc_icgraph.svg" width="391" height="239"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a285a4fac32f6564ee4682edec23142fe" name="a285a4fac32f6564ee4682edec23142fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a285a4fac32f6564ee4682edec23142fe">&#9670;&#160;</a></span>mutt_ch_choose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * mutt_ch_choose </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>fromcode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structSlist.html">Slist</a> *</td>          <td class="paramname"><span class="paramname"><em>charsets</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>ulen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>dlen</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Figure the best charset to encode a string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fromcode</td><td>Original charset of the string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">charsets</td><td>List of potential charsets to use </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>String to encode </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ulen</td><td>Length of the string to encode </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">d</td><td>If not NULL, point it to the converted string </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dlen</td><td>If not NULL, point it to the length of the d string </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Best performing charset </td></tr>
    <tr><td class="paramname">NULL</td><td>None could be found </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l01108">1108</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1110</span>{</div>
<div class="line"><span class="lineno"> 1111</span>  <span class="keywordflow">if</span> (!fromcode || !charsets)</div>
<div class="line"><span class="lineno"> 1112</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1113</span> </div>
<div class="line"><span class="lineno"> 1114</span>  <span class="keywordtype">char</span> *e = NULL, *tocode = NULL;</div>
<div class="line"><span class="lineno"> 1115</span>  <span class="keywordtype">size_t</span> elen = 0, bestn = 0;</div>
<div class="line"><span class="lineno"> 1116</span> </div>
<div class="line"><span class="lineno"> 1117</span>  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structListNode.html">ListNode</a> *np = NULL;</div>
<div class="line"><span class="lineno"> 1118</span>  <a class="code hl_define" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(np, &amp;charsets-&gt;<a class="code hl_variable" href="structSlist.html#a6abed005cd7946996bcf80e0daa53c3b">head</a>, entries)</div>
<div class="line"><span class="lineno"> 1119</span>  {</div>
<div class="line"><span class="lineno"> 1120</span>    <span class="keywordtype">char</span> *t = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>);</div>
<div class="line"><span class="lineno"> 1121</span>    <span class="keywordflow">if</span> (!t)</div>
<div class="line"><span class="lineno"> 1122</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1123</span> </div>
<div class="line"><span class="lineno"> 1124</span>    <span class="keywordtype">size_t</span> n = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(t);</div>
<div class="line"><span class="lineno"> 1125</span>    <span class="keywordtype">char</span> *s = <a class="code hl_function" href="mutt_2string_8c.html#a116d1d2391bc57f2ba3a9d9cfb15db76">mutt_strn_dup</a>(u, ulen);</div>
<div class="line"><span class="lineno"> 1126</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> rc = d ? <a class="code hl_function" href="mutt_2charset_8c.html#a6304403ed915a40228aeda4082920a42">mutt_ch_convert_string</a>(&amp;s, fromcode, t, <a class="code hl_define" href="#a7e8b71716e5c874b2997a2304be23081">MUTT_ICONV_NO_FLAGS</a>) :</div>
<div class="line"><span class="lineno"> 1127</span>                       <a class="code hl_function" href="mutt_2charset_8c.html#a81959a5c114f585575d5116c50a51638">mutt_ch_check</a>(s, ulen, fromcode, t);</div>
<div class="line"><span class="lineno"> 1128</span>    <span class="keywordflow">if</span> (rc)</div>
<div class="line"><span class="lineno"> 1129</span>    {</div>
<div class="line"><span class="lineno"> 1130</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;t);</div>
<div class="line"><span class="lineno"> 1131</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;s);</div>
<div class="line"><span class="lineno"> 1132</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1133</span>    }</div>
<div class="line"><span class="lineno"> 1134</span>    <span class="keywordtype">size_t</span> slen = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(s);</div>
<div class="line"><span class="lineno"> 1135</span> </div>
<div class="line"><span class="lineno"> 1136</span>    <span class="keywordflow">if</span> (!tocode || (n &lt; bestn))</div>
<div class="line"><span class="lineno"> 1137</span>    {</div>
<div class="line"><span class="lineno"> 1138</span>      bestn = n;</div>
<div class="line"><span class="lineno"> 1139</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;tocode);</div>
<div class="line"><span class="lineno"> 1140</span>      tocode = t;</div>
<div class="line"><span class="lineno"> 1141</span>      <span class="keywordflow">if</span> (d)</div>
<div class="line"><span class="lineno"> 1142</span>      {</div>
<div class="line"><span class="lineno"> 1143</span>        <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;e);</div>
<div class="line"><span class="lineno"> 1144</span>        e = s;</div>
<div class="line"><span class="lineno"> 1145</span>      }</div>
<div class="line"><span class="lineno"> 1146</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1147</span>      {</div>
<div class="line"><span class="lineno"> 1148</span>        <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;s);</div>
<div class="line"><span class="lineno"> 1149</span>      }</div>
<div class="line"><span class="lineno"> 1150</span>      elen = slen;</div>
<div class="line"><span class="lineno"> 1151</span>    }</div>
<div class="line"><span class="lineno"> 1152</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1153</span>    {</div>
<div class="line"><span class="lineno"> 1154</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;t);</div>
<div class="line"><span class="lineno"> 1155</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;s);</div>
<div class="line"><span class="lineno"> 1156</span>    }</div>
<div class="line"><span class="lineno"> 1157</span>  }</div>
<div class="line"><span class="lineno"> 1158</span>  <span class="keywordflow">if</span> (tocode)</div>
<div class="line"><span class="lineno"> 1159</span>  {</div>
<div class="line"><span class="lineno"> 1160</span>    <span class="keywordflow">if</span> (d)</div>
<div class="line"><span class="lineno"> 1161</span>      *d = e;</div>
<div class="line"><span class="lineno"> 1162</span>    <span class="keywordflow">if</span> (dlen)</div>
<div class="line"><span class="lineno"> 1163</span>      *dlen = elen;</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>    <span class="keywordtype">char</span> canonical_buf[1024] = { 0 };</div>
<div class="line"><span class="lineno"> 1166</span>    <a class="code hl_function" href="mutt_2charset_8c.html#a4b347dd75af05a18dbe328c354c18fe8">mutt_ch_canonical_charset</a>(canonical_buf, <span class="keyword">sizeof</span>(canonical_buf), tocode);</div>
<div class="line"><span class="lineno"> 1167</span>    <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;tocode, canonical_buf);</div>
<div class="line"><span class="lineno"> 1168</span>  }</div>
<div class="line"><span class="lineno"> 1169</span>  <span class="keywordflow">return</span> tocode;</div>
<div class="line"><span class="lineno"> 1170</span>}</div>
<div class="ttc" id="amutt_2charset_8c_html_a4b347dd75af05a18dbe328c354c18fe8"><div class="ttname"><a href="mutt_2charset_8c.html#a4b347dd75af05a18dbe328c354c18fe8">mutt_ch_canonical_charset</a></div><div class="ttdeci">void mutt_ch_canonical_charset(char *buf, size_t buflen, const char *name)</div><div class="ttdoc">Canonicalise the charset of a string.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00374">charset.c:374</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_a6304403ed915a40228aeda4082920a42"><div class="ttname"><a href="mutt_2charset_8c.html#a6304403ed915a40228aeda4082920a42">mutt_ch_convert_string</a></div><div class="ttdeci">int mutt_ch_convert_string(char **ps, const char *from, const char *to, uint8_t flags)</div><div class="ttdoc">Convert a string between encodings.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00831">charset.c:831</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_a81959a5c114f585575d5116c50a51638"><div class="ttname"><a href="mutt_2charset_8c.html#a81959a5c114f585575d5116c50a51638">mutt_ch_check</a></div><div class="ttdeci">int mutt_ch_check(const char *s, size_t slen, const char *from, const char *to)</div><div class="ttdoc">Check whether a string can be converted between encodings.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00796">charset.c:796</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a116d1d2391bc57f2ba3a9d9cfb15db76"><div class="ttname"><a href="mutt_2string_8c.html#a116d1d2391bc57f2ba3a9d9cfb15db76">mutt_strn_dup</a></div><div class="ttdeci">char * mutt_strn_dup(const char *begin, size_t len)</div><div class="ttdoc">Duplicate a sub-string.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00382">string.c:382</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a3fe33d90e4814281cd57de048119c950"><div class="ttname"><a href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a></div><div class="ttdeci">char * mutt_str_dup(const char *str)</div><div class="ttdoc">Copy a string, safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00255">string.c:255</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_acca6786b903b22a5924219f9db96e10d"><div class="ttname"><a href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a></div><div class="ttdeci">size_t mutt_str_len(const char *a)</div><div class="ttdoc">Calculate the length of a string, safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00498">string.c:498</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_af8c32ffc64dd55e92001a974a4be6bbf"><div class="ttname"><a href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a></div><div class="ttdeci">char * mutt_str_replace(char **p, const char *s)</div><div class="ttdoc">Replace one string with another.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00282">string.c:282</a></div></div>
<div class="ttc" id="aqueue_8h_html_a77999ebdf5aaf7af8b8ea22bf208c432"><div class="ttname"><a href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a></div><div class="ttdeci">#define STAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00390">queue.h:390</a></div></div>
<div class="ttc" id="astructListNode_html"><div class="ttname"><a href="structListNode.html">ListNode</a></div><div class="ttdoc">A List node for strings.</div><div class="ttdef"><b>Definition</b> <a href="list_8h_source.html#l00036">list.h:37</a></div></div>
<div class="ttc" id="astructListNode_html_aafe688d670318196766392d8235d00a7"><div class="ttname"><a href="structListNode.html#aafe688d670318196766392d8235d00a7">ListNode::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">String.</div><div class="ttdef"><b>Definition</b> <a href="list_8h_source.html#l00038">list.h:38</a></div></div>
<div class="ttc" id="astructSlist_html_a6abed005cd7946996bcf80e0daa53c3b"><div class="ttname"><a href="structSlist.html#a6abed005cd7946996bcf80e0daa53c3b">Slist::head</a></div><div class="ttdeci">struct ListHead head</div><div class="ttdoc">List containing values.</div><div class="ttdef"><b>Definition</b> <a href="slist_8h_source.html#l00038">slist.h:38</a></div></div>
</div><!-- fragment --><div id="dynsection-10" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a285a4fac32f6564ee4682edec23142fe_cgraph.svg" width="518" height="358"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-11" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a285a4fac32f6564ee4682edec23142fe_icgraph.svg" width="460" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aea5561f6489bbbbdfcdfb29e6f22b688" name="aea5561f6489bbbbdfcdfb29e6f22b688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea5561f6489bbbbdfcdfb29e6f22b688">&#9670;&#160;</a></span>mutt_ch_chscmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mutt_ch_chscmp </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>cs1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>cs2</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Are the names of two character sets equivalent? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cs1</td><td>First character set </td></tr>
    <tr><td class="paramname">cs2</td><td>Second character set </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Names are equivalent </td></tr>
    <tr><td class="paramname">false</td><td>Names differ</td></tr>
  </table>
  </dd>
</dl>
<p>Charsets may have extensions that <a class="el" href="mutt_2charset_8c.html#a4b347dd75af05a18dbe328c354c18fe8" title="Canonicalise the charset of a string.">mutt_ch_canonical_charset()</a> leaves intact; we expect 'cs2' to originate from neomutt code, not user input (i.e. 'cs2' does <em>not</em> have any extension) we simply check if the shorter string is a prefix for the longer. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00442">442</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  443</span>{</div>
<div class="line"><span class="lineno">  444</span>  <span class="keywordflow">if</span> (!cs1 || !cs2)</div>
<div class="line"><span class="lineno">  445</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>  <span class="keywordtype">char</span> buf[256] = { 0 };</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>  <a class="code hl_function" href="mutt_2charset_8c.html#a4b347dd75af05a18dbe328c354c18fe8">mutt_ch_canonical_charset</a>(buf, <span class="keyword">sizeof</span>(buf), cs1);</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>  <span class="keywordtype">int</span> len1 = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(buf);</div>
<div class="line"><span class="lineno">  452</span>  <span class="keywordtype">int</span> len2 = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(cs2);</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="mutt_2string_8c.html#aefa17bf84a5a1cb4b41afb08cd91ceff">mutt_istrn_equal</a>(((len1 &gt; len2) ? buf : cs2),</div>
<div class="line"><span class="lineno">  455</span>                          ((len1 &gt; len2) ? cs2 : buf), <a class="code hl_define" href="memory_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(len1, len2));</div>
<div class="line"><span class="lineno">  456</span>}</div>
<div class="ttc" id="amemory_8h_html_a3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="memory_8h.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00037">memory.h:37</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_aefa17bf84a5a1cb4b41afb08cd91ceff"><div class="ttname"><a href="mutt_2string_8c.html#aefa17bf84a5a1cb4b41afb08cd91ceff">mutt_istrn_equal</a></div><div class="ttdeci">bool mutt_istrn_equal(const char *a, const char *b, size_t num)</div><div class="ttdoc">Check for equality of two strings ignoring case (to a maximum), safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00455">string.c:455</a></div></div>
</div><!-- fragment --><div id="dynsection-12" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_aea5561f6489bbbbdfcdfb29e6f22b688_cgraph.svg" width="368" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a328973bb86fd341ba82021d540c0cc0b" name="a328973bb86fd341ba82021d540c0cc0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a328973bb86fd341ba82021d540c0cc0b">&#9670;&#160;</a></span>mutt_ch_convert_nonmime_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_ch_convert_nonmime_string </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structSlist.html">Slist</a> *const</td>          <td class="paramname"><span class="paramname"><em>assumed_charset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>charset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>ps</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to convert a string using a list of character sets. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">assumed_charset</td><td>From $assumed_charset </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">charset</td><td>From $charset </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ps</td><td>String to be converted </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error</td></tr>
  </table>
  </dd>
</dl>
<p>Work through <code>$assumed_charset</code> looking for a character set conversion that works. Failing that, try <a class="el" href="mutt_2charset_8c.html#af919f6cab94a1ff6ba6fa6b9b9c2f8f8" title="Get the default character set.">mutt_ch_get_default_charset()</a>. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00331">331</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  333</span>{</div>
<div class="line"><span class="lineno">  334</span>  <span class="keywordflow">if</span> (!ps)</div>
<div class="line"><span class="lineno">  335</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>  <span class="keywordtype">char</span> *u = *ps;</div>
<div class="line"><span class="lineno">  338</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> ulen = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(u);</div>
<div class="line"><span class="lineno">  339</span>  <span class="keywordflow">if</span> (ulen == 0)</div>
<div class="line"><span class="lineno">  340</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structListNode.html">ListNode</a> *np = NULL;</div>
<div class="line"><span class="lineno">  343</span>  <a class="code hl_define" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(np, &amp;assumed_charset-&gt;<a class="code hl_variable" href="structSlist.html#a6abed005cd7946996bcf80e0daa53c3b">head</a>, entries)</div>
<div class="line"><span class="lineno">  344</span>  {</div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordtype">char</span> <span class="keyword">const</span> *c = np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>;</div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordtype">size_t</span> n = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(c);</div>
<div class="line"><span class="lineno">  347</span>    <span class="keywordtype">char</span> *fromcode = <a class="code hl_define" href="memory_8h.html#af997cb3719dc7abbeabae655d0ee1b9e">MUTT_MEM_MALLOC</a>(n + 1, <span class="keywordtype">char</span>);</div>
<div class="line"><span class="lineno">  348</span>    <a class="code hl_function" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(fromcode, c, n + 1);</div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordtype">char</span> *s = <a class="code hl_function" href="mutt_2string_8c.html#a116d1d2391bc57f2ba3a9d9cfb15db76">mutt_strn_dup</a>(u, ulen);</div>
<div class="line"><span class="lineno">  350</span>    <span class="keywordtype">int</span> m = <a class="code hl_function" href="mutt_2charset_8c.html#a6304403ed915a40228aeda4082920a42">mutt_ch_convert_string</a>(&amp;s, fromcode, charset, <a class="code hl_define" href="#a7e8b71716e5c874b2997a2304be23081">MUTT_ICONV_NO_FLAGS</a>);</div>
<div class="line"><span class="lineno">  351</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;fromcode);</div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">if</span> (m == 0)</div>
<div class="line"><span class="lineno">  353</span>    {</div>
<div class="line"><span class="lineno">  354</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(ps);</div>
<div class="line"><span class="lineno">  355</span>      *ps = s;</div>
<div class="line"><span class="lineno">  356</span>      <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  357</span>    }</div>
<div class="line"><span class="lineno">  358</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;s);</div>
<div class="line"><span class="lineno">  359</span>  }</div>
<div class="line"><span class="lineno">  360</span>  <a class="code hl_function" href="mutt_2charset_8c.html#a6304403ed915a40228aeda4082920a42">mutt_ch_convert_string</a>(ps, <a class="code hl_function" href="mutt_2charset_8c.html#af919f6cab94a1ff6ba6fa6b9b9c2f8f8">mutt_ch_get_default_charset</a>(assumed_charset),</div>
<div class="line"><span class="lineno">  361</span>                         charset, <a class="code hl_define" href="#a1807a22585916adccafa5e09bda9b6a7">MUTT_ICONV_HOOK_FROM</a>);</div>
<div class="line"><span class="lineno">  362</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  363</span>}</div>
<div class="ttc" id="amutt_2charset_8c_html_af919f6cab94a1ff6ba6fa6b9b9c2f8f8"><div class="ttname"><a href="mutt_2charset_8c.html#af919f6cab94a1ff6ba6fa6b9b9c2f8f8">mutt_ch_get_default_charset</a></div><div class="ttdeci">const char * mutt_ch_get_default_charset(const struct Slist *const assumed_charset)</div><div class="ttdoc">Get the default character set.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00465">charset.c:465</a></div></div>
<div class="ttc" id="amutt_2charset_8h_html_a1807a22585916adccafa5e09bda9b6a7"><div class="ttname"><a href="#a1807a22585916adccafa5e09bda9b6a7">MUTT_ICONV_HOOK_FROM</a></div><div class="ttdeci">#define MUTT_ICONV_HOOK_FROM</div><div class="ttdoc">apply charset-hooks to fromcode</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00065">charset.h:65</a></div></div>
</div><!-- fragment --><div id="dynsection-13" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a328973bb86fd341ba82021d540c0cc0b_cgraph.svg" width="574" height="270"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-14" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a328973bb86fd341ba82021d540c0cc0b_icgraph.svg" width="620" height="76"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6304403ed915a40228aeda4082920a42" name="a6304403ed915a40228aeda4082920a42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6304403ed915a40228aeda4082920a42">&#9670;&#160;</a></span>mutt_ch_convert_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_ch_convert_string </td>
          <td>(</td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>ps</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>from</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>to</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>flags</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a string between encodings. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ps</td><td>String to convert </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">from</td><td>Current character set </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to</td><td>Target character set </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>Flags, e.g. <a class="el" href="#a1807a22585916adccafa5e09bda9b6a7" title="apply charset-hooks to fromcode">MUTT_ICONV_HOOK_FROM</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Invalid arguments or failure to open an iconv channel </td></tr>
    <tr><td class="paramname">errno</td><td>Failure in iconv conversion</td></tr>
  </table>
  </dd>
</dl>
<p><a class="el" href="structParameter.html" title="Attribute associated with a MIME part.">Parameter</a> flags is given as-is to <a class="el" href="mutt_2charset_8c.html#af7380ef31de4a56ab644b71f0a010ed9" title="Set up iconv for conversions.">mutt_ch_iconv_open()</a>. See there for its meaning and usage policy. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00831">831</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  832</span>{</div>
<div class="line"><span class="lineno">  833</span>  <span class="keywordflow">if</span> (!ps)</div>
<div class="line"><span class="lineno">  834</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>  <span class="keywordtype">char</span> *s = *ps;</div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>  <span class="keywordflow">if</span> (!s || (*s == <span class="charliteral">&#39;\0&#39;</span>))</div>
<div class="line"><span class="lineno">  839</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  840</span> </div>
<div class="line"><span class="lineno">  841</span>  <span class="keywordflow">if</span> (!to || !from)</div>
<div class="line"><span class="lineno">  842</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  843</span> </div>
<div class="line"><span class="lineno">  844</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *repls[] = { <span class="stringliteral">&quot;\357\277\275&quot;</span>, <span class="stringliteral">&quot;?&quot;</span>, 0 };</div>
<div class="line"><span class="lineno">  845</span>  <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span>  iconv_t cd = <a class="code hl_function" href="mutt_2charset_8c.html#af7380ef31de4a56ab644b71f0a010ed9">mutt_ch_iconv_open</a>(to, from, flags);</div>
<div class="line"><span class="lineno">  848</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a>(cd))</div>
<div class="line"><span class="lineno">  849</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> **inrepls = NULL;</div>
<div class="line"><span class="lineno">  852</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *outrepl = NULL;</div>
<div class="line"><span class="lineno">  853</span> </div>
<div class="line"><span class="lineno">  854</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="#a56cbec4a6366d637d41d151d10dc5b87">mutt_ch_is_utf8</a>(to))</div>
<div class="line"><span class="lineno">  855</span>    outrepl = <span class="stringliteral">&quot;\357\277\275&quot;</span>;</div>
<div class="line"><span class="lineno">  856</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="#a56cbec4a6366d637d41d151d10dc5b87">mutt_ch_is_utf8</a>(from))</div>
<div class="line"><span class="lineno">  857</span>    inrepls = repls;</div>
<div class="line"><span class="lineno">  858</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  859</span>    outrepl = <span class="stringliteral">&quot;?&quot;</span>;</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *ib = s;</div>
<div class="line"><span class="lineno">  862</span>  <span class="keywordtype">size_t</span> ibl = strlen(s);</div>
<div class="line"><span class="lineno">  863</span>  <span class="keywordflow">if</span> (ibl &gt;= (SIZE_MAX / MB_LEN_MAX))</div>
<div class="line"><span class="lineno">  864</span>  {</div>
<div class="line"><span class="lineno">  865</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  866</span>  }</div>
<div class="line"><span class="lineno">  867</span>  <span class="keywordtype">size_t</span> obl = MB_LEN_MAX * ibl;</div>
<div class="line"><span class="lineno">  868</span>  <span class="keywordtype">char</span> *buf = <a class="code hl_define" href="memory_8h.html#af997cb3719dc7abbeabae655d0ee1b9e">MUTT_MEM_MALLOC</a>(obl + 1, <span class="keywordtype">char</span>);</div>
<div class="line"><span class="lineno">  869</span>  <span class="keywordtype">char</span> *ob = buf;</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>  <a class="code hl_function" href="mutt_2charset_8c.html#a161c342ed0b417b1f931b15463fe091b">mutt_ch_iconv</a>(cd, &amp;ib, &amp;ibl, &amp;ob, &amp;obl, inrepls, outrepl, &amp;rc);</div>
<div class="line"><span class="lineno">  872</span>  iconv(cd, 0, 0, &amp;ob, &amp;obl);</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>  *ob = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(ps);</div>
<div class="line"><span class="lineno">  877</span>  *ps = buf;</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>  <a class="code hl_function" href="mutt_2string_8c.html#aa413e39e802d1748408fcc8509844411">mutt_str_adjust</a>(ps);</div>
<div class="line"><span class="lineno">  880</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  881</span>}</div>
<div class="ttc" id="amutt_2charset_8c_html_a161c342ed0b417b1f931b15463fe091b"><div class="ttname"><a href="mutt_2charset_8c.html#a161c342ed0b417b1f931b15463fe091b">mutt_ch_iconv</a></div><div class="ttdeci">size_t mutt_ch_iconv(iconv_t cd, const char **inbuf, size_t *inbytesleft, char **outbuf, size_t *outbytesleft, const char **inrepls, const char *outrepl, int *iconverrno)</div><div class="ttdoc">Change the encoding of a string.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00697">charset.c:697</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_aa413e39e802d1748408fcc8509844411"><div class="ttname"><a href="mutt_2string_8c.html#aa413e39e802d1748408fcc8509844411">mutt_str_adjust</a></div><div class="ttdeci">void mutt_str_adjust(char **ptr)</div><div class="ttdoc">Shrink-to-fit a string.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00301">string.c:301</a></div></div>
</div><!-- fragment --><div id="dynsection-15" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a6304403ed915a40228aeda4082920a42_cgraph.svg" width="520" height="167"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-16" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a6304403ed915a40228aeda4082920a42_icgraph.svg" width="666" height="1006"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a90191f2589de2c605dd8c13b496ad3e1" name="a90191f2589de2c605dd8c13b496ad3e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90191f2589de2c605dd8c13b496ad3e1">&#9670;&#160;</a></span>mutt_ch_fgetconv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_ch_fgetconv </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structFgetConv.html">FgetConv</a> *</td>          <td class="paramname"><span class="paramname"><em>fc</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a file's character set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fc</td><td><a class="el" href="structFgetConv.html" title="Cursor for converting a file&#39;s encoding.">FgetConv</a> handle </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>Next character in the converted file </td></tr>
    <tr><td class="paramname">EOF</td><td>Error</td></tr>
  </table>
  </dd>
</dl>
<p>A file is read into a buffer and its character set is converted. Each call to this function will return one converted character. The buffer is refilled automatically when empty. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00980">980</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  981</span>{</div>
<div class="line"><span class="lineno">  982</span>  <span class="keywordflow">if</span> (!fc)</div>
<div class="line"><span class="lineno">  983</span>    <span class="keywordflow">return</span> EOF;</div>
<div class="line"><span class="lineno">  984</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a>(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a091a74aba71b3de8636bd8c8a346042c">cd</a>))</div>
<div class="line"><span class="lineno">  985</span>    <span class="keywordflow">return</span> fgetc(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a483092f21edf7805e8bf9b3595d085c4">fp</a>);</div>
<div class="line"><span class="lineno">  986</span>  <span class="keywordflow">if</span> (!fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a>)</div>
<div class="line"><span class="lineno">  987</span>    <span class="keywordflow">return</span> EOF;</div>
<div class="line"><span class="lineno">  988</span>  <span class="keywordflow">if</span> (fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a> &lt; fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac6158087fd789411703f38d046c73820">ob</a>)</div>
<div class="line"><span class="lineno">  989</span>    <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) *(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a>)++;</div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>  <span class="comment">/* Try to convert some more */</span></div>
<div class="line"><span class="lineno">  992</span>  fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a> = fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0e82782ef364c7d6bf7a34981e3325e5">bufo</a>;</div>
<div class="line"><span class="lineno">  993</span>  fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac6158087fd789411703f38d046c73820">ob</a> = fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0e82782ef364c7d6bf7a34981e3325e5">bufo</a>;</div>
<div class="line"><span class="lineno">  994</span>  <span class="keywordflow">if</span> (fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a>)</div>
<div class="line"><span class="lineno">  995</span>  {</div>
<div class="line"><span class="lineno">  996</span>    <span class="keywordtype">size_t</span> obl = <span class="keyword">sizeof</span>(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0e82782ef364c7d6bf7a34981e3325e5">bufo</a>);</div>
<div class="line"><span class="lineno">  997</span>    iconv(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a091a74aba71b3de8636bd8c8a346042c">cd</a>, (ICONV_CONST <span class="keywordtype">char</span> **) &amp;fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac15d524a9c68e47b97c96b377a317171">ib</a>, &amp;fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a>, &amp;fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac6158087fd789411703f38d046c73820">ob</a>, &amp;obl);</div>
<div class="line"><span class="lineno">  998</span>    <span class="keywordflow">if</span> (fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a> &lt; fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac6158087fd789411703f38d046c73820">ob</a>)</div>
<div class="line"><span class="lineno">  999</span>      <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) *(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a>)++;</div>
<div class="line"><span class="lineno"> 1000</span>  }</div>
<div class="line"><span class="lineno"> 1001</span> </div>
<div class="line"><span class="lineno"> 1002</span>  <span class="comment">/* If we trusted iconv a bit more, we would at this point</span></div>
<div class="line"><span class="lineno"> 1003</span><span class="comment">   * ask why it had stopped converting ... */</span></div>
<div class="line"><span class="lineno"> 1004</span> </div>
<div class="line"><span class="lineno"> 1005</span>  <span class="comment">/* Try to read some more */</span></div>
<div class="line"><span class="lineno"> 1006</span>  <span class="keywordflow">if</span> ((fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a> == <span class="keyword">sizeof</span>(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0326b518fb9c485d2f32c2ad2fc9843c">bufi</a>)) ||</div>
<div class="line"><span class="lineno"> 1007</span>      (fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a> &amp;&amp; (fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac15d524a9c68e47b97c96b377a317171">ib</a> + fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a> &lt; fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0326b518fb9c485d2f32c2ad2fc9843c">bufi</a> + <span class="keyword">sizeof</span>(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0326b518fb9c485d2f32c2ad2fc9843c">bufi</a>))))</div>
<div class="line"><span class="lineno"> 1008</span>  {</div>
<div class="line"><span class="lineno"> 1009</span>    fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a> = 0;</div>
<div class="line"><span class="lineno"> 1010</span>    <span class="keywordflow">return</span> EOF;</div>
<div class="line"><span class="lineno"> 1011</span>  }</div>
<div class="line"><span class="lineno"> 1012</span>  <span class="keywordflow">if</span> (fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a>)</div>
<div class="line"><span class="lineno"> 1013</span>    memcpy(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0326b518fb9c485d2f32c2ad2fc9843c">bufi</a>, fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac15d524a9c68e47b97c96b377a317171">ib</a>, fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a>);</div>
<div class="line"><span class="lineno"> 1014</span>  fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac15d524a9c68e47b97c96b377a317171">ib</a> = fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0326b518fb9c485d2f32c2ad2fc9843c">bufi</a>;</div>
<div class="line"><span class="lineno"> 1015</span>  fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a> += fread(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac15d524a9c68e47b97c96b377a317171">ib</a> + fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a>, 1, <span class="keyword">sizeof</span>(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0326b518fb9c485d2f32c2ad2fc9843c">bufi</a>) - fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a>, fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a483092f21edf7805e8bf9b3595d085c4">fp</a>);</div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span>  <span class="comment">/* Try harder this time to convert some */</span></div>
<div class="line"><span class="lineno"> 1018</span>  <span class="keywordflow">if</span> (fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a>)</div>
<div class="line"><span class="lineno"> 1019</span>  {</div>
<div class="line"><span class="lineno"> 1020</span>    <span class="keywordtype">size_t</span> obl = <span class="keyword">sizeof</span>(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0e82782ef364c7d6bf7a34981e3325e5">bufo</a>);</div>
<div class="line"><span class="lineno"> 1021</span>    <a class="code hl_function" href="mutt_2charset_8c.html#a161c342ed0b417b1f931b15463fe091b">mutt_ch_iconv</a>(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a091a74aba71b3de8636bd8c8a346042c">cd</a>, (<span class="keyword">const</span> <span class="keywordtype">char</span> **) &amp;fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac15d524a9c68e47b97c96b377a317171">ib</a>, &amp;fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a>, &amp;fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac6158087fd789411703f38d046c73820">ob</a>, &amp;obl,</div>
<div class="line"><span class="lineno"> 1022</span>                  fc-&gt;<a class="code hl_variable" href="structFgetConv.html#abf98f002997a9985a4e82483ab9384bd">inrepls</a>, 0, NULL);</div>
<div class="line"><span class="lineno"> 1023</span>    <span class="keywordflow">if</span> (fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a> &lt; fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac6158087fd789411703f38d046c73820">ob</a>)</div>
<div class="line"><span class="lineno"> 1024</span>      <span class="keywordflow">return</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) *(fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a>)++;</div>
<div class="line"><span class="lineno"> 1025</span>  }</div>
<div class="line"><span class="lineno"> 1026</span> </div>
<div class="line"><span class="lineno"> 1027</span>  <span class="comment">/* Either the file has finished or one of the buffers is too small */</span></div>
<div class="line"><span class="lineno"> 1028</span>  fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a> = 0;</div>
<div class="line"><span class="lineno"> 1029</span>  <span class="keywordflow">return</span> EOF;</div>
<div class="line"><span class="lineno"> 1030</span>}</div>
<div class="ttc" id="astructFgetConv_html_a0326b518fb9c485d2f32c2ad2fc9843c"><div class="ttname"><a href="structFgetConv.html#a0326b518fb9c485d2f32c2ad2fc9843c">FgetConv::bufi</a></div><div class="ttdeci">char bufi[512]</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00046">charset.h:46</a></div></div>
<div class="ttc" id="astructFgetConv_html_a091a74aba71b3de8636bd8c8a346042c"><div class="ttname"><a href="structFgetConv.html#a091a74aba71b3de8636bd8c8a346042c">FgetConv::cd</a></div><div class="ttdeci">iconv_t cd</div><div class="ttdoc">iconv conversion descriptor</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00045">charset.h:45</a></div></div>
<div class="ttc" id="astructFgetConv_html_a0e82782ef364c7d6bf7a34981e3325e5"><div class="ttname"><a href="structFgetConv.html#a0e82782ef364c7d6bf7a34981e3325e5">FgetConv::bufo</a></div><div class="ttdeci">char bufo[512]</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00047">charset.h:47</a></div></div>
<div class="ttc" id="astructFgetConv_html_a1856487d837ba4b6c24a7bdac4666e96"><div class="ttname"><a href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">FgetConv::ibl</a></div><div class="ttdeci">size_t ibl</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00051">charset.h:51</a></div></div>
<div class="ttc" id="astructFgetConv_html_a483092f21edf7805e8bf9b3595d085c4"><div class="ttname"><a href="structFgetConv.html#a483092f21edf7805e8bf9b3595d085c4">FgetConv::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00044">charset.h:44</a></div></div>
<div class="ttc" id="astructFgetConv_html_a723a63c788d0a7f7d007da7a2c0e7ddb"><div class="ttname"><a href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">FgetConv::p</a></div><div class="ttdeci">char * p</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00048">charset.h:48</a></div></div>
<div class="ttc" id="astructFgetConv_html_abf98f002997a9985a4e82483ab9384bd"><div class="ttname"><a href="structFgetConv.html#abf98f002997a9985a4e82483ab9384bd">FgetConv::inrepls</a></div><div class="ttdeci">const char ** inrepls</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00052">charset.h:52</a></div></div>
<div class="ttc" id="astructFgetConv_html_ac15d524a9c68e47b97c96b377a317171"><div class="ttname"><a href="structFgetConv.html#ac15d524a9c68e47b97c96b377a317171">FgetConv::ib</a></div><div class="ttdeci">char * ib</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00050">charset.h:50</a></div></div>
<div class="ttc" id="astructFgetConv_html_ac6158087fd789411703f38d046c73820"><div class="ttname"><a href="structFgetConv.html#ac6158087fd789411703f38d046c73820">FgetConv::ob</a></div><div class="ttdeci">char * ob</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00049">charset.h:49</a></div></div>
</div><!-- fragment --><div id="dynsection-17" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a90191f2589de2c605dd8c13b496ad3e1_cgraph.svg" width="300" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-18" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a90191f2589de2c605dd8c13b496ad3e1_icgraph.svg" width="359" height="419"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af3ab5375dc558a241b9e0d5787954dc5" name="af3ab5375dc558a241b9e0d5787954dc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3ab5375dc558a241b9e0d5787954dc5">&#9670;&#160;</a></span>mutt_ch_fgetconv_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_ch_fgetconv_close </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structFgetConv.html">FgetConv</a> **</td>          <td class="paramname"><span class="paramname"><em>ptr</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close an fgetconv handle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ptr</td><td>fgetconv handle </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00962">962</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  963</span>{</div>
<div class="line"><span class="lineno">  964</span>  <span class="keywordflow">if</span> (!ptr || !*ptr)</div>
<div class="line"><span class="lineno">  965</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(ptr);</div>
<div class="line"><span class="lineno">  968</span>}</div>
</div><!-- fragment --><div id="dynsection-19" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_af3ab5375dc558a241b9e0d5787954dc5_icgraph.svg" width="611" height="344"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="acf9480125d36a09af9c0e5c8c13eaed1" name="acf9480125d36a09af9c0e5c8c13eaed1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf9480125d36a09af9c0e5c8c13eaed1">&#9670;&#160;</a></span>mutt_ch_fgetconv_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structFgetConv.html">FgetConv</a> * mutt_ch_fgetconv_open </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>from</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>to</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>flags</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare a file for charset conversion. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>FILE ptr to prepare </td></tr>
    <tr><td class="paramname">from</td><td>Current character set </td></tr>
    <tr><td class="paramname">to</td><td>Destination character set </td></tr>
    <tr><td class="paramname">flags</td><td>Flags, e.g. <a class="el" href="#a1807a22585916adccafa5e09bda9b6a7" title="apply charset-hooks to fromcode">MUTT_ICONV_HOOK_FROM</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>fgetconv handle</td></tr>
  </table>
  </dd>
</dl>
<p><a class="el" href="structParameter.html" title="Attribute associated with a MIME part.">Parameter</a> flags is given as-is to <a class="el" href="mutt_2charset_8c.html#af7380ef31de4a56ab644b71f0a010ed9" title="Set up iconv for conversions.">mutt_ch_iconv_open()</a>. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00933">933</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  934</span>{</div>
<div class="line"><span class="lineno">  935</span>  iconv_t cd = <a class="code hl_define" href="#a343b22f930dd486990858724937bb6cd">ICONV_T_INVALID</a>;</div>
<div class="line"><span class="lineno">  936</span> </div>
<div class="line"><span class="lineno">  937</span>  <span class="keywordflow">if</span> (from &amp;&amp; to)</div>
<div class="line"><span class="lineno">  938</span>    cd = <a class="code hl_function" href="mutt_2charset_8c.html#af7380ef31de4a56ab644b71f0a010ed9">mutt_ch_iconv_open</a>(to, from, flags);</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structFgetConv.html">FgetConv</a> *fc = <a class="code hl_define" href="memory_8h.html#a9aaf8f21a29735767a069ff1aee9d7d9">MUTT_MEM_CALLOC</a>(1, <span class="keyword">struct</span> <a class="code hl_struct" href="structFgetConv.html">FgetConv</a>);</div>
<div class="line"><span class="lineno">  941</span>  fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a483092f21edf7805e8bf9b3595d085c4">fp</a> = <a class="code hl_variable" href="structFgetConv.html#a483092f21edf7805e8bf9b3595d085c4">fp</a>;</div>
<div class="line"><span class="lineno">  942</span>  fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a091a74aba71b3de8636bd8c8a346042c">cd</a> = <a class="code hl_variable" href="structFgetConv.html#a091a74aba71b3de8636bd8c8a346042c">cd</a>;</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a>(<a class="code hl_variable" href="structFgetConv.html#a091a74aba71b3de8636bd8c8a346042c">cd</a>))</div>
<div class="line"><span class="lineno">  945</span>  {</div>
<div class="line"><span class="lineno">  946</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *repls[] = { <span class="stringliteral">&quot;\357\277\275&quot;</span>, <span class="stringliteral">&quot;?&quot;</span>, 0 };</div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span>    fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a> = fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0e82782ef364c7d6bf7a34981e3325e5">bufo</a>;</div>
<div class="line"><span class="lineno">  949</span>    fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac6158087fd789411703f38d046c73820">ob</a> = fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0e82782ef364c7d6bf7a34981e3325e5">bufo</a>;</div>
<div class="line"><span class="lineno">  950</span>    fc-&gt;<a class="code hl_variable" href="structFgetConv.html#ac15d524a9c68e47b97c96b377a317171">ib</a> = fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a0326b518fb9c485d2f32c2ad2fc9843c">bufi</a>;</div>
<div class="line"><span class="lineno">  951</span>    fc-&gt;<a class="code hl_variable" href="structFgetConv.html#a1856487d837ba4b6c24a7bdac4666e96">ibl</a> = 0;</div>
<div class="line"><span class="lineno">  952</span>    fc-&gt;<a class="code hl_variable" href="structFgetConv.html#abf98f002997a9985a4e82483ab9384bd">inrepls</a> = <a class="code hl_define" href="#a56cbec4a6366d637d41d151d10dc5b87">mutt_ch_is_utf8</a>(to) ? repls : repls + 1;</div>
<div class="line"><span class="lineno">  953</span>  }</div>
<div class="line"><span class="lineno">  954</span> </div>
<div class="line"><span class="lineno">  955</span>  <span class="keywordflow">return</span> fc;</div>
<div class="line"><span class="lineno">  956</span>}</div>
<div class="ttc" id="amemory_8h_html_a9aaf8f21a29735767a069ff1aee9d7d9"><div class="ttname"><a href="memory_8h.html#a9aaf8f21a29735767a069ff1aee9d7d9">MUTT_MEM_CALLOC</a></div><div class="ttdeci">#define MUTT_MEM_CALLOC(n, type)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00047">memory.h:47</a></div></div>
<div class="ttc" id="amutt_2charset_8h_html_a343b22f930dd486990858724937bb6cd"><div class="ttname"><a href="#a343b22f930dd486990858724937bb6cd">ICONV_T_INVALID</a></div><div class="ttdeci">#define ICONV_T_INVALID</div><div class="ttdoc">Error value for iconv functions.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00093">charset.h:93</a></div></div>
<div class="ttc" id="astructFgetConv_html"><div class="ttname"><a href="structFgetConv.html">FgetConv</a></div><div class="ttdoc">Cursor for converting a file&#39;s encoding.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00042">charset.h:43</a></div></div>
</div><!-- fragment --><div id="dynsection-20" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_acf9480125d36a09af9c0e5c8c13eaed1_cgraph.svg" width="523" height="66"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-21" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_acf9480125d36a09af9c0e5c8c13eaed1_icgraph.svg" width="612" height="344"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae9ccef550daaa86a0276dbfae78a1c1a" name="ae9ccef550daaa86a0276dbfae78a1c1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ccef550daaa86a0276dbfae78a1c1a">&#9670;&#160;</a></span>mutt_ch_fgetconvs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * mutt_ch_fgetconvs </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>buflen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structFgetConv.html">FgetConv</a> *</td>          <td class="paramname"><span class="paramname"><em>fc</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert a file's charset into a string buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td><a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> for result </td></tr>
    <tr><td class="paramname">buflen</td><td>Length of buffer </td></tr>
    <tr><td class="paramname">fc</td><td><a class="el" href="structFgetConv.html" title="Cursor for converting a file&#39;s encoding.">FgetConv</a> handle </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Success, result buffer </td></tr>
    <tr><td class="paramname">NULL</td><td>Error</td></tr>
  </table>
  </dd>
</dl>
<p>Read a file into a buffer, converting the character set as it goes. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l01042">1042</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1043</span>{</div>
<div class="line"><span class="lineno"> 1044</span>  <span class="keywordflow">if</span> (!buf)</div>
<div class="line"><span class="lineno"> 1045</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span>  <span class="keywordtype">size_t</span> r;</div>
<div class="line"><span class="lineno"> 1048</span>  <span class="keywordflow">for</span> (r = 0; (r + 1) &lt; buflen;)</div>
<div class="line"><span class="lineno"> 1049</span>  {</div>
<div class="line"><span class="lineno"> 1050</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> c = <a class="code hl_function" href="mutt_2charset_8c.html#a90191f2589de2c605dd8c13b496ad3e1">mutt_ch_fgetconv</a>(fc);</div>
<div class="line"><span class="lineno"> 1051</span>    <span class="keywordflow">if</span> (c == EOF)</div>
<div class="line"><span class="lineno"> 1052</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1053</span>    buf[r++] = (char) c;</div>
<div class="line"><span class="lineno"> 1054</span>    <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line"><span class="lineno"> 1055</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1056</span>  }</div>
<div class="line"><span class="lineno"> 1057</span>  buf[r] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno"> 1058</span> </div>
<div class="line"><span class="lineno"> 1059</span>  <span class="keywordflow">if</span> (r &gt; 0)</div>
<div class="line"><span class="lineno"> 1060</span>    <span class="keywordflow">return</span> buf;</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1063</span>}</div>
<div class="ttc" id="amutt_2charset_8c_html_a90191f2589de2c605dd8c13b496ad3e1"><div class="ttname"><a href="mutt_2charset_8c.html#a90191f2589de2c605dd8c13b496ad3e1">mutt_ch_fgetconv</a></div><div class="ttdeci">int mutt_ch_fgetconv(struct FgetConv *fc)</div><div class="ttdoc">Convert a file&#39;s character set.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00980">charset.c:980</a></div></div>
</div><!-- fragment --><div id="dynsection-22" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_ae9ccef550daaa86a0276dbfae78a1c1a_cgraph.svg" width="330" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-23" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_ae9ccef550daaa86a0276dbfae78a1c1a_icgraph.svg" width="355" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af919f6cab94a1ff6ba6fa6b9b9c2f8f8" name="af919f6cab94a1ff6ba6fa6b9b9c2f8f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af919f6cab94a1ff6ba6fa6b9b9c2f8f8">&#9670;&#160;</a></span>mutt_ch_get_default_charset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * mutt_ch_get_default_charset </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structSlist.html">Slist</a> *const</td>          <td class="paramname"><span class="paramname"><em>assumed_charset</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the default character set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">assumed_charset</td><td>From $assumed_charset </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Name of the default character set</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>This returns a pointer to a static buffer. Do not free it. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00465">465</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  466</span>{</div>
<div class="line"><span class="lineno">  467</span>  <span class="keyword">static</span> <span class="keywordtype">char</span> fcharset[128];</div>
<div class="line"><span class="lineno">  468</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *c = NULL;</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>  <span class="keywordflow">if</span> (assumed_charset &amp;&amp; (assumed_charset-&gt;<a class="code hl_variable" href="structSlist.html#a7ad6a474ee1f2eeb00367916567fb5a6">count</a> &gt; 0))</div>
<div class="line"><span class="lineno">  471</span>    c = <a class="code hl_define" href="queue_8h.html#a3e2eb7535019a2829399b24744dd1a66">STAILQ_FIRST</a>(&amp;assumed_charset-&gt;<a class="code hl_variable" href="structSlist.html#a6abed005cd7946996bcf80e0daa53c3b">head</a>)-&gt;data;</div>
<div class="line"><span class="lineno">  472</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  473</span>    c = <span class="stringliteral">&quot;us-ascii&quot;</span>;</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>  <a class="code hl_function" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(fcharset, c, <span class="keyword">sizeof</span>(fcharset));</div>
<div class="line"><span class="lineno">  476</span>  <span class="keywordflow">return</span> fcharset;</div>
<div class="line"><span class="lineno">  477</span>}</div>
<div class="ttc" id="aqueue_8h_html_a3e2eb7535019a2829399b24744dd1a66"><div class="ttname"><a href="queue_8h.html#a3e2eb7535019a2829399b24744dd1a66">STAILQ_FIRST</a></div><div class="ttdeci">#define STAILQ_FIRST(head)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00388">queue.h:388</a></div></div>
<div class="ttc" id="astructSlist_html_a7ad6a474ee1f2eeb00367916567fb5a6"><div class="ttname"><a href="structSlist.html#a7ad6a474ee1f2eeb00367916567fb5a6">Slist::count</a></div><div class="ttdeci">size_t count</div><div class="ttdoc">Number of values in list.</div><div class="ttdef"><b>Definition</b> <a href="slist_8h_source.html#l00039">slist.h:39</a></div></div>
</div><!-- fragment --><div id="dynsection-24" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_af919f6cab94a1ff6ba6fa6b9b9c2f8f8_cgraph.svg" width="316" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-25" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_af919f6cab94a1ff6ba6fa6b9b9c2f8f8_icgraph.svg" width="398" height="166"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a4406d5ba8ac279c5060e81257320b165" name="a4406d5ba8ac279c5060e81257320b165"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4406d5ba8ac279c5060e81257320b165">&#9670;&#160;</a></span>mutt_ch_get_langinfo_charset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * mutt_ch_get_langinfo_charset </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the user's choice of character set. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Charset string</td></tr>
  </table>
  </dd>
</dl>
<p>Get the canonical character set used by the user's locale. The caller must free the returned string. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00486">486</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  487</span>{</div>
<div class="line"><span class="lineno">  488</span>  <span class="keywordtype">char</span> buf[1024] = { 0 };</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>  <a class="code hl_function" href="mutt_2charset_8c.html#a4b347dd75af05a18dbe328c354c18fe8">mutt_ch_canonical_charset</a>(buf, <span class="keyword">sizeof</span>(buf), nl_langinfo(CODESET));</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>  <span class="keywordflow">if</span> (buf[0] != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno">  493</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(buf);</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(<span class="stringliteral">&quot;iso-8859-1&quot;</span>);</div>
<div class="line"><span class="lineno">  496</span>}</div>
</div><!-- fragment --><div id="dynsection-26" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a4406d5ba8ac279c5060e81257320b165_cgraph.svg" width="399" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-27" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a4406d5ba8ac279c5060e81257320b165_icgraph.svg" width="290" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a161c342ed0b417b1f931b15463fe091b" name="a161c342ed0b417b1f931b15463fe091b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a161c342ed0b417b1f931b15463fe091b">&#9670;&#160;</a></span>mutt_ch_iconv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t mutt_ch_iconv </td>
          <td>(</td>
          <td class="paramtype">iconv_t</td>          <td class="paramname"><span class="paramname"><em>cd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **</td>          <td class="paramname"><span class="paramname"><em>inbuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>inbytesleft</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>outbuf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>outbytesleft</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **</td>          <td class="paramname"><span class="paramname"><em>inrepls</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>outrepl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>iconverrno</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change the encoding of a string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cd</td><td>Iconv conversion descriptor </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">inbuf</td><td><a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> to convert </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">inbytesleft</td><td>Length of buffer to convert </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">outbuf</td><td><a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> for the result </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">outbytesleft</td><td>Length of result buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inrepls</td><td>Input replacement characters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">outrepl</td><td>Output replacement characters </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">iconverrno</td><td>Errno if iconv() fails, 0 if it succeeds </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>Characters converted</td></tr>
  </table>
  </dd>
</dl>
<p>Like iconv, but keeps going even when the input is invalid If you're supplying inrepls, the source charset should be stateless; if you're supplying an outrepl, the target charset should be. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00697">697</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  700</span>{</div>
<div class="line"><span class="lineno">  701</span>  <span class="keywordtype">size_t</span> rc = 0;</div>
<div class="line"><span class="lineno">  702</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *ib = *inbuf;</div>
<div class="line"><span class="lineno">  703</span>  <span class="keywordtype">size_t</span> ibl = *inbytesleft;</div>
<div class="line"><span class="lineno">  704</span>  <span class="keywordtype">char</span> *ob = *outbuf;</div>
<div class="line"><span class="lineno">  705</span>  <span class="keywordtype">size_t</span> obl = *outbytesleft;</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>  <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno">  708</span>  {</div>
<div class="line"><span class="lineno">  709</span>    errno = 0;</div>
<div class="line"><span class="lineno">  710</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> ret1 = iconv(cd, (ICONV_CONST <span class="keywordtype">char</span> **) &amp;ib, &amp;ibl, &amp;ob, &amp;obl);</div>
<div class="line"><span class="lineno">  711</span>    <span class="keywordflow">if</span> (ret1 != <a class="code hl_define" href="#aa492c8da74811c680daecd5cc99fd506">ICONV_ILLEGAL_SEQ</a>)</div>
<div class="line"><span class="lineno">  712</span>      rc += ret1;</div>
<div class="line"><span class="lineno">  713</span>    <span class="keywordflow">if</span> (iconverrno)</div>
<div class="line"><span class="lineno">  714</span>      *iconverrno = errno;</div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>    <span class="keywordflow">if</span> (ibl &amp;&amp; obl &amp;&amp; (errno == <a class="code hl_define" href="mutt_2charset_8c.html#ac6c071293826a4e66a717bb38db7794d">EILSEQ</a>))</div>
<div class="line"><span class="lineno">  717</span>    {</div>
<div class="line"><span class="lineno">  718</span>      <span class="keywordflow">if</span> (inrepls)</div>
<div class="line"><span class="lineno">  719</span>      {</div>
<div class="line"><span class="lineno">  720</span>        <span class="comment">/* Try replacing the input */</span></div>
<div class="line"><span class="lineno">  721</span>        <span class="keyword">const</span> <span class="keywordtype">char</span> **t = NULL;</div>
<div class="line"><span class="lineno">  722</span>        <span class="keywordflow">for</span> (t = inrepls; *t; t++)</div>
<div class="line"><span class="lineno">  723</span>        {</div>
<div class="line"><span class="lineno">  724</span>          <span class="keyword">const</span> <span class="keywordtype">char</span> *ib1 = *t;</div>
<div class="line"><span class="lineno">  725</span>          <span class="keywordtype">size_t</span> ibl1 = strlen(*t);</div>
<div class="line"><span class="lineno">  726</span>          <span class="keywordtype">char</span> *ob1 = ob;</div>
<div class="line"><span class="lineno">  727</span>          <span class="keywordtype">size_t</span> obl1 = obl;</div>
<div class="line"><span class="lineno">  728</span>          iconv(cd, (ICONV_CONST <span class="keywordtype">char</span> **) &amp;ib1, &amp;ibl1, &amp;ob1, &amp;obl1);</div>
<div class="line"><span class="lineno">  729</span>          <span class="keywordflow">if</span> (ibl1 == 0)</div>
<div class="line"><span class="lineno">  730</span>          {</div>
<div class="line"><span class="lineno">  731</span>            ib++;</div>
<div class="line"><span class="lineno">  732</span>            ibl--;</div>
<div class="line"><span class="lineno">  733</span>            ob = ob1;</div>
<div class="line"><span class="lineno">  734</span>            obl = obl1;</div>
<div class="line"><span class="lineno">  735</span>            rc++;</div>
<div class="line"><span class="lineno">  736</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  737</span>          }</div>
<div class="line"><span class="lineno">  738</span>        }</div>
<div class="line"><span class="lineno">  739</span>        <span class="keywordflow">if</span> (*t)</div>
<div class="line"><span class="lineno">  740</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  741</span>      }</div>
<div class="line"><span class="lineno">  742</span>      <span class="comment">/* Replace the output */</span></div>
<div class="line"><span class="lineno">  743</span>      <span class="keywordflow">if</span> (!outrepl)</div>
<div class="line"><span class="lineno">  744</span>        outrepl = <span class="stringliteral">&quot;?&quot;</span>;</div>
<div class="line"><span class="lineno">  745</span>      iconv(cd, NULL, NULL, &amp;ob, &amp;obl);</div>
<div class="line"><span class="lineno">  746</span>      <span class="keywordflow">if</span> (obl)</div>
<div class="line"><span class="lineno">  747</span>      {</div>
<div class="line"><span class="lineno">  748</span>        <span class="keywordtype">int</span> n = strlen(outrepl);</div>
<div class="line"><span class="lineno">  749</span>        <span class="keywordflow">if</span> (n &gt; obl)</div>
<div class="line"><span class="lineno">  750</span>        {</div>
<div class="line"><span class="lineno">  751</span>          outrepl = <span class="stringliteral">&quot;?&quot;</span>;</div>
<div class="line"><span class="lineno">  752</span>          n = 1;</div>
<div class="line"><span class="lineno">  753</span>        }</div>
<div class="line"><span class="lineno">  754</span>        memcpy(ob, outrepl, n);</div>
<div class="line"><span class="lineno">  755</span>        ib++;</div>
<div class="line"><span class="lineno">  756</span>        ibl--;</div>
<div class="line"><span class="lineno">  757</span>        ob += n;</div>
<div class="line"><span class="lineno">  758</span>        obl -= n;</div>
<div class="line"><span class="lineno">  759</span>        rc++;</div>
<div class="line"><span class="lineno">  760</span>        iconv(cd, NULL, NULL, NULL, NULL); <span class="comment">/* for good measure */</span></div>
<div class="line"><span class="lineno">  761</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  762</span>      }</div>
<div class="line"><span class="lineno">  763</span>    }</div>
<div class="line"><span class="lineno">  764</span>    *inbuf = ib;</div>
<div class="line"><span class="lineno">  765</span>    *inbytesleft = ibl;</div>
<div class="line"><span class="lineno">  766</span>    *outbuf = ob;</div>
<div class="line"><span class="lineno">  767</span>    *outbytesleft = obl;</div>
<div class="line"><span class="lineno">  768</span>    <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  769</span>  }</div>
<div class="line"><span class="lineno">  770</span>}</div>
<div class="ttc" id="amutt_2charset_8c_html_ac6c071293826a4e66a717bb38db7794d"><div class="ttname"><a href="mutt_2charset_8c.html#ac6c071293826a4e66a717bb38db7794d">EILSEQ</a></div><div class="ttdeci">#define EILSEQ</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00055">charset.c:55</a></div></div>
</div><!-- fragment --><div id="dynsection-28" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a161c342ed0b417b1f931b15463fe091b_icgraph.svg" width="336" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a54a6b32746302571e3a61b1daa22c512" name="a54a6b32746302571e3a61b1daa22c512"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54a6b32746302571e3a61b1daa22c512">&#9670;&#160;</a></span>mutt_ch_iconv_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * mutt_ch_iconv_lookup </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>chs</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Look for a replacement character set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chs</td><td>Character set to lookup </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Replacement character set (if a 'iconv-hook' matches) </td></tr>
    <tr><td class="paramname">NULL</td><td>No matching hook</td></tr>
  </table>
  </dd>
</dl>
<p>Look through all the 'iconv-hook's. If one matches return the replacement character set. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00781">781</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  782</span>{</div>
<div class="line"><span class="lineno">  783</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="mutt_2charset_8c.html#a7f43e095c200569d3434021bc8ce13d1">lookup_charset</a>(<a class="code hl_enumvalue" href="#a677743e89f8cc2c57a0e6e91a47bdc4aadb54e12de4bd2494e86573e4728b4956">MUTT_LOOKUP_ICONV</a>, chs);</div>
<div class="line"><span class="lineno">  784</span>}</div>
</div><!-- fragment --><div id="dynsection-29" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a54a6b32746302571e3a61b1daa22c512_cgraph.svg" width="332" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-30" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-30-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-30-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-30-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a54a6b32746302571e3a61b1daa22c512_icgraph.svg" width="364" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af7380ef31de4a56ab644b71f0a010ed9" name="af7380ef31de4a56ab644b71f0a010ed9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7380ef31de4a56ab644b71f0a010ed9">&#9670;&#160;</a></span>mutt_ch_iconv_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">iconv_t mutt_ch_iconv_open </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>tocode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>fromcode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>flags</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up iconv for conversions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tocode</td><td>Current character set </td></tr>
    <tr><td class="paramname">fromcode</td><td>Target character set </td></tr>
    <tr><td class="paramname">flags</td><td>Flags, e.g. <a class="el" href="#a1807a22585916adccafa5e09bda9b6a7" title="apply charset-hooks to fromcode">MUTT_ICONV_HOOK_FROM</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>iconv handle for the conversion</td></tr>
  </table>
  </dd>
</dl>
<p>Like iconv_open, but canonicalises the charsets, applies charset-hooks, recanonicalises, and finally applies iconv-hooks. <a class="el" href="structParameter.html" title="Attribute associated with a MIME part.">Parameter</a> flags=0 skips charset-hooks, while MUTT_ICONV_HOOK_FROM applies them to fromcode. Callers should use flags=0 when fromcode can safely be considered true, either some constant, or some value provided by the user; MUTT_ICONV_HOOK_FROM should be used only when fromcode is unsure, taken from a possibly wrong incoming MIME label, or such. Misusing MUTT_ICONV_HOOK_FROM leads to unwanted interactions in some setups.</p>
<p>Since calling iconv_open() repeatedly can be expensive, we keep a cache of the most recently used iconv_t objects, kept in LRU order. This means that you should not call iconv_close() on the object yourself. All remaining objects in the cache will exit when <a class="el" href="main_8c.html#adedb285b02c41bde2158ded9cc9fd7ac" title="Start NeoMutt.">main()</a> calls <a class="el" href="mutt_2charset_8c.html#a52a634eff18853e0a34a06876717fa4c" title="Clean up the cached iconv handles and charset strings.">mutt_ch_cache_cleanup()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>By design charset-hooks should never be, and are never, applied to tocode.</dd>
<dd>
The top-well-named MUTT_ICONV_HOOK_FROM acts on charset-hooks, not at all on iconv-hooks. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00594">594</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  595</span>{</div>
<div class="line"><span class="lineno">  596</span>  <span class="keywordtype">char</span> tocode1[128] = { 0 };</div>
<div class="line"><span class="lineno">  597</span>  <span class="keywordtype">char</span> fromcode1[128] = { 0 };</div>
<div class="line"><span class="lineno">  598</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *tocode2 = NULL, *fromcode2 = NULL;</div>
<div class="line"><span class="lineno">  599</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *tmp = NULL;</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>  <span class="comment">/* transform to MIME preferred charset names */</span></div>
<div class="line"><span class="lineno">  602</span>  <a class="code hl_function" href="mutt_2charset_8c.html#a4b347dd75af05a18dbe328c354c18fe8">mutt_ch_canonical_charset</a>(tocode1, <span class="keyword">sizeof</span>(tocode1), tocode);</div>
<div class="line"><span class="lineno">  603</span>  <a class="code hl_function" href="mutt_2charset_8c.html#a4b347dd75af05a18dbe328c354c18fe8">mutt_ch_canonical_charset</a>(fromcode1, <span class="keyword">sizeof</span>(fromcode1), fromcode);</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>  <span class="comment">/* maybe apply charset-hooks and recanonicalise fromcode,</span></div>
<div class="line"><span class="lineno">  606</span><span class="comment">   * but only when caller asked us to sanitize a potentially wrong</span></div>
<div class="line"><span class="lineno">  607</span><span class="comment">   * charset name incoming from the wild exterior. */</span></div>
<div class="line"><span class="lineno">  608</span>  <span class="keywordflow">if</span> (flags &amp; <a class="code hl_define" href="#a1807a22585916adccafa5e09bda9b6a7">MUTT_ICONV_HOOK_FROM</a>)</div>
<div class="line"><span class="lineno">  609</span>  {</div>
<div class="line"><span class="lineno">  610</span>    tmp = <a class="code hl_function" href="mutt_2charset_8c.html#a82415c52a83b63f4a8ce5110e86525a2">mutt_ch_charset_lookup</a>(fromcode1);</div>
<div class="line"><span class="lineno">  611</span>    <span class="keywordflow">if</span> (tmp)</div>
<div class="line"><span class="lineno">  612</span>      <a class="code hl_function" href="mutt_2charset_8c.html#a4b347dd75af05a18dbe328c354c18fe8">mutt_ch_canonical_charset</a>(fromcode1, <span class="keyword">sizeof</span>(fromcode1), tmp);</div>
<div class="line"><span class="lineno">  613</span>  }</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>  <span class="comment">/* check if we have this pair cached already */</span></div>
<div class="line"><span class="lineno">  616</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a>; i++)</div>
<div class="line"><span class="lineno">  617</span>  {</div>
<div class="line"><span class="lineno">  618</span>    <span class="keywordflow">if</span> (strcmp(tocode1, <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[i].tocode1) == 0 &amp;&amp;</div>
<div class="line"><span class="lineno">  619</span>        strcmp(fromcode1, <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[i].fromcode1) == 0)</div>
<div class="line"><span class="lineno">  620</span>    {</div>
<div class="line"><span class="lineno">  621</span>      iconv_t cd = <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[i].cd;</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>      <span class="comment">/* make room for this one at the top */</span></div>
<div class="line"><span class="lineno">  624</span>      <span class="keyword">struct </span><a class="code hl_struct" href="structIconvCacheEntry.html">IconvCacheEntry</a> top = <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[i];</div>
<div class="line"><span class="lineno">  625</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = i - 1; j &gt;= 0; j--)</div>
<div class="line"><span class="lineno">  626</span>      {</div>
<div class="line"><span class="lineno">  627</span>        <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[j + 1] = <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[j];</div>
<div class="line"><span class="lineno">  628</span>      }</div>
<div class="line"><span class="lineno">  629</span>      <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[0] = top;</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a>(<a class="code hl_variable" href="structIconvCacheEntry.html#a8086f85b900d42d83d47b58f6b9f1fe7">cd</a>))</div>
<div class="line"><span class="lineno">  632</span>      {</div>
<div class="line"><span class="lineno">  633</span>        <span class="comment">/* reset state */</span></div>
<div class="line"><span class="lineno">  634</span>        iconv(<a class="code hl_variable" href="structIconvCacheEntry.html#a8086f85b900d42d83d47b58f6b9f1fe7">cd</a>, NULL, NULL, NULL, NULL);</div>
<div class="line"><span class="lineno">  635</span>      }</div>
<div class="line"><span class="lineno">  636</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="structIconvCacheEntry.html#a8086f85b900d42d83d47b58f6b9f1fe7">cd</a>;</div>
<div class="line"><span class="lineno">  637</span>    }</div>
<div class="line"><span class="lineno">  638</span>  }</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>  <span class="comment">/* not found in cache */</span></div>
<div class="line"><span class="lineno">  641</span>  <span class="comment">/* always apply iconv-hooks to suit system&#39;s iconv tastes */</span></div>
<div class="line"><span class="lineno">  642</span>  tocode2 = <a class="code hl_function" href="mutt_2charset_8c.html#a54a6b32746302571e3a61b1daa22c512">mutt_ch_iconv_lookup</a>(<a class="code hl_variable" href="structIconvCacheEntry.html#a49f6d5946466f2737122b52e040b84ac">tocode1</a>);</div>
<div class="line"><span class="lineno">  643</span>  tocode2 = tocode2 ? tocode2 : <a class="code hl_variable" href="structIconvCacheEntry.html#a49f6d5946466f2737122b52e040b84ac">tocode1</a>;</div>
<div class="line"><span class="lineno">  644</span>  fromcode2 = <a class="code hl_function" href="mutt_2charset_8c.html#a54a6b32746302571e3a61b1daa22c512">mutt_ch_iconv_lookup</a>(<a class="code hl_variable" href="structIconvCacheEntry.html#a4f244848f1de7e83b00b60a2ab12661c">fromcode1</a>);</div>
<div class="line"><span class="lineno">  645</span>  fromcode2 = fromcode2 ? fromcode2 : <a class="code hl_variable" href="structIconvCacheEntry.html#a4f244848f1de7e83b00b60a2ab12661c">fromcode1</a>;</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>  <span class="comment">/* call system iconv with names it appreciates */</span></div>
<div class="line"><span class="lineno">  648</span>  iconv_t <a class="code hl_variable" href="structIconvCacheEntry.html#a8086f85b900d42d83d47b58f6b9f1fe7">cd</a> = iconv_open(tocode2, fromcode2);</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a> == <a class="code hl_define" href="mutt_2charset_8c.html#aac380af38f941083bdd07b61805786dd">ICONV_CACHE_SIZE</a>)</div>
<div class="line"><span class="lineno">  651</span>  {</div>
<div class="line"><span class="lineno">  652</span>    <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;iconv: dropping %s -&gt; %s from the cache\n&quot;</span>,</div>
<div class="line"><span class="lineno">  653</span>               <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[<a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a> - 1].<a class="code hl_variable" href="structIconvCacheEntry.html#a4f244848f1de7e83b00b60a2ab12661c">fromcode1</a>,</div>
<div class="line"><span class="lineno">  654</span>               <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[<a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a> - 1].<a class="code hl_variable" href="structIconvCacheEntry.html#a49f6d5946466f2737122b52e040b84ac">tocode1</a>);</div>
<div class="line"><span class="lineno">  655</span>    <span class="comment">/* get rid of the oldest entry */</span></div>
<div class="line"><span class="lineno">  656</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;<a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[<a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a> - 1].<a class="code hl_variable" href="structIconvCacheEntry.html#a4f244848f1de7e83b00b60a2ab12661c">fromcode1</a>);</div>
<div class="line"><span class="lineno">  657</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;<a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[<a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a> - 1].<a class="code hl_variable" href="structIconvCacheEntry.html#a49f6d5946466f2737122b52e040b84ac">tocode1</a>);</div>
<div class="line"><span class="lineno">  658</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a>(<a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[<a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a> - 1].<a class="code hl_variable" href="structIconvCacheEntry.html#a8086f85b900d42d83d47b58f6b9f1fe7">cd</a>))</div>
<div class="line"><span class="lineno">  659</span>    {</div>
<div class="line"><span class="lineno">  660</span>      iconv_close(<a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[<a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a> - 1].<a class="code hl_variable" href="structIconvCacheEntry.html#a8086f85b900d42d83d47b58f6b9f1fe7">cd</a>);</div>
<div class="line"><span class="lineno">  661</span>    }</div>
<div class="line"><span class="lineno">  662</span>    <a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a>--;</div>
<div class="line"><span class="lineno">  663</span>  }</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>  <span class="comment">/* make room for this one at the top */</span></div>
<div class="line"><span class="lineno">  666</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = <a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a> - 1; j &gt;= 0; j--)</div>
<div class="line"><span class="lineno">  667</span>  {</div>
<div class="line"><span class="lineno">  668</span>    <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[j + 1] = <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[j];</div>
<div class="line"><span class="lineno">  669</span>  }</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>  <a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a>++;</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>  <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;iconv: adding %s -&gt; %s to the cache\n&quot;</span>, <a class="code hl_variable" href="structIconvCacheEntry.html#a4f244848f1de7e83b00b60a2ab12661c">fromcode1</a>, <a class="code hl_variable" href="structIconvCacheEntry.html#a49f6d5946466f2737122b52e040b84ac">tocode1</a>);</div>
<div class="line"><span class="lineno">  674</span>  <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[0].fromcode1 = strdup(<a class="code hl_variable" href="structIconvCacheEntry.html#a4f244848f1de7e83b00b60a2ab12661c">fromcode1</a>);</div>
<div class="line"><span class="lineno">  675</span>  <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[0].tocode1 = strdup(<a class="code hl_variable" href="structIconvCacheEntry.html#a49f6d5946466f2737122b52e040b84ac">tocode1</a>);</div>
<div class="line"><span class="lineno">  676</span>  <a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[0].cd = <a class="code hl_variable" href="structIconvCacheEntry.html#a8086f85b900d42d83d47b58f6b9f1fe7">cd</a>;</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="structIconvCacheEntry.html#a8086f85b900d42d83d47b58f6b9f1fe7">cd</a>;</div>
<div class="line"><span class="lineno">  679</span>}</div>
<div class="ttc" id="agroup__logging__api_html_gae6c5fd73af3410b2d5e8099f8774c8da"><div class="ttname"><a href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a></div><div class="ttdeci">#define mutt_debug(LEVEL,...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00090">logging2.h:90</a></div></div>
<div class="ttc" id="alogging2_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3"><div class="ttname"><a href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a></div><div class="ttdeci">@ LL_DEBUG2</div><div class="ttdoc">Log at debug level 2.</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00045">logging2.h:45</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_a2639b5938db1d6035ff02786ff4566cb"><div class="ttname"><a href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a></div><div class="ttdeci">static int IconvCacheUsed</div><div class="ttdoc">Number of iconv descriptors in the cache.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00100">charset.c:100</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_a54a6b32746302571e3a61b1daa22c512"><div class="ttname"><a href="mutt_2charset_8c.html#a54a6b32746302571e3a61b1daa22c512">mutt_ch_iconv_lookup</a></div><div class="ttdeci">const char * mutt_ch_iconv_lookup(const char *chs)</div><div class="ttdoc">Look for a replacement character set.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00781">charset.c:781</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_a82415c52a83b63f4a8ce5110e86525a2"><div class="ttname"><a href="mutt_2charset_8c.html#a82415c52a83b63f4a8ce5110e86525a2">mutt_ch_charset_lookup</a></div><div class="ttdeci">const char * mutt_ch_charset_lookup(const char *chs)</div><div class="ttdoc">Look for a replacement character set.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00562">charset.c:562</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_aac380af38f941083bdd07b61805786dd"><div class="ttname"><a href="mutt_2charset_8c.html#aac380af38f941083bdd07b61805786dd">ICONV_CACHE_SIZE</a></div><div class="ttdeci">#define ICONV_CACHE_SIZE</div><div class="ttdoc">Max size of the iconv cache.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00096">charset.c:96</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_ad6c68b3b8d5fe0a4c163fc7f4154569e"><div class="ttname"><a href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a></div><div class="ttdeci">static struct IconvCacheEntry IconvCache[ICONV_CACHE_SIZE]</div><div class="ttdoc">Cache of iconv conversion descriptors.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00098">charset.c:98</a></div></div>
<div class="ttc" id="astructIconvCacheEntry_html"><div class="ttname"><a href="structIconvCacheEntry.html">IconvCacheEntry</a></div><div class="ttdoc">Cached iconv conversion descriptor.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00088">charset.c:89</a></div></div>
<div class="ttc" id="astructIconvCacheEntry_html_a49f6d5946466f2737122b52e040b84ac"><div class="ttname"><a href="structIconvCacheEntry.html#a49f6d5946466f2737122b52e040b84ac">IconvCacheEntry::tocode1</a></div><div class="ttdeci">char * tocode1</div><div class="ttdoc">Destination character set.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00091">charset.c:91</a></div></div>
<div class="ttc" id="astructIconvCacheEntry_html_a4f244848f1de7e83b00b60a2ab12661c"><div class="ttname"><a href="structIconvCacheEntry.html#a4f244848f1de7e83b00b60a2ab12661c">IconvCacheEntry::fromcode1</a></div><div class="ttdeci">char * fromcode1</div><div class="ttdoc">Source character set.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00090">charset.c:90</a></div></div>
<div class="ttc" id="astructIconvCacheEntry_html_a8086f85b900d42d83d47b58f6b9f1fe7"><div class="ttname"><a href="structIconvCacheEntry.html#a8086f85b900d42d83d47b58f6b9f1fe7">IconvCacheEntry::cd</a></div><div class="ttdeci">iconv_t cd</div><div class="ttdoc">iconv conversion descriptor</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00092">charset.c:92</a></div></div>
</div><!-- fragment --><div id="dynsection-31" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-31-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-31-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-31-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_af7380ef31de4a56ab644b71f0a010ed9_cgraph.svg" width="392" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-32" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-32-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-32-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-32-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_af7380ef31de4a56ab644b71f0a010ed9_icgraph.svg" width="387" height="467"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a495d768c7996bc40c64980efbbb191c8" name="a495d768c7996bc40c64980efbbb191c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a495d768c7996bc40c64980efbbb191c8">&#9670;&#160;</a></span>mutt_ch_lookup_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mutt_ch_lookup_add </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="#a677743e89f8cc2c57a0e6e91a47bdc4a">LookupType</a></td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>pat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>replace</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBuffer.html">Buffer</a> *</td>          <td class="paramname"><span class="paramname"><em>err</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a new character set lookup. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Type of character set, e.g. <a class="el" href="#a677743e89f8cc2c57a0e6e91a47bdc4aaf70d36a04a9e6e5ecd554392626886d4" title="Alias for another character set.">MUTT_LOOKUP_CHARSET</a> </td></tr>
    <tr><td class="paramname">pat</td><td><a class="el" href="structPattern.html" title="A simple (non-regex) pattern.">Pattern</a> to match </td></tr>
    <tr><td class="paramname">replace</td><td>Replacement string </td></tr>
    <tr><td class="paramname">err</td><td><a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> for error message </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td><a class="el" href="structLookup.html" title="Regex to String lookup table.">Lookup</a> added to list </td></tr>
    <tr><td class="paramname">false</td><td><a class="el" href="structRegex.html" title="Cached regular expression.">Regex</a> string was invalid</td></tr>
  </table>
  </dd>
</dl>
<p>Add a regex for a character set and a replacement name. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00509">509</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  511</span>{</div>
<div class="line"><span class="lineno">  512</span>  <span class="keywordflow">if</span> (!pat || !replace)</div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>  regex_t *rx = <a class="code hl_define" href="memory_8h.html#a9aaf8f21a29735767a069ff1aee9d7d9">MUTT_MEM_CALLOC</a>(1, regex_t);</div>
<div class="line"><span class="lineno">  516</span>  <span class="keywordtype">int</span> rc = <a class="code hl_define" href="regex3_8h.html#a349838a3143be1dd9b0500bfbe54d48f">REG_COMP</a>(rx, pat, REG_ICASE);</div>
<div class="line"><span class="lineno">  517</span>  <span class="keywordflow">if</span> (rc != 0)</div>
<div class="line"><span class="lineno">  518</span>  {</div>
<div class="line"><span class="lineno">  519</span>    regerror(rc, rx, err-&gt;<a class="code hl_variable" href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">data</a>, err-&gt;<a class="code hl_variable" href="structBuffer.html#a1d9ee60bcf94de702b15ec2b5d811995">dsize</a>);</div>
<div class="line"><span class="lineno">  520</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;rx);</div>
<div class="line"><span class="lineno">  521</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  522</span>  }</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structLookup.html">Lookup</a> *l = <a class="code hl_function" href="mutt_2charset_8c.html#a8849f881bcc5d973667da6af45138741">lookup_new</a>();</div>
<div class="line"><span class="lineno">  525</span>  l-&gt;<a class="code hl_variable" href="structLookup.html#a89726da813ba93a35abba858ff2f5a0b">type</a> = <a class="code hl_variable" href="structLookup.html#a89726da813ba93a35abba858ff2f5a0b">type</a>;</div>
<div class="line"><span class="lineno">  526</span>  l-&gt;<a class="code hl_variable" href="structLookup.html#a25a23240d9698ea3e760736f1e516c3c">replacement</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(replace);</div>
<div class="line"><span class="lineno">  527</span>  l-&gt;<a class="code hl_variable" href="structLookup.html#ab8893578bc138302e089ee40fea03fee">regex</a>.<a class="code hl_variable" href="structRegex.html#a91a347ac006d49f161382d291f0edd99">pattern</a> = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(pat);</div>
<div class="line"><span class="lineno">  528</span>  l-&gt;<a class="code hl_variable" href="structLookup.html#ab8893578bc138302e089ee40fea03fee">regex</a>.<a class="code hl_variable" href="structRegex.html#af9ccc25da6324c9055e53966abe9a7b3">regex</a> = rx;</div>
<div class="line"><span class="lineno">  529</span>  l-&gt;<a class="code hl_variable" href="structLookup.html#ab8893578bc138302e089ee40fea03fee">regex</a>.<a class="code hl_variable" href="structRegex.html#adf40b2d25dabe5abb853946f35fe7c44">pat_not</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>  <a class="code hl_define" href="queue_8h.html#a512bee16b46f601078c96c776d2648c3">TAILQ_INSERT_TAIL</a>(&amp;<a class="code hl_variable" href="mutt_2charset_8c.html#a34621a4d59512ce0d1f14d66d2c6abde">Lookups</a>, l, entries);</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  534</span>}</div>
<div class="ttc" id="amutt_2charset_8c_html_a34621a4d59512ce0d1f14d66d2c6abde"><div class="ttname"><a href="mutt_2charset_8c.html#a34621a4d59512ce0d1f14d66d2c6abde">Lookups</a></div><div class="ttdeci">static struct LookupList Lookups</div><div class="ttdoc">Lookup table of preferred character set names.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00083">charset.c:83</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_a8849f881bcc5d973667da6af45138741"><div class="ttname"><a href="mutt_2charset_8c.html#a8849f881bcc5d973667da6af45138741">lookup_new</a></div><div class="ttdeci">static struct Lookup * lookup_new(void)</div><div class="ttdoc">Create a new Lookup.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00269">charset.c:269</a></div></div>
<div class="ttc" id="aqueue_8h_html_a512bee16b46f601078c96c776d2648c3"><div class="ttname"><a href="queue_8h.html#a512bee16b46f601078c96c776d2648c3">TAILQ_INSERT_TAIL</a></div><div class="ttdeci">#define TAILQ_INSERT_TAIL(head, elm, field)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00866">queue.h:866</a></div></div>
<div class="ttc" id="aregex3_8h_html_a349838a3143be1dd9b0500bfbe54d48f"><div class="ttname"><a href="regex3_8h.html#a349838a3143be1dd9b0500bfbe54d48f">REG_COMP</a></div><div class="ttdeci">#define REG_COMP(preg, regex, cflags)</div><div class="ttdoc">Compile a regular expression.</div><div class="ttdef"><b>Definition</b> <a href="regex3_8h_source.html#l00050">regex3.h:50</a></div></div>
<div class="ttc" id="astructBuffer_html_a1d9ee60bcf94de702b15ec2b5d811995"><div class="ttname"><a href="structBuffer.html#a1d9ee60bcf94de702b15ec2b5d811995">Buffer::dsize</a></div><div class="ttdeci">size_t dsize</div><div class="ttdoc">Length of data.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00039">buffer.h:39</a></div></div>
<div class="ttc" id="astructBuffer_html_aeec1fd4af0ddf6765b0187466d4361b8"><div class="ttname"><a href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">Buffer::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">Pointer to data.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00037">buffer.h:37</a></div></div>
<div class="ttc" id="astructLookup_html"><div class="ttname"><a href="structLookup.html">Lookup</a></div><div class="ttdoc">Regex to String lookup table.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00073">charset.c:74</a></div></div>
<div class="ttc" id="astructLookup_html_a25a23240d9698ea3e760736f1e516c3c"><div class="ttname"><a href="structLookup.html#a25a23240d9698ea3e760736f1e516c3c">Lookup::replacement</a></div><div class="ttdeci">char * replacement</div><div class="ttdoc">Alternative charset to use.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00077">charset.c:77</a></div></div>
<div class="ttc" id="astructLookup_html_a89726da813ba93a35abba858ff2f5a0b"><div class="ttname"><a href="structLookup.html#a89726da813ba93a35abba858ff2f5a0b">Lookup::type</a></div><div class="ttdeci">enum LookupType type</div><div class="ttdoc">Lookup type.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00075">charset.c:75</a></div></div>
<div class="ttc" id="astructLookup_html_ab8893578bc138302e089ee40fea03fee"><div class="ttname"><a href="structLookup.html#ab8893578bc138302e089ee40fea03fee">Lookup::regex</a></div><div class="ttdeci">struct Regex regex</div><div class="ttdoc">Regular expression.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00076">charset.c:76</a></div></div>
<div class="ttc" id="astructRegex_html_a91a347ac006d49f161382d291f0edd99"><div class="ttname"><a href="structRegex.html#a91a347ac006d49f161382d291f0edd99">Regex::pattern</a></div><div class="ttdeci">char * pattern</div><div class="ttdoc">printable version</div><div class="ttdef"><b>Definition</b> <a href="regex3_8h_source.html#l00087">regex3.h:87</a></div></div>
<div class="ttc" id="astructRegex_html_adf40b2d25dabe5abb853946f35fe7c44"><div class="ttname"><a href="structRegex.html#adf40b2d25dabe5abb853946f35fe7c44">Regex::pat_not</a></div><div class="ttdeci">bool pat_not</div><div class="ttdoc">do not match</div><div class="ttdef"><b>Definition</b> <a href="regex3_8h_source.html#l00089">regex3.h:89</a></div></div>
<div class="ttc" id="astructRegex_html_af9ccc25da6324c9055e53966abe9a7b3"><div class="ttname"><a href="structRegex.html#af9ccc25da6324c9055e53966abe9a7b3">Regex::regex</a></div><div class="ttdeci">regex_t * regex</div><div class="ttdoc">compiled expression</div><div class="ttdef"><b>Definition</b> <a href="regex3_8h_source.html#l00088">regex3.h:88</a></div></div>
</div><!-- fragment --><div id="dynsection-33" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-33-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-33-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-33-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a495d768c7996bc40c64980efbbb191c8_cgraph.svg" width="312" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-34" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-34-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-34-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-34-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a495d768c7996bc40c64980efbbb191c8_icgraph.svg" width="352" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a1b4218535731ab6b94715522af613e00" name="a1b4218535731ab6b94715522af613e00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b4218535731ab6b94715522af613e00">&#9670;&#160;</a></span>mutt_ch_lookup_remove()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_ch_lookup_remove </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove all the character set lookups. </p>
<p>Empty the list of replacement character set names. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00541">541</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  542</span>{</div>
<div class="line"><span class="lineno">  543</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structLookup.html">Lookup</a> *l = NULL;</div>
<div class="line"><span class="lineno">  544</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structLookup.html">Lookup</a> *tmp = NULL;</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>  <a class="code hl_define" href="queue_8h.html#a2a85f19896399eecd0ebf91cb8176166">TAILQ_FOREACH_SAFE</a>(l, &amp;<a class="code hl_variable" href="mutt_2charset_8c.html#a34621a4d59512ce0d1f14d66d2c6abde">Lookups</a>, entries, tmp)</div>
<div class="line"><span class="lineno">  547</span>  {</div>
<div class="line"><span class="lineno">  548</span>    <a class="code hl_define" href="queue_8h.html#aaae87ca18c28066e1a96221e762d1209">TAILQ_REMOVE</a>(&amp;<a class="code hl_variable" href="mutt_2charset_8c.html#a34621a4d59512ce0d1f14d66d2c6abde">Lookups</a>, l, entries);</div>
<div class="line"><span class="lineno">  549</span>    <a class="code hl_function" href="mutt_2charset_8c.html#abb434a7b5d54f0904f8ae5a22b261a44">lookup_free</a>(&amp;l);</div>
<div class="line"><span class="lineno">  550</span>  }</div>
<div class="line"><span class="lineno">  551</span>}</div>
<div class="ttc" id="amutt_2charset_8c_html_abb434a7b5d54f0904f8ae5a22b261a44"><div class="ttname"><a href="mutt_2charset_8c.html#abb434a7b5d54f0904f8ae5a22b261a44">lookup_free</a></div><div class="ttdeci">static void lookup_free(struct Lookup **ptr)</div><div class="ttdoc">Free a Lookup.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00278">charset.c:278</a></div></div>
<div class="ttc" id="aqueue_8h_html_a2a85f19896399eecd0ebf91cb8176166"><div class="ttname"><a href="queue_8h.html#a2a85f19896399eecd0ebf91cb8176166">TAILQ_FOREACH_SAFE</a></div><div class="ttdeci">#define TAILQ_FOREACH_SAFE(var, head, field, tvar)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00792">queue.h:792</a></div></div>
<div class="ttc" id="aqueue_8h_html_aaae87ca18c28066e1a96221e762d1209"><div class="ttname"><a href="queue_8h.html#aaae87ca18c28066e1a96221e762d1209">TAILQ_REMOVE</a></div><div class="ttdeci">#define TAILQ_REMOVE(head, elm, field)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00901">queue.h:901</a></div></div>
</div><!-- fragment --><div id="dynsection-35" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-35-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-35-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-35-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a1b4218535731ab6b94715522af613e00_cgraph.svg" width="328" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-36" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-36-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-36-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-36-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a1b4218535731ab6b94715522af613e00_icgraph.svg" width="378" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7bb46d6d31e21e8390de490c5894bfda" name="a7bb46d6d31e21e8390de490c5894bfda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bb46d6d31e21e8390de490c5894bfda">&#9670;&#160;</a></span>mutt_ch_set_charset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_ch_set_charset </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>charset</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the records for a new character set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">charset</td><td>New character set</td></tr>
  </table>
  </dd>
</dl>
<p>Check if this character set is utf-8 and pick a suitable replacement character for unprintable characters.</p>
<dl class="section note"><dt>Note</dt><dd>This calls <code>bind_textdomain_codeset()</code> which will affect future message translations. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l01075">1075</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1076</span>{</div>
<div class="line"><span class="lineno"> 1077</span>  <span class="keywordtype">char</span> buf[256] = { 0 };</div>
<div class="line"><span class="lineno"> 1078</span> </div>
<div class="line"><span class="lineno"> 1079</span>  <a class="code hl_function" href="mutt_2charset_8c.html#a4b347dd75af05a18dbe328c354c18fe8">mutt_ch_canonical_charset</a>(buf, <span class="keyword">sizeof</span>(buf), charset);</div>
<div class="line"><span class="lineno"> 1080</span> </div>
<div class="line"><span class="lineno"> 1081</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="#a56cbec4a6366d637d41d151d10dc5b87">mutt_ch_is_utf8</a>(buf))</div>
<div class="line"><span class="lineno"> 1082</span>  {</div>
<div class="line"><span class="lineno"> 1083</span>    <a class="code hl_variable" href="mutt_2charset_8c.html#a7bcd93869f482805be7e6d437d29f54d">CharsetIsUtf8</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1084</span>    <a class="code hl_variable" href="mutt_2charset_8c.html#ac31e11b5fb12abda40361188af9105ef">ReplacementChar</a> = 0xfffd; <span class="comment">/* replacement character */</span></div>
<div class="line"><span class="lineno"> 1085</span>  }</div>
<div class="line"><span class="lineno"> 1086</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1087</span>  {</div>
<div class="line"><span class="lineno"> 1088</span>    <a class="code hl_variable" href="mutt_2charset_8c.html#a7bcd93869f482805be7e6d437d29f54d">CharsetIsUtf8</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1089</span>    <a class="code hl_variable" href="mutt_2charset_8c.html#ac31e11b5fb12abda40361188af9105ef">ReplacementChar</a> = <span class="charliteral">&#39;?&#39;</span>;</div>
<div class="line"><span class="lineno"> 1090</span>  }</div>
<div class="line"><span class="lineno"> 1091</span> </div>
<div class="line"><span class="lineno"> 1092</span><span class="preprocessor">#if defined(HAVE_BIND_TEXTDOMAIN_CODESET) &amp;&amp; defined(ENABLE_NLS)</span></div>
<div class="line"><span class="lineno"> 1093</span>  bind_textdomain_codeset(PACKAGE, buf);</div>
<div class="line"><span class="lineno"> 1094</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1095</span>}</div>
<div class="ttc" id="amutt_2charset_8c_html_a7bcd93869f482805be7e6d437d29f54d"><div class="ttname"><a href="mutt_2charset_8c.html#a7bcd93869f482805be7e6d437d29f54d">CharsetIsUtf8</a></div><div class="ttdeci">bool CharsetIsUtf8</div><div class="ttdoc">Is the user&#39;s current character set utf-8?</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00066">charset.c:66</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_ac31e11b5fb12abda40361188af9105ef"><div class="ttname"><a href="mutt_2charset_8c.html#ac31e11b5fb12abda40361188af9105ef">ReplacementChar</a></div><div class="ttdeci">wchar_t ReplacementChar</div><div class="ttdoc">When a Unicode character can&#39;t be displayed, use this instead.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00061">charset.c:61</a></div></div>
</div><!-- fragment --><div id="dynsection-37" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-37-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-37-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-37-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a7bb46d6d31e21e8390de490c5894bfda_cgraph.svg" width="392" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-38" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-38-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-38-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-38-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a7bb46d6d31e21e8390de490c5894bfda_icgraph.svg" width="284" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a52a634eff18853e0a34a06876717fa4c" name="a52a634eff18853e0a34a06876717fa4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52a634eff18853e0a34a06876717fa4c">&#9670;&#160;</a></span>mutt_ch_cache_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_ch_cache_cleanup </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean up the cached iconv handles and charset strings. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l01175">1175</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1176</span>{</div>
<div class="line"><span class="lineno"> 1177</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a>; i++)</div>
<div class="line"><span class="lineno"> 1178</span>  {</div>
<div class="line"><span class="lineno"> 1179</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;<a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[i].fromcode1);</div>
<div class="line"><span class="lineno"> 1180</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;<a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[i].tocode1);</div>
<div class="line"><span class="lineno"> 1181</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a>(<a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[i].cd))</div>
<div class="line"><span class="lineno"> 1182</span>    {</div>
<div class="line"><span class="lineno"> 1183</span>      iconv_close(<a class="code hl_variable" href="mutt_2charset_8c.html#ad6c68b3b8d5fe0a4c163fc7f4154569e">IconvCache</a>[i].cd);</div>
<div class="line"><span class="lineno"> 1184</span>    }</div>
<div class="line"><span class="lineno"> 1185</span>  }</div>
<div class="line"><span class="lineno"> 1186</span>  <a class="code hl_variable" href="mutt_2charset_8c.html#a2639b5938db1d6035ff02786ff4566cb">IconvCacheUsed</a> = 0;</div>
<div class="line"><span class="lineno"> 1187</span>}</div>
</div><!-- fragment --><div id="dynsection-39" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-39-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-39-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-39-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a52a634eff18853e0a34a06876717fa4c_cgraph.svg" width="324" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-40" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-40-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-40-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-40-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_a52a634eff18853e0a34a06876717fa4c_icgraph.svg" width="276" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af99f0dca1b479b94f1287bc8aa050e4c" name="af99f0dca1b479b94f1287bc8aa050e4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af99f0dca1b479b94f1287bc8aa050e4c">&#9670;&#160;</a></span>iconv_t_valid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool iconv_t_valid </td>
          <td>(</td>
          <td class="paramtype">const iconv_t</td>          <td class="paramname"><span class="paramname"><em>cd</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is the conversion descriptor valid? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cd</td><td>Conversion descriptor to test </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>It's valid </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8h_source.html#l00105">105</a> of file <a class="el" href="mutt_2charset_8h_source.html">charset.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  106</span>{</div>
<div class="line"><span class="lineno">  107</span>  <span class="keywordflow">return</span> cd != <a class="code hl_define" href="#a343b22f930dd486990858724937bb6cd">ICONV_T_INVALID</a>;</div>
<div class="line"><span class="lineno">  108</span>}</div>
</div><!-- fragment --><div id="dynsection-41" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-41-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-41-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-41-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt_2charset_8h_af99f0dca1b479b94f1287bc8aa050e4c_icgraph.svg" width="542" height="606"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7bcd93869f482805be7e6d437d29f54d" name="a7bcd93869f482805be7e6d437d29f54d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bcd93869f482805be7e6d437d29f54d">&#9670;&#160;</a></span>CharsetIsUtf8</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool CharsetIsUtf8</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is the user's current character set utf-8? </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00066">66</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>

</div>
</div>
<a id="ac31e11b5fb12abda40361188af9105ef" name="ac31e11b5fb12abda40361188af9105ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac31e11b5fb12abda40361188af9105ef">&#9670;&#160;</a></span>ReplacementChar</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">wchar_t ReplacementChar</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel extern">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>When a Unicode character can't be displayed, use this instead. </p>

<p class="definition">Definition at line <a class="el" href="mutt_2charset_8c_source.html#l00061">61</a> of file <a class="el" href="mutt_2charset_8c_source.html">charset.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>
