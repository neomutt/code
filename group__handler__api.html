<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: Mime Handler API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><a href="https://neomutt.org"><img alt="Logo" src="neomutt-64.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <a style="color: black; text-decoration: none;" href="https://neomutt.org">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">2025-09-05-43-g177ed6</span>
   </div>
   <div id="projectbrief">Teaching an old dog new tricks</div>
   </a>
   <a href="https://github.com/neomutt/neomutt" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000000; color:#fff; position: fixed; top: 0; border: 0; right: 0; z-index: 9999;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </td>
   <td><a style="text-decoration: none; position: absolute; right: 0; top: 25px; margin-right: 100px; color: #66d866; font-size: 400%;" href="http://www.doxygen.org/index.html">DOXYGEN</a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group__handler__api.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Mime Handler API</div></div>
</div><!--header-->
<div class="contents">

<p>Prototype for a function to handle MIME parts.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga52988b26b8120b105355accebe501bee" id="r_ga52988b26b8120b105355accebe501bee"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga52988b26b8120b105355accebe501bee">text_enriched_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga52988b26b8120b105355accebe501bee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for enriched text - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga52988b26b8120b105355accebe501bee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6d9d9125a5e89f59e0bdc7dfe1da915f" id="r_ga6d9d9125a5e89f59e0bdc7dfe1da915f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga6d9d9125a5e89f59e0bdc7dfe1da915f">autoview_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga6d9d9125a5e89f59e0bdc7dfe1da915f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for autoviewable attachments - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga6d9d9125a5e89f59e0bdc7dfe1da915f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5552ea70deb1b5c9d5eed357948915d6" id="r_ga5552ea70deb1b5c9d5eed357948915d6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga5552ea70deb1b5c9d5eed357948915d6">text_plain_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga5552ea70deb1b5c9d5eed357948915d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for plain text - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga5552ea70deb1b5c9d5eed357948915d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabb6e3be5f79882648b38690c851c6587" id="r_gabb6e3be5f79882648b38690c851c6587"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gabb6e3be5f79882648b38690c851c6587">message_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:gabb6e3be5f79882648b38690c851c6587"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for message/rfc822 body parts - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:gabb6e3be5f79882648b38690c851c6587"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a838ae7b50e8ffa147203c5cfaa3272" id="r_ga8a838ae7b50e8ffa147203c5cfaa3272"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga8a838ae7b50e8ffa147203c5cfaa3272">external_body_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga8a838ae7b50e8ffa147203c5cfaa3272"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for external-body emails - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga8a838ae7b50e8ffa147203c5cfaa3272"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4ff5374eaa24ed80f864aa4caeb54a46" id="r_ga4ff5374eaa24ed80f864aa4caeb54a46"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4ff5374eaa24ed80f864aa4caeb54a46">alternative_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga4ff5374eaa24ed80f864aa4caeb54a46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for multipart alternative emails - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga4ff5374eaa24ed80f864aa4caeb54a46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad678bde50d3eb6367c65e9ed646939bc" id="r_gad678bde50d3eb6367c65e9ed646939bc"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad678bde50d3eb6367c65e9ed646939bc">multilingual_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:gad678bde50d3eb6367c65e9ed646939bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for multi-lingual emails - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:gad678bde50d3eb6367c65e9ed646939bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac1b8e821ab05eee2180e82f0ae4c7421" id="r_gac1b8e821ab05eee2180e82f0ae4c7421"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac1b8e821ab05eee2180e82f0ae4c7421">multipart_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:gac1b8e821ab05eee2180e82f0ae4c7421"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for multipart emails - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:gac1b8e821ab05eee2180e82f0ae4c7421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaef1af1685b1d85753ac8ab8c1fc9339" id="r_gaaef1af1685b1d85753ac8ab8c1fc9339"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaaef1af1685b1d85753ac8ab8c1fc9339">valid_pgp_encrypted_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:gaaef1af1685b1d85753ac8ab8c1fc9339"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for valid pgp-encrypted emails - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:gaaef1af1685b1d85753ac8ab8c1fc9339"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaadf7c637f58f34e7a58ac5b2c2b0f42f" id="r_gaadf7c637f58f34e7a58ac5b2c2b0f42f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaadf7c637f58f34e7a58ac5b2c2b0f42f">malformed_pgp_encrypted_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:gaadf7c637f58f34e7a58ac5b2c2b0f42f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for invalid pgp-encrypted emails - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:gaadf7c637f58f34e7a58ac5b2c2b0f42f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7ccf06ce10b9aed658fcc6c7a40c64b8" id="r_ga7ccf06ce10b9aed658fcc6c7a40c64b8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7ccf06ce10b9aed658fcc6c7a40c64b8">mutt_protected_headers_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga7ccf06ce10b9aed658fcc6c7a40c64b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for protected headers - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga7ccf06ce10b9aed658fcc6c7a40c64b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad8f7563b8c9aba96de145d0e17e58437" id="r_gad8f7563b8c9aba96de145d0e17e58437"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gad8f7563b8c9aba96de145d0e17e58437">mutt_signed_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:gad8f7563b8c9aba96de145d0e17e58437"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for "multipart/signed" - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:gad8f7563b8c9aba96de145d0e17e58437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2de61c155f3d4ff8b010e2e4f615ea94" id="r_ga2de61c155f3d4ff8b010e2e4f615ea94"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2de61c155f3d4ff8b010e2e4f615ea94">crypt_pgp_application_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga2de61c155f3d4ff8b010e2e4f615ea94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a9d7b47fb748a7cdb4975f2dde8179a98">CryptModuleSpecs::application_handler()</a> - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga2de61c155f3d4ff8b010e2e4f615ea94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b445e21874bc1e1ec681a2626df13f9" id="r_ga7b445e21874bc1e1ec681a2626df13f9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga7b445e21874bc1e1ec681a2626df13f9">crypt_pgp_encrypted_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga7b445e21874bc1e1ec681a2626df13f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a0a6f227729bf45fc362bc0896a241de2">CryptModuleSpecs::encrypted_handler()</a> - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga7b445e21874bc1e1ec681a2626df13f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga570796cc91abc82fbc16bcd285137688" id="r_ga570796cc91abc82fbc16bcd285137688"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga570796cc91abc82fbc16bcd285137688">crypt_smime_application_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga570796cc91abc82fbc16bcd285137688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a9d7b47fb748a7cdb4975f2dde8179a98">CryptModuleSpecs::application_handler()</a> - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga570796cc91abc82fbc16bcd285137688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaadbb7eb9de333071b51c4ff88b45315b" id="r_gaadbb7eb9de333071b51c4ff88b45315b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaadbb7eb9de333071b51c4ff88b45315b">rfc3676_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:gaadbb7eb9de333071b51c4ff88b45315b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for format=flowed - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:gaadbb7eb9de333071b51c4ff88b45315b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Prototype for a function to handle MIME parts. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b_email</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of the email </td></tr>
    <tr><td class="paramname">state</td><td><a class="el" href="structState.html" title="Keep track when processing files.">State</a> of text being processed </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error </td></tr>
  </table>
  </dd>
</dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga52988b26b8120b105355accebe501bee" name="ga52988b26b8120b105355accebe501bee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga52988b26b8120b105355accebe501bee">&#9670;&#160;</a></span>text_enriched_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int text_enriched_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for enriched text - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Always </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="enriched_8c_source.html#l00469">469</a> of file <a class="el" href="enriched_8c_source.html">enriched.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  470</span>{</div>
<div class="line"><span class="lineno">  471</span>  <span class="keyword">enum</span></div>
<div class="line"><span class="lineno">  472</span>  {</div>
<div class="line"><span class="lineno">  473</span>    TEXT,</div>
<div class="line"><span class="lineno">  474</span>    LANGLE,</div>
<div class="line"><span class="lineno">  475</span>    TAG,</div>
<div class="line"><span class="lineno">  476</span>    BOGUS_TAG,</div>
<div class="line"><span class="lineno">  477</span>    NEWLINE,</div>
<div class="line"><span class="lineno">  478</span>    ST_EOF,</div>
<div class="line"><span class="lineno">  479</span>    DONE</div>
<div class="line"><span class="lineno">  480</span>  } text_state = TEXT;</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>  <span class="keywordtype">long</span> bytes = b_email-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a>;</div>
<div class="line"><span class="lineno">  483</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structEnrichedState.html">EnrichedState</a> enriched = { 0 };</div>
<div class="line"><span class="lineno">  484</span>  wint_t wc = 0;</div>
<div class="line"><span class="lineno">  485</span>  <span class="keywordtype">int</span> tag_len = 0;</div>
<div class="line"><span class="lineno">  486</span>  <span class="keywordtype">wchar_t</span> tag[1024 + 1];</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>  enriched.<a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a> = <a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a>;</div>
<div class="line"><span class="lineno">  489</span>  enriched.<a class="code hl_variable" href="structEnrichedState.html#afed741d4664b2201a4bd28b23f776b26">wrap_margin</a> = ((<a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a>-&gt;<a class="code hl_variable" href="structState.html#a2c506e7d8513e59e6162cdc5d6f9f320">wraplen</a> &gt; 4) &amp;&amp;</div>
<div class="line"><span class="lineno">  490</span>                          ((<a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a>-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>) || (<a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a>-&gt;<a class="code hl_variable" href="structState.html#a2c506e7d8513e59e6162cdc5d6f9f320">wraplen</a> &lt; 76))) ?</div>
<div class="line"><span class="lineno">  491</span>                             <a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a>-&gt;<a class="code hl_variable" href="structState.html#a2c506e7d8513e59e6162cdc5d6f9f320">wraplen</a> - 4 :</div>
<div class="line"><span class="lineno">  492</span>                             72;</div>
<div class="line"><span class="lineno">  493</span>  enriched.<a class="code hl_variable" href="structEnrichedState.html#aefb17717977e343b9c178b934c65830e">line_max</a> = enriched.<a class="code hl_variable" href="structEnrichedState.html#afed741d4664b2201a4bd28b23f776b26">wrap_margin</a> * 4;</div>
<div class="line"><span class="lineno">  494</span>  enriched.<a class="code hl_variable" href="structEnrichedState.html#a5c98ee59229be04267e11585aa973684">line</a> = <a class="code hl_define" href="memory_8h.html#a9aaf8f21a29735767a069ff1aee9d7d9">MUTT_MEM_CALLOC</a>(enriched.<a class="code hl_variable" href="structEnrichedState.html#aefb17717977e343b9c178b934c65830e">line_max</a> + 1, <span class="keywordtype">wchar_t</span>);</div>
<div class="line"><span class="lineno">  495</span>  enriched.<a class="code hl_variable" href="structEnrichedState.html#a4302bc98504a6e715be8e5006833051c">param</a> = <a class="code hl_define" href="memory_8h.html#a9aaf8f21a29735767a069ff1aee9d7d9">MUTT_MEM_CALLOC</a>(256, <span class="keywordtype">wchar_t</span>);</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>  enriched.<a class="code hl_variable" href="structEnrichedState.html#ad6e42cbea8841c7ddff457cb8c63693e">param_len</a> = 256;</div>
<div class="line"><span class="lineno">  498</span>  enriched.<a class="code hl_variable" href="structEnrichedState.html#a3def386a556bda9d870e9b44bd2407e0">param_used</a> = 0;</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a>-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>)</div>
<div class="line"><span class="lineno">  501</span>  {</div>
<div class="line"><span class="lineno">  502</span>    <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(<a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a>, <a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a>-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>);</div>
<div class="line"><span class="lineno">  503</span>    enriched.<a class="code hl_variable" href="structEnrichedState.html#aff30327d80e7c33db452c719aeea9c7a">indent_len</a> += <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(<a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a>-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>);</div>
<div class="line"><span class="lineno">  504</span>  }</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>  <span class="keywordflow">while</span> (text_state != DONE)</div>
<div class="line"><span class="lineno">  507</span>  {</div>
<div class="line"><span class="lineno">  508</span>    <span class="keywordflow">if</span> (text_state != ST_EOF)</div>
<div class="line"><span class="lineno">  509</span>    {</div>
<div class="line"><span class="lineno">  510</span>      <span class="keywordflow">if</span> (!bytes || ((wc = fgetwc(<a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a>-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>)) == WEOF))</div>
<div class="line"><span class="lineno">  511</span>        text_state = ST_EOF;</div>
<div class="line"><span class="lineno">  512</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  513</span>        bytes--;</div>
<div class="line"><span class="lineno">  514</span>    }</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>    <span class="keywordflow">switch</span> (text_state)</div>
<div class="line"><span class="lineno">  517</span>    {</div>
<div class="line"><span class="lineno">  518</span>      <span class="keywordflow">case</span> TEXT:</div>
<div class="line"><span class="lineno">  519</span>        <span class="keywordflow">switch</span> (wc)</div>
<div class="line"><span class="lineno">  520</span>        {</div>
<div class="line"><span class="lineno">  521</span>          <span class="keywordflow">case</span> <span class="charliteral">&#39;&lt;&#39;</span>:</div>
<div class="line"><span class="lineno">  522</span>            text_state = LANGLE;</div>
<div class="line"><span class="lineno">  523</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>          <span class="keywordflow">case</span> <span class="charliteral">&#39;\n&#39;</span>:</div>
<div class="line"><span class="lineno">  526</span>            <span class="keywordflow">if</span> (enriched.<a class="code hl_variable" href="structEnrichedState.html#a7003e363f1bd2f53eded1dffd3dd51d3">tag_level</a>[<a class="code hl_enumvalue" href="enriched_8c.html#a4148209775369a82f56b9fde2cf2dd2da06eab0f67d7b47d5693157b7ad9f3bb1">RICH_NOFILL</a>])</div>
<div class="line"><span class="lineno">  527</span>            {</div>
<div class="line"><span class="lineno">  528</span>              <a class="code hl_function" href="enriched_8c.html#ab669a4eb5f4606a93dc08e1226172cf1">enriched_flush</a>(&amp;enriched, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  529</span>            }</div>
<div class="line"><span class="lineno">  530</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  531</span>            {</div>
<div class="line"><span class="lineno">  532</span>              <a class="code hl_function" href="enriched_8c.html#a564da94635e771c599f27fb909577626">enriched_putwc</a>((<span class="keywordtype">wchar_t</span>) <span class="charliteral">&#39; &#39;</span>, &amp;enriched);</div>
<div class="line"><span class="lineno">  533</span>              text_state = NEWLINE;</div>
<div class="line"><span class="lineno">  534</span>            }</div>
<div class="line"><span class="lineno">  535</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>          <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  538</span>            <a class="code hl_function" href="enriched_8c.html#a564da94635e771c599f27fb909577626">enriched_putwc</a>(wc, &amp;enriched);</div>
<div class="line"><span class="lineno">  539</span>        }</div>
<div class="line"><span class="lineno">  540</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>      <span class="keywordflow">case</span> LANGLE:</div>
<div class="line"><span class="lineno">  543</span>        <span class="keywordflow">if</span> (wc == (<span class="keywordtype">wchar_t</span>) <span class="charliteral">&#39;&lt;&#39;</span>)</div>
<div class="line"><span class="lineno">  544</span>        {</div>
<div class="line"><span class="lineno">  545</span>          <a class="code hl_function" href="enriched_8c.html#a564da94635e771c599f27fb909577626">enriched_putwc</a>(wc, &amp;enriched);</div>
<div class="line"><span class="lineno">  546</span>          text_state = TEXT;</div>
<div class="line"><span class="lineno">  547</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  548</span>        }</div>
<div class="line"><span class="lineno">  549</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  550</span>        {</div>
<div class="line"><span class="lineno">  551</span>          tag_len = 0;</div>
<div class="line"><span class="lineno">  552</span>          text_state = TAG;</div>
<div class="line"><span class="lineno">  553</span>        }</div>
<div class="line"><span class="lineno">  554</span>        <span class="comment">/* Yes, (it wasn&#39;t a &lt;&lt;, so this char is first in TAG) */</span></div>
<div class="line"><span class="lineno">  555</span>        <a class="code hl_define" href="mutt_2lib_8h.html#a0cf2d82c57a09723ab59e6f4dcc45b84">FALLTHROUGH</a>;</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>      <span class="keywordflow">case</span> TAG:</div>
<div class="line"><span class="lineno">  558</span>        <span class="keywordflow">if</span> (wc == (<span class="keywordtype">wchar_t</span>) <span class="charliteral">&#39;&gt;&#39;</span>)</div>
<div class="line"><span class="lineno">  559</span>        {</div>
<div class="line"><span class="lineno">  560</span>          tag[tag_len] = (wchar_t) <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  561</span>          <a class="code hl_function" href="enriched_8c.html#a0671852d4e72755733eb2715cbdf87f8">enriched_set_flags</a>(tag, &amp;enriched);</div>
<div class="line"><span class="lineno">  562</span>          text_state = TEXT;</div>
<div class="line"><span class="lineno">  563</span>        }</div>
<div class="line"><span class="lineno">  564</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag_len &lt; 1024) <span class="comment">/* ignore overly long tags */</span></div>
<div class="line"><span class="lineno">  565</span>        {</div>
<div class="line"><span class="lineno">  566</span>          tag[tag_len++] = wc;</div>
<div class="line"><span class="lineno">  567</span>        }</div>
<div class="line"><span class="lineno">  568</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  569</span>        {</div>
<div class="line"><span class="lineno">  570</span>          text_state = BOGUS_TAG;</div>
<div class="line"><span class="lineno">  571</span>        }</div>
<div class="line"><span class="lineno">  572</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>      <span class="keywordflow">case</span> BOGUS_TAG:</div>
<div class="line"><span class="lineno">  575</span>        <span class="keywordflow">if</span> (wc == (<span class="keywordtype">wchar_t</span>) <span class="charliteral">&#39;&gt;&#39;</span>)</div>
<div class="line"><span class="lineno">  576</span>          text_state = TEXT;</div>
<div class="line"><span class="lineno">  577</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>      <span class="keywordflow">case</span> NEWLINE:</div>
<div class="line"><span class="lineno">  580</span>        <span class="keywordflow">if</span> (wc == (<span class="keywordtype">wchar_t</span>) <span class="charliteral">&#39;\n&#39;</span>)</div>
<div class="line"><span class="lineno">  581</span>        {</div>
<div class="line"><span class="lineno">  582</span>          <a class="code hl_function" href="enriched_8c.html#ab669a4eb5f4606a93dc08e1226172cf1">enriched_flush</a>(&amp;enriched, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  583</span>        }</div>
<div class="line"><span class="lineno">  584</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  585</span>        {</div>
<div class="line"><span class="lineno">  586</span>          ungetwc(wc, <a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a>-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>);</div>
<div class="line"><span class="lineno">  587</span>          bytes++;</div>
<div class="line"><span class="lineno">  588</span>          text_state = TEXT;</div>
<div class="line"><span class="lineno">  589</span>        }</div>
<div class="line"><span class="lineno">  590</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>      <span class="keywordflow">case</span> ST_EOF:</div>
<div class="line"><span class="lineno">  593</span>        <a class="code hl_function" href="enriched_8c.html#a564da94635e771c599f27fb909577626">enriched_putwc</a>((<span class="keywordtype">wchar_t</span>) <span class="charliteral">&#39;\0&#39;</span>, &amp;enriched);</div>
<div class="line"><span class="lineno">  594</span>        <a class="code hl_function" href="enriched_8c.html#ab669a4eb5f4606a93dc08e1226172cf1">enriched_flush</a>(&amp;enriched, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  595</span>        text_state = DONE;</div>
<div class="line"><span class="lineno">  596</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  599</span>        <span class="comment">/* not reached */</span></div>
<div class="line"><span class="lineno">  600</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  601</span>    }</div>
<div class="line"><span class="lineno">  602</span>  }</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>  <a class="code hl_define" href="mutt_2state_8h.html#a511e4530400bb790de3fc76b44640e43">state_putc</a>(<a class="code hl_variable" href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">state</a>, <span class="charliteral">&#39;\n&#39;</span>); <span class="comment">/* add a final newline */</span></div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;(enriched.<a class="code hl_variable" href="structEnrichedState.html#a24e444e4075e48ac58f72cff287f3c0f">buffer</a>));</div>
<div class="line"><span class="lineno">  607</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;(enriched.<a class="code hl_variable" href="structEnrichedState.html#a5c98ee59229be04267e11585aa973684">line</a>));</div>
<div class="line"><span class="lineno">  608</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;(enriched.<a class="code hl_variable" href="structEnrichedState.html#a4302bc98504a6e715be8e5006833051c">param</a>));</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  611</span>}</div>
<div class="ttc" id="aenriched_8c_html_a0671852d4e72755733eb2715cbdf87f8"><div class="ttname"><a href="enriched_8c.html#a0671852d4e72755733eb2715cbdf87f8">enriched_set_flags</a></div><div class="ttdeci">static void enriched_set_flags(const wchar_t *tag, struct EnrichedState *enriched)</div><div class="ttdoc">Set flags on the enriched text state.</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00377">enriched.c:377</a></div></div>
<div class="ttc" id="aenriched_8c_html_a4148209775369a82f56b9fde2cf2dd2da06eab0f67d7b47d5693157b7ad9f3bb1"><div class="ttname"><a href="enriched_8c.html#a4148209775369a82f56b9fde2cf2dd2da06eab0f67d7b47d5693157b7ad9f3bb1">RICH_NOFILL</a></div><div class="ttdeci">@ RICH_NOFILL</div><div class="ttdoc">Text will not be reformatted.</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00054">enriched.c:54</a></div></div>
<div class="ttc" id="aenriched_8c_html_a564da94635e771c599f27fb909577626"><div class="ttname"><a href="enriched_8c.html#a564da94635e771c599f27fb909577626">enriched_putwc</a></div><div class="ttdeci">static void enriched_putwc(wchar_t c, struct EnrichedState *enriched)</div><div class="ttdoc">Write one wide character to the state.</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00275">enriched.c:275</a></div></div>
<div class="ttc" id="aenriched_8c_html_ab669a4eb5f4606a93dc08e1226172cf1"><div class="ttname"><a href="enriched_8c.html#ab669a4eb5f4606a93dc08e1226172cf1">enriched_flush</a></div><div class="ttdeci">static void enriched_flush(struct EnrichedState *enriched, bool wrap)</div><div class="ttdoc">Write enriched text to the State.</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00238">enriched.c:238</a></div></div>
<div class="ttc" id="amemory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00062">memory.h:62</a></div></div>
<div class="ttc" id="amemory_8h_html_a9aaf8f21a29735767a069ff1aee9d7d9"><div class="ttname"><a href="memory_8h.html#a9aaf8f21a29735767a069ff1aee9d7d9">MUTT_MEM_CALLOC</a></div><div class="ttdeci">#define MUTT_MEM_CALLOC(n, type)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00047">memory.h:47</a></div></div>
<div class="ttc" id="amutt_2lib_8h_html_a0cf2d82c57a09723ab59e6f4dcc45b84"><div class="ttname"><a href="mutt_2lib_8h.html#a0cf2d82c57a09723ab59e6f4dcc45b84">FALLTHROUGH</a></div><div class="ttdeci">#define FALLTHROUGH</div><div class="ttdef"><b>Definition</b> <a href="mutt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_a0ea44a0777d9d2712ba6db4350f1e671"><div class="ttname"><a href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a></div><div class="ttdeci">#define state_puts(STATE, STR)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00058">state.h:58</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_a2a4ce653367a744f47960bc30b42f3a7"><div class="ttname"><a href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a></div><div class="ttdeci">#define STATE_DISPLAY</div><div class="ttdoc">Output is displayed to the user.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00033">state.h:33</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_a511e4530400bb790de3fc76b44640e43"><div class="ttname"><a href="mutt_2state_8h.html#a511e4530400bb790de3fc76b44640e43">state_putc</a></div><div class="ttdeci">#define state_putc(STATE, STR)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00059">state.h:59</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_acca6786b903b22a5924219f9db96e10d"><div class="ttname"><a href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a></div><div class="ttdeci">size_t mutt_str_len(const char *a)</div><div class="ttdoc">Calculate the length of a string, safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00498">string.c:498</a></div></div>
<div class="ttc" id="astructBody_html_a6f92d7ec8568ca04ae07931c56dd0790"><div class="ttname"><a href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">Body::length</a></div><div class="ttdeci">LOFF_T length</div><div class="ttdoc">length (in bytes) of attachment</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00053">body.h:53</a></div></div>
<div class="ttc" id="astructEnrichedState_html"><div class="ttname"><a href="structEnrichedState.html">EnrichedState</a></div><div class="ttdoc">State of enriched-text parser.</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00098">enriched.c:99</a></div></div>
<div class="ttc" id="astructEnrichedState_html_a24e444e4075e48ac58f72cff287f3c0f"><div class="ttname"><a href="structEnrichedState.html#a24e444e4075e48ac58f72cff287f3c0f">EnrichedState::buffer</a></div><div class="ttdeci">wchar_t * buffer</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00100">enriched.c:100</a></div></div>
<div class="ttc" id="astructEnrichedState_html_a3def386a556bda9d870e9b44bd2407e0"><div class="ttname"><a href="structEnrichedState.html#a3def386a556bda9d870e9b44bd2407e0">EnrichedState::param_used</a></div><div class="ttdeci">size_t param_used</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00110">enriched.c:110</a></div></div>
<div class="ttc" id="astructEnrichedState_html_a4302bc98504a6e715be8e5006833051c"><div class="ttname"><a href="structEnrichedState.html#a4302bc98504a6e715be8e5006833051c">EnrichedState::param</a></div><div class="ttdeci">wchar_t * param</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00102">enriched.c:102</a></div></div>
<div class="ttc" id="astructEnrichedState_html_a5c98ee59229be04267e11585aa973684"><div class="ttname"><a href="structEnrichedState.html#a5c98ee59229be04267e11585aa973684">EnrichedState::line</a></div><div class="ttdeci">wchar_t * line</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00101">enriched.c:101</a></div></div>
<div class="ttc" id="astructEnrichedState_html_a7003e363f1bd2f53eded1dffd3dd51d3"><div class="ttname"><a href="structEnrichedState.html#a7003e363f1bd2f53eded1dffd3dd51d3">EnrichedState::tag_level</a></div><div class="ttdeci">int tag_level[RICH_MAX]</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00112">enriched.c:112</a></div></div>
<div class="ttc" id="astructEnrichedState_html_ac0dfe119df7a193d899282cf630e01e4"><div class="ttname"><a href="structEnrichedState.html#ac0dfe119df7a193d899282cf630e01e4">EnrichedState::state</a></div><div class="ttdeci">struct State * state</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00114">enriched.c:114</a></div></div>
<div class="ttc" id="astructEnrichedState_html_ad6e42cbea8841c7ddff457cb8c63693e"><div class="ttname"><a href="structEnrichedState.html#ad6e42cbea8841c7ddff457cb8c63693e">EnrichedState::param_len</a></div><div class="ttdeci">size_t param_len</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00111">enriched.c:111</a></div></div>
<div class="ttc" id="astructEnrichedState_html_aefb17717977e343b9c178b934c65830e"><div class="ttname"><a href="structEnrichedState.html#aefb17717977e343b9c178b934c65830e">EnrichedState::line_max</a></div><div class="ttdeci">size_t line_max</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00106">enriched.c:106</a></div></div>
<div class="ttc" id="astructEnrichedState_html_afed741d4664b2201a4bd28b23f776b26"><div class="ttname"><a href="structEnrichedState.html#afed741d4664b2201a4bd28b23f776b26">EnrichedState::wrap_margin</a></div><div class="ttdeci">int wrap_margin</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00113">enriched.c:113</a></div></div>
<div class="ttc" id="astructEnrichedState_html_aff30327d80e7c33db452c719aeea9c7a"><div class="ttname"><a href="structEnrichedState.html#aff30327d80e7c33db452c719aeea9c7a">EnrichedState::indent_len</a></div><div class="ttdeci">size_t indent_len</div><div class="ttdef"><b>Definition</b> <a href="enriched_8c_source.html#l00107">enriched.c:107</a></div></div>
<div class="ttc" id="astructState_html_a2c506e7d8513e59e6162cdc5d6f9f320"><div class="ttname"><a href="structState.html#a2c506e7d8513e59e6162cdc5d6f9f320">State::wraplen</a></div><div class="ttdeci">int wraplen</div><div class="ttdoc">Width to wrap lines to (when flags &amp; STATE_DISPLAY)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00053">state.h:53</a></div></div>
<div class="ttc" id="astructState_html_a5d855f7d518fde2ac4e8e409cbb24ad3"><div class="ttname"><a href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">State::flags</a></div><div class="ttdeci">StateFlags flags</div><div class="ttdoc">Flags, e.g. STATE_DISPLAY.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00052">state.h:52</a></div></div>
<div class="ttc" id="astructState_html_a9cf7e1f0c5c12399def5ca38b13054ae"><div class="ttname"><a href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">State::fp_in</a></div><div class="ttdeci">FILE * fp_in</div><div class="ttdoc">File to read from.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00049">state.h:49</a></div></div>
<div class="ttc" id="astructState_html_ac92c06846530ad9f3cde7e23d5789d76"><div class="ttname"><a href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">State::prefix</a></div><div class="ttdeci">const char * prefix</div><div class="ttdoc">String to add to the beginning of each output line.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00051">state.h:51</a></div></div>
</div><!-- fragment --><div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga52988b26b8120b105355accebe501bee_cgraph.svg" width="516" height="167"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-1" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga52988b26b8120b105355accebe501bee_icgraph.svg" width="362" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ga6d9d9125a5e89f59e0bdc7dfe1da915f" name="ga6d9d9125a5e89f59e0bdc7dfe1da915f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6d9d9125a5e89f59e0bdc7dfe1da915f">&#9670;&#160;</a></span>autoview_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int autoview_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handler for autoviewable attachments - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>

<p class="definition">Definition at line <a class="el" href="handler_8c_source.html#l00533">533</a> of file <a class="el" href="handler_8c_source.html">handler.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  534</span>{</div>
<div class="line"><span class="lineno">  535</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structMailcapEntry.html">MailcapEntry</a> *entry = <a class="code hl_function" href="mailcap_8c.html#a8114f2f64a9bf84055e0e1d624b8c050">mailcap_entry_new</a>();</div>
<div class="line"><span class="lineno">  536</span>  <span class="keywordtype">char</span> buf[1024] = { 0 };</div>
<div class="line"><span class="lineno">  537</span>  <span class="keywordtype">char</span> type[256] = { 0 };</div>
<div class="line"><span class="lineno">  538</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *cmd = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  539</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *tempfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  540</span>  <span class="keywordtype">char</span> *fname = NULL;</div>
<div class="line"><span class="lineno">  541</span>  FILE *fp_in = NULL;</div>
<div class="line"><span class="lineno">  542</span>  FILE *fp_out = NULL;</div>
<div class="line"><span class="lineno">  543</span>  FILE *fp_err = NULL;</div>
<div class="line"><span class="lineno">  544</span>  pid_t pid;</div>
<div class="line"><span class="lineno">  545</span>  <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>  snprintf(type, <span class="keyword">sizeof</span>(type), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code hl_define" href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a>(b_email), b_email-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>);</div>
<div class="line"><span class="lineno">  548</span>  <a class="code hl_function" href="mailcap_8c.html#af76f3b2c5819c22f1470723cc30a9ad1">mailcap_lookup</a>(b_email, type, <span class="keyword">sizeof</span>(type), entry, <a class="code hl_enumvalue" href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1a685052e871afa17028f0e1c11e056a60">MUTT_MC_AUTOVIEW</a>);</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span>  fname = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(b_email-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div>
<div class="line"><span class="lineno">  551</span>  <a class="code hl_function" href="file_8c.html#a4deebaf3a646b3075a2b51eda5dc03ca">mutt_file_sanitize_filename</a>(fname, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  552</span>  <a class="code hl_function" href="mailcap_8c.html#accb5ae6e2f507053e8436a2f00b834ea">mailcap_expand_filename</a>(entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a85835d27aa930e64eef4eae5f9498401">nametemplate</a>, fname, tempfile);</div>
<div class="line"><span class="lineno">  553</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;fname);</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>  <span class="keywordflow">if</span> (entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#ad682bf5b0b80e72f2a9b9196728514e3">command</a>)</div>
<div class="line"><span class="lineno">  556</span>  {</div>
<div class="line"><span class="lineno">  557</span>    <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(cmd, entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#ad682bf5b0b80e72f2a9b9196728514e3">command</a>);</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>    <span class="comment">/* mailcap_expand_command returns 0 if the file is required */</span></div>
<div class="line"><span class="lineno">  560</span>    <span class="keywordtype">bool</span> piped = <a class="code hl_function" href="mailcap_8c.html#ac95deddbed52214ab8797bf9d19c1b8b">mailcap_expand_command</a>(b_email, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), type, cmd);</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno">  563</span>    {</div>
<div class="line"><span class="lineno">  564</span>      <a class="code hl_function" href="mutt_2state_8c.html#a549e8896ba39ea5006be8905349a6782">state_mark_attach</a>(state);</div>
<div class="line"><span class="lineno">  565</span>      <a class="code hl_function" href="mutt_2state_8c.html#a7566d1f9e015cd673fd8744bf5ad2f06">state_printf</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Autoview using %s --]\n&quot;</span>), <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd));</div>
<div class="line"><span class="lineno">  566</span>      <a class="code hl_define" href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Invoking autoview command: %s&quot;</span>), <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd));</div>
<div class="line"><span class="lineno">  567</span>    }</div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>    fp_in = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), <span class="stringliteral">&quot;w+&quot;</span>);</div>
<div class="line"><span class="lineno">  570</span>    <span class="keywordflow">if</span> (!fp_in)</div>
<div class="line"><span class="lineno">  571</span>    {</div>
<div class="line"><span class="lineno">  572</span>      <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;fopen&quot;</span>);</div>
<div class="line"><span class="lineno">  573</span>      <a class="code hl_function" href="mailcap_8c.html#a49fd88d8bb73a7a56c4cc0fe28dfb645">mailcap_entry_free</a>(&amp;entry);</div>
<div class="line"><span class="lineno">  574</span>      rc = -1;</div>
<div class="line"><span class="lineno">  575</span>      <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  576</span>    }</div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>    <a class="code hl_function" href="file_8c.html#a2bafa45ca3c8ce7d96303377d860e2db">mutt_file_copy_bytes</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, fp_in, b_email-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a>);</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>    <span class="keywordflow">if</span> (piped)</div>
<div class="line"><span class="lineno">  581</span>    {</div>
<div class="line"><span class="lineno">  582</span>      unlink(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  583</span>      fflush(fp_in);</div>
<div class="line"><span class="lineno">  584</span>      rewind(fp_in);</div>
<div class="line"><span class="lineno">  585</span>      pid = <a class="code hl_function" href="mutt_2filter_8c.html#a8b8175018aa96307b2cf569d719ca6dc">filter_create_fd</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd), NULL, &amp;fp_out, &amp;fp_err,</div>
<div class="line"><span class="lineno">  586</span>                             fileno(fp_in), -1, -1, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">env</a>);</div>
<div class="line"><span class="lineno">  587</span>    }</div>
<div class="line"><span class="lineno">  588</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  589</span>    {</div>
<div class="line"><span class="lineno">  590</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_in);</div>
<div class="line"><span class="lineno">  591</span>      pid = <a class="code hl_function" href="mutt_2filter_8c.html#ad1ec6916f8ee2520af1711891f6b5302">filter_create</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd), NULL, &amp;fp_out, &amp;fp_err, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">env</a>);</div>
<div class="line"><span class="lineno">  592</span>    }</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span>    <span class="keywordflow">if</span> (pid &lt; 0)</div>
<div class="line"><span class="lineno">  595</span>    {</div>
<div class="line"><span class="lineno">  596</span>      <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t create filter&quot;</span>));</div>
<div class="line"><span class="lineno">  597</span>      <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno">  598</span>      {</div>
<div class="line"><span class="lineno">  599</span>        <a class="code hl_function" href="mutt_2state_8c.html#a549e8896ba39ea5006be8905349a6782">state_mark_attach</a>(state);</div>
<div class="line"><span class="lineno">  600</span>        <a class="code hl_function" href="mutt_2state_8c.html#a7566d1f9e015cd673fd8744bf5ad2f06">state_printf</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Can&#39;t run %s --]\n&quot;</span>), <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd));</div>
<div class="line"><span class="lineno">  601</span>      }</div>
<div class="line"><span class="lineno">  602</span>      rc = -1;</div>
<div class="line"><span class="lineno">  603</span>      <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  604</span>    }</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>)</div>
<div class="line"><span class="lineno">  607</span>    {</div>
<div class="line"><span class="lineno">  608</span>      <span class="comment">/* Remove ansi and formatting from autoview output in replies only.  The</span></div>
<div class="line"><span class="lineno">  609</span><span class="comment">       * user may want to see the formatting in the pager, but it shouldn&#39;t be</span></div>
<div class="line"><span class="lineno">  610</span><span class="comment">       * in their quoted reply text too.  */</span></div>
<div class="line"><span class="lineno">  611</span>      <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *stripped = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  612</span>      <span class="keywordflow">while</span> (fgets(buf, <span class="keyword">sizeof</span>(buf), fp_out))</div>
<div class="line"><span class="lineno">  613</span>      {</div>
<div class="line"><span class="lineno">  614</span>        <a class="code hl_function" href="display_8c.html#a73742be224ef1cc275d4b6c7d585d44a">buf_strip_formatting</a>(stripped, buf, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  615</span>        <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>);</div>
<div class="line"><span class="lineno">  616</span>        <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(stripped));</div>
<div class="line"><span class="lineno">  617</span>      }</div>
<div class="line"><span class="lineno">  618</span>      <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;stripped);</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span>      <span class="comment">/* check for data on stderr */</span></div>
<div class="line"><span class="lineno">  621</span>      <span class="keywordflow">if</span> (fgets(buf, <span class="keyword">sizeof</span>(buf), fp_err))</div>
<div class="line"><span class="lineno">  622</span>      {</div>
<div class="line"><span class="lineno">  623</span>        <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno">  624</span>        {</div>
<div class="line"><span class="lineno">  625</span>          <a class="code hl_function" href="mutt_2state_8c.html#a549e8896ba39ea5006be8905349a6782">state_mark_attach</a>(state);</div>
<div class="line"><span class="lineno">  626</span>          <a class="code hl_function" href="mutt_2state_8c.html#a7566d1f9e015cd673fd8744bf5ad2f06">state_printf</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Autoview stderr of %s --]\n&quot;</span>), <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd));</div>
<div class="line"><span class="lineno">  627</span>        }</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>        <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>);</div>
<div class="line"><span class="lineno">  630</span>        <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, buf);</div>
<div class="line"><span class="lineno">  631</span>        <span class="keywordflow">while</span> (fgets(buf, <span class="keyword">sizeof</span>(buf), fp_err))</div>
<div class="line"><span class="lineno">  632</span>        {</div>
<div class="line"><span class="lineno">  633</span>          <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>);</div>
<div class="line"><span class="lineno">  634</span>          <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, buf);</div>
<div class="line"><span class="lineno">  635</span>        }</div>
<div class="line"><span class="lineno">  636</span>      }</div>
<div class="line"><span class="lineno">  637</span>    }</div>
<div class="line"><span class="lineno">  638</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  639</span>    {</div>
<div class="line"><span class="lineno">  640</span>      <a class="code hl_function" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(fp_out, state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>);</div>
<div class="line"><span class="lineno">  641</span>      <span class="comment">/* Check for stderr messages */</span></div>
<div class="line"><span class="lineno">  642</span>      <span class="keywordflow">if</span> (fgets(buf, <span class="keyword">sizeof</span>(buf), fp_err))</div>
<div class="line"><span class="lineno">  643</span>      {</div>
<div class="line"><span class="lineno">  644</span>        <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno">  645</span>        {</div>
<div class="line"><span class="lineno">  646</span>          <a class="code hl_function" href="mutt_2state_8c.html#a549e8896ba39ea5006be8905349a6782">state_mark_attach</a>(state);</div>
<div class="line"><span class="lineno">  647</span>          <a class="code hl_function" href="mutt_2state_8c.html#a7566d1f9e015cd673fd8744bf5ad2f06">state_printf</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Autoview stderr of %s --]\n&quot;</span>), <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd));</div>
<div class="line"><span class="lineno">  648</span>        }</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>        <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, buf);</div>
<div class="line"><span class="lineno">  651</span>        <a class="code hl_function" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(fp_err, state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>);</div>
<div class="line"><span class="lineno">  652</span>      }</div>
<div class="line"><span class="lineno">  653</span>    }</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>  bail:</div>
<div class="line"><span class="lineno">  656</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_out);</div>
<div class="line"><span class="lineno">  657</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_err);</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>    <a class="code hl_function" href="mutt_2filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a>(pid);</div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordflow">if</span> (piped)</div>
<div class="line"><span class="lineno">  661</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_in);</div>
<div class="line"><span class="lineno">  662</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  663</span>      <a class="code hl_function" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno">  666</span>      <a class="code hl_function" href="mutt__logging_8c.html#af068b3f524a31fad293b2fb61dfc4534">mutt_clear_error</a>();</div>
<div class="line"><span class="lineno">  667</span>  }</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>cleanup:</div>
<div class="line"><span class="lineno">  670</span>  <a class="code hl_function" href="mailcap_8c.html#a49fd88d8bb73a7a56c4cc0fe28dfb645">mailcap_entry_free</a>(&amp;entry);</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;cmd);</div>
<div class="line"><span class="lineno">  673</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;tempfile);</div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  676</span>}</div>
<div class="ttc" id="abuffer_8c_html_ac958acbd189e463a2c3bbc2f23aaeb1e"><div class="ttname"><a href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a></div><div class="ttdeci">size_t buf_strcpy(struct Buffer *buf, const char *s)</div><div class="ttdoc">Copy a string into a Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00395">buffer.c:395</a></div></div>
<div class="ttc" id="abuffer_8h_html_a728ebc5a947b77c8d56db44ce553a7ab"><div class="ttname"><a href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a></div><div class="ttdeci">static const char * buf_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00096">buffer.h:96</a></div></div>
<div class="ttc" id="adisplay_8c_html_a73742be224ef1cc275d4b6c7d585d44a"><div class="ttname"><a href="display_8c.html#a73742be224ef1cc275d4b6c7d585d44a">buf_strip_formatting</a></div><div class="ttdeci">void buf_strip_formatting(struct Buffer *dest, const char *src, bool strip_markers)</div><div class="ttdoc">Removes ANSI and backspace formatting.</div><div class="ttdef"><b>Definition</b> <a href="display_8c_source.html#l00730">display.c:730</a></div></div>
<div class="ttc" id="afile_8c_html_a0a6ff09a685fb6fa1120a582a5a6ef4a"><div class="ttname"><a href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a></div><div class="ttdeci">int mutt_file_copy_stream(FILE *fp_in, FILE *fp_out)</div><div class="ttdoc">Copy the contents of one file into another.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00225">file.c:225</a></div></div>
<div class="ttc" id="afile_8c_html_a2bafa45ca3c8ce7d96303377d860e2db"><div class="ttname"><a href="file_8c.html#a2bafa45ca3c8ce7d96303377d860e2db">mutt_file_copy_bytes</a></div><div class="ttdeci">int mutt_file_copy_bytes(FILE *fp_in, FILE *fp_out, size_t size)</div><div class="ttdoc">Copy some content from one file to another.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00195">file.c:195</a></div></div>
<div class="ttc" id="afile_8c_html_a4deebaf3a646b3075a2b51eda5dc03ca"><div class="ttname"><a href="file_8c.html#a4deebaf3a646b3075a2b51eda5dc03ca">mutt_file_sanitize_filename</a></div><div class="ttdeci">void mutt_file_sanitize_filename(char *path, bool slash)</div><div class="ttdoc">Replace unsafe characters in a filename.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00589">file.c:589</a></div></div>
<div class="ttc" id="afile_8c_html_ae57463c2854c006a3c67b78736e9056e"><div class="ttname"><a href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a></div><div class="ttdeci">void mutt_file_unlink(const char *s)</div><div class="ttdoc">Delete a file, carefully.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00159">file.c:159</a></div></div>
<div class="ttc" id="afile_8h_html_a9b519e795f098be88b93cd72c49a35ec"><div class="ttname"><a href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a></div><div class="ttdeci">#define mutt_file_fclose(FP)</div><div class="ttdef"><b>Definition</b> <a href="file_8h_source.html#l00139">file.h:139</a></div></div>
<div class="ttc" id="afile_8h_html_a9fa358d76519cb6bc8ffca5850976d46"><div class="ttname"><a href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a></div><div class="ttdeci">#define mutt_file_fopen(PATH, MODE)</div><div class="ttdef"><b>Definition</b> <a href="file_8h_source.html#l00138">file.h:138</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gae108f891125caafa9250cf0959c40c04"><div class="ttname"><a href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a></div><div class="ttdeci">#define mutt_message(...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00092">logging2.h:92</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gafaa521ab22db877ccf1b87e679e1b43e"><div class="ttname"><a href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a></div><div class="ttdeci">#define mutt_perror(...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00094">logging2.h:94</a></div></div>
<div class="ttc" id="amailcap_8c_html_a49fd88d8bb73a7a56c4cc0fe28dfb645"><div class="ttname"><a href="mailcap_8c.html#a49fd88d8bb73a7a56c4cc0fe28dfb645">mailcap_entry_free</a></div><div class="ttdeci">void mailcap_entry_free(struct MailcapEntry **ptr)</div><div class="ttdoc">Deallocate an struct MailcapEntry.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8c_source.html#l00454">mailcap.c:454</a></div></div>
<div class="ttc" id="amailcap_8c_html_a8114f2f64a9bf84055e0e1d624b8c050"><div class="ttname"><a href="mailcap_8c.html#a8114f2f64a9bf84055e0e1d624b8c050">mailcap_entry_new</a></div><div class="ttdeci">struct MailcapEntry * mailcap_entry_new(void)</div><div class="ttdoc">Allocate memory for a new rfc1524 entry.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8c_source.html#l00445">mailcap.c:445</a></div></div>
<div class="ttc" id="amailcap_8c_html_ac95deddbed52214ab8797bf9d19c1b8b"><div class="ttname"><a href="mailcap_8c.html#ac95deddbed52214ab8797bf9d19c1b8b">mailcap_expand_command</a></div><div class="ttdeci">int mailcap_expand_command(struct Body *b, const char *filename, const char *type, struct Buffer *command)</div><div class="ttdoc">Expand expandos in a command.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8c_source.html#l00069">mailcap.c:69</a></div></div>
<div class="ttc" id="amailcap_8c_html_accb5ae6e2f507053e8436a2f00b834ea"><div class="ttname"><a href="mailcap_8c.html#accb5ae6e2f507053e8436a2f00b834ea">mailcap_expand_filename</a></div><div class="ttdeci">void mailcap_expand_filename(const char *nametemplate, const char *oldfile, struct Buffer *newfile)</div><div class="ttdoc">Expand a new filename from a template or existing filename.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8c_source.html#l00552">mailcap.c:552</a></div></div>
<div class="ttc" id="amailcap_8c_html_af76f3b2c5819c22f1470723cc30a9ad1"><div class="ttname"><a href="mailcap_8c.html#af76f3b2c5819c22f1470723cc30a9ad1">mailcap_lookup</a></div><div class="ttdeci">bool mailcap_lookup(struct Body *b, char *type, size_t typelen, struct MailcapEntry *entry, enum MailcapLookup opt)</div><div class="ttdoc">Find given type in the list of mailcap files.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8c_source.html#l00483">mailcap.c:483</a></div></div>
<div class="ttc" id="amailcap_8h_html_a0716f6351a9229990024889ec22b33c1a685052e871afa17028f0e1c11e056a60"><div class="ttname"><a href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1a685052e871afa17028f0e1c11e056a60">MUTT_MC_AUTOVIEW</a></div><div class="ttdeci">@ MUTT_MC_AUTOVIEW</div><div class="ttdoc">Mailcap autoview field.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00061">mailcap.h:61</a></div></div>
<div class="ttc" id="amime_8h_html_a3e568918dd102d7bfd39661c82ff6c3f"><div class="ttname"><a href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a></div><div class="ttdeci">#define BODY_TYPE(body)</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00089">mime.h:89</a></div></div>
<div class="ttc" id="amutt_2filter_8c_html_a22c6912b837b1114c3276c990e73dca3"><div class="ttname"><a href="mutt_2filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a></div><div class="ttdeci">int filter_wait(pid_t pid)</div><div class="ttdoc">Wait for the exit of a process and return its status.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2filter_8c_source.html#l00220">filter.c:220</a></div></div>
<div class="ttc" id="amutt_2filter_8c_html_a8b8175018aa96307b2cf569d719ca6dc"><div class="ttname"><a href="mutt_2filter_8c.html#a8b8175018aa96307b2cf569d719ca6dc">filter_create_fd</a></div><div class="ttdeci">pid_t filter_create_fd(const char *cmd, FILE **fp_in, FILE **fp_out, FILE **fp_err, int fdin, int fdout, int fderr, char **envlist)</div><div class="ttdoc">Run a command on a pipe (optionally connect stdin/stdout)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2filter_8c_source.html#l00062">filter.c:62</a></div></div>
<div class="ttc" id="amutt_2filter_8c_html_ad1ec6916f8ee2520af1711891f6b5302"><div class="ttname"><a href="mutt_2filter_8c.html#ad1ec6916f8ee2520af1711891f6b5302">filter_create</a></div><div class="ttdeci">pid_t filter_create(const char *cmd, FILE **fp_in, FILE **fp_out, FILE **fp_err, char **envlist)</div><div class="ttdoc">Set up filter program.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2filter_8c_source.html#l00209">filter.c:209</a></div></div>
<div class="ttc" id="amutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="amutt_2state_8c_html_a549e8896ba39ea5006be8905349a6782"><div class="ttname"><a href="mutt_2state_8c.html#a549e8896ba39ea5006be8905349a6782">state_mark_attach</a></div><div class="ttdeci">void state_mark_attach(struct State *state)</div><div class="ttdoc">Write a unique marker around content.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8c_source.html#l00073">state.c:73</a></div></div>
<div class="ttc" id="amutt_2state_8c_html_a7566d1f9e015cd673fd8744bf5ad2f06"><div class="ttname"><a href="mutt_2state_8c.html#a7566d1f9e015cd673fd8744bf5ad2f06">state_printf</a></div><div class="ttdeci">int state_printf(struct State *state, const char *fmt,...)</div><div class="ttdoc">Write a formatted string to the State.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8c_source.html#l00187">state.c:187</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a3fe33d90e4814281cd57de048119c950"><div class="ttname"><a href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a></div><div class="ttdeci">char * mutt_str_dup(const char *str)</div><div class="ttdoc">Copy a string, safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00255">string.c:255</a></div></div>
<div class="ttc" id="amutt__logging_8c_html_af068b3f524a31fad293b2fb61dfc4534"><div class="ttname"><a href="mutt__logging_8c.html#af068b3f524a31fad293b2fb61dfc4534">mutt_clear_error</a></div><div class="ttdeci">void mutt_clear_error(void)</div><div class="ttdoc">Clear the message line (bottom line of screen)</div><div class="ttdef"><b>Definition</b> <a href="mutt__logging_8c_source.html#l00074">mutt_logging.c:74</a></div></div>
<div class="ttc" id="apool_8c_html_a41cba27c25d33cb6822789a2856093f2"><div class="ttname"><a href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a></div><div class="ttdeci">struct Buffer * buf_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00082">pool.c:82</a></div></div>
<div class="ttc" id="apool_8c_html_a4cc6068279461cb8628219586dfa35a1"><div class="ttname"><a href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a></div><div class="ttdeci">void buf_pool_release(struct Buffer **ptr)</div><div class="ttdoc">Return a Buffer to the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00096">pool.c:96</a></div></div>
<div class="ttc" id="astructBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00061">body.h:61</a></div></div>
<div class="ttc" id="astructBody_html_afe3cd2c4b1070e3d0edbf1fed939ac5a"><div class="ttname"><a href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">Body::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">When sending a message, this is the file to which this structure refers.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00059">body.h:59</a></div></div>
<div class="ttc" id="astructBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00035">buffer.h:36</a></div></div>
<div class="ttc" id="astructMailcapEntry_html"><div class="ttname"><a href="structMailcapEntry.html">MailcapEntry</a></div><div class="ttdoc">A mailcap entry.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00036">mailcap.h:37</a></div></div>
<div class="ttc" id="astructMailcapEntry_html_a85835d27aa930e64eef4eae5f9498401"><div class="ttname"><a href="structMailcapEntry.html#a85835d27aa930e64eef4eae5f9498401">MailcapEntry::nametemplate</a></div><div class="ttdeci">char * nametemplate</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00044">mailcap.h:44</a></div></div>
<div class="ttc" id="astructMailcapEntry_html_ad682bf5b0b80e72f2a9b9196728514e3"><div class="ttname"><a href="structMailcapEntry.html#ad682bf5b0b80e72f2a9b9196728514e3">MailcapEntry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00038">mailcap.h:38</a></div></div>
<div class="ttc" id="astructNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00042">neomutt.h:43</a></div></div>
<div class="ttc" id="astructNeoMutt_html_a5410041863c473ba1f27b415c0a40482"><div class="ttname"><a href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">NeoMutt::env</a></div><div class="ttdeci">char ** env</div><div class="ttdoc">Private copy of the environment variables.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00055">neomutt.h:55</a></div></div>
<div class="ttc" id="astructState_html_a88fc722d3012ebf69d3a061cbf6bc296"><div class="ttname"><a href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">State::fp_out</a></div><div class="ttdeci">FILE * fp_out</div><div class="ttdoc">File to write to.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00050">state.h:50</a></div></div>
</div><!-- fragment --><div id="dynsection-2" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga6d9d9125a5e89f59e0bdc7dfe1da915f_cgraph.svg" width="550" height="1084"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-3" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga6d9d9125a5e89f59e0bdc7dfe1da915f_icgraph.svg" width="332" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ga5552ea70deb1b5c9d5eed357948915d6" name="ga5552ea70deb1b5c9d5eed357948915d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5552ea70deb1b5c9d5eed357948915d6">&#9670;&#160;</a></span>text_plain_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int text_plain_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handler for plain text - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Always</td></tr>
  </table>
  </dd>
</dl>
<p>When generating format=flowed ($text_flowed is set) from format=fixed, strip all trailing spaces to improve interoperability; if $text_flowed is unset, simply verbatim copy input. </p>

<p class="definition">Definition at line <a class="el" href="handler_8c_source.html#l00686">686</a> of file <a class="el" href="handler_8c_source.html">handler.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  687</span>{</div>
<div class="line"><span class="lineno">  688</span>  <span class="keywordtype">char</span> *buf = NULL;</div>
<div class="line"><span class="lineno">  689</span>  <span class="keywordtype">size_t</span> sz = 0;</div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_text_flowed = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;text_flowed&quot;</span>);</div>
<div class="line"><span class="lineno">  692</span>  <span class="keywordflow">while</span> ((buf = <a class="code hl_function" href="file_8c.html#a1ad76f956147154f16128b7761dadd58">mutt_file_read_line</a>(buf, &amp;sz, state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, NULL, <a class="code hl_define" href="file_8h.html#abb6d0dccab49bda4ed23948c7f5d0eaa">MUTT_RL_NO_FLAGS</a>)))</div>
<div class="line"><span class="lineno">  693</span>  {</div>
<div class="line"><span class="lineno">  694</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(buf, <span class="stringliteral">&quot;-- &quot;</span>) &amp;&amp; c_text_flowed)</div>
<div class="line"><span class="lineno">  695</span>    {</div>
<div class="line"><span class="lineno">  696</span>      <span class="keywordtype">size_t</span> len = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(buf);</div>
<div class="line"><span class="lineno">  697</span>      <span class="keywordflow">while</span> ((len &gt; 0) &amp;&amp; (buf[len - 1] == <span class="charliteral">&#39; &#39;</span>))</div>
<div class="line"><span class="lineno">  698</span>        buf[--len] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  699</span>    }</div>
<div class="line"><span class="lineno">  700</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>)</div>
<div class="line"><span class="lineno">  701</span>      <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>);</div>
<div class="line"><span class="lineno">  702</span>    <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, buf);</div>
<div class="line"><span class="lineno">  703</span>    <a class="code hl_define" href="mutt_2state_8h.html#a511e4530400bb790de3fc76b44640e43">state_putc</a>(state, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><span class="lineno">  704</span>  }</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;buf);</div>
<div class="line"><span class="lineno">  707</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  708</span>}</div>
<div class="ttc" id="aconfig_2helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00047">helpers.c:47</a></div></div>
<div class="ttc" id="afile_8c_html_a1ad76f956147154f16128b7761dadd58"><div class="ttname"><a href="file_8c.html#a1ad76f956147154f16128b7761dadd58">mutt_file_read_line</a></div><div class="ttdeci">char * mutt_file_read_line(char *line, size_t *size, FILE *fp, int *line_num, ReadLineFlags flags)</div><div class="ttdoc">Read a line from a file.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00685">file.c:685</a></div></div>
<div class="ttc" id="afile_8h_html_abb6d0dccab49bda4ed23948c7f5d0eaa"><div class="ttname"><a href="file_8h.html#abb6d0dccab49bda4ed23948c7f5d0eaa">MUTT_RL_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_RL_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="file_8h_source.html#l00040">file.h:40</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a6b6a50296dd2a31863a43379ef4a343d"><div class="ttname"><a href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a></div><div class="ttdeci">bool mutt_str_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00660">string.c:660</a></div></div>
<div class="ttc" id="astructNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00047">neomutt.h:47</a></div></div>
</div><!-- fragment --><div id="dynsection-4" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga5552ea70deb1b5c9d5eed357948915d6_cgraph.svg" width="332" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-5" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga5552ea70deb1b5c9d5eed357948915d6_icgraph.svg" width="336" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="gabb6e3be5f79882648b38690c851c6587" name="gabb6e3be5f79882648b38690c851c6587"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabb6e3be5f79882648b38690c851c6587">&#9670;&#160;</a></span>message_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int message_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handler for message/rfc822 body parts - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>

<p class="definition">Definition at line <a class="el" href="handler_8c_source.html#l00713">713</a> of file <a class="el" href="handler_8c_source.html">handler.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  714</span>{</div>
<div class="line"><span class="lineno">  715</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *b = NULL;</div>
<div class="line"><span class="lineno">  716</span>  LOFF_T off_start;</div>
<div class="line"><span class="lineno">  717</span>  <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>  off_start = ftello(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>);</div>
<div class="line"><span class="lineno">  720</span>  <span class="keywordflow">if</span> (off_start &lt; 0)</div>
<div class="line"><span class="lineno">  721</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>  <span class="keywordflow">if</span> ((b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a>) || (b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a>) ||</div>
<div class="line"><span class="lineno">  724</span>      (b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a17c00808bfbeb61dc2a001baf0aac5bd">ENC_UUENCODED</a>))</div>
<div class="line"><span class="lineno">  725</span>  {</div>
<div class="line"><span class="lineno">  726</span>    b = <a class="code hl_function" href="email_2body_8c.html#a37b346253e3b97aa64bb38ffc8d1ea0c">mutt_body_new</a>();</div>
<div class="line"><span class="lineno">  727</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = <a class="code hl_function" href="file_8c.html#a4cffa4f503de3736198956ebed431f7e">mutt_file_get_size_fp</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>);</div>
<div class="line"><span class="lineno">  728</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = <a class="code hl_function" href="email_2parse_8c.html#a0a62f0f03006788df8c7bdd6f687457f">mutt_rfc822_parse_message</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, b);</div>
<div class="line"><span class="lineno">  729</span>  }</div>
<div class="line"><span class="lineno">  730</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  731</span>  {</div>
<div class="line"><span class="lineno">  732</span>    b = b_email;</div>
<div class="line"><span class="lineno">  733</span>  }</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>  <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>)</div>
<div class="line"><span class="lineno">  736</span>  {</div>
<div class="line"><span class="lineno">  737</span>    <a class="code hl_typedef" href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a> chflags = <a class="code hl_define" href="copy_8h.html#a05de77c5d16eb6266cfb34b7b322a807">CH_DECODE</a> | <a class="code hl_define" href="copy_8h.html#a3ff472dcfcc60933d0deaba111527d6c">CH_FROM</a>;</div>
<div class="line"><span class="lineno">  738</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_weed = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;weed&quot;</span>);</div>
<div class="line"><span class="lineno">  739</span>    <span class="keywordflow">if</span> ((state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a02eaa3f6fb1163bab63297a9399b6f60">STATE_WEED</a>) ||</div>
<div class="line"><span class="lineno">  740</span>        ((state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; (<a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a> | <a class="code hl_define" href="mutt_2state_8h.html#ae6b85563c0a8006aaa87dda06029ba63">STATE_PRINTING</a>)) &amp;&amp; c_weed))</div>
<div class="line"><span class="lineno">  741</span>    {</div>
<div class="line"><span class="lineno">  742</span>      chflags |= <a class="code hl_define" href="copy_8h.html#a5e818fe5d60277b658d3f98ee7e0e675">CH_WEED</a> | <a class="code hl_define" href="copy_8h.html#a606b533a9896e294b1341e648f0b8ba2">CH_REORDER</a>;</div>
<div class="line"><span class="lineno">  743</span>    }</div>
<div class="line"><span class="lineno">  744</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>)</div>
<div class="line"><span class="lineno">  745</span>      chflags |= <a class="code hl_define" href="copy_8h.html#a3788f097f145555722bd4b63b45cd016">CH_PREFIX</a>;</div>
<div class="line"><span class="lineno">  746</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno">  747</span>      chflags |= <a class="code hl_define" href="copy_8h.html#a78788518de9fe57639d22d204a686383">CH_DISPLAY</a>;</div>
<div class="line"><span class="lineno">  748</span> </div>
<div class="line"><span class="lineno">  749</span>    <a class="code hl_function" href="copy_8c.html#a52e9f9a52a91efbaeca673868cfc8b93">mutt_copy_hdr</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, off_start, b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>,</div>
<div class="line"><span class="lineno">  750</span>                  chflags, state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>, 0);</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>)</div>
<div class="line"><span class="lineno">  753</span>      <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>);</div>
<div class="line"><span class="lineno">  754</span>    <a class="code hl_define" href="mutt_2state_8h.html#a511e4530400bb790de3fc76b44640e43">state_putc</a>(state, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>    rc = <a class="code hl_function" href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a>(b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>, state);</div>
<div class="line"><span class="lineno">  757</span>  }</div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>  <span class="keywordflow">if</span> ((b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a>) || (b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a>) ||</div>
<div class="line"><span class="lineno">  760</span>      (b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a17c00808bfbeb61dc2a001baf0aac5bd">ENC_UUENCODED</a>))</div>
<div class="line"><span class="lineno">  761</span>  {</div>
<div class="line"><span class="lineno">  762</span>    <a class="code hl_function" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;b);</div>
<div class="line"><span class="lineno">  763</span>  }</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  766</span>}</div>
<div class="ttc" id="acopy_8c_html_a52e9f9a52a91efbaeca673868cfc8b93"><div class="ttname"><a href="copy_8c.html#a52e9f9a52a91efbaeca673868cfc8b93">mutt_copy_hdr</a></div><div class="ttdeci">int mutt_copy_hdr(FILE *fp_in, FILE *fp_out, LOFF_T off_start, LOFF_T off_end, CopyHeaderFlags chflags, const char *prefix, int wraplen)</div><div class="ttdoc">Copy header from one file to another.</div><div class="ttdef"><b>Definition</b> <a href="copy_8c_source.html#l00104">copy.c:104</a></div></div>
<div class="ttc" id="acopy_8h_html_a05de77c5d16eb6266cfb34b7b322a807"><div class="ttname"><a href="copy_8h.html#a05de77c5d16eb6266cfb34b7b322a807">CH_DECODE</a></div><div class="ttdeci">#define CH_DECODE</div><div class="ttdoc">Do RFC2047 header decoding.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00056">copy.h:56</a></div></div>
<div class="ttc" id="acopy_8h_html_a3788f097f145555722bd4b63b45cd016"><div class="ttname"><a href="copy_8h.html#a3788f097f145555722bd4b63b45cd016">CH_PREFIX</a></div><div class="ttdeci">#define CH_PREFIX</div><div class="ttdoc">Quote header using $indent_string string?</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00059">copy.h:59</a></div></div>
<div class="ttc" id="acopy_8h_html_a3ff472dcfcc60933d0deaba111527d6c"><div class="ttname"><a href="copy_8h.html#a3ff472dcfcc60933d0deaba111527d6c">CH_FROM</a></div><div class="ttdeci">#define CH_FROM</div><div class="ttdoc">Retain the &quot;From &quot; message separator?</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00058">copy.h:58</a></div></div>
<div class="ttc" id="acopy_8h_html_a5e818fe5d60277b658d3f98ee7e0e675"><div class="ttname"><a href="copy_8h.html#a5e818fe5d60277b658d3f98ee7e0e675">CH_WEED</a></div><div class="ttdeci">#define CH_WEED</div><div class="ttdoc">Weed the headers?</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00055">copy.h:55</a></div></div>
<div class="ttc" id="acopy_8h_html_a606b533a9896e294b1341e648f0b8ba2"><div class="ttname"><a href="copy_8h.html#a606b533a9896e294b1341e648f0b8ba2">CH_REORDER</a></div><div class="ttdeci">#define CH_REORDER</div><div class="ttdoc">Re-order output of headers (specified by &#39;hdr_order&#39;)</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00061">copy.h:61</a></div></div>
<div class="ttc" id="acopy_8h_html_a78788518de9fe57639d22d204a686383"><div class="ttname"><a href="copy_8h.html#a78788518de9fe57639d22d204a686383">CH_DISPLAY</a></div><div class="ttdeci">#define CH_DISPLAY</div><div class="ttdoc">Display result to user.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00072">copy.h:72</a></div></div>
<div class="ttc" id="acopy_8h_html_a88a40e8f238a8478b885c90d1ce53e9c"><div class="ttname"><a href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a></div><div class="ttdeci">uint32_t CopyHeaderFlags</div><div class="ttdoc">Flags for mutt_copy_header(), e.g. CH_UPDATE.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00052">copy.h:52</a></div></div>
<div class="ttc" id="aemail_2body_8c_html_a129af1c316fcbc26b55fb48957bab2cb"><div class="ttname"><a href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a></div><div class="ttdeci">void mutt_body_free(struct Body **ptr)</div><div class="ttdoc">Free a Body.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8c_source.html#l00058">body.c:58</a></div></div>
<div class="ttc" id="aemail_2body_8c_html_a37b346253e3b97aa64bb38ffc8d1ea0c"><div class="ttname"><a href="email_2body_8c.html#a37b346253e3b97aa64bb38ffc8d1ea0c">mutt_body_new</a></div><div class="ttdeci">struct Body * mutt_body_new(void)</div><div class="ttdoc">Create a new Body.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8c_source.html#l00044">body.c:44</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a0a62f0f03006788df8c7bdd6f687457f"><div class="ttname"><a href="email_2parse_8c.html#a0a62f0f03006788df8c7bdd6f687457f">mutt_rfc822_parse_message</a></div><div class="ttdeci">struct Body * mutt_rfc822_parse_message(FILE *fp, struct Body *b)</div><div class="ttdoc">Parse a Message/RFC822 body.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01836">parse.c:1836</a></div></div>
<div class="ttc" id="afile_8c_html_a4cffa4f503de3736198956ebed431f7e"><div class="ttname"><a href="file_8c.html#a4cffa4f503de3736198956ebed431f7e">mutt_file_get_size_fp</a></div><div class="ttdeci">long mutt_file_get_size_fp(FILE *fp)</div><div class="ttdoc">Get the size of a file.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l01430">file.c:1430</a></div></div>
<div class="ttc" id="ahandler_8c_html_a3e520d3004995a6c0cf0696edfd209fb"><div class="ttname"><a href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a></div><div class="ttdeci">int mutt_body_handler(struct Body *b, struct State *state)</div><div class="ttdoc">Handler for the Body of an email.</div><div class="ttdef"><b>Definition</b> <a href="handler_8c_source.html#l01632">handler.c:1632</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a17c00808bfbeb61dc2a001baf0aac5bd"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a17c00808bfbeb61dc2a001baf0aac5bd">ENC_UUENCODED</a></div><div class="ttdeci">@ ENC_UUENCODED</div><div class="ttdoc">UUEncoded text.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00054">mime.h:54</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a></div><div class="ttdeci">@ ENC_BASE64</div><div class="ttdoc">Base-64 encoded text.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00052">mime.h:52</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a></div><div class="ttdeci">@ ENC_QUOTED_PRINTABLE</div><div class="ttdoc">Quoted-printable text.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00051">mime.h:51</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_a02eaa3f6fb1163bab63297a9399b6f60"><div class="ttname"><a href="mutt_2state_8h.html#a02eaa3f6fb1163bab63297a9399b6f60">STATE_WEED</a></div><div class="ttdeci">#define STATE_WEED</div><div class="ttdoc">Weed headers even when not in display mode.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00036">state.h:36</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_ae6b85563c0a8006aaa87dda06029ba63"><div class="ttname"><a href="mutt_2state_8h.html#ae6b85563c0a8006aaa87dda06029ba63">STATE_PRINTING</a></div><div class="ttdeci">#define STATE_PRINTING</div><div class="ttdoc">Are we printing? - STATE_DISPLAY &quot;light&quot;.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00038">state.h:38</a></div></div>
<div class="ttc" id="astructBody_html"><div class="ttname"><a href="structBody.html">Body</a></div><div class="ttdoc">The body of an email.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00035">body.h:36</a></div></div>
<div class="ttc" id="astructBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00073">body.h:73</a></div></div>
<div class="ttc" id="astructBody_html_a1969dfeb0a155ccb16153fe777a103b0"><div class="ttname"><a href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">Body::offset</a></div><div class="ttdeci">LOFF_T offset</div><div class="ttdoc">offset where the actual data begins</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00052">body.h:52</a></div></div>
<div class="ttc" id="astructBody_html_ad2f05b8ff24813de41988e63de5d6a31"><div class="ttname"><a href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">Body::encoding</a></div><div class="ttdeci">unsigned int encoding</div><div class="ttdoc">content-transfer-encoding, ContentEncoding</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00041">body.h:41</a></div></div>
</div><!-- fragment --><div id="dynsection-6" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gabb6e3be5f79882648b38690c851c6587_cgraph.svg" width="551" height="362"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-7" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gabb6e3be5f79882648b38690c851c6587_icgraph.svg" width="332" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ga8a838ae7b50e8ffa147203c5cfaa3272" name="ga8a838ae7b50e8ffa147203c5cfaa3272"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8a838ae7b50e8ffa147203c5cfaa3272">&#9670;&#160;</a></span>external_body_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int external_body_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handler for external-body emails - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>

<p class="definition">Definition at line <a class="el" href="handler_8c_source.html#l00771">771</a> of file <a class="el" href="handler_8c_source.html">handler.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  772</span>{</div>
<div class="line"><span class="lineno">  773</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *access_type = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;access-type&quot;</span>);</div>
<div class="line"><span class="lineno">  774</span>  <span class="keywordflow">if</span> (!access_type)</div>
<div class="line"><span class="lineno">  775</span>  {</div>
<div class="line"><span class="lineno">  776</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno">  777</span>    {</div>
<div class="line"><span class="lineno">  778</span>      <a class="code hl_function" href="mutt_2state_8c.html#a549e8896ba39ea5006be8905349a6782">state_mark_attach</a>(state);</div>
<div class="line"><span class="lineno">  779</span>      <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Error: message/external-body has no access-type parameter --]\n&quot;</span>));</div>
<div class="line"><span class="lineno">  780</span>      <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  781</span>    }</div>
<div class="line"><span class="lineno">  782</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  783</span>    {</div>
<div class="line"><span class="lineno">  784</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  785</span>    }</div>
<div class="line"><span class="lineno">  786</span>  }</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt = NULL;</div>
<div class="line"><span class="lineno">  789</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *banner = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  790</span> </div>
<div class="line"><span class="lineno">  791</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *expiration = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;expiration&quot;</span>);</div>
<div class="line"><span class="lineno">  792</span>  time_t expire;</div>
<div class="line"><span class="lineno">  793</span>  <span class="keywordflow">if</span> (expiration)</div>
<div class="line"><span class="lineno">  794</span>    expire = <a class="code hl_function" href="mutt_2date_8c.html#ad8aaf5118148ed8f6708f32bfab3146f">mutt_date_parse_date</a>(expiration, NULL);</div>
<div class="line"><span class="lineno">  795</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  796</span>    expire = -1;</div>
<div class="line"><span class="lineno">  797</span> </div>
<div class="line"><span class="lineno">  798</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_weed = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;weed&quot;</span>);</div>
<div class="line"><span class="lineno">  799</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(access_type, <span class="stringliteral">&quot;x-mutt-deleted&quot;</span>))</div>
<div class="line"><span class="lineno">  800</span>  {</div>
<div class="line"><span class="lineno">  801</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; (<a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a> | <a class="code hl_define" href="mutt_2state_8h.html#ae6b85563c0a8006aaa87dda06029ba63">STATE_PRINTING</a>))</div>
<div class="line"><span class="lineno">  802</span>    {</div>
<div class="line"><span class="lineno">  803</span>      <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *pretty_size = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  804</span>      <span class="keywordtype">char</span> *length = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;length&quot;</span>);</div>
<div class="line"><span class="lineno">  805</span>      <span class="keywordflow">if</span> (length)</div>
<div class="line"><span class="lineno">  806</span>      {</div>
<div class="line"><span class="lineno">  807</span>        <span class="keyword">const</span> <span class="keywordtype">long</span> size = strtol(length, NULL, 10);</div>
<div class="line"><span class="lineno">  808</span>        <a class="code hl_function" href="muttlib_8c.html#a68a20bb1a92b933179acfe8157e423b1">mutt_str_pretty_size</a>(pretty_size, size);</div>
<div class="line"><span class="lineno">  809</span>        <span class="keywordflow">if</span> (expire != -1)</div>
<div class="line"><span class="lineno">  810</span>        {</div>
<div class="line"><span class="lineno">  811</span>          fmt = ngettext(</div>
<div class="line"><span class="lineno">  812</span>              <span class="comment">/* L10N: If the translation of this string is a multi line string, then</span></div>
<div class="line"><span class="lineno">  813</span><span class="comment">                 each line should start with &quot;[-- &quot; and end with &quot; --]&quot;.</span></div>
<div class="line"><span class="lineno">  814</span><span class="comment">                 The first &quot;%s/%s&quot; is a MIME type, e.g. &quot;text/plain&quot;. The last %s</span></div>
<div class="line"><span class="lineno">  815</span><span class="comment">                 expands to a date as returned by `mutt_date_parse_date()`.</span></div>
<div class="line"><span class="lineno">  816</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  817</span><span class="comment">                 Note: The size argument printed is not the actual number as passed</span></div>
<div class="line"><span class="lineno">  818</span><span class="comment">                 to gettext but the prettified version, e.g. size = 2048 will be</span></div>
<div class="line"><span class="lineno">  819</span><span class="comment">                 printed as 2K.  Your language might be sensitive to that: For</span></div>
<div class="line"><span class="lineno">  820</span><span class="comment">                 example although &#39;1K&#39; and &#39;1024&#39; represent the same number your</span></div>
<div class="line"><span class="lineno">  821</span><span class="comment">                 language might inflect the noun &#39;byte&#39; differently.</span></div>
<div class="line"><span class="lineno">  822</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  823</span><span class="comment">                 Sadly, we can&#39;t do anything about that at the moment besides</span></div>
<div class="line"><span class="lineno">  824</span><span class="comment">                 passing the precise size in bytes. If you are interested the</span></div>
<div class="line"><span class="lineno">  825</span><span class="comment">                 function responsible for the prettification is</span></div>
<div class="line"><span class="lineno">  826</span><span class="comment">                 mutt_str_pretty_size() in muttlib.c */</span></div>
<div class="line"><span class="lineno">  827</span>              <span class="stringliteral">&quot;[-- This %s/%s attachment (size %s byte) has been deleted --]\n&quot;</span></div>
<div class="line"><span class="lineno">  828</span>              <span class="stringliteral">&quot;[-- on %s --]\n&quot;</span>,</div>
<div class="line"><span class="lineno">  829</span>              <span class="stringliteral">&quot;[-- This %s/%s attachment (size %s bytes) has been deleted --]\n&quot;</span></div>
<div class="line"><span class="lineno">  830</span>              <span class="stringliteral">&quot;[-- on %s --]\n&quot;</span>,</div>
<div class="line"><span class="lineno">  831</span>              size);</div>
<div class="line"><span class="lineno">  832</span>        }</div>
<div class="line"><span class="lineno">  833</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  834</span>        {</div>
<div class="line"><span class="lineno">  835</span>          fmt = ngettext(</div>
<div class="line"><span class="lineno">  836</span>              <span class="comment">/* L10N: If the translation of this string is a multi line string, then</span></div>
<div class="line"><span class="lineno">  837</span><span class="comment">                 each line should start with &quot;[-- &quot; and end with &quot; --]&quot;.</span></div>
<div class="line"><span class="lineno">  838</span><span class="comment">                 The first &quot;%s/%s&quot; is a MIME type, e.g. &quot;text/plain&quot;.</span></div>
<div class="line"><span class="lineno">  839</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  840</span><span class="comment">                 Note: The size argument printed is not the actual number as passed</span></div>
<div class="line"><span class="lineno">  841</span><span class="comment">                 to gettext but the prettified version, e.g. size = 2048 will be</span></div>
<div class="line"><span class="lineno">  842</span><span class="comment">                 printed as 2K.  Your language might be sensitive to that: For</span></div>
<div class="line"><span class="lineno">  843</span><span class="comment">                 example although &#39;1K&#39; and &#39;1024&#39; represent the same number your</span></div>
<div class="line"><span class="lineno">  844</span><span class="comment">                 language might inflect the noun &#39;byte&#39; differently.</span></div>
<div class="line"><span class="lineno">  845</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  846</span><span class="comment">                 Sadly, we can&#39;t do anything about that at the moment besides</span></div>
<div class="line"><span class="lineno">  847</span><span class="comment">                 passing the precise size in bytes. If you are interested the</span></div>
<div class="line"><span class="lineno">  848</span><span class="comment">                 function responsible for the prettification is</span></div>
<div class="line"><span class="lineno">  849</span><span class="comment">                 mutt_str_pretty_size() in muttlib.c  */</span></div>
<div class="line"><span class="lineno">  850</span>              <span class="stringliteral">&quot;[-- This %s/%s attachment (size %s byte) has been deleted --]\n&quot;</span>,</div>
<div class="line"><span class="lineno">  851</span>              <span class="stringliteral">&quot;[-- This %s/%s attachment (size %s bytes) has been deleted --]\n&quot;</span>, size);</div>
<div class="line"><span class="lineno">  852</span>        }</div>
<div class="line"><span class="lineno">  853</span>      }</div>
<div class="line"><span class="lineno">  854</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  855</span>      {</div>
<div class="line"><span class="lineno">  856</span>        <span class="keywordflow">if</span> (expire != -1)</div>
<div class="line"><span class="lineno">  857</span>        {</div>
<div class="line"><span class="lineno">  858</span>          <span class="comment">/* L10N: If the translation of this string is a multi line string, then</span></div>
<div class="line"><span class="lineno">  859</span><span class="comment">             each line should start with &quot;[-- &quot; and end with &quot; --]&quot;.</span></div>
<div class="line"><span class="lineno">  860</span><span class="comment">             The first &quot;%s/%s&quot; is a MIME type, e.g. &quot;text/plain&quot;. The last %s</span></div>
<div class="line"><span class="lineno">  861</span><span class="comment">             expands to a date as returned by `mutt_date_parse_date()`.</span></div>
<div class="line"><span class="lineno">  862</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">  863</span><span class="comment">             Caution: Argument three %3$ is also defined but should not be used</span></div>
<div class="line"><span class="lineno">  864</span><span class="comment">             in this translation!  */</span></div>
<div class="line"><span class="lineno">  865</span>          fmt = <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- This %s/%s attachment has been deleted --]\n[-- on %4$s --]\n&quot;</span>);</div>
<div class="line"><span class="lineno">  866</span>        }</div>
<div class="line"><span class="lineno">  867</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  868</span>        {</div>
<div class="line"><span class="lineno">  869</span>          <span class="comment">/* L10N: If the translation of this string is a multi line string, then</span></div>
<div class="line"><span class="lineno">  870</span><span class="comment">             each line should start with &quot;[-- &quot; and end with &quot; --]&quot;.</span></div>
<div class="line"><span class="lineno">  871</span><span class="comment">             The first &quot;%s/%s&quot; is a MIME type, e.g. &quot;text/plain&quot;. */</span></div>
<div class="line"><span class="lineno">  872</span>          fmt = <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- This %s/%s attachment has been deleted --]\n&quot;</span>);</div>
<div class="line"><span class="lineno">  873</span>        }</div>
<div class="line"><span class="lineno">  874</span>      }</div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span>      <a class="code hl_function" href="buffer_8c.html#a02123807d31181ac701b566226e93b33">buf_printf</a>(banner, fmt, <a class="code hl_define" href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a>(b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>),</div>
<div class="line"><span class="lineno">  877</span>                 b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(pretty_size), expiration);</div>
<div class="line"><span class="lineno">  878</span>      <a class="code hl_function" href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a>(state, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(banner));</div>
<div class="line"><span class="lineno">  879</span>      <span class="keywordflow">if</span> (b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>)</div>
<div class="line"><span class="lineno">  880</span>      {</div>
<div class="line"><span class="lineno">  881</span>        <a class="code hl_function" href="mutt_2state_8c.html#a549e8896ba39ea5006be8905349a6782">state_mark_attach</a>(state);</div>
<div class="line"><span class="lineno">  882</span>        <a class="code hl_function" href="mutt_2state_8c.html#a7566d1f9e015cd673fd8744bf5ad2f06">state_printf</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- name: %s --]\n&quot;</span>), b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div>
<div class="line"><span class="lineno">  883</span>      }</div>
<div class="line"><span class="lineno">  884</span> </div>
<div class="line"><span class="lineno">  885</span>      <a class="code hl_typedef" href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a> chflags = <a class="code hl_define" href="copy_8h.html#a05de77c5d16eb6266cfb34b7b322a807">CH_DECODE</a>;</div>
<div class="line"><span class="lineno">  886</span>      <span class="keywordflow">if</span> (c_weed)</div>
<div class="line"><span class="lineno">  887</span>        chflags |= <a class="code hl_define" href="copy_8h.html#a5e818fe5d60277b658d3f98ee7e0e675">CH_WEED</a> | <a class="code hl_define" href="copy_8h.html#a606b533a9896e294b1341e648f0b8ba2">CH_REORDER</a>;</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>      <a class="code hl_function" href="copy_8c.html#a52e9f9a52a91efbaeca673868cfc8b93">mutt_copy_hdr</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, ftello(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>),</div>
<div class="line"><span class="lineno">  890</span>                    b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>, chflags, NULL, 0);</div>
<div class="line"><span class="lineno">  891</span>      <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;pretty_size);</div>
<div class="line"><span class="lineno">  892</span>    }</div>
<div class="line"><span class="lineno">  893</span>  }</div>
<div class="line"><span class="lineno">  894</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (expiration &amp;&amp; (expire &lt; <a class="code hl_function" href="mutt_2date_8c.html#ad1e6304a91c7b6f3c266a9b17c1740fe">mutt_date_now</a>()))</div>
<div class="line"><span class="lineno">  895</span>  {</div>
<div class="line"><span class="lineno">  896</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno">  897</span>    {</div>
<div class="line"><span class="lineno">  898</span>      <span class="comment">/* L10N: If the translation of this string is a multi line string, then</span></div>
<div class="line"><span class="lineno">  899</span><span class="comment">         each line should start with &quot;[-- &quot; and end with &quot; --]&quot;.</span></div>
<div class="line"><span class="lineno">  900</span><span class="comment">         The &quot;%s/%s&quot; is a MIME type, e.g. &quot;text/plain&quot;. */</span></div>
<div class="line"><span class="lineno">  901</span>      <a class="code hl_function" href="buffer_8c.html#a02123807d31181ac701b566226e93b33">buf_printf</a>(banner, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- This %s/%s attachment is not included, --]\n[-- and the indicated external source has expired --]\n&quot;</span>),</div>
<div class="line"><span class="lineno">  902</span>                 <a class="code hl_define" href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a>(b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>), b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>);</div>
<div class="line"><span class="lineno">  903</span>      <a class="code hl_function" href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a>(state, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(banner));</div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span>      <a class="code hl_typedef" href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a> chflags = <a class="code hl_define" href="copy_8h.html#a05de77c5d16eb6266cfb34b7b322a807">CH_DECODE</a> | <a class="code hl_define" href="copy_8h.html#a78788518de9fe57639d22d204a686383">CH_DISPLAY</a>;</div>
<div class="line"><span class="lineno">  906</span>      <span class="keywordflow">if</span> (c_weed)</div>
<div class="line"><span class="lineno">  907</span>        chflags |= <a class="code hl_define" href="copy_8h.html#a5e818fe5d60277b658d3f98ee7e0e675">CH_WEED</a> | <a class="code hl_define" href="copy_8h.html#a606b533a9896e294b1341e648f0b8ba2">CH_REORDER</a>;</div>
<div class="line"><span class="lineno">  908</span> </div>
<div class="line"><span class="lineno">  909</span>      <a class="code hl_function" href="copy_8c.html#a52e9f9a52a91efbaeca673868cfc8b93">mutt_copy_hdr</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, ftello(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>),</div>
<div class="line"><span class="lineno">  910</span>                    b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>, chflags, NULL, 0);</div>
<div class="line"><span class="lineno">  911</span>    }</div>
<div class="line"><span class="lineno">  912</span>  }</div>
<div class="line"><span class="lineno">  913</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  914</span>  {</div>
<div class="line"><span class="lineno">  915</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno">  916</span>    {</div>
<div class="line"><span class="lineno">  917</span>      <span class="comment">/* L10N: If the translation of this string is a multi line string, then</span></div>
<div class="line"><span class="lineno">  918</span><span class="comment">         each line should start with &quot;[-- &quot; and end with &quot; --]&quot;.</span></div>
<div class="line"><span class="lineno">  919</span><span class="comment">         The &quot;%s/%s&quot; is a MIME type, e.g. &quot;text/plain&quot;.  The %s after</span></div>
<div class="line"><span class="lineno">  920</span><span class="comment">         access-type is an access-type as defined by the MIME RFCs, e.g. &quot;FTP&quot;,</span></div>
<div class="line"><span class="lineno">  921</span><span class="comment">         &quot;LOCAL-FILE&quot;, &quot;MAIL-SERVER&quot;. */</span></div>
<div class="line"><span class="lineno">  922</span>      <a class="code hl_function" href="buffer_8c.html#a02123807d31181ac701b566226e93b33">buf_printf</a>(banner, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- This %s/%s attachment is not included, --]\n[-- and the indicated access-type %s is unsupported --]\n&quot;</span>),</div>
<div class="line"><span class="lineno">  923</span>                 <a class="code hl_define" href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a>(b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>), b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, access_type);</div>
<div class="line"><span class="lineno">  924</span>      <a class="code hl_function" href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a>(state, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(banner));</div>
<div class="line"><span class="lineno">  925</span> </div>
<div class="line"><span class="lineno">  926</span>      <a class="code hl_typedef" href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a> chflags = <a class="code hl_define" href="copy_8h.html#a05de77c5d16eb6266cfb34b7b322a807">CH_DECODE</a> | <a class="code hl_define" href="copy_8h.html#a78788518de9fe57639d22d204a686383">CH_DISPLAY</a>;</div>
<div class="line"><span class="lineno">  927</span>      <span class="keywordflow">if</span> (c_weed)</div>
<div class="line"><span class="lineno">  928</span>        chflags |= <a class="code hl_define" href="copy_8h.html#a5e818fe5d60277b658d3f98ee7e0e675">CH_WEED</a> | <a class="code hl_define" href="copy_8h.html#a606b533a9896e294b1341e648f0b8ba2">CH_REORDER</a>;</div>
<div class="line"><span class="lineno">  929</span> </div>
<div class="line"><span class="lineno">  930</span>      <a class="code hl_function" href="copy_8c.html#a52e9f9a52a91efbaeca673868cfc8b93">mutt_copy_hdr</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, ftello(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>),</div>
<div class="line"><span class="lineno">  931</span>                    b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>, chflags, NULL, 0);</div>
<div class="line"><span class="lineno">  932</span>    }</div>
<div class="line"><span class="lineno">  933</span>  }</div>
<div class="line"><span class="lineno">  934</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;banner);</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  937</span>}</div>
<div class="ttc" id="abuffer_8c_html_a02123807d31181ac701b566226e93b33"><div class="ttname"><a href="buffer_8c.html#a02123807d31181ac701b566226e93b33">buf_printf</a></div><div class="ttdeci">int buf_printf(struct Buffer *buf, const char *fmt,...)</div><div class="ttdoc">Format a string overwriting a Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00161">buffer.c:161</a></div></div>
<div class="ttc" id="amutt_2date_8c_html_ad1e6304a91c7b6f3c266a9b17c1740fe"><div class="ttname"><a href="mutt_2date_8c.html#ad1e6304a91c7b6f3c266a9b17c1740fe">mutt_date_now</a></div><div class="ttdeci">time_t mutt_date_now(void)</div><div class="ttdoc">Return the number of seconds since the Unix epoch.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2date_8c_source.html#l00456">date.c:456</a></div></div>
<div class="ttc" id="amutt_2date_8c_html_ad8aaf5118148ed8f6708f32bfab3146f"><div class="ttname"><a href="mutt_2date_8c.html#ad8aaf5118148ed8f6708f32bfab3146f">mutt_date_parse_date</a></div><div class="ttdeci">time_t mutt_date_parse_date(const char *s, struct Tz *tz_out)</div><div class="ttdoc">Parse a date string in RFC822 format.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2date_8c_source.html#l00716">date.c:716</a></div></div>
<div class="ttc" id="amutt_2state_8c_html_a0d52430e63f8cffdd0e6a78182ad4385"><div class="ttname"><a href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a></div><div class="ttdeci">void state_attach_puts(struct State *state, const char *t)</div><div class="ttdoc">Write a string to the state.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8c_source.html#l00104">state.c:104</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00672">string.c:672</a></div></div>
<div class="ttc" id="amuttlib_8c_html_a68a20bb1a92b933179acfe8157e423b1"><div class="ttname"><a href="muttlib_8c.html#a68a20bb1a92b933179acfe8157e423b1">mutt_str_pretty_size</a></div><div class="ttdeci">int mutt_str_pretty_size(struct Buffer *buf, size_t num)</div><div class="ttdoc">Display an abbreviated size, like 3.4K.</div><div class="ttdef"><b>Definition</b> <a href="muttlib_8c_source.html#l00989">muttlib.c:989</a></div></div>
<div class="ttc" id="aparameter_8c_html_a31d10561ad6b3637e7591569b903aa33"><div class="ttname"><a href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a></div><div class="ttdeci">char * mutt_param_get(const struct ParameterList *pl, const char *s)</div><div class="ttdoc">Find a matching Parameter.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8c_source.html#l00085">parameter.c:85</a></div></div>
<div class="ttc" id="astructBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">Parameters of the content-type.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00063">body.h:63</a></div></div>
</div><!-- fragment --><div id="dynsection-8" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga8a838ae7b50e8ffa147203c5cfaa3272_cgraph.svg" width="566" height="750"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-9" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga8a838ae7b50e8ffa147203c5cfaa3272_icgraph.svg" width="364" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ga4ff5374eaa24ed80f864aa4caeb54a46" name="ga4ff5374eaa24ed80f864aa4caeb54a46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4ff5374eaa24ed80f864aa4caeb54a46">&#9670;&#160;</a></span>alternative_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int alternative_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handler for multipart alternative emails - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>

<p class="definition">Definition at line <a class="el" href="handler_8c_source.html#l00942">942</a> of file <a class="el" href="handler_8c_source.html">handler.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  943</span>{</div>
<div class="line"><span class="lineno">  944</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *<span class="keyword">const</span> head = b_email;</div>
<div class="line"><span class="lineno">  945</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *choice = NULL;</div>
<div class="line"><span class="lineno">  946</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *b = NULL;</div>
<div class="line"><span class="lineno">  947</span>  <span class="keywordtype">bool</span> mustfree = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  948</span>  <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span>  <span class="keywordflow">if</span> ((b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a>) || (b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a>) ||</div>
<div class="line"><span class="lineno">  951</span>      (b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a17c00808bfbeb61dc2a001baf0aac5bd">ENC_UUENCODED</a>))</div>
<div class="line"><span class="lineno">  952</span>  {</div>
<div class="line"><span class="lineno">  953</span>    mustfree = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  954</span>    b = <a class="code hl_function" href="email_2body_8c.html#a37b346253e3b97aa64bb38ffc8d1ea0c">mutt_body_new</a>();</div>
<div class="line"><span class="lineno">  955</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = <a class="code hl_function" href="file_8c.html#a4cffa4f503de3736198956ebed431f7e">mutt_file_get_size_fp</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>);</div>
<div class="line"><span class="lineno">  956</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = <a class="code hl_function" href="email_2parse_8c.html#a9c098e697548d0ad0809a1ac49b91f8e">mutt_parse_multipart</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>,</div>
<div class="line"><span class="lineno">  957</span>                                    <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;boundary&quot;</span>),</div>
<div class="line"><span class="lineno">  958</span>                                    b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a>,</div>
<div class="line"><span class="lineno">  959</span>                                    <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;digest&quot;</span>, b_email-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>));</div>
<div class="line"><span class="lineno">  960</span>  }</div>
<div class="line"><span class="lineno">  961</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  962</span>  {</div>
<div class="line"><span class="lineno">  963</span>    b = b_email;</div>
<div class="line"><span class="lineno">  964</span>  }</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>  b_email = b;</div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span>  <span class="comment">/* First, search list of preferred types */</span></div>
<div class="line"><span class="lineno">  969</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structListNode.html">ListNode</a> *np = NULL;</div>
<div class="line"><span class="lineno">  970</span>  <a class="code hl_define" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(np, &amp;<a class="code hl_variable" href="globals_8c.html#a62b820cb814d69bafbca876aeabaf081">AlternativeOrderList</a>, entries)</div>
<div class="line"><span class="lineno">  971</span>  {</div>
<div class="line"><span class="lineno">  972</span>    <span class="keywordtype">int</span> btlen; <span class="comment">/* length of basetype */</span></div>
<div class="line"><span class="lineno">  973</span>    <span class="keywordtype">bool</span> wild; <span class="comment">/* do we have a wildcard to match all subtypes? */</span></div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span>    <span class="keywordtype">char</span> *c = strchr(np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, <span class="charliteral">&#39;/&#39;</span>);</div>
<div class="line"><span class="lineno">  976</span>    <span class="keywordflow">if</span> (c)</div>
<div class="line"><span class="lineno">  977</span>    {</div>
<div class="line"><span class="lineno">  978</span>      wild = ((c[1] == <span class="charliteral">&#39;*&#39;</span>) &amp;&amp; (c[2] == <span class="charliteral">&#39;\0&#39;</span>));</div>
<div class="line"><span class="lineno">  979</span>      btlen = c - np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>;</div>
<div class="line"><span class="lineno">  980</span>    }</div>
<div class="line"><span class="lineno">  981</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  982</span>    {</div>
<div class="line"><span class="lineno">  983</span>      wild = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  984</span>      btlen = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>);</div>
<div class="line"><span class="lineno">  985</span>    }</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>    <span class="keywordflow">if</span> (b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>)</div>
<div class="line"><span class="lineno">  988</span>      b = b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno">  989</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  990</span>      b = b_email;</div>
<div class="line"><span class="lineno">  991</span>    <span class="keywordflow">while</span> (b)</div>
<div class="line"><span class="lineno">  992</span>    {</div>
<div class="line"><span class="lineno">  993</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *bt = <a class="code hl_define" href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a>(b);</div>
<div class="line"><span class="lineno">  994</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#aefa17bf84a5a1cb4b41afb08cd91ceff">mutt_istrn_equal</a>(bt, np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, btlen) &amp;&amp; (bt[btlen] == 0))</div>
<div class="line"><span class="lineno">  995</span>      {</div>
<div class="line"><span class="lineno">  996</span>        <span class="comment">/* the basetype matches */</span></div>
<div class="line"><span class="lineno">  997</span>        <span class="keywordflow">if</span> (wild || <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a> + btlen + 1, b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>))</div>
<div class="line"><span class="lineno">  998</span>        {</div>
<div class="line"><span class="lineno">  999</span>          choice = b;</div>
<div class="line"><span class="lineno"> 1000</span>        }</div>
<div class="line"><span class="lineno"> 1001</span>      }</div>
<div class="line"><span class="lineno"> 1002</span>      b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno"> 1003</span>    }</div>
<div class="line"><span class="lineno"> 1004</span> </div>
<div class="line"><span class="lineno"> 1005</span>    <span class="keywordflow">if</span> (choice)</div>
<div class="line"><span class="lineno"> 1006</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1007</span>  }</div>
<div class="line"><span class="lineno"> 1008</span> </div>
<div class="line"><span class="lineno"> 1009</span>  <span class="comment">/* Next, look for an autoviewable type */</span></div>
<div class="line"><span class="lineno"> 1010</span>  <span class="keywordflow">if</span> (!choice)</div>
<div class="line"><span class="lineno"> 1011</span>  {</div>
<div class="line"><span class="lineno"> 1012</span>    <span class="keywordflow">if</span> (b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>)</div>
<div class="line"><span class="lineno"> 1013</span>      b = b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno"> 1014</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1015</span>      b = b_email;</div>
<div class="line"><span class="lineno"> 1016</span>    <span class="keywordflow">while</span> (b)</div>
<div class="line"><span class="lineno"> 1017</span>    {</div>
<div class="line"><span class="lineno"> 1018</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="handler_8c.html#a09f27e2821153040ea4cad0b9ade6153">is_autoview</a>(b))</div>
<div class="line"><span class="lineno"> 1019</span>        choice = b;</div>
<div class="line"><span class="lineno"> 1020</span>      b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno"> 1021</span>    }</div>
<div class="line"><span class="lineno"> 1022</span>  }</div>
<div class="line"><span class="lineno"> 1023</span> </div>
<div class="line"><span class="lineno"> 1024</span>  <span class="comment">/* Then, look for a text entry */</span></div>
<div class="line"><span class="lineno"> 1025</span>  <span class="keywordflow">if</span> (!choice)</div>
<div class="line"><span class="lineno"> 1026</span>  {</div>
<div class="line"><span class="lineno"> 1027</span>    <span class="keywordflow">if</span> (b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>)</div>
<div class="line"><span class="lineno"> 1028</span>      b = b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno"> 1029</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1030</span>      b = b_email;</div>
<div class="line"><span class="lineno"> 1031</span>    <span class="keywordtype">int</span> type = 0;</div>
<div class="line"><span class="lineno"> 1032</span>    <span class="keywordflow">while</span> (b)</div>
<div class="line"><span class="lineno"> 1033</span>    {</div>
<div class="line"><span class="lineno"> 1034</span>      <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>)</div>
<div class="line"><span class="lineno"> 1035</span>      {</div>
<div class="line"><span class="lineno"> 1036</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;plain&quot;</span>, b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>) &amp;&amp; (type &lt;= <a class="code hl_define" href="handler_8c.html#a83d9765384489e5b98d948f610c4af38">TXT_PLAIN</a>))</div>
<div class="line"><span class="lineno"> 1037</span>        {</div>
<div class="line"><span class="lineno"> 1038</span>          choice = b;</div>
<div class="line"><span class="lineno"> 1039</span>          type = <a class="code hl_define" href="handler_8c.html#a83d9765384489e5b98d948f610c4af38">TXT_PLAIN</a>;</div>
<div class="line"><span class="lineno"> 1040</span>        }</div>
<div class="line"><span class="lineno"> 1041</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;enriched&quot;</span>, b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>) &amp;&amp; (type &lt;= <a class="code hl_define" href="handler_8c.html#aac25f3e996b8633b1ee447360b4f4398">TXT_ENRICHED</a>))</div>
<div class="line"><span class="lineno"> 1042</span>        {</div>
<div class="line"><span class="lineno"> 1043</span>          choice = b;</div>
<div class="line"><span class="lineno"> 1044</span>          type = <a class="code hl_define" href="handler_8c.html#aac25f3e996b8633b1ee447360b4f4398">TXT_ENRICHED</a>;</div>
<div class="line"><span class="lineno"> 1045</span>        }</div>
<div class="line"><span class="lineno"> 1046</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;html&quot;</span>, b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>) &amp;&amp; (type &lt;= <a class="code hl_define" href="handler_8c.html#a984562cb651e984a5b587170dee57a89">TXT_HTML</a>))</div>
<div class="line"><span class="lineno"> 1047</span>        {</div>
<div class="line"><span class="lineno"> 1048</span>          choice = b;</div>
<div class="line"><span class="lineno"> 1049</span>          type = <a class="code hl_define" href="handler_8c.html#a984562cb651e984a5b587170dee57a89">TXT_HTML</a>;</div>
<div class="line"><span class="lineno"> 1050</span>        }</div>
<div class="line"><span class="lineno"> 1051</span>      }</div>
<div class="line"><span class="lineno"> 1052</span>      b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno"> 1053</span>    }</div>
<div class="line"><span class="lineno"> 1054</span>  }</div>
<div class="line"><span class="lineno"> 1055</span> </div>
<div class="line"><span class="lineno"> 1056</span>  <span class="comment">/* Finally, look for other possibilities */</span></div>
<div class="line"><span class="lineno"> 1057</span>  <span class="keywordflow">if</span> (!choice)</div>
<div class="line"><span class="lineno"> 1058</span>  {</div>
<div class="line"><span class="lineno"> 1059</span>    <span class="keywordflow">if</span> (b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>)</div>
<div class="line"><span class="lineno"> 1060</span>      b = b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno"> 1061</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1062</span>      b = b_email;</div>
<div class="line"><span class="lineno"> 1063</span>    <span class="keywordflow">while</span> (b)</div>
<div class="line"><span class="lineno"> 1064</span>    {</div>
<div class="line"><span class="lineno"> 1065</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="handler_8c.html#a3cc6312b687436c5023e476461662e8e">mutt_can_decode</a>(b))</div>
<div class="line"><span class="lineno"> 1066</span>        choice = b;</div>
<div class="line"><span class="lineno"> 1067</span>      b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno"> 1068</span>    }</div>
<div class="line"><span class="lineno"> 1069</span>  }</div>
<div class="line"><span class="lineno"> 1070</span> </div>
<div class="line"><span class="lineno"> 1071</span>  <span class="keywordflow">if</span> (choice)</div>
<div class="line"><span class="lineno"> 1072</span>  {</div>
<div class="line"><span class="lineno"> 1073</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_weed = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;weed&quot;</span>);</div>
<div class="line"><span class="lineno"> 1074</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a> &amp;&amp; !c_weed &amp;&amp;</div>
<div class="line"><span class="lineno"> 1075</span>        <a class="code hl_function" href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, choice-&gt;<a class="code hl_variable" href="structBody.html#ae6ebb9758689003ed9ae055272420dd9">hdr_offset</a>, SEEK_SET))</div>
<div class="line"><span class="lineno"> 1076</span>    {</div>
<div class="line"><span class="lineno"> 1077</span>      <a class="code hl_function" href="file_8c.html#a2bafa45ca3c8ce7d96303377d860e2db">mutt_file_copy_bytes</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, choice-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a> - choice-&gt;<a class="code hl_variable" href="structBody.html#ae6ebb9758689003ed9ae055272420dd9">hdr_offset</a>);</div>
<div class="line"><span class="lineno"> 1078</span>    }</div>
<div class="line"><span class="lineno"> 1079</span> </div>
<div class="line"><span class="lineno"> 1080</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_show_multipart_alternative = <a class="code hl_function" href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;show_multipart_alternative&quot;</span>);</div>
<div class="line"><span class="lineno"> 1081</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(<span class="stringliteral">&quot;info&quot;</span>, c_show_multipart_alternative))</div>
<div class="line"><span class="lineno"> 1082</span>    {</div>
<div class="line"><span class="lineno"> 1083</span>      <a class="code hl_function" href="handler_8c.html#a8192c0ff2c40550af9c2ccdca02276e3">print_part_line</a>(state, choice, 0);</div>
<div class="line"><span class="lineno"> 1084</span>    }</div>
<div class="line"><span class="lineno"> 1085</span>    <a class="code hl_function" href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a>(choice, state);</div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span>    <span class="comment">/* Let it flow back to the main part */</span></div>
<div class="line"><span class="lineno"> 1088</span>    head-&gt;<a class="code hl_variable" href="structBody.html#abf4a6326b43363706a4731cbab976df6">nowrap</a> = choice-&gt;<a class="code hl_variable" href="structBody.html#abf4a6326b43363706a4731cbab976df6">nowrap</a>;</div>
<div class="line"><span class="lineno"> 1089</span>    choice-&gt;<a class="code hl_variable" href="structBody.html#abf4a6326b43363706a4731cbab976df6">nowrap</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(<span class="stringliteral">&quot;info&quot;</span>, c_show_multipart_alternative))</div>
<div class="line"><span class="lineno"> 1092</span>    {</div>
<div class="line"><span class="lineno"> 1093</span>      <span class="keywordflow">if</span> (b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>)</div>
<div class="line"><span class="lineno"> 1094</span>        b = b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno"> 1095</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1096</span>        b = b_email;</div>
<div class="line"><span class="lineno"> 1097</span>      <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><span class="lineno"> 1098</span>      <span class="keywordflow">while</span> (b)</div>
<div class="line"><span class="lineno"> 1099</span>      {</div>
<div class="line"><span class="lineno"> 1100</span>        <span class="keywordflow">if</span> (choice != b)</div>
<div class="line"><span class="lineno"> 1101</span>        {</div>
<div class="line"><span class="lineno"> 1102</span>          count += 1;</div>
<div class="line"><span class="lineno"> 1103</span>          <span class="keywordflow">if</span> (count == 1)</div>
<div class="line"><span class="lineno"> 1104</span>            <a class="code hl_define" href="mutt_2state_8h.html#a511e4530400bb790de3fc76b44640e43">state_putc</a>(state, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><span class="lineno"> 1105</span> </div>
<div class="line"><span class="lineno"> 1106</span>          <a class="code hl_function" href="handler_8c.html#a8192c0ff2c40550af9c2ccdca02276e3">print_part_line</a>(state, b, count);</div>
<div class="line"><span class="lineno"> 1107</span>        }</div>
<div class="line"><span class="lineno"> 1108</span>        b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno"> 1109</span>      }</div>
<div class="line"><span class="lineno"> 1110</span>    }</div>
<div class="line"><span class="lineno"> 1111</span>  }</div>
<div class="line"><span class="lineno"> 1112</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno"> 1113</span>  {</div>
<div class="line"><span class="lineno"> 1114</span>    <span class="comment">/* didn&#39;t find anything that we could display! */</span></div>
<div class="line"><span class="lineno"> 1115</span>    <a class="code hl_function" href="mutt_2state_8c.html#a549e8896ba39ea5006be8905349a6782">state_mark_attach</a>(state);</div>
<div class="line"><span class="lineno"> 1116</span>    <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Error: Could not display any parts of Multipart/Alternative --]\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1117</span>    rc = -1;</div>
<div class="line"><span class="lineno"> 1118</span>  }</div>
<div class="line"><span class="lineno"> 1119</span> </div>
<div class="line"><span class="lineno"> 1120</span>  <span class="keywordflow">if</span> (mustfree)</div>
<div class="line"><span class="lineno"> 1121</span>    <a class="code hl_function" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;b_email);</div>
<div class="line"><span class="lineno"> 1122</span> </div>
<div class="line"><span class="lineno"> 1123</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno"> 1124</span>}</div>
<div class="ttc" id="aconfig_2helpers_8c_html_a6b1589ee93ff51ef31f1d9324e138078"><div class="ttname"><a href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00291">helpers.c:291</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a9c098e697548d0ad0809a1ac49b91f8e"><div class="ttname"><a href="email_2parse_8c.html#a9c098e697548d0ad0809a1ac49b91f8e">mutt_parse_multipart</a></div><div class="ttdeci">struct Body * mutt_parse_multipart(FILE *fp, const char *boundary, LOFF_T end_off, bool digest)</div><div class="ttdoc">Parse a multipart structure.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01852">parse.c:1852</a></div></div>
<div class="ttc" id="afile_8c_html_a6b60cb2044041374689e6e6641c5cc05"><div class="ttname"><a href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a></div><div class="ttdeci">bool mutt_file_seek(FILE *fp, LOFF_T offset, int whence)</div><div class="ttdoc">Wrapper for fseeko with error handling.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00655">file.c:655</a></div></div>
<div class="ttc" id="aglobals_8c_html_a62b820cb814d69bafbca876aeabaf081"><div class="ttname"><a href="globals_8c.html#a62b820cb814d69bafbca876aeabaf081">AlternativeOrderList</a></div><div class="ttdeci">struct ListHead AlternativeOrderList</div><div class="ttdoc">List of preferred mime types to display.</div><div class="ttdef"><b>Definition</b> <a href="globals_8c_source.html#l00044">globals.c:44</a></div></div>
<div class="ttc" id="ahandler_8c_html_a09f27e2821153040ea4cad0b9ade6153"><div class="ttname"><a href="handler_8c.html#a09f27e2821153040ea4cad0b9ade6153">is_autoview</a></div><div class="ttdeci">static bool is_autoview(struct Body *b)</div><div class="ttdoc">Should email body be filtered by mailcap.</div><div class="ttdef"><b>Definition</b> <a href="handler_8c_source.html#l00486">handler.c:486</a></div></div>
<div class="ttc" id="ahandler_8c_html_a3cc6312b687436c5023e476461662e8e"><div class="ttname"><a href="handler_8c.html#a3cc6312b687436c5023e476461662e8e">mutt_can_decode</a></div><div class="ttdeci">bool mutt_can_decode(struct Body *b)</div><div class="ttdoc">Will decoding the attachment produce any output.</div><div class="ttdef"><b>Definition</b> <a href="handler_8c_source.html#l01866">handler.c:1866</a></div></div>
<div class="ttc" id="ahandler_8c_html_a8192c0ff2c40550af9c2ccdca02276e3"><div class="ttname"><a href="handler_8c.html#a8192c0ff2c40550af9c2ccdca02276e3">print_part_line</a></div><div class="ttdeci">static void print_part_line(struct State *state, struct Body *b_email, int n)</div><div class="ttdoc">Print a separator for the Mime part.</div><div class="ttdef"><b>Definition</b> <a href="handler_8c_source.html#l00092">handler.c:92</a></div></div>
<div class="ttc" id="ahandler_8c_html_a83d9765384489e5b98d948f610c4af38"><div class="ttname"><a href="handler_8c.html#a83d9765384489e5b98d948f610c4af38">TXT_PLAIN</a></div><div class="ttdeci">#define TXT_PLAIN</div><div class="ttdef"><b>Definition</b> <a href="handler_8c_source.html#l00071">handler.c:71</a></div></div>
<div class="ttc" id="ahandler_8c_html_a984562cb651e984a5b587170dee57a89"><div class="ttname"><a href="handler_8c.html#a984562cb651e984a5b587170dee57a89">TXT_HTML</a></div><div class="ttdeci">#define TXT_HTML</div><div class="ttdef"><b>Definition</b> <a href="handler_8c_source.html#l00070">handler.c:70</a></div></div>
<div class="ttc" id="ahandler_8c_html_aac25f3e996b8633b1ee447360b4f4398"><div class="ttname"><a href="handler_8c.html#aac25f3e996b8633b1ee447360b4f4398">TXT_ENRICHED</a></div><div class="ttdeci">#define TXT_ENRICHED</div><div class="ttdef"><b>Definition</b> <a href="handler_8c_source.html#l00072">handler.c:72</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdeci">@ TYPE_TEXT</div><div class="ttdoc">Type: &#39;text/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_aefa17bf84a5a1cb4b41afb08cd91ceff"><div class="ttname"><a href="mutt_2string_8c.html#aefa17bf84a5a1cb4b41afb08cd91ceff">mutt_istrn_equal</a></div><div class="ttdeci">bool mutt_istrn_equal(const char *a, const char *b, size_t num)</div><div class="ttdoc">Check for equality of two strings ignoring case (to a maximum), safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00455">string.c:455</a></div></div>
<div class="ttc" id="aqueue_8h_html_a77999ebdf5aaf7af8b8ea22bf208c432"><div class="ttname"><a href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a></div><div class="ttdeci">#define STAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00390">queue.h:390</a></div></div>
<div class="ttc" id="astructBody_html_abf4a6326b43363706a4731cbab976df6"><div class="ttname"><a href="structBody.html#abf4a6326b43363706a4731cbab976df6">Body::nowrap</a></div><div class="ttdeci">bool nowrap</div><div class="ttdoc">Do not wrap the output in the pager.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00089">body.h:89</a></div></div>
<div class="ttc" id="astructBody_html_ac55cdfce46eed13151dcfe9b329d254c"><div class="ttname"><a href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">Body::next</a></div><div class="ttdeci">struct Body * next</div><div class="ttdoc">next attachment in the list</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00072">body.h:72</a></div></div>
<div class="ttc" id="astructBody_html_ae6ebb9758689003ed9ae055272420dd9"><div class="ttname"><a href="structBody.html#ae6ebb9758689003ed9ae055272420dd9">Body::hdr_offset</a></div><div class="ttdeci">long hdr_offset</div><div class="ttdoc">Offset in stream where the headers begin.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00081">body.h:81</a></div></div>
<div class="ttc" id="astructBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00040">body.h:40</a></div></div>
<div class="ttc" id="astructListNode_html"><div class="ttname"><a href="structListNode.html">ListNode</a></div><div class="ttdoc">A List node for strings.</div><div class="ttdef"><b>Definition</b> <a href="list_8h_source.html#l00036">list.h:37</a></div></div>
<div class="ttc" id="astructListNode_html_aafe688d670318196766392d8235d00a7"><div class="ttname"><a href="structListNode.html#aafe688d670318196766392d8235d00a7">ListNode::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">String.</div><div class="ttdef"><b>Definition</b> <a href="list_8h_source.html#l00038">list.h:38</a></div></div>
</div><!-- fragment --><div id="dynsection-10" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga4ff5374eaa24ed80f864aa4caeb54a46_cgraph.svg" width="712" height="966"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-11" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga4ff5374eaa24ed80f864aa4caeb54a46_icgraph.svg" width="344" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="gad678bde50d3eb6367c65e9ed646939bc" name="gad678bde50d3eb6367c65e9ed646939bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad678bde50d3eb6367c65e9ed646939bc">&#9670;&#160;</a></span>multilingual_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int multilingual_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handler for multi-lingual emails - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Always </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="handler_8c_source.html#l01130">1130</a> of file <a class="el" href="handler_8c_source.html">handler.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1131</span>{</div>
<div class="line"><span class="lineno"> 1132</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *b = NULL;</div>
<div class="line"><span class="lineno"> 1133</span>  <span class="keywordtype">bool</span> mustfree = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1134</span>  <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><span class="lineno"> 1135</span> </div>
<div class="line"><span class="lineno"> 1136</span>  <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;RFC8255 &gt;&gt; entering in handler multilingual handler\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1137</span>  <span class="keywordflow">if</span> ((b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a>) || (b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a>) ||</div>
<div class="line"><span class="lineno"> 1138</span>      (b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a17c00808bfbeb61dc2a001baf0aac5bd">ENC_UUENCODED</a>))</div>
<div class="line"><span class="lineno"> 1139</span>  {</div>
<div class="line"><span class="lineno"> 1140</span>    mustfree = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1141</span>    b = <a class="code hl_function" href="email_2body_8c.html#a37b346253e3b97aa64bb38ffc8d1ea0c">mutt_body_new</a>();</div>
<div class="line"><span class="lineno"> 1142</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = <a class="code hl_function" href="file_8c.html#a4cffa4f503de3736198956ebed431f7e">mutt_file_get_size_fp</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>);</div>
<div class="line"><span class="lineno"> 1143</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = <a class="code hl_function" href="email_2parse_8c.html#a9c098e697548d0ad0809a1ac49b91f8e">mutt_parse_multipart</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>,</div>
<div class="line"><span class="lineno"> 1144</span>                                    <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;boundary&quot;</span>),</div>
<div class="line"><span class="lineno"> 1145</span>                                    b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a>,</div>
<div class="line"><span class="lineno"> 1146</span>                                    <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;digest&quot;</span>, b_email-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>));</div>
<div class="line"><span class="lineno"> 1147</span>  }</div>
<div class="line"><span class="lineno"> 1148</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1149</span>  {</div>
<div class="line"><span class="lineno"> 1150</span>    b = b_email;</div>
<div class="line"><span class="lineno"> 1151</span>  }</div>
<div class="line"><span class="lineno"> 1152</span> </div>
<div class="line"><span class="lineno"> 1153</span>  b_email = b;</div>
<div class="line"><span class="lineno"> 1154</span> </div>
<div class="line"><span class="lineno"> 1155</span>  <span class="keywordflow">if</span> (b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>)</div>
<div class="line"><span class="lineno"> 1156</span>    b = b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno"> 1157</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1158</span>    b = b_email;</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *choice = NULL;</div>
<div class="line"><span class="lineno"> 1161</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *first_part = NULL;</div>
<div class="line"><span class="lineno"> 1162</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *zxx_part = NULL;</div>
<div class="line"><span class="lineno"> 1163</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structListNode.html">ListNode</a> *np = NULL;</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>  <span class="keywordflow">while</span> (b)</div>
<div class="line"><span class="lineno"> 1166</span>  {</div>
<div class="line"><span class="lineno"> 1167</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="handler_8c.html#a3cc6312b687436c5023e476461662e8e">mutt_can_decode</a>(b))</div>
<div class="line"><span class="lineno"> 1168</span>    {</div>
<div class="line"><span class="lineno"> 1169</span>      first_part = b;</div>
<div class="line"><span class="lineno"> 1170</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1171</span>    }</div>
<div class="line"><span class="lineno"> 1172</span>    b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno"> 1173</span>  }</div>
<div class="line"><span class="lineno"> 1174</span> </div>
<div class="line"><span class="lineno"> 1175</span>  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structSlist.html">Slist</a> *c_preferred_languages = <a class="code hl_function" href="config_2helpers_8c.html#a72ee0a5d0c0632c4fe911ef5aa6a9b8b">cs_subset_slist</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;preferred_languages&quot;</span>);</div>
<div class="line"><span class="lineno"> 1176</span>  <span class="keywordflow">if</span> (c_preferred_languages)</div>
<div class="line"><span class="lineno"> 1177</span>  {</div>
<div class="line"><span class="lineno"> 1178</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *langs = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno"> 1179</span>    <a class="code hl_function" href="subset_8c.html#a7e8ecc401fed4ef7d076bc377ec8b80a">cs_subset_str_string_get</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;preferred_languages&quot;</span>, langs);</div>
<div class="line"><span class="lineno"> 1180</span>    <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;RFC8255 &gt;&gt; preferred_languages set in config to &#39;%s&#39;\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1181</span>               <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(langs));</div>
<div class="line"><span class="lineno"> 1182</span>    <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;langs);</div>
<div class="line"><span class="lineno"> 1183</span> </div>
<div class="line"><span class="lineno"> 1184</span>    <a class="code hl_define" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(np, &amp;c_preferred_languages-&gt;<a class="code hl_variable" href="structSlist.html#a6abed005cd7946996bcf80e0daa53c3b">head</a>, entries)</div>
<div class="line"><span class="lineno"> 1185</span>    {</div>
<div class="line"><span class="lineno"> 1186</span>      <span class="keywordflow">while</span> (b)</div>
<div class="line"><span class="lineno"> 1187</span>      {</div>
<div class="line"><span class="lineno"> 1188</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="handler_8c.html#a3cc6312b687436c5023e476461662e8e">mutt_can_decode</a>(b))</div>
<div class="line"><span class="lineno"> 1189</span>        {</div>
<div class="line"><span class="lineno"> 1190</span>          <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#a043f55e8f15bc6f1324d35cb5d7f061c">language</a> &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(<span class="stringliteral">&quot;zxx&quot;</span>, b-&gt;<a class="code hl_variable" href="structBody.html#a043f55e8f15bc6f1324d35cb5d7f061c">language</a>))</div>
<div class="line"><span class="lineno"> 1191</span>            zxx_part = b;</div>
<div class="line"><span class="lineno"> 1192</span> </div>
<div class="line"><span class="lineno"> 1193</span>          <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;RFC8255 &gt;&gt; comparing configuration preferred_language=&#39;%s&#39; to mail part content-language=&#39;%s&#39;\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1194</span>                     np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, b-&gt;<a class="code hl_variable" href="structBody.html#a043f55e8f15bc6f1324d35cb5d7f061c">language</a>);</div>
<div class="line"><span class="lineno"> 1195</span>          <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#a043f55e8f15bc6f1324d35cb5d7f061c">language</a> &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, b-&gt;<a class="code hl_variable" href="structBody.html#a043f55e8f15bc6f1324d35cb5d7f061c">language</a>))</div>
<div class="line"><span class="lineno"> 1196</span>          {</div>
<div class="line"><span class="lineno"> 1197</span>            <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;RFC8255 &gt;&gt; preferred_language=&#39;%s&#39; matches content-language=&#39;%s&#39; &gt;&gt; part selected to be displayed\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1198</span>                       np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, b-&gt;<a class="code hl_variable" href="structBody.html#a043f55e8f15bc6f1324d35cb5d7f061c">language</a>);</div>
<div class="line"><span class="lineno"> 1199</span>            choice = b;</div>
<div class="line"><span class="lineno"> 1200</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1201</span>          }</div>
<div class="line"><span class="lineno"> 1202</span>        }</div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span>        b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno"> 1205</span>      }</div>
<div class="line"><span class="lineno"> 1206</span> </div>
<div class="line"><span class="lineno"> 1207</span>      <span class="keywordflow">if</span> (choice)</div>
<div class="line"><span class="lineno"> 1208</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1209</span> </div>
<div class="line"><span class="lineno"> 1210</span>      <span class="keywordflow">if</span> (b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>)</div>
<div class="line"><span class="lineno"> 1211</span>        b = b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno"> 1212</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1213</span>        b = b_email;</div>
<div class="line"><span class="lineno"> 1214</span>    }</div>
<div class="line"><span class="lineno"> 1215</span>  }</div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span>  <span class="keywordflow">if</span> (choice)</div>
<div class="line"><span class="lineno"> 1218</span>  {</div>
<div class="line"><span class="lineno"> 1219</span>    <a class="code hl_function" href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a>(choice, state);</div>
<div class="line"><span class="lineno"> 1220</span>  }</div>
<div class="line"><span class="lineno"> 1221</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1222</span>  {</div>
<div class="line"><span class="lineno"> 1223</span>    <span class="keywordflow">if</span> (zxx_part)</div>
<div class="line"><span class="lineno"> 1224</span>      <a class="code hl_function" href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a>(zxx_part, state);</div>
<div class="line"><span class="lineno"> 1225</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1226</span>      <a class="code hl_function" href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a>(first_part, state);</div>
<div class="line"><span class="lineno"> 1227</span>  }</div>
<div class="line"><span class="lineno"> 1228</span> </div>
<div class="line"><span class="lineno"> 1229</span>  <span class="keywordflow">if</span> (mustfree)</div>
<div class="line"><span class="lineno"> 1230</span>    <a class="code hl_function" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;b_email);</div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno"> 1233</span>}</div>
<div class="ttc" id="aconfig_2helpers_8c_html_a72ee0a5d0c0632c4fe911ef5aa6a9b8b"><div class="ttname"><a href="config_2helpers_8c.html#a72ee0a5d0c0632c4fe911ef5aa6a9b8b">cs_subset_slist</a></div><div class="ttdeci">const struct Slist * cs_subset_slist(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string-list config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00242">helpers.c:242</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gae6c5fd73af3410b2d5e8099f8774c8da"><div class="ttname"><a href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a></div><div class="ttdeci">#define mutt_debug(LEVEL,...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00090">logging2.h:90</a></div></div>
<div class="ttc" id="alogging2_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3"><div class="ttname"><a href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a></div><div class="ttdeci">@ LL_DEBUG2</div><div class="ttdoc">Log at debug level 2.</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00045">logging2.h:45</a></div></div>
<div class="ttc" id="astructBody_html_a043f55e8f15bc6f1324d35cb5d7f061c"><div class="ttname"><a href="structBody.html#a043f55e8f15bc6f1324d35cb5d7f061c">Body::language</a></div><div class="ttdeci">char * language</div><div class="ttdoc">content-language (RFC8255)</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00078">body.h:78</a></div></div>
<div class="ttc" id="astructSlist_html"><div class="ttname"><a href="structSlist.html">Slist</a></div><div class="ttdoc">String list.</div><div class="ttdef"><b>Definition</b> <a href="slist_8h_source.html#l00036">slist.h:37</a></div></div>
<div class="ttc" id="astructSlist_html_a6abed005cd7946996bcf80e0daa53c3b"><div class="ttname"><a href="structSlist.html#a6abed005cd7946996bcf80e0daa53c3b">Slist::head</a></div><div class="ttdeci">struct ListHead head</div><div class="ttdoc">List containing values.</div><div class="ttdef"><b>Definition</b> <a href="slist_8h_source.html#l00038">slist.h:38</a></div></div>
<div class="ttc" id="asubset_8c_html_a7e8ecc401fed4ef7d076bc377ec8b80a"><div class="ttname"><a href="subset_8c.html#a7e8ecc401fed4ef7d076bc377ec8b80a">cs_subset_str_string_get</a></div><div class="ttdeci">int cs_subset_str_string_get(const struct ConfigSubset *sub, const char *name, struct Buffer *result)</div><div class="ttdoc">Get a config item as a string.</div><div class="ttdef"><b>Definition</b> <a href="subset_8c_source.html#l00354">subset.c:354</a></div></div>
</div><!-- fragment --><div id="dynsection-12" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gad678bde50d3eb6367c65e9ed646939bc_cgraph.svg" width="722" height="772"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-13" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gad678bde50d3eb6367c65e9ed646939bc_icgraph.svg" width="348" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="gac1b8e821ab05eee2180e82f0ae4c7421" name="gac1b8e821ab05eee2180e82f0ae4c7421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac1b8e821ab05eee2180e82f0ae4c7421">&#9670;&#160;</a></span>multipart_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int multipart_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handler for multipart emails - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>

<p class="definition">Definition at line <a class="el" href="handler_8c_source.html#l01238">1238</a> of file <a class="el" href="handler_8c_source.html">handler.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1239</span>{</div>
<div class="line"><span class="lineno"> 1240</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *b = NULL, *p = NULL;</div>
<div class="line"><span class="lineno"> 1241</span>  <span class="keywordtype">int</span> count;</div>
<div class="line"><span class="lineno"> 1242</span>  <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><span class="lineno"> 1243</span> </div>
<div class="line"><span class="lineno"> 1244</span>  <span class="keywordflow">if</span> ((b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a>) || (b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a>) ||</div>
<div class="line"><span class="lineno"> 1245</span>      (b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a17c00808bfbeb61dc2a001baf0aac5bd">ENC_UUENCODED</a>))</div>
<div class="line"><span class="lineno"> 1246</span>  {</div>
<div class="line"><span class="lineno"> 1247</span>    b = <a class="code hl_function" href="email_2body_8c.html#a37b346253e3b97aa64bb38ffc8d1ea0c">mutt_body_new</a>();</div>
<div class="line"><span class="lineno"> 1248</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = <a class="code hl_function" href="file_8c.html#a4cffa4f503de3736198956ebed431f7e">mutt_file_get_size_fp</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>);</div>
<div class="line"><span class="lineno"> 1249</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = <a class="code hl_function" href="email_2parse_8c.html#a9c098e697548d0ad0809a1ac49b91f8e">mutt_parse_multipart</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>,</div>
<div class="line"><span class="lineno"> 1250</span>                                    <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;boundary&quot;</span>),</div>
<div class="line"><span class="lineno"> 1251</span>                                    b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a>,</div>
<div class="line"><span class="lineno"> 1252</span>                                    <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;digest&quot;</span>, b_email-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>));</div>
<div class="line"><span class="lineno"> 1253</span>  }</div>
<div class="line"><span class="lineno"> 1254</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1255</span>  {</div>
<div class="line"><span class="lineno"> 1256</span>    b = b_email;</div>
<div class="line"><span class="lineno"> 1257</span>  }</div>
<div class="line"><span class="lineno"> 1258</span> </div>
<div class="line"><span class="lineno"> 1259</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_weed = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;weed&quot;</span>);</div>
<div class="line"><span class="lineno"> 1260</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_include_only_first = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;include_only_first&quot;</span>);</div>
<div class="line"><span class="lineno"> 1261</span> </div>
<div class="line"><span class="lineno"> 1262</span>  <span class="keywordflow">for</span> (p = b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>, count = 1; p; p = p-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>, count++)</div>
<div class="line"><span class="lineno"> 1263</span>  {</div>
<div class="line"><span class="lineno"> 1264</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno"> 1265</span>    {</div>
<div class="line"><span class="lineno"> 1266</span>      <a class="code hl_function" href="mutt_2state_8c.html#a549e8896ba39ea5006be8905349a6782">state_mark_attach</a>(state);</div>
<div class="line"><span class="lineno"> 1267</span>      <span class="keywordflow">if</span> (p-&gt;description || p-&gt;filename || p-&gt;form_name)</div>
<div class="line"><span class="lineno"> 1268</span>      {</div>
<div class="line"><span class="lineno"> 1269</span>        <span class="comment">/* L10N: %s is the attachment description, filename or form_name. */</span></div>
<div class="line"><span class="lineno"> 1270</span>        <a class="code hl_function" href="mutt_2state_8c.html#a7566d1f9e015cd673fd8744bf5ad2f06">state_printf</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Attachment #%d: %s --]\n&quot;</span>), count,</div>
<div class="line"><span class="lineno"> 1271</span>                     p-&gt;description ? p-&gt;description :</div>
<div class="line"><span class="lineno"> 1272</span>                     p-&gt;filename    ? p-&gt;filename :</div>
<div class="line"><span class="lineno"> 1273</span>                                      p-&gt;form_name);</div>
<div class="line"><span class="lineno"> 1274</span>      }</div>
<div class="line"><span class="lineno"> 1275</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1276</span>      {</div>
<div class="line"><span class="lineno"> 1277</span>        <a class="code hl_function" href="mutt_2state_8c.html#a7566d1f9e015cd673fd8744bf5ad2f06">state_printf</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Attachment #%d --]\n&quot;</span>), count);</div>
<div class="line"><span class="lineno"> 1278</span>      }</div>
<div class="line"><span class="lineno"> 1279</span>      <a class="code hl_function" href="handler_8c.html#a8192c0ff2c40550af9c2ccdca02276e3">print_part_line</a>(state, p, 0);</div>
<div class="line"><span class="lineno"> 1280</span>      <span class="keywordflow">if</span> (c_weed)</div>
<div class="line"><span class="lineno"> 1281</span>      {</div>
<div class="line"><span class="lineno"> 1282</span>        <a class="code hl_define" href="mutt_2state_8h.html#a511e4530400bb790de3fc76b44640e43">state_putc</a>(state, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><span class="lineno"> 1283</span>      }</div>
<div class="line"><span class="lineno"> 1284</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, p-&gt;hdr_offset, SEEK_SET))</div>
<div class="line"><span class="lineno"> 1285</span>      {</div>
<div class="line"><span class="lineno"> 1286</span>        <a class="code hl_function" href="file_8c.html#a2bafa45ca3c8ce7d96303377d860e2db">mutt_file_copy_bytes</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, p-&gt;offset - p-&gt;hdr_offset);</div>
<div class="line"><span class="lineno"> 1287</span>      }</div>
<div class="line"><span class="lineno"> 1288</span>    }</div>
<div class="line"><span class="lineno"> 1289</span> </div>
<div class="line"><span class="lineno"> 1290</span>    rc = <a class="code hl_function" href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a>(p, state);</div>
<div class="line"><span class="lineno"> 1291</span>    <a class="code hl_define" href="mutt_2state_8h.html#a511e4530400bb790de3fc76b44640e43">state_putc</a>(state, <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><span class="lineno"> 1292</span> </div>
<div class="line"><span class="lineno"> 1293</span>    <span class="keywordflow">if</span> (rc != 0)</div>
<div class="line"><span class="lineno"> 1294</span>    {</div>
<div class="line"><span class="lineno"> 1295</span>      <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;One or more parts of this message could not be displayed&quot;</span>));</div>
<div class="line"><span class="lineno"> 1296</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;Failed on attachment #%d, type %s/%s\n&quot;</span>, count,</div>
<div class="line"><span class="lineno"> 1297</span>                 <a class="code hl_define" href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a>(p), <a class="code hl_define" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(p-&gt;subtype));</div>
<div class="line"><span class="lineno"> 1298</span>    }</div>
<div class="line"><span class="lineno"> 1299</span> </div>
<div class="line"><span class="lineno"> 1300</span>    <span class="keywordflow">if</span> ((state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a77951e3f170a44a6e89c2261a6cf0f75">STATE_REPLYING</a>) &amp;&amp; c_include_only_first &amp;&amp; (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a3747adb496e21b20abbcf8d3b1db92ce">STATE_FIRSTDONE</a>))</div>
<div class="line"><span class="lineno"> 1301</span>    {</div>
<div class="line"><span class="lineno"> 1302</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1303</span>    }</div>
<div class="line"><span class="lineno"> 1304</span>  }</div>
<div class="line"><span class="lineno"> 1305</span> </div>
<div class="line"><span class="lineno"> 1306</span>  <span class="keywordflow">if</span> ((b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a>) || (b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a>) ||</div>
<div class="line"><span class="lineno"> 1307</span>      (b_email-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a17c00808bfbeb61dc2a001baf0aac5bd">ENC_UUENCODED</a>))</div>
<div class="line"><span class="lineno"> 1308</span>  {</div>
<div class="line"><span class="lineno"> 1309</span>    <a class="code hl_function" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;b);</div>
<div class="line"><span class="lineno"> 1310</span>  }</div>
<div class="line"><span class="lineno"> 1311</span> </div>
<div class="line"><span class="lineno"> 1312</span>  <span class="comment">/* make failure of a single part non-fatal */</span></div>
<div class="line"><span class="lineno"> 1313</span>  <span class="keywordflow">if</span> (rc &lt; 0)</div>
<div class="line"><span class="lineno"> 1314</span>    rc = 1;</div>
<div class="line"><span class="lineno"> 1315</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno"> 1316</span>}</div>
<div class="ttc" id="agroup__logging__api_html_gacc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00093">logging2.h:93</a></div></div>
<div class="ttc" id="alogging2_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5"><div class="ttname"><a href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a></div><div class="ttdeci">@ LL_DEBUG1</div><div class="ttdoc">Log at debug level 1.</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00044">logging2.h:44</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_a3747adb496e21b20abbcf8d3b1db92ce"><div class="ttname"><a href="mutt_2state_8h.html#a3747adb496e21b20abbcf8d3b1db92ce">STATE_FIRSTDONE</a></div><div class="ttdeci">#define STATE_FIRSTDONE</div><div class="ttdoc">The first attachment has been done.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00040">state.h:40</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_a77951e3f170a44a6e89c2261a6cf0f75"><div class="ttname"><a href="mutt_2state_8h.html#a77951e3f170a44a6e89c2261a6cf0f75">STATE_REPLYING</a></div><div class="ttdeci">#define STATE_REPLYING</div><div class="ttdoc">Are we replying?</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00039">state.h:39</a></div></div>
<div class="ttc" id="astring2_8h_html_a7e0481bed27661ea2679f256b24e0283"><div class="ttname"><a href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a></div><div class="ttdeci">#define NONULL(x)</div><div class="ttdef"><b>Definition</b> <a href="string2_8h_source.html#l00043">string2.h:43</a></div></div>
</div><!-- fragment --><div id="dynsection-14" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gac1b8e821ab05eee2180e82f0ae4c7421_cgraph.svg" width="695" height="690"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-15" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gac1b8e821ab05eee2180e82f0ae4c7421_icgraph.svg" width="334" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="gaaef1af1685b1d85753ac8ab8c1fc9339" name="gaaef1af1685b1d85753ac8ab8c1fc9339"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaef1af1685b1d85753ac8ab8c1fc9339">&#9670;&#160;</a></span>valid_pgp_encrypted_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int valid_pgp_encrypted_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handler for valid pgp-encrypted emails - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>

<p class="definition">Definition at line <a class="el" href="handler_8c_source.html#l01472">1472</a> of file <a class="el" href="handler_8c_source.html">handler.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1473</span>{</div>
<div class="line"><span class="lineno"> 1474</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *octetstream = b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno"> 1475</span> </div>
<div class="line"><span class="lineno"> 1476</span>  <span class="comment">/* clear out any mime headers before the handler, so they can&#39;t be spoofed. */</span></div>
<div class="line"><span class="lineno"> 1477</span>  <a class="code hl_function" href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>);</div>
<div class="line"><span class="lineno"> 1478</span>  <a class="code hl_function" href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;octetstream-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>);</div>
<div class="line"><span class="lineno"> 1479</span> </div>
<div class="line"><span class="lineno"> 1480</span>  <span class="keywordtype">int</span> rc;</div>
<div class="line"><span class="lineno"> 1481</span>  <span class="comment">/* Some clients improperly encode the octetstream part. */</span></div>
<div class="line"><span class="lineno"> 1482</span>  <span class="keywordflow">if</span> (octetstream-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> != <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e">ENC_7BIT</a>)</div>
<div class="line"><span class="lineno"> 1483</span>    rc = <a class="code hl_function" href="handler_8c.html#a88df4ca81c59bfc2464df374863edfd9">run_decode_and_handler</a>(octetstream, state, <a class="code hl_function" href="#ga7b445e21874bc1e1ec681a2626df13f9">crypt_pgp_encrypted_handler</a>, 0);</div>
<div class="line"><span class="lineno"> 1484</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1485</span>    rc = <a class="code hl_function" href="#ga7b445e21874bc1e1ec681a2626df13f9">crypt_pgp_encrypted_handler</a>(octetstream, state);</div>
<div class="line"><span class="lineno"> 1486</span>  b_email-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a> |= octetstream-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a>;</div>
<div class="line"><span class="lineno"> 1487</span> </div>
<div class="line"><span class="lineno"> 1488</span>  <span class="comment">/* Relocate protected headers onto the multipart/encrypted part */</span></div>
<div class="line"><span class="lineno"> 1489</span>  <span class="keywordflow">if</span> (!rc &amp;&amp; octetstream-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>)</div>
<div class="line"><span class="lineno"> 1490</span>  {</div>
<div class="line"><span class="lineno"> 1491</span>    b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a> = octetstream-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>;</div>
<div class="line"><span class="lineno"> 1492</span>    octetstream-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a> = NULL;</div>
<div class="line"><span class="lineno"> 1493</span>  }</div>
<div class="line"><span class="lineno"> 1494</span> </div>
<div class="line"><span class="lineno"> 1495</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno"> 1496</span>}</div>
<div class="ttc" id="aenvelope_8c_html_a244dacf9b1001c9ce1dbd473e001381f"><div class="ttname"><a href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a></div><div class="ttdeci">void mutt_env_free(struct Envelope **ptr)</div><div class="ttdoc">Free an Envelope.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8c_source.html#l00126">envelope.c:126</a></div></div>
<div class="ttc" id="agroup__handler__api_html_ga7b445e21874bc1e1ec681a2626df13f9"><div class="ttname"><a href="#ga7b445e21874bc1e1ec681a2626df13f9">crypt_pgp_encrypted_handler</a></div><div class="ttdeci">int crypt_pgp_encrypted_handler(struct Body *b_email, struct State *state)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::encrypted_handler() - Implements handler_t -.</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00247">cryptglue.c:247</a></div></div>
<div class="ttc" id="ahandler_8c_html_a88df4ca81c59bfc2464df374863edfd9"><div class="ttname"><a href="handler_8c.html#a88df4ca81c59bfc2464df374863edfd9">run_decode_and_handler</a></div><div class="ttdeci">static int run_decode_and_handler(struct Body *b, struct State *state, handler_t handler, bool plaintext)</div><div class="ttdoc">Run an appropriate decoder for an email.</div><div class="ttdef"><b>Definition</b> <a href="handler_8c_source.html#l01327">handler.c:1327</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e">ENC_7BIT</a></div><div class="ttdeci">@ ENC_7BIT</div><div class="ttdoc">7-bit text</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00049">mime.h:49</a></div></div>
<div class="ttc" id="astructBody_html_a62f6c9b4245ed3b6b9296adb45aa4010"><div class="ttname"><a href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">Body::mime_headers</a></div><div class="ttdeci">struct Envelope * mime_headers</div><div class="ttdoc">Memory hole protected headers.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00076">body.h:76</a></div></div>
<div class="ttc" id="astructBody_html_ae4b2706a5c4601ae1497a96e047d8f5e"><div class="ttname"><a href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">Body::goodsig</a></div><div class="ttdeci">bool goodsig</div><div class="ttdoc">Good cryptographic signature.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00045">body.h:45</a></div></div>
</div><!-- fragment --><div id="dynsection-16" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gaaef1af1685b1d85753ac8ab8c1fc9339_cgraph.svg" width="387" height="166"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-17" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gaaef1af1685b1d85753ac8ab8c1fc9339_icgraph.svg" width="351" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="gaadf7c637f58f34e7a58ac5b2c2b0f42f" name="gaadf7c637f58f34e7a58ac5b2c2b0f42f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaadf7c637f58f34e7a58ac5b2c2b0f42f">&#9670;&#160;</a></span>malformed_pgp_encrypted_handler()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int malformed_pgp_encrypted_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handler for invalid pgp-encrypted emails - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>

<p class="definition">Definition at line <a class="el" href="handler_8c_source.html#l01501">1501</a> of file <a class="el" href="handler_8c_source.html">handler.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1502</span>{</div>
<div class="line"><span class="lineno"> 1503</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *octetstream = b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno"> 1504</span> </div>
<div class="line"><span class="lineno"> 1505</span>  <span class="comment">/* clear out any mime headers before the handler, so they can&#39;t be spoofed. */</span></div>
<div class="line"><span class="lineno"> 1506</span>  <a class="code hl_function" href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>);</div>
<div class="line"><span class="lineno"> 1507</span>  <a class="code hl_function" href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;octetstream-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>);</div>
<div class="line"><span class="lineno"> 1508</span> </div>
<div class="line"><span class="lineno"> 1509</span>  <span class="comment">/* exchange encodes the octet-stream, so re-run it through the decoder */</span></div>
<div class="line"><span class="lineno"> 1510</span>  <span class="keywordtype">int</span> rc = <a class="code hl_function" href="handler_8c.html#a88df4ca81c59bfc2464df374863edfd9">run_decode_and_handler</a>(octetstream, state, <a class="code hl_function" href="#ga7b445e21874bc1e1ec681a2626df13f9">crypt_pgp_encrypted_handler</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1511</span>  b_email-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a> |= octetstream-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a>;</div>
<div class="line"><span class="lineno"> 1512</span><span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div>
<div class="line"><span class="lineno"> 1513</span>  b_email-&gt;<a class="code hl_variable" href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">is_autocrypt</a> |= octetstream-&gt;<a class="code hl_variable" href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">is_autocrypt</a>;</div>
<div class="line"><span class="lineno"> 1514</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1515</span> </div>
<div class="line"><span class="lineno"> 1516</span>  <span class="comment">/* Relocate protected headers onto the multipart/encrypted part */</span></div>
<div class="line"><span class="lineno"> 1517</span>  <span class="keywordflow">if</span> (!rc &amp;&amp; octetstream-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>)</div>
<div class="line"><span class="lineno"> 1518</span>  {</div>
<div class="line"><span class="lineno"> 1519</span>    b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a> = octetstream-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>;</div>
<div class="line"><span class="lineno"> 1520</span>    octetstream-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a> = NULL;</div>
<div class="line"><span class="lineno"> 1521</span>  }</div>
<div class="line"><span class="lineno"> 1522</span> </div>
<div class="line"><span class="lineno"> 1523</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno"> 1524</span>}</div>
<div class="ttc" id="astructBody_html_a63e1a4c2a0bacf3d1d5869edfebed0dd"><div class="ttname"><a href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">Body::is_autocrypt</a></div><div class="ttdeci">bool is_autocrypt</div><div class="ttdoc">Flag autocrypt-decrypted messages for replying.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00050">body.h:50</a></div></div>
</div><!-- fragment --><div id="dynsection-18" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gaadf7c637f58f34e7a58ac5b2c2b0f42f_cgraph.svg" width="428" height="166"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-19" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gaadf7c637f58f34e7a58ac5b2c2b0f42f_icgraph.svg" width="392" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ga7ccf06ce10b9aed658fcc6c7a40c64b8" name="ga7ccf06ce10b9aed658fcc6c7a40c64b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7ccf06ce10b9aed658fcc6c7a40c64b8">&#9670;&#160;</a></span>mutt_protected_headers_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_protected_headers_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for protected headers - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01118">1118</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1119</span>{</div>
<div class="line"><span class="lineno"> 1120</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_protected_headers_read&quot;</span>))</div>
<div class="line"><span class="lineno"> 1121</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1122</span> </div>
<div class="line"><span class="lineno"> 1123</span>  <a class="code hl_function" href="mutt_2state_8c.html#aa5f14be3e44a3a28b094ca1f1116025b">state_mark_protected_header</a>(state);</div>
<div class="line"><span class="lineno"> 1124</span> </div>
<div class="line"><span class="lineno"> 1125</span>  <span class="keywordflow">if</span> (!b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>)</div>
<div class="line"><span class="lineno"> 1126</span>    <span class="keywordflow">goto</span> blank;</div>
<div class="line"><span class="lineno"> 1127</span> </div>
<div class="line"><span class="lineno"> 1128</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_devel_security = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;devel_security&quot;</span>);</div>
<div class="line"><span class="lineno"> 1129</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> display = (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>);</div>
<div class="line"><span class="lineno"> 1130</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_weed = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;weed&quot;</span>);</div>
<div class="line"><span class="lineno"> 1131</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_protected_headers_weed = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_protected_headers_weed&quot;</span>);</div>
<div class="line"><span class="lineno"> 1132</span>  <span class="keyword">const</span> <span class="keywordtype">short</span> c_wrap = <a class="code hl_function" href="config_2helpers_8c.html#a96039a9f8d37daad993ae7b490510339">cs_subset_number</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;wrap&quot;</span>);</div>
<div class="line"><span class="lineno"> 1133</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> wraplen = display ? <a class="code hl_function" href="mutt__window_8c.html#abab364f87c187982863f3bbed871f7e6">mutt_window_wrap_cols</a>(state-&gt;<a class="code hl_variable" href="structState.html#a2c506e7d8513e59e6162cdc5d6f9f320">wraplen</a>, c_wrap) : 0;</div>
<div class="line"><span class="lineno"> 1134</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a> chflags = display ? <a class="code hl_define" href="copy_8h.html#a78788518de9fe57639d22d204a686383">CH_DISPLAY</a> : <a class="code hl_define" href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno"> 1135</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *buf = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno"> 1136</span>  <span class="keywordtype">bool</span> weed = (display &amp;&amp; c_weed &amp;&amp; c_crypt_protected_headers_weed);</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>  <span class="keywordflow">if</span> (c_devel_security)</div>
<div class="line"><span class="lineno"> 1139</span>  {</div>
<div class="line"><span class="lineno"> 1140</span>    <span class="keywordflow">if</span> (b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#adb752a72d48a701571b3c1784bc4b59b">date</a> &amp;&amp; (!display || !c_weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;date&quot;</span>)))</div>
<div class="line"><span class="lineno"> 1141</span>    {</div>
<div class="line"><span class="lineno"> 1142</span>      <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;Date&quot;</span>, b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#adb752a72d48a701571b3c1784bc4b59b">date</a>,</div>
<div class="line"><span class="lineno"> 1143</span>                            state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>, wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1144</span>    }</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span>    <span class="keywordflow">if</span> (!weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;return-path&quot;</span>))</div>
<div class="line"><span class="lineno"> 1147</span>    {</div>
<div class="line"><span class="lineno"> 1148</span>      <a class="code hl_function" href="address_2address_8c.html#a8143574988507c4f906548a2e88166d5">mutt_addrlist_write</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a1c204b091d782098fc1efa0c2f3b1e20">return_path</a>, buf, display);</div>
<div class="line"><span class="lineno"> 1149</span>      <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;Return-Path&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf),</div>
<div class="line"><span class="lineno"> 1150</span>                            state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>, wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1151</span>    }</div>
<div class="line"><span class="lineno"> 1152</span>    <span class="keywordflow">if</span> (!weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;from&quot;</span>))</div>
<div class="line"><span class="lineno"> 1153</span>    {</div>
<div class="line"><span class="lineno"> 1154</span>      <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(buf);</div>
<div class="line"><span class="lineno"> 1155</span>      <a class="code hl_function" href="address_2address_8c.html#a8143574988507c4f906548a2e88166d5">mutt_addrlist_write</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, buf, display);</div>
<div class="line"><span class="lineno"> 1156</span>      <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;From&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf),</div>
<div class="line"><span class="lineno"> 1157</span>                            state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>, wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1158</span>    }</div>
<div class="line"><span class="lineno"> 1159</span>    <span class="keywordflow">if</span> (!weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;to&quot;</span>))</div>
<div class="line"><span class="lineno"> 1160</span>    {</div>
<div class="line"><span class="lineno"> 1161</span>      <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(buf);</div>
<div class="line"><span class="lineno"> 1162</span>      <a class="code hl_function" href="address_2address_8c.html#a8143574988507c4f906548a2e88166d5">mutt_addrlist_write</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, buf, display);</div>
<div class="line"><span class="lineno"> 1163</span>      <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;To&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf), state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>,</div>
<div class="line"><span class="lineno"> 1164</span>                            wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1165</span>    }</div>
<div class="line"><span class="lineno"> 1166</span>    <span class="keywordflow">if</span> (!weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;cc&quot;</span>))</div>
<div class="line"><span class="lineno"> 1167</span>    {</div>
<div class="line"><span class="lineno"> 1168</span>      <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(buf);</div>
<div class="line"><span class="lineno"> 1169</span>      <a class="code hl_function" href="address_2address_8c.html#a8143574988507c4f906548a2e88166d5">mutt_addrlist_write</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, buf, display);</div>
<div class="line"><span class="lineno"> 1170</span>      <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;Cc&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf), state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>,</div>
<div class="line"><span class="lineno"> 1171</span>                            wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1172</span>    }</div>
<div class="line"><span class="lineno"> 1173</span>    <span class="keywordflow">if</span> (!weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;sender&quot;</span>))</div>
<div class="line"><span class="lineno"> 1174</span>    {</div>
<div class="line"><span class="lineno"> 1175</span>      <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(buf);</div>
<div class="line"><span class="lineno"> 1176</span>      <a class="code hl_function" href="address_2address_8c.html#a8143574988507c4f906548a2e88166d5">mutt_addrlist_write</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>, buf, display);</div>
<div class="line"><span class="lineno"> 1177</span>      <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;Sender&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf),</div>
<div class="line"><span class="lineno"> 1178</span>                            state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>, wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1179</span>    }</div>
<div class="line"><span class="lineno"> 1180</span>    <span class="keywordflow">if</span> (!weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;reply-to&quot;</span>))</div>
<div class="line"><span class="lineno"> 1181</span>    {</div>
<div class="line"><span class="lineno"> 1182</span>      <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(buf);</div>
<div class="line"><span class="lineno"> 1183</span>      <a class="code hl_function" href="address_2address_8c.html#a8143574988507c4f906548a2e88166d5">mutt_addrlist_write</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>, buf, display);</div>
<div class="line"><span class="lineno"> 1184</span>      <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;Reply-To&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf),</div>
<div class="line"><span class="lineno"> 1185</span>                            state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>, wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1186</span>    }</div>
<div class="line"><span class="lineno"> 1187</span>    <span class="keywordflow">if</span> (!weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;mail-followup-to&quot;</span>))</div>
<div class="line"><span class="lineno"> 1188</span>    {</div>
<div class="line"><span class="lineno"> 1189</span>      <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(buf);</div>
<div class="line"><span class="lineno"> 1190</span>      <a class="code hl_function" href="address_2address_8c.html#a8143574988507c4f906548a2e88166d5">mutt_addrlist_write</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>, buf, display);</div>
<div class="line"><span class="lineno"> 1191</span>      <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;Mail-Followup-To&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf),</div>
<div class="line"><span class="lineno"> 1192</span>                            state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>, wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1193</span>    }</div>
<div class="line"><span class="lineno"> 1194</span>    <span class="keywordflow">if</span> (!weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;x-original-to&quot;</span>))</div>
<div class="line"><span class="lineno"> 1195</span>    {</div>
<div class="line"><span class="lineno"> 1196</span>      <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(buf);</div>
<div class="line"><span class="lineno"> 1197</span>      <a class="code hl_function" href="address_2address_8c.html#a8143574988507c4f906548a2e88166d5">mutt_addrlist_write</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">x_original_to</a>, buf, display);</div>
<div class="line"><span class="lineno"> 1198</span>      <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;X-Original-To&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf),</div>
<div class="line"><span class="lineno"> 1199</span>                            state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>, wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1200</span>    }</div>
<div class="line"><span class="lineno"> 1201</span>  }</div>
<div class="line"><span class="lineno"> 1202</span> </div>
<div class="line"><span class="lineno"> 1203</span>  <span class="keywordflow">if</span> (b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">subject</a> &amp;&amp; (!weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;subject&quot;</span>)))</div>
<div class="line"><span class="lineno"> 1204</span>  {</div>
<div class="line"><span class="lineno"> 1205</span>    <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;Subject&quot;</span>, b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">subject</a>,</div>
<div class="line"><span class="lineno"> 1206</span>                          state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>, wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1207</span>  }</div>
<div class="line"><span class="lineno"> 1208</span> </div>
<div class="line"><span class="lineno"> 1209</span>  <span class="keywordflow">if</span> (c_devel_security)</div>
<div class="line"><span class="lineno"> 1210</span>  {</div>
<div class="line"><span class="lineno"> 1211</span>    <span class="keywordflow">if</span> (b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a> &amp;&amp; (!weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;message-id&quot;</span>)))</div>
<div class="line"><span class="lineno"> 1212</span>    {</div>
<div class="line"><span class="lineno"> 1213</span>      <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;Message-ID&quot;</span>, b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a>,</div>
<div class="line"><span class="lineno"> 1214</span>                            state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>, wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1215</span>    }</div>
<div class="line"><span class="lineno"> 1216</span>    <span class="keywordflow">if</span> (!weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;references&quot;</span>))</div>
<div class="line"><span class="lineno"> 1217</span>    {</div>
<div class="line"><span class="lineno"> 1218</span>      <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(buf);</div>
<div class="line"><span class="lineno"> 1219</span>      <a class="code hl_function" href="list_8c.html#a5f04ca102be20813d8c3ab0776a2786b">mutt_list_write</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>, buf);</div>
<div class="line"><span class="lineno"> 1220</span>      <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;References&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf),</div>
<div class="line"><span class="lineno"> 1221</span>                            state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>, wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1222</span>    }</div>
<div class="line"><span class="lineno"> 1223</span>    <span class="keywordflow">if</span> (!weed || !<a class="code hl_function" href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a>(<span class="stringliteral">&quot;in-reply-to&quot;</span>))</div>
<div class="line"><span class="lineno"> 1224</span>    {</div>
<div class="line"><span class="lineno"> 1225</span>      <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(buf);</div>
<div class="line"><span class="lineno"> 1226</span>      <a class="code hl_function" href="list_8c.html#a5f04ca102be20813d8c3ab0776a2786b">mutt_list_write</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">in_reply_to</a>, buf);</div>
<div class="line"><span class="lineno"> 1227</span>      <a class="code hl_function" href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a>(state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, <span class="stringliteral">&quot;In-Reply-To&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf),</div>
<div class="line"><span class="lineno"> 1228</span>                            state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>, wraplen, chflags, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno"> 1229</span>    }</div>
<div class="line"><span class="lineno"> 1230</span>  }</div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;buf);</div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span>blank:</div>
<div class="line"><span class="lineno"> 1235</span>  <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1236</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1237</span>}</div>
<div class="ttc" id="aaddress_2address_8c_html_a8143574988507c4f906548a2e88166d5"><div class="ttname"><a href="address_2address_8c.html#a8143574988507c4f906548a2e88166d5">mutt_addrlist_write</a></div><div class="ttdeci">size_t mutt_addrlist_write(const struct AddressList *al, struct Buffer *buf, bool display)</div><div class="ttdoc">Write an Address to a buffer.</div><div class="ttdef"><b>Definition</b> <a href="address_2address_8c_source.html#l01206">address.c:1206</a></div></div>
<div class="ttc" id="abuffer_8c_html_a3b1f80652b37dc26046f9acdd85a0b05"><div class="ttname"><a href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a></div><div class="ttdeci">void buf_reset(struct Buffer *buf)</div><div class="ttdoc">Reset an existing Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00076">buffer.c:76</a></div></div>
<div class="ttc" id="aconfig_2helpers_8c_html_a96039a9f8d37daad993ae7b490510339"><div class="ttname"><a href="config_2helpers_8c.html#a96039a9f8d37daad993ae7b490510339">cs_subset_number</a></div><div class="ttdeci">short cs_subset_number(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a number config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00143">helpers.c:143</a></div></div>
<div class="ttc" id="acopy_8h_html_af310a44d7c96b22de90934cb18634b58"><div class="ttname"><a href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a></div><div class="ttdeci">#define CH_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00053">copy.h:53</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a5f2728949322a1a6210d61d9629005d1"><div class="ttname"><a href="email_2parse_8c.html#a5f2728949322a1a6210d61d9629005d1">mutt_matches_ignore</a></div><div class="ttdeci">bool mutt_matches_ignore(const char *s)</div><div class="ttdoc">Does the string match the ignore list.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l00355">parse.c:355</a></div></div>
<div class="ttc" id="aheader_8c_html_acb110e1fda6d0ddb3cdf8074ba439441"><div class="ttname"><a href="header_8c.html#acb110e1fda6d0ddb3cdf8074ba439441">mutt_write_one_header</a></div><div class="ttdeci">int mutt_write_one_header(FILE *fp, const char *tag, const char *value, const char *pfx, int wraplen, CopyHeaderFlags chflags, struct ConfigSubset *sub)</div><div class="ttdoc">Write one header line to a file.</div><div class="ttdef"><b>Definition</b> <a href="header_8c_source.html#l00423">header.c:423</a></div></div>
<div class="ttc" id="alist_8c_html_a5f04ca102be20813d8c3ab0776a2786b"><div class="ttname"><a href="list_8c.html#a5f04ca102be20813d8c3ab0776a2786b">mutt_list_write</a></div><div class="ttdeci">size_t mutt_list_write(const struct ListHead *h, struct Buffer *buf)</div><div class="ttdoc">Write a list to a buffer.</div><div class="ttdef"><b>Definition</b> <a href="list_8c_source.html#l00293">list.c:293</a></div></div>
<div class="ttc" id="amutt_2state_8c_html_aa5f14be3e44a3a28b094ca1f1116025b"><div class="ttname"><a href="mutt_2state_8c.html#aa5f14be3e44a3a28b094ca1f1116025b">state_mark_protected_header</a></div><div class="ttdeci">void state_mark_protected_header(struct State *state)</div><div class="ttdoc">Write a unique marker around protected headers.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8c_source.html#l00088">state.c:88</a></div></div>
<div class="ttc" id="amutt__window_8c_html_abab364f87c187982863f3bbed871f7e6"><div class="ttname"><a href="mutt__window_8c.html#abab364f87c187982863f3bbed871f7e6">mutt_window_wrap_cols</a></div><div class="ttdeci">int mutt_window_wrap_cols(int width, short wrap)</div><div class="ttdoc">Calculate the wrap column for a given screen width.</div><div class="ttdef"><b>Definition</b> <a href="mutt__window_8c_source.html#l00337">mutt_window.c:337</a></div></div>
<div class="ttc" id="astructEnvelope_html_a1c204b091d782098fc1efa0c2f3b1e20"><div class="ttname"><a href="structEnvelope.html#a1c204b091d782098fc1efa0c2f3b1e20">Envelope::return_path</a></div><div class="ttdeci">struct AddressList return_path</div><div class="ttdoc">Return path for the Email.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00058">envelope.h:58</a></div></div>
<div class="ttc" id="astructEnvelope_html_a20d5ccf675db375e011a7791151fa09d"><div class="ttname"><a href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">Envelope::subject</a></div><div class="ttdeci">char *const subject</div><div class="ttdoc">Email&#39;s subject.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00070">envelope.h:70</a></div></div>
<div class="ttc" id="astructEnvelope_html_a2d927371b3b80e025d6f7522b7361fe7"><div class="ttname"><a href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">Envelope::to</a></div><div class="ttdeci">struct AddressList to</div><div class="ttdoc">Email&#39;s &#39;To&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00060">envelope.h:60</a></div></div>
<div class="ttc" id="astructEnvelope_html_a4b75ab1853f95878dec079371bb0d799"><div class="ttname"><a href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">Envelope::reply_to</a></div><div class="ttdeci">struct AddressList reply_to</div><div class="ttdoc">Email&#39;s &#39;reply-to&#39;.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00064">envelope.h:64</a></div></div>
<div class="ttc" id="astructEnvelope_html_a50418c13a849bf27b22922bd5867e5e1"><div class="ttname"><a href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">Envelope::message_id</a></div><div class="ttdeci">char * message_id</div><div class="ttdoc">Message ID.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00073">envelope.h:73</a></div></div>
<div class="ttc" id="astructEnvelope_html_a525bd5213606067d5c2be2e17fbe956b"><div class="ttname"><a href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">Envelope::x_original_to</a></div><div class="ttdeci">struct AddressList x_original_to</div><div class="ttdoc">Email&#39;s &#39;X-Original-to&#39;.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00066">envelope.h:66</a></div></div>
<div class="ttc" id="astructEnvelope_html_a6044b60220b8029a6a505e5b61f1cadc"><div class="ttname"><a href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">Envelope::mail_followup_to</a></div><div class="ttdeci">struct AddressList mail_followup_to</div><div class="ttdoc">Email&#39;s &#39;mail-followup-to&#39;.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00065">envelope.h:65</a></div></div>
<div class="ttc" id="astructEnvelope_html_a6b00837b3cb4b41898b42307135be8b6"><div class="ttname"><a href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">Envelope::cc</a></div><div class="ttdeci">struct AddressList cc</div><div class="ttdoc">Email&#39;s &#39;Cc&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00061">envelope.h:61</a></div></div>
<div class="ttc" id="astructEnvelope_html_a72ee5c0af4f94f83aeb8d31183261611"><div class="ttname"><a href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">Envelope::sender</a></div><div class="ttdeci">struct AddressList sender</div><div class="ttdoc">Email&#39;s sender.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00063">envelope.h:63</a></div></div>
<div class="ttc" id="astructEnvelope_html_a832eec73356a806761e26f0bc40d9083"><div class="ttname"><a href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">Envelope::references</a></div><div class="ttdeci">struct ListHead references</div><div class="ttdoc">message references (in reverse order)</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00083">envelope.h:83</a></div></div>
<div class="ttc" id="astructEnvelope_html_a9ae6d450b2f012c37d3350f4305fbb90"><div class="ttname"><a href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">Envelope::in_reply_to</a></div><div class="ttdeci">struct ListHead in_reply_to</div><div class="ttdoc">in-reply-to header content</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00084">envelope.h:84</a></div></div>
<div class="ttc" id="astructEnvelope_html_adb752a72d48a701571b3c1784bc4b59b"><div class="ttname"><a href="structEnvelope.html#adb752a72d48a701571b3c1784bc4b59b">Envelope::date</a></div><div class="ttdeci">char * date</div><div class="ttdoc">Sent date.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00075">envelope.h:75</a></div></div>
<div class="ttc" id="astructEnvelope_html_af1aa00aed4b8767cf98f08e45a432ad8"><div class="ttname"><a href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">Envelope::from</a></div><div class="ttdeci">struct AddressList from</div><div class="ttdoc">Email&#39;s &#39;From&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00059">envelope.h:59</a></div></div>
</div><!-- fragment --><div id="dynsection-20" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga7ccf06ce10b9aed658fcc6c7a40c64b8_cgraph.svg" width="590" height="662"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-21" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga7ccf06ce10b9aed658fcc6c7a40c64b8_icgraph.svg" width="419" height="312"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="gad8f7563b8c9aba96de145d0e17e58437" name="gad8f7563b8c9aba96de145d0e17e58437"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad8f7563b8c9aba96de145d0e17e58437">&#9670;&#160;</a></span>mutt_signed_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_signed_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for "multipart/signed" - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01242">1242</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1243</span>{</div>
<div class="line"><span class="lineno"> 1244</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno"> 1245</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1246</span> </div>
<div class="line"><span class="lineno"> 1247</span>  <span class="keywordtype">bool</span> inconsistent = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1248</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *top = b_email;</div>
<div class="line"><span class="lineno"> 1249</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> **signatures = NULL;</div>
<div class="line"><span class="lineno"> 1250</span>  <span class="keywordtype">int</span> sigcnt = 0;</div>
<div class="line"><span class="lineno"> 1251</span>  <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><span class="lineno"> 1252</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *tempfile = NULL;</div>
<div class="line"><span class="lineno"> 1253</span> </div>
<div class="line"><span class="lineno"> 1254</span>  b_email = b_email-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno"> 1255</span>  <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> signed_type = <a class="code hl_function" href="crypt_8c.html#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a>(top);</div>
<div class="line"><span class="lineno"> 1256</span>  <span class="keywordflow">if</span> (signed_type == <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>)</div>
<div class="line"><span class="lineno"> 1257</span>  {</div>
<div class="line"><span class="lineno"> 1258</span>    <span class="comment">/* A null protocol value is already checked for in mutt_body_handler() */</span></div>
<div class="line"><span class="lineno"> 1259</span>    <a class="code hl_function" href="mutt_2state_8c.html#a7566d1f9e015cd673fd8744bf5ad2f06">state_printf</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Error: Unknown multipart/signed protocol %s --]\n\n&quot;</span>),</div>
<div class="line"><span class="lineno"> 1260</span>                 <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;top-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protocol&quot;</span>));</div>
<div class="line"><span class="lineno"> 1261</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a>(b_email, state);</div>
<div class="line"><span class="lineno"> 1262</span>  }</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>  <span class="keywordflow">if</span> (!(b_email &amp;&amp; b_email-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>))</div>
<div class="line"><span class="lineno"> 1265</span>  {</div>
<div class="line"><span class="lineno"> 1266</span>    inconsistent = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1267</span>  }</div>
<div class="line"><span class="lineno"> 1268</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1269</span>  {</div>
<div class="line"><span class="lineno"> 1270</span>    <span class="keywordflow">switch</span> (signed_type)</div>
<div class="line"><span class="lineno"> 1271</span>    {</div>
<div class="line"><span class="lineno"> 1272</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>:</div>
<div class="line"><span class="lineno"> 1273</span>        <span class="keywordflow">if</span> ((b_email-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) ||</div>
<div class="line"><span class="lineno"> 1274</span>            !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b_email-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;mixed&quot;</span>))</div>
<div class="line"><span class="lineno"> 1275</span>        {</div>
<div class="line"><span class="lineno"> 1276</span>          inconsistent = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1277</span>        }</div>
<div class="line"><span class="lineno"> 1278</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1279</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>:</div>
<div class="line"><span class="lineno"> 1280</span>        <span class="keywordflow">if</span> ((b_email-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) ||</div>
<div class="line"><span class="lineno"> 1281</span>            !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b_email-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-signature&quot;</span>))</div>
<div class="line"><span class="lineno"> 1282</span>        {</div>
<div class="line"><span class="lineno"> 1283</span>          inconsistent = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1284</span>        }</div>
<div class="line"><span class="lineno"> 1285</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1286</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a>:</div>
<div class="line"><span class="lineno"> 1287</span>        <span class="keywordflow">if</span> ((b_email-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) ||</div>
<div class="line"><span class="lineno"> 1288</span>            (!<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b_email-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;x-pkcs7-signature&quot;</span>) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1289</span>             !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b_email-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pkcs7-signature&quot;</span>)))</div>
<div class="line"><span class="lineno"> 1290</span>        {</div>
<div class="line"><span class="lineno"> 1291</span>          inconsistent = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1292</span>        }</div>
<div class="line"><span class="lineno"> 1293</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1294</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1295</span>        inconsistent = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1296</span>    }</div>
<div class="line"><span class="lineno"> 1297</span>  }</div>
<div class="line"><span class="lineno"> 1298</span>  <span class="keywordflow">if</span> (inconsistent)</div>
<div class="line"><span class="lineno"> 1299</span>  {</div>
<div class="line"><span class="lineno"> 1300</span>    <a class="code hl_function" href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Error: Missing or bad-format multipart/signed signature --]\n\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1301</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a>(b_email, state);</div>
<div class="line"><span class="lineno"> 1302</span>  }</div>
<div class="line"><span class="lineno"> 1303</span> </div>
<div class="line"><span class="lineno"> 1304</span>  <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno"> 1305</span>  {</div>
<div class="line"><span class="lineno"> 1306</span>    <a class="code hl_function" href="crypt_8c.html#a125731bc0d4f94974c4ccba4a6146c23">crypt_fetch_signatures</a>(&amp;signatures, b_email-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>, &amp;sigcnt);</div>
<div class="line"><span class="lineno"> 1307</span> </div>
<div class="line"><span class="lineno"> 1308</span>    <span class="keywordflow">if</span> (sigcnt != 0)</div>
<div class="line"><span class="lineno"> 1309</span>    {</div>
<div class="line"><span class="lineno"> 1310</span>      tempfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno"> 1311</span>      <a class="code hl_define" href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a>(tempfile);</div>
<div class="line"><span class="lineno"> 1312</span>      <span class="keywordtype">bool</span> goodsig = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1313</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="crypt_8c.html#ab3dde2a67c95a70df3d498215427863b">crypt_write_signed</a>(b_email, state, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile)) == 0)</div>
<div class="line"><span class="lineno"> 1314</span>      {</div>
<div class="line"><span class="lineno"> 1315</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; sigcnt; i++)</div>
<div class="line"><span class="lineno"> 1316</span>        {</div>
<div class="line"><span class="lineno"> 1317</span>          <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1318</span>              (signatures[i]-&gt;type == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1319</span>              <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(signatures[i]-&gt;subtype, <span class="stringliteral">&quot;pgp-signature&quot;</span>))</div>
<div class="line"><span class="lineno"> 1320</span>          {</div>
<div class="line"><span class="lineno"> 1321</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="cryptglue_8c.html#ad4a89b47b43715de8ee481c21cbb8df1">crypt_pgp_verify_one</a>(signatures[i], state, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile)) != 0)</div>
<div class="line"><span class="lineno"> 1322</span>              goodsig = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1325</span>          }</div>
<div class="line"><span class="lineno"> 1326</span> </div>
<div class="line"><span class="lineno"> 1327</span>          <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1328</span>              (signatures[i]-&gt;type == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1329</span>              (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(signatures[i]-&gt;subtype, <span class="stringliteral">&quot;x-pkcs7-signature&quot;</span>) ||</div>
<div class="line"><span class="lineno"> 1330</span>               <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(signatures[i]-&gt;subtype, <span class="stringliteral">&quot;pkcs7-signature&quot;</span>)))</div>
<div class="line"><span class="lineno"> 1331</span>          {</div>
<div class="line"><span class="lineno"> 1332</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="cryptglue_8c.html#aade609beeedeadec75f1c15cfa4b1e61">crypt_smime_verify_one</a>(signatures[i], state, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile)) != 0)</div>
<div class="line"><span class="lineno"> 1333</span>              goodsig = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1334</span> </div>
<div class="line"><span class="lineno"> 1335</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1336</span>          }</div>
<div class="line"><span class="lineno"> 1337</span> </div>
<div class="line"><span class="lineno"> 1338</span>          <a class="code hl_function" href="mutt_2state_8c.html#a7566d1f9e015cd673fd8744bf5ad2f06">state_printf</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Warning: We can&#39;t verify %s/%s signatures --]\n\n&quot;</span>),</div>
<div class="line"><span class="lineno"> 1339</span>                       <a class="code hl_define" href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a>(signatures[i]), signatures[i]-&gt;subtype);</div>
<div class="line"><span class="lineno"> 1340</span>        }</div>
<div class="line"><span class="lineno"> 1341</span>      }</div>
<div class="line"><span class="lineno"> 1342</span> </div>
<div class="line"><span class="lineno"> 1343</span>      <a class="code hl_function" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno"> 1344</span>      <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;tempfile);</div>
<div class="line"><span class="lineno"> 1345</span> </div>
<div class="line"><span class="lineno"> 1346</span>      top-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a> = goodsig;</div>
<div class="line"><span class="lineno"> 1347</span>      top-&gt;<a class="code hl_variable" href="structBody.html#a4de063a5f09cb7376f9fde6bb0fe48bc">badsig</a> = !goodsig;</div>
<div class="line"><span class="lineno"> 1348</span> </div>
<div class="line"><span class="lineno"> 1349</span>      <span class="comment">/* Now display the signed body */</span></div>
<div class="line"><span class="lineno"> 1350</span>      <a class="code hl_function" href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- The following data is signed --]\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1351</span> </div>
<div class="line"><span class="lineno"> 1352</span>      <a class="code hl_function" href="#ga7ccf06ce10b9aed658fcc6c7a40c64b8">mutt_protected_headers_handler</a>(b_email, state);</div>
<div class="line"><span class="lineno"> 1353</span> </div>
<div class="line"><span class="lineno"> 1354</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;signatures);</div>
<div class="line"><span class="lineno"> 1355</span>    }</div>
<div class="line"><span class="lineno"> 1356</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1357</span>    {</div>
<div class="line"><span class="lineno"> 1358</span>      <a class="code hl_function" href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Warning: Can&#39;t find any signatures --]\n\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1359</span>    }</div>
<div class="line"><span class="lineno"> 1360</span>  }</div>
<div class="line"><span class="lineno"> 1361</span> </div>
<div class="line"><span class="lineno"> 1362</span>  rc = <a class="code hl_function" href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a>(b_email, state);</div>
<div class="line"><span class="lineno"> 1363</span> </div>
<div class="line"><span class="lineno"> 1364</span>  <span class="keywordflow">if</span> ((state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>) &amp;&amp; (sigcnt != 0))</div>
<div class="line"><span class="lineno"> 1365</span>    <a class="code hl_function" href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- End of signed data --]\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1366</span> </div>
<div class="line"><span class="lineno"> 1367</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno"> 1368</span>}</div>
<div class="ttc" id="acrypt_8c_html_a125731bc0d4f94974c4ccba4a6146c23"><div class="ttname"><a href="crypt_8c.html#a125731bc0d4f94974c4ccba4a6146c23">crypt_fetch_signatures</a></div><div class="ttdeci">static void crypt_fetch_signatures(struct Body ***b_sigs, struct Body *b, int *n)</div><div class="ttdoc">Create an array of an emails parts.</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l01075">crypt.c:1075</a></div></div>
<div class="ttc" id="acrypt_8c_html_a345fb1ff241b3fc778632947c2b08d37"><div class="ttname"><a href="crypt_8c.html#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a></div><div class="ttdeci">SecurityFlags mutt_is_multipart_signed(struct Body *b)</div><div class="ttdoc">Is a message signed?</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l00409">crypt.c:409</a></div></div>
<div class="ttc" id="acrypt_8c_html_ab3dde2a67c95a70df3d498215427863b"><div class="ttname"><a href="crypt_8c.html#ab3dde2a67c95a70df3d498215427863b">crypt_write_signed</a></div><div class="ttdeci">int crypt_write_signed(struct Body *b, struct State *state, const char *tempfile)</div><div class="ttdoc">Write the message body/part.</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l00760">crypt.c:760</a></div></div>
<div class="ttc" id="acryptglue_8c_html_aade609beeedeadec75f1c15cfa4b1e61"><div class="ttname"><a href="cryptglue_8c.html#aade609beeedeadec75f1c15cfa4b1e61">crypt_smime_verify_one</a></div><div class="ttdeci">int crypt_smime_verify_one(struct Body *b, struct State *state, const char *tempf)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::verify_one()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00516">cryptglue.c:516</a></div></div>
<div class="ttc" id="acryptglue_8c_html_ad4a89b47b43715de8ee481c21cbb8df1"><div class="ttname"><a href="cryptglue_8c.html#ad4a89b47b43715de8ee481c21cbb8df1">crypt_pgp_verify_one</a></div><div class="ttdeci">int crypt_pgp_verify_one(struct Body *b, struct State *state, const char *tempf)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::verify_one()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00372">cryptglue.c:372</a></div></div>
<div class="ttc" id="agroup__handler__api_html_ga7ccf06ce10b9aed658fcc6c7a40c64b8"><div class="ttname"><a href="#ga7ccf06ce10b9aed658fcc6c7a40c64b8">mutt_protected_headers_handler</a></div><div class="ttdeci">int mutt_protected_headers_handler(struct Body *b_email, struct State *state)</div><div class="ttdoc">Handler for protected headers - Implements handler_t -.</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l01118">crypt.c:1118</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a></div><div class="ttdeci">@ TYPE_MULTIPART</div><div class="ttdoc">Type: &#39;multipart/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00037">mime.h:37</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdeci">@ TYPE_APPLICATION</div><div class="ttdoc">Type: &#39;application/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a14f75a650c49341776276f44881d54b2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a></div><div class="ttdeci">#define PGP_SIGN</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00103">lib.h:103</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a2073a168ca3a64c3c30d13fa4917a05d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></div><div class="ttdeci">uint16_t SecurityFlags</div><div class="ttdoc">Flags, e.g. SEC_ENCRYPT.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00082">lib.h:82</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00096">lib.h:96</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a67114d960e61fc36c467f4bf08d37335"><div class="ttname"><a href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a></div><div class="ttdeci">#define SMIME_SIGN</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00109">lib.h:109</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00097">lib.h:97</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00083">lib.h:83</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00122">lib.h:122</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_ae12c003463c99d28f65f1d6b8b053b2c"><div class="ttname"><a href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a></div><div class="ttdeci">#define SEC_SIGN</div><div class="ttdoc">Email is signed.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00085">lib.h:85</a></div></div>
<div class="ttc" id="astructBody_html_a4de063a5f09cb7376f9fde6bb0fe48bc"><div class="ttname"><a href="structBody.html#a4de063a5f09cb7376f9fde6bb0fe48bc">Body::badsig</a></div><div class="ttdeci">bool badsig</div><div class="ttdoc">Bad cryptographic signature (needed to check encrypted s/mime-signatures)</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00043">body.h:43</a></div></div>
<div class="ttc" id="atmp_8h_html_a271a7828888985955df49205d7846a45"><div class="ttname"><a href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a></div><div class="ttdeci">#define buf_mktemp(buf)</div><div class="ttdef"><b>Definition</b> <a href="tmp_8h_source.html#l00033">tmp.h:33</a></div></div>
</div><!-- fragment --><div id="dynsection-22" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gad8f7563b8c9aba96de145d0e17e58437_cgraph.svg" width="727" height="783"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-23" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gad8f7563b8c9aba96de145d0e17e58437_icgraph.svg" width="354" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ga2de61c155f3d4ff8b010e2e4f615ea94" name="ga2de61c155f3d4ff8b010e2e4f615ea94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2de61c155f3d4ff8b010e2e4f615ea94">&#9670;&#160;</a></span>crypt_pgp_application_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_pgp_application_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a9d7b47fb748a7cdb4975f2dde8179a98">CryptModuleSpecs::application_handler()</a> - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00236">236</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  237</span>{</div>
<div class="line"><span class="lineno">  238</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, application_handler))</div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, application_handler)(b_email, state);</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  242</span>}</div>
<div class="ttc" id="acryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00079">cryptglue.c:79</a></div></div>
<div class="ttc" id="acryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00085">cryptglue.c:85</a></div></div>
</div><!-- fragment --><div id="dynsection-24" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga2de61c155f3d4ff8b010e2e4f615ea94_icgraph.svg" width="356" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ga7b445e21874bc1e1ec681a2626df13f9" name="ga7b445e21874bc1e1ec681a2626df13f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7b445e21874bc1e1ec681a2626df13f9">&#9670;&#160;</a></span>crypt_pgp_encrypted_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_pgp_encrypted_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a0a6f227729bf45fc362bc0896a241de2">CryptModuleSpecs::encrypted_handler()</a> - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00247">247</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  248</span>{</div>
<div class="line"><span class="lineno">  249</span><span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div>
<div class="line"><span class="lineno">  250</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_autocrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;autocrypt&quot;</span>);</div>
<div class="line"><span class="lineno">  251</span>  <span class="keywordflow">if</span> (c_autocrypt)</div>
<div class="line"><span class="lineno">  252</span>  {</div>
<div class="line"><span class="lineno">  253</span>    <a class="code hl_variable" href="globals_8c.html#a1137c8074e2a6ff941529fc8e64fbca5">OptAutocryptGpgme</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordtype">int</span> result = <a class="code hl_function" href="group__crypto__encrypted__handler.html#ga977d571785aa92dcb76ce1d84491fca8">pgp_gpgme_encrypted_handler</a>(b_email, state);</div>
<div class="line"><span class="lineno">  255</span>    <a class="code hl_variable" href="globals_8c.html#a1137c8074e2a6ff941529fc8e64fbca5">OptAutocryptGpgme</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordflow">if</span> (result == 0)</div>
<div class="line"><span class="lineno">  257</span>    {</div>
<div class="line"><span class="lineno">  258</span>      b_email-&gt;<a class="code hl_variable" href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">is_autocrypt</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  259</span>      <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  260</span>    }</div>
<div class="line"><span class="lineno">  261</span>  }</div>
<div class="line"><span class="lineno">  262</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, encrypted_handler))</div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, encrypted_handler)(b_email, state);</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  268</span>}</div>
<div class="ttc" id="aglobals_8c_html_a1137c8074e2a6ff941529fc8e64fbca5"><div class="ttname"><a href="globals_8c.html#a1137c8074e2a6ff941529fc8e64fbca5">OptAutocryptGpgme</a></div><div class="ttdeci">bool OptAutocryptGpgme</div><div class="ttdoc">(pseudo) use Autocrypt context inside ncrypt/crypt_gpgme.c</div><div class="ttdef"><b>Definition</b> <a href="globals_8c_source.html#l00055">globals.c:55</a></div></div>
<div class="ttc" id="agroup__crypto__encrypted__handler_html_ga977d571785aa92dcb76ce1d84491fca8"><div class="ttname"><a href="group__crypto__encrypted__handler.html#ga977d571785aa92dcb76ce1d84491fca8">pgp_gpgme_encrypted_handler</a></div><div class="ttdeci">int pgp_gpgme_encrypted_handler(struct Body *b, struct State *state)</div><div class="ttdoc">Manage a PGP or S/MIME encrypted MIME part - Implements CryptModuleSpecs::encrypted_handler() -.</div><div class="ttdef"><b>Definition</b> <a href="crypt__gpgme_8c_source.html#l02764">crypt_gpgme.c:2764</a></div></div>
</div><!-- fragment --><div id="dynsection-25" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga7b445e21874bc1e1ec681a2626df13f9_cgraph.svg" width="378" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-26" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga7b445e21874bc1e1ec681a2626df13f9_icgraph.svg" width="403" height="134"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ga570796cc91abc82fbc16bcd285137688" name="ga570796cc91abc82fbc16bcd285137688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga570796cc91abc82fbc16bcd285137688">&#9670;&#160;</a></span>crypt_smime_application_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_smime_application_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a9d7b47fb748a7cdb4975f2dde8179a98">CryptModuleSpecs::application_handler()</a> - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00443">443</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  444</span>{</div>
<div class="line"><span class="lineno">  445</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, application_handler))</div>
<div class="line"><span class="lineno">  446</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, application_handler)(b_email, state);</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  449</span>}</div>
</div><!-- fragment --><div id="dynsection-27" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_ga570796cc91abc82fbc16bcd285137688_icgraph.svg" width="374" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="gaadbb7eb9de333071b51c4ff88b45315b" name="gaadbb7eb9de333071b51c4ff88b45315b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaadbb7eb9de333071b51c4ff88b45315b">&#9670;&#160;</a></span>rfc3676_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rfc3676_handler </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b_email</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handler for format=flowed - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Always </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rfc3676_8c_source.html#l00323">323</a> of file <a class="el" href="rfc3676_8c_source.html">rfc3676.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  324</span>{</div>
<div class="line"><span class="lineno">  325</span>  <span class="keywordtype">char</span> *buf = NULL;</div>
<div class="line"><span class="lineno">  326</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> quotelevel = 0;</div>
<div class="line"><span class="lineno">  327</span>  <span class="keywordtype">bool</span> delsp = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  328</span>  <span class="keywordtype">size_t</span> sz = 0;</div>
<div class="line"><span class="lineno">  329</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structFlowedState.html">FlowedState</a> fst = { 0 };</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>  <span class="comment">/* respect DelSp of RFC3676 only with f=f parts */</span></div>
<div class="line"><span class="lineno">  332</span>  <span class="keywordtype">char</span> *t = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b_email-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;delsp&quot;</span>);</div>
<div class="line"><span class="lineno">  333</span>  <span class="keywordflow">if</span> (t)</div>
<div class="line"><span class="lineno">  334</span>  {</div>
<div class="line"><span class="lineno">  335</span>    <a class="code hl_variable" href="structFlowedState.html#a002470002d76c1ede9624e88fe9f2f36">delsp</a> = <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(t, <span class="stringliteral">&quot;yes&quot;</span>);</div>
<div class="line"><span class="lineno">  336</span>    t = NULL;</div>
<div class="line"><span class="lineno">  337</span>    fst.<a class="code hl_variable" href="structFlowedState.html#a002470002d76c1ede9624e88fe9f2f36">delsp</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  338</span>  }</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>  <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a51339e1b6c72f67dcc9649e7859789c5">LL_DEBUG3</a>, <span class="stringliteral">&quot;f=f: DelSp: %s\n&quot;</span>, <a class="code hl_variable" href="structFlowedState.html#a002470002d76c1ede9624e88fe9f2f36">delsp</a> ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>  <span class="keywordflow">while</span> ((buf = <a class="code hl_function" href="file_8c.html#a1ad76f956147154f16128b7761dadd58">mutt_file_read_line</a>(buf, &amp;sz, state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, NULL, <a class="code hl_define" href="file_8h.html#abb6d0dccab49bda4ed23948c7f5d0eaa">MUTT_RL_NO_FLAGS</a>)))</div>
<div class="line"><span class="lineno">  343</span>  {</div>
<div class="line"><span class="lineno">  344</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> buflen = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(buf);</div>
<div class="line"><span class="lineno">  345</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> newql = <a class="code hl_function" href="rfc3676_8c.html#aae9c55042003c431c7a004bab1f93860">get_quote_level</a>(buf);</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>    <span class="comment">/* end flowed paragraph (if we&#39;re within one) if quoting level</span></div>
<div class="line"><span class="lineno">  348</span><span class="comment">     * changes (should not but can happen, see RFC3676, sec. 4.5.) */</span></div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">if</span> (newql != quotelevel)</div>
<div class="line"><span class="lineno">  350</span>      <a class="code hl_function" href="rfc3676_8c.html#ad360747b800996106c85eceac62ff7ab">flush_par</a>(state, &amp;fst);</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>    quotelevel = newql;</div>
<div class="line"><span class="lineno">  353</span>    <span class="keywordtype">int</span> buf_off = newql;</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>    <span class="comment">/* respect sender&#39;s space-stuffing by removing one leading space */</span></div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordflow">if</span> (buf[buf_off] == <span class="charliteral">&#39; &#39;</span>)</div>
<div class="line"><span class="lineno">  357</span>      buf_off++;</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>    <span class="comment">/* test for signature separator */</span></div>
<div class="line"><span class="lineno">  360</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sigsep = <a class="code hl_function" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(buf + buf_off, <span class="stringliteral">&quot;-- &quot;</span>);</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>    <span class="comment">/* a fixed line either has no trailing space or is the</span></div>
<div class="line"><span class="lineno">  363</span><span class="comment">     * signature separator */</span></div>
<div class="line"><span class="lineno">  364</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> fixed = (buflen == buf_off) || (buf[buflen - 1] != <span class="charliteral">&#39; &#39;</span>) || sigsep;</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    <span class="comment">/* print fixed-and-standalone, fixed-and-empty and sigsep lines as</span></div>
<div class="line"><span class="lineno">  367</span><span class="comment">     * fixed lines */</span></div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">if</span> ((fixed &amp;&amp; ((fst.<a class="code hl_variable" href="structFlowedState.html#a635fa843f878b8699143b02b178e5dcb">width</a> == 0) || (buflen == 0))) || sigsep)</div>
<div class="line"><span class="lineno">  369</span>    {</div>
<div class="line"><span class="lineno">  370</span>      <span class="comment">/* if we&#39;re within a flowed paragraph, terminate it */</span></div>
<div class="line"><span class="lineno">  371</span>      <a class="code hl_function" href="rfc3676_8c.html#ad360747b800996106c85eceac62ff7ab">flush_par</a>(state, &amp;fst);</div>
<div class="line"><span class="lineno">  372</span>      <a class="code hl_function" href="rfc3676_8c.html#a03ce1fc38ef17fba59c40b9987022391">print_fixed_line</a>(buf + buf_off, state, quotelevel, &amp;fst);</div>
<div class="line"><span class="lineno">  373</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  374</span>    }</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>    <span class="comment">/* for DelSp=yes, we need to strip one SP prior to CRLF on flowed lines */</span></div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structFlowedState.html#a002470002d76c1ede9624e88fe9f2f36">delsp</a> &amp;&amp; !fixed)</div>
<div class="line"><span class="lineno">  378</span>      buf[buflen - 1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>    <a class="code hl_function" href="rfc3676_8c.html#accf0413501a69b46811870a88b3c2816">print_flowed_line</a>(buf + buf_off, state, quotelevel, &amp;fst, fixed);</div>
<div class="line"><span class="lineno">  381</span>  }</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>  <a class="code hl_function" href="rfc3676_8c.html#ad360747b800996106c85eceac62ff7ab">flush_par</a>(state, &amp;fst);</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;buf);</div>
<div class="line"><span class="lineno">  386</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  387</span>}</div>
<div class="ttc" id="alogging2_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a51339e1b6c72f67dcc9649e7859789c5"><div class="ttname"><a href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a51339e1b6c72f67dcc9649e7859789c5">LL_DEBUG3</a></div><div class="ttdeci">@ LL_DEBUG3</div><div class="ttdoc">Log at debug level 3.</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00046">logging2.h:46</a></div></div>
<div class="ttc" id="arfc3676_8c_html_a03ce1fc38ef17fba59c40b9987022391"><div class="ttname"><a href="rfc3676_8c.html#a03ce1fc38ef17fba59c40b9987022391">print_fixed_line</a></div><div class="ttdeci">static void print_fixed_line(const char *line, struct State *state, int ql, struct FlowedState *fst)</div><div class="ttdoc">Print a fixed format line.</div><div class="ttdef"><b>Definition</b> <a href="rfc3676_8c_source.html#l00307">rfc3676.c:307</a></div></div>
<div class="ttc" id="arfc3676_8c_html_aae9c55042003c431c7a004bab1f93860"><div class="ttname"><a href="rfc3676_8c.html#aae9c55042003c431c7a004bab1f93860">get_quote_level</a></div><div class="ttdeci">static int get_quote_level(const char *line)</div><div class="ttdoc">Get the quote level of a line.</div><div class="ttdef"><b>Definition</b> <a href="rfc3676_8c_source.html#l00063">rfc3676.c:63</a></div></div>
<div class="ttc" id="arfc3676_8c_html_accf0413501a69b46811870a88b3c2816"><div class="ttname"><a href="rfc3676_8c.html#accf0413501a69b46811870a88b3c2816">print_flowed_line</a></div><div class="ttdeci">static void print_flowed_line(char *line, struct State *state, int ql, struct FlowedState *fst, bool term)</div><div class="ttdoc">Print a format-flowed line.</div><div class="ttdef"><b>Definition</b> <a href="rfc3676_8c_source.html#l00228">rfc3676.c:228</a></div></div>
<div class="ttc" id="arfc3676_8c_html_ad360747b800996106c85eceac62ff7ab"><div class="ttname"><a href="rfc3676_8c.html#ad360747b800996106c85eceac62ff7ab">flush_par</a></div><div class="ttdeci">static void flush_par(struct State *state, struct FlowedState *fst)</div><div class="ttdoc">Write out the paragraph.</div><div class="ttdef"><b>Definition</b> <a href="rfc3676_8c_source.html#l00175">rfc3676.c:175</a></div></div>
<div class="ttc" id="astructFlowedState_html"><div class="ttname"><a href="structFlowedState.html">FlowedState</a></div><div class="ttdoc">State of a Format-Flowed line of text.</div><div class="ttdef"><b>Definition</b> <a href="rfc3676_8c_source.html#l00051">rfc3676.c:52</a></div></div>
<div class="ttc" id="astructFlowedState_html_a002470002d76c1ede9624e88fe9f2f36"><div class="ttname"><a href="structFlowedState.html#a002470002d76c1ede9624e88fe9f2f36">FlowedState::delsp</a></div><div class="ttdeci">bool delsp</div><div class="ttdef"><b>Definition</b> <a href="rfc3676_8c_source.html#l00055">rfc3676.c:55</a></div></div>
<div class="ttc" id="astructFlowedState_html_a635fa843f878b8699143b02b178e5dcb"><div class="ttname"><a href="structFlowedState.html#a635fa843f878b8699143b02b178e5dcb">FlowedState::width</a></div><div class="ttdeci">size_t width</div><div class="ttdef"><b>Definition</b> <a href="rfc3676_8c_source.html#l00053">rfc3676.c:53</a></div></div>
</div><!-- fragment --><div id="dynsection-28" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gaadbb7eb9de333071b51c4ff88b45315b_cgraph.svg" width="487" height="444"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-29" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__handler__api_gaadbb7eb9de333071b51c4ff88b45315b_icgraph.svg" width="326" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
