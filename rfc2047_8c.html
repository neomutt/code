<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: email/rfc2047.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><a href="https://neomutt.org"><img alt="Logo" src="neomutt-64.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <a style="color: black; text-decoration: none;" href="https://neomutt.org">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">2025-12-11-79-gf03987</span>
   </div>
   <div id="projectbrief">Teaching an old dog new tricks</div>
   </a>
   <a href="https://github.com/neomutt/neomutt" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000000; color:#fff; position: fixed; top: 0; border: 0; right: 0; z-index: 9999;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </td>
   <td><a style="text-decoration: none; position: absolute; right: 0; top: 25px; margin-right: 100px; color: #66d866; font-size: 400%;" href="http://www.doxygen.org/index.html">DOXYGEN</a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('rfc2047_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">rfc2047.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>RFC2047 MIME extensions encoding / decoding routines.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;config.h&quot;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;iconv.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="mutt_2lib_8h_source.html">mutt/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="address_2lib_8h_source.html">address/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_2lib_8h_source.html">config/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="core_2lib_8h_source.html">core/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rfc2047_8h_source.html">rfc2047.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="envelope_8h_source.html">envelope.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mime_8h_source.html">mime.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for rfc2047.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c__incl.svg" width="987" height="274"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="rfc2047_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aed2999c145a004bc9c37fbd6248b822e" id="r_aed2999c145a004bc9c37fbd6248b822e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed2999c145a004bc9c37fbd6248b822e">ENCWORD_LEN_MAX</a>&#160;&#160;&#160;75</td></tr>
<tr class="separator:aed2999c145a004bc9c37fbd6248b822e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72b4275b0634c8faba7296d1c1c9d97e" id="r_a72b4275b0634c8faba7296d1c1c9d97e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a72b4275b0634c8faba7296d1c1c9d97e">ENCWORD_LEN_MIN</a>&#160;&#160;&#160;9 /* strlen (&quot;=?.?.?.?=&quot;) */</td></tr>
<tr class="separator:a72b4275b0634c8faba7296d1c1c9d97e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5a216c48811ce4274751b1ffed405da" id="r_ae5a216c48811ce4274751b1ffed405da"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5a216c48811ce4274751b1ffed405da">HSPACE</a>(ch)</td></tr>
<tr class="separator:ae5a216c48811ce4274751b1ffed405da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a470b076f25dc95af370a94d73dbd7cc0" id="r_a470b076f25dc95af370a94d73dbd7cc0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a470b076f25dc95af370a94d73dbd7cc0">CONTINUATION_BYTE</a>(ch)</td></tr>
<tr class="separator:a470b076f25dc95af370a94d73dbd7cc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a7b92834b648d377605408439bdf8e137" id="r_a7b92834b648d377605408439bdf8e137"><td class="memItemLeft" align="right" valign="top">typedef size_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b92834b648d377605408439bdf8e137">encoder_t</a>) (char *res, const char *buf, size_t buflen, const char *tocode)</td></tr>
<tr class="separator:a7b92834b648d377605408439bdf8e137"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3eedcf9e2c7f60af22ef8bfc5face403" id="r_ga3eedcf9e2c7f60af22ef8bfc5face403"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__encoder__api.html#ga3eedcf9e2c7f60af22ef8bfc5face403">b_encoder</a> (char *res, const char *src, size_t srclen, const char *tocode)</td></tr>
<tr class="memdesc:ga3eedcf9e2c7f60af22ef8bfc5face403"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base64 Encode a string - Implements <a class="el" href="#a7b92834b648d377605408439bdf8e137">encoder_t</a> -.  <br /></td></tr>
<tr class="separator:ga3eedcf9e2c7f60af22ef8bfc5face403"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad424be4019f3940ef8e1f14b10c6d594" id="r_gad424be4019f3940ef8e1f14b10c6d594"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__encoder__api.html#gad424be4019f3940ef8e1f14b10c6d594">q_encoder</a> (char *res, const char *src, size_t srclen, const char *tocode)</td></tr>
<tr class="memdesc:gad424be4019f3940ef8e1f14b10c6d594"><td class="mdescLeft">&#160;</td><td class="mdescRight">Quoted-printable Encode a string - Implements <a class="el" href="#a7b92834b648d377605408439bdf8e137">encoder_t</a> -.  <br /></td></tr>
<tr class="separator:gad424be4019f3940ef8e1f14b10c6d594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a1b1661d6ad0bbd2c87ed4883d51bf7" id="r_a7a1b1661d6ad0bbd2c87ed4883d51bf7"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a1b1661d6ad0bbd2c87ed4883d51bf7">parse_encoded_word</a> (char *str, enum <a class="el" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61">ContentEncoding</a> *enc, char **charset, size_t *charsetlen, char **text, size_t *textlen)</td></tr>
<tr class="memdesc:a7a1b1661d6ad0bbd2c87ed4883d51bf7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse a string and report RFC2047 elements.  <br /></td></tr>
<tr class="separator:a7a1b1661d6ad0bbd2c87ed4883d51bf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af517130be123255c119dae5b47f3cb1c" id="r_af517130be123255c119dae5b47f3cb1c"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af517130be123255c119dae5b47f3cb1c">try_block</a> (const char *d, size_t dlen, const char *fromcode, const char *tocode, <a class="el" href="#a7b92834b648d377605408439bdf8e137">encoder_t</a> *encoder, size_t *wlen)</td></tr>
<tr class="memdesc:af517130be123255c119dae5b47f3cb1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to convert a block of text.  <br /></td></tr>
<tr class="separator:af517130be123255c119dae5b47f3cb1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c4ea35c95b50455b895a18b7e4cbc10" id="r_a8c4ea35c95b50455b895a18b7e4cbc10"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c4ea35c95b50455b895a18b7e4cbc10">encode_block</a> (char *str, char *buf, size_t buflen, const char *fromcode, const char *tocode, <a class="el" href="#a7b92834b648d377605408439bdf8e137">encoder_t</a> encoder)</td></tr>
<tr class="memdesc:a8c4ea35c95b50455b895a18b7e4cbc10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encode a block of text using an encoder.  <br /></td></tr>
<tr class="separator:a8c4ea35c95b50455b895a18b7e4cbc10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68424d046b66d891da1b80929074f616" id="r_a68424d046b66d891da1b80929074f616"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a68424d046b66d891da1b80929074f616">choose_block</a> (char *d, size_t dlen, int col, const char *fromcode, const char *tocode, <a class="el" href="#a7b92834b648d377605408439bdf8e137">encoder_t</a> *encoder, size_t *wlen)</td></tr>
<tr class="memdesc:a68424d046b66d891da1b80929074f616"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate how much data can be converted.  <br /></td></tr>
<tr class="separator:a68424d046b66d891da1b80929074f616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afef686b50d1bc6030d76a2c1c5dbb6c4" id="r_afef686b50d1bc6030d76a2c1c5dbb6c4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afef686b50d1bc6030d76a2c1c5dbb6c4">finalize_chunk</a> (struct <a class="el" href="structBuffer.html">Buffer</a> *res, struct <a class="el" href="structBuffer.html">Buffer</a> *buf, char *charset, size_t charsetlen)</td></tr>
<tr class="memdesc:afef686b50d1bc6030d76a2c1c5dbb6c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform charset conversion and filtering.  <br /></td></tr>
<tr class="separator:afef686b50d1bc6030d76a2c1c5dbb6c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1018339402895dc4ec81b2afbcaab57" id="r_ab1018339402895dc4ec81b2afbcaab57"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab1018339402895dc4ec81b2afbcaab57">decode_word</a> (const char *s, size_t len, enum <a class="el" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61">ContentEncoding</a> enc)</td></tr>
<tr class="memdesc:ab1018339402895dc4ec81b2afbcaab57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode an RFC2047-encoded string.  <br /></td></tr>
<tr class="separator:ab1018339402895dc4ec81b2afbcaab57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad76ba986603e70d8fcacff83ee5a4dc2" id="r_ad76ba986603e70d8fcacff83ee5a4dc2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad76ba986603e70d8fcacff83ee5a4dc2">encode</a> (const char *d, size_t dlen, int col, const char *fromcode, const struct <a class="el" href="structSlist.html">Slist</a> *charsets, char **e, size_t *elen, const char *specials)</td></tr>
<tr class="memdesc:ad76ba986603e70d8fcacff83ee5a4dc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">RFC2047-encode a string.  <br /></td></tr>
<tr class="separator:ad76ba986603e70d8fcacff83ee5a4dc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61043d0660090027414b220222dbf90b" id="r_a61043d0660090027414b220222dbf90b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61043d0660090027414b220222dbf90b">rfc2047_encode</a> (char **pd, const char *specials, int col, const struct <a class="el" href="structSlist.html">Slist</a> *charsets)</td></tr>
<tr class="memdesc:a61043d0660090027414b220222dbf90b"><td class="mdescLeft">&#160;</td><td class="mdescRight">RFC-2047-encode a string.  <br /></td></tr>
<tr class="separator:a61043d0660090027414b220222dbf90b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89c57c82465740567f73641c9397d760" id="r_a89c57c82465740567f73641c9397d760"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a89c57c82465740567f73641c9397d760">rfc2047_decode</a> (char **pd)</td></tr>
<tr class="memdesc:a89c57c82465740567f73641c9397d760"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode any RFC2047-encoded header fields.  <br /></td></tr>
<tr class="separator:a89c57c82465740567f73641c9397d760"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f979b4ba087d3291049da868935e005" id="r_a4f979b4ba087d3291049da868935e005"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f979b4ba087d3291049da868935e005">rfc2047_encode_addrlist</a> (struct AddressList *al, const char *tag)</td></tr>
<tr class="memdesc:a4f979b4ba087d3291049da868935e005"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encode any RFC2047 headers, where required, in an <a class="el" href="structAddress.html" title="An email address.">Address</a> list.  <br /></td></tr>
<tr class="separator:a4f979b4ba087d3291049da868935e005"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7aa3c6d84c8eaa435d161cc2c227b88" id="r_ac7aa3c6d84c8eaa435d161cc2c227b88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac7aa3c6d84c8eaa435d161cc2c227b88">rfc2047_decode_addrlist</a> (struct AddressList *al)</td></tr>
<tr class="memdesc:ac7aa3c6d84c8eaa435d161cc2c227b88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode any RFC2047 headers in an <a class="el" href="structAddress.html" title="An email address.">Address</a> list.  <br /></td></tr>
<tr class="separator:ac7aa3c6d84c8eaa435d161cc2c227b88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79026f5cfec0b561058f7021e19b9601" id="r_a79026f5cfec0b561058f7021e19b9601"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a79026f5cfec0b561058f7021e19b9601">rfc2047_decode_envelope</a> (struct <a class="el" href="structEnvelope.html">Envelope</a> *env)</td></tr>
<tr class="memdesc:a79026f5cfec0b561058f7021e19b9601"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode the fields of an <a class="el" href="structEnvelope.html" title="The header of an Email.">Envelope</a>.  <br /></td></tr>
<tr class="separator:a79026f5cfec0b561058f7021e19b9601"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceeb3a044de1c06a649af033af856486" id="r_aceeb3a044de1c06a649af033af856486"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aceeb3a044de1c06a649af033af856486">rfc2047_encode_envelope</a> (struct <a class="el" href="structEnvelope.html">Envelope</a> *env)</td></tr>
<tr class="memdesc:aceeb3a044de1c06a649af033af856486"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encode the fields of an <a class="el" href="structEnvelope.html" title="The header of an Email.">Envelope</a>.  <br /></td></tr>
<tr class="separator:aceeb3a044de1c06a649af033af856486"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>RFC2047 MIME extensions encoding / decoding routines. </p>
<dl class="section author"><dt>Authors</dt><dd><ul>
<li>Federico Kircheis</li>
<li>Pietro Cerutti</li>
<li>Richard Russon</li>
<li>Anna Figueiredo Gomes</li>
<li>наб</li>
</ul>
</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 2 of the License, or (at your option) any later version.</dd></dl>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>

<p class="definition">Definition in file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aed2999c145a004bc9c37fbd6248b822e" name="aed2999c145a004bc9c37fbd6248b822e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed2999c145a004bc9c37fbd6248b822e">&#9670;&#160;</a></span>ENCWORD_LEN_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENCWORD_LEN_MAX&#160;&#160;&#160;75</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00046">46</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>

</div>
</div>
<a id="a72b4275b0634c8faba7296d1c1c9d97e" name="a72b4275b0634c8faba7296d1c1c9d97e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72b4275b0634c8faba7296d1c1c9d97e">&#9670;&#160;</a></span>ENCWORD_LEN_MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENCWORD_LEN_MIN&#160;&#160;&#160;9 /* strlen (&quot;=?.?.?.?=&quot;) */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00047">47</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>

</div>
</div>
<a id="ae5a216c48811ce4274751b1ffed405da" name="ae5a216c48811ce4274751b1ffed405da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5a216c48811ce4274751b1ffed405da">&#9670;&#160;</a></span>HSPACE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HSPACE</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ch</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(((ch) == <span class="charliteral">&#39;\0&#39;</span>) || ((ch) == <span class="charliteral">&#39; &#39;</span>) || ((ch) == <span class="charliteral">&#39;\t&#39;</span>))</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00049">49</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>

</div>
</div>
<a id="a470b076f25dc95af370a94d73dbd7cc0" name="a470b076f25dc95af370a94d73dbd7cc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a470b076f25dc95af370a94d73dbd7cc0">&#9670;&#160;</a></span>CONTINUATION_BYTE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTINUATION_BYTE</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>ch</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">(((ch) &amp; 0xc0) == 0x80)</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00051">51</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a7b92834b648d377605408439bdf8e137" name="a7b92834b648d377605408439bdf8e137"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b92834b648d377605408439bdf8e137">&#9670;&#160;</a></span>encoder_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef size_t(* encoder_t) (char *res, const char *buf, size_t buflen, const char *tocode)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00064">64</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7a1b1661d6ad0bbd2c87ed4883d51bf7" name="a7a1b1661d6ad0bbd2c87ed4883d51bf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a1b1661d6ad0bbd2c87ed4883d51bf7">&#9670;&#160;</a></span>parse_encoded_word()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char * parse_encoded_word </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>str</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61">ContentEncoding</a> *</td>          <td class="paramname"><span class="paramname"><em>enc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>charset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>charsetlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>text</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>textlen</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parse a string and report RFC2047 elements. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">str</td><td>String to parse </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">enc</td><td><a class="el" href="structContent.html" title="Info about an attachment.">Content</a> encoding found in the first RFC2047 word </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">charset</td><td>Charset found in the first RFC2047 word </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">charsetlen</td><td>Length of the charset string found </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">text</td><td>Start of the first RFC2047 encoded text </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">textlen</td><td>Length of the encoded text found </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Start of the RFC2047 encoded word </td></tr>
    <tr><td class="paramname">NULL</td><td>None was found </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00147">147</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  149</span>{</div>
<div class="line"><span class="lineno">  150</span>  regmatch_t *match = <a class="code hl_function" href="prex_8c.html#a204aa135b8b80f39730506b82385612d">mutt_prex_capture</a>(<a class="code hl_enumvalue" href="prex_8h.html#a94868f2b3ee14f09fb7b9e236d752488af227d92cffdf02d0d0e79709479dbf1c">PREX_RFC2047_ENCODED_WORD</a>, str);</div>
<div class="line"><span class="lineno">  151</span>  <span class="keywordflow">if</span> (!match)</div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>  <span class="keyword">const</span> regmatch_t *mfull = &amp;match[<a class="code hl_enumvalue" href="prex_8h.html#a6b141ce42781c26c0333833ab56b7dbdaa1e8aeea941f8236c4182f3c8fbe33d2">PREX_RFC2047_ENCODED_WORD_MATCH_FULL</a>];</div>
<div class="line"><span class="lineno">  155</span>  <span class="keyword">const</span> regmatch_t *mcharset = &amp;match[<a class="code hl_enumvalue" href="prex_8h.html#a6b141ce42781c26c0333833ab56b7dbda38899ba4ecb2eb507a14bb3d9468fffa">PREX_RFC2047_ENCODED_WORD_MATCH_CHARSET</a>];</div>
<div class="line"><span class="lineno">  156</span>  <span class="keyword">const</span> regmatch_t *mencoding = &amp;match[<a class="code hl_enumvalue" href="prex_8h.html#a6b141ce42781c26c0333833ab56b7dbda1524dbe964e647ff2b4c9f594c76010b">PREX_RFC2047_ENCODED_WORD_MATCH_ENCODING</a>];</div>
<div class="line"><span class="lineno">  157</span>  <span class="keyword">const</span> regmatch_t *mtext = &amp;match[<a class="code hl_enumvalue" href="prex_8h.html#a6b141ce42781c26c0333833ab56b7dbda20392e6eaaad3de2e7ae53431e3e620a">PREX_RFC2047_ENCODED_WORD_MATCH_TEXT</a>];</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>  <span class="comment">/* Charset */</span></div>
<div class="line"><span class="lineno">  160</span>  *charset = str + <a class="code hl_function" href="regex3_8h.html#ace9a8836dfa6c039cb619573c60e253f">mutt_regmatch_start</a>(mcharset);</div>
<div class="line"><span class="lineno">  161</span>  *charsetlen = <a class="code hl_function" href="regex3_8h.html#a67ed3f37a5cbaab7f957bf5d842a9ff9">mutt_regmatch_len</a>(mcharset);</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>  <span class="comment">/* Encoding: either Q or B */</span></div>
<div class="line"><span class="lineno">  164</span>  *enc = (<a class="code hl_function" href="ctype_8c.html#ad14cca3d15a5c91eceb6965fcff34cb9">mutt_tolower</a>(str[<a class="code hl_function" href="regex3_8h.html#ace9a8836dfa6c039cb619573c60e253f">mutt_regmatch_start</a>(mencoding)]) == <span class="charliteral">&#39;q&#39;</span>) ? <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a> :</div>
<div class="line"><span class="lineno">  165</span>                                                                      <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a>;</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>  *text = str + <a class="code hl_function" href="regex3_8h.html#ace9a8836dfa6c039cb619573c60e253f">mutt_regmatch_start</a>(mtext);</div>
<div class="line"><span class="lineno">  168</span>  *textlen = <a class="code hl_function" href="regex3_8h.html#a67ed3f37a5cbaab7f957bf5d842a9ff9">mutt_regmatch_len</a>(mtext);</div>
<div class="line"><span class="lineno">  169</span>  <span class="keywordflow">return</span> str + <a class="code hl_function" href="regex3_8h.html#ace9a8836dfa6c039cb619573c60e253f">mutt_regmatch_start</a>(mfull);</div>
<div class="line"><span class="lineno">  170</span>}</div>
<div class="ttc" id="actype_8c_html_ad14cca3d15a5c91eceb6965fcff34cb9"><div class="ttname"><a href="ctype_8c.html#ad14cca3d15a5c91eceb6965fcff34cb9">mutt_tolower</a></div><div class="ttdeci">int mutt_tolower(int arg)</div><div class="ttdoc">Wrapper for tolower(3)</div><div class="ttdef"><b>Definition</b> <a href="ctype_8c_source.html#l00126">ctype.c:126</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a></div><div class="ttdeci">@ ENC_BASE64</div><div class="ttdoc">Base-64 encoded text.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00052">mime.h:52</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a></div><div class="ttdeci">@ ENC_QUOTED_PRINTABLE</div><div class="ttdoc">Quoted-printable text.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00051">mime.h:51</a></div></div>
<div class="ttc" id="aprex_8c_html_a204aa135b8b80f39730506b82385612d"><div class="ttname"><a href="prex_8c.html#a204aa135b8b80f39730506b82385612d">mutt_prex_capture</a></div><div class="ttdeci">regmatch_t * mutt_prex_capture(enum Prex which, const char *str)</div><div class="ttdoc">Match a precompiled regex against a string.</div><div class="ttdef"><b>Definition</b> <a href="prex_8c_source.html#l00297">prex.c:297</a></div></div>
<div class="ttc" id="aprex_8h_html_a6b141ce42781c26c0333833ab56b7dbda1524dbe964e647ff2b4c9f594c76010b"><div class="ttname"><a href="prex_8h.html#a6b141ce42781c26c0333833ab56b7dbda1524dbe964e647ff2b4c9f594c76010b">PREX_RFC2047_ENCODED_WORD_MATCH_ENCODING</a></div><div class="ttdeci">@ PREX_RFC2047_ENCODED_WORD_MATCH_ENCODING</div><div class="ttdoc">=?utf-8?[Q]?=E8=81...?=</div><div class="ttdef"><b>Definition</b> <a href="prex_8h_source.html#l00098">prex.h:98</a></div></div>
<div class="ttc" id="aprex_8h_html_a6b141ce42781c26c0333833ab56b7dbda20392e6eaaad3de2e7ae53431e3e620a"><div class="ttname"><a href="prex_8h.html#a6b141ce42781c26c0333833ab56b7dbda20392e6eaaad3de2e7ae53431e3e620a">PREX_RFC2047_ENCODED_WORD_MATCH_TEXT</a></div><div class="ttdeci">@ PREX_RFC2047_ENCODED_WORD_MATCH_TEXT</div><div class="ttdoc">=?utf-8?Q?[=E8=81...]?=</div><div class="ttdef"><b>Definition</b> <a href="prex_8h_source.html#l00099">prex.h:99</a></div></div>
<div class="ttc" id="aprex_8h_html_a6b141ce42781c26c0333833ab56b7dbda38899ba4ecb2eb507a14bb3d9468fffa"><div class="ttname"><a href="prex_8h.html#a6b141ce42781c26c0333833ab56b7dbda38899ba4ecb2eb507a14bb3d9468fffa">PREX_RFC2047_ENCODED_WORD_MATCH_CHARSET</a></div><div class="ttdeci">@ PREX_RFC2047_ENCODED_WORD_MATCH_CHARSET</div><div class="ttdoc">=?[utf-8]?Q?=E8=81...?=</div><div class="ttdef"><b>Definition</b> <a href="prex_8h_source.html#l00097">prex.h:97</a></div></div>
<div class="ttc" id="aprex_8h_html_a6b141ce42781c26c0333833ab56b7dbdaa1e8aeea941f8236c4182f3c8fbe33d2"><div class="ttname"><a href="prex_8h.html#a6b141ce42781c26c0333833ab56b7dbdaa1e8aeea941f8236c4182f3c8fbe33d2">PREX_RFC2047_ENCODED_WORD_MATCH_FULL</a></div><div class="ttdeci">@ PREX_RFC2047_ENCODED_WORD_MATCH_FULL</div><div class="ttdoc">[=?utf-8?Q?=E8=81...?=]</div><div class="ttdef"><b>Definition</b> <a href="prex_8h_source.html#l00096">prex.h:96</a></div></div>
<div class="ttc" id="aprex_8h_html_a94868f2b3ee14f09fb7b9e236d752488af227d92cffdf02d0d0e79709479dbf1c"><div class="ttname"><a href="prex_8h.html#a94868f2b3ee14f09fb7b9e236d752488af227d92cffdf02d0d0e79709479dbf1c">PREX_RFC2047_ENCODED_WORD</a></div><div class="ttdeci">@ PREX_RFC2047_ENCODED_WORD</div><div class="ttdoc">[=?utf-8?Q?=E8=81=AA=E6=98=8E=E7=9A=84?=]</div><div class="ttdef"><b>Definition</b> <a href="prex_8h_source.html#l00036">prex.h:36</a></div></div>
<div class="ttc" id="aregex3_8h_html_a67ed3f37a5cbaab7f957bf5d842a9ff9"><div class="ttname"><a href="regex3_8h.html#a67ed3f37a5cbaab7f957bf5d842a9ff9">mutt_regmatch_len</a></div><div class="ttdeci">static size_t mutt_regmatch_len(const regmatch_t *match)</div><div class="ttdoc">Return the length of a match.</div><div class="ttdef"><b>Definition</b> <a href="regex3_8h_source.html#l00077">regex3.h:77</a></div></div>
<div class="ttc" id="aregex3_8h_html_ace9a8836dfa6c039cb619573c60e253f"><div class="ttname"><a href="regex3_8h.html#ace9a8836dfa6c039cb619573c60e253f">mutt_regmatch_start</a></div><div class="ttdeci">static regoff_t mutt_regmatch_start(const regmatch_t *match)</div><div class="ttdoc">Return the start of a match.</div><div class="ttdef"><b>Definition</b> <a href="regex3_8h_source.html#l00057">regex3.h:57</a></div></div>
</div><!-- fragment --><div id="dynsection-1" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a7a1b1661d6ad0bbd2c87ed4883d51bf7_cgraph.svg" width="364" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-2" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a7a1b1661d6ad0bbd2c87ed4883d51bf7_icgraph.svg" width="335" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af517130be123255c119dae5b47f3cb1c" name="af517130be123255c119dae5b47f3cb1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af517130be123255c119dae5b47f3cb1c">&#9670;&#160;</a></span>try_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t try_block </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>dlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>fromcode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>tocode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a7b92834b648d377605408439bdf8e137">encoder_t</a> *</td>          <td class="paramname"><span class="paramname"><em>encoder</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>wlen</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attempt to convert a block of text. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>String to convert </td></tr>
    <tr><td class="paramname">dlen</td><td>Length of string </td></tr>
    <tr><td class="paramname">fromcode</td><td>Original encoding </td></tr>
    <tr><td class="paramname">tocode</td><td>New encoding </td></tr>
    <tr><td class="paramname">encoder</td><td>Encoding function </td></tr>
    <tr><td class="paramname">wlen</td><td>Number of characters converted </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success, string converted </td></tr>
    <tr><td class="paramname">&gt;0</td><td>Error, number of bytes that could be converted</td></tr>
  </table>
  </dd>
</dl>
<p>If the data could be converted using encoder, then set *encoder and *wlen. Otherwise return an upper bound on the maximum length of the data which could be converted.</p>
<p>The data is converted from fromcode (which must be stateless) to tocode, unless fromcode is NULL, in which case the data is assumed to be already in tocode, which should be 8-bit and stateless. </p>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00191">191</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  193</span>{</div>
<div class="line"><span class="lineno">  194</span>  <span class="keywordtype">char</span> buf[<a class="code hl_define" href="#aed2999c145a004bc9c37fbd6248b822e">ENCWORD_LEN_MAX</a> - <a class="code hl_define" href="#a72b4275b0634c8faba7296d1c1c9d97e">ENCWORD_LEN_MIN</a> + 1];</div>
<div class="line"><span class="lineno">  195</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *ib = NULL;</div>
<div class="line"><span class="lineno">  196</span>  <span class="keywordtype">char</span> *ob = NULL;</div>
<div class="line"><span class="lineno">  197</span>  <span class="keywordtype">size_t</span> ibl, obl;</div>
<div class="line"><span class="lineno">  198</span>  <span class="keywordtype">int</span> count, len, len_b, len_q;</div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>  <span class="keywordflow">if</span> (fromcode)</div>
<div class="line"><span class="lineno">  201</span>  {</div>
<div class="line"><span class="lineno">  202</span>    iconv_t cd = <a class="code hl_function" href="mutt_2charset_8c.html#af7380ef31de4a56ab644b71f0a010ed9">mutt_ch_iconv_open</a>(tocode, fromcode, <a class="code hl_define" href="mutt_2charset_8h.html#a7e8b71716e5c874b2997a2304be23081">MUTT_ICONV_NO_FLAGS</a>);</div>
<div class="line"><span class="lineno">  203</span>    <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>(<a class="code hl_function" href="mutt_2charset_8h.html#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a>(cd));</div>
<div class="line"><span class="lineno">  204</span>    ib = d;</div>
<div class="line"><span class="lineno">  205</span>    ibl = dlen;</div>
<div class="line"><span class="lineno">  206</span>    ob = buf;</div>
<div class="line"><span class="lineno">  207</span>    obl = <span class="keyword">sizeof</span>(buf) - strlen(tocode);</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">if</span> ((iconv(cd, (ICONV_CONST <span class="keywordtype">char</span> **) &amp;ib, &amp;ibl, &amp;ob, &amp;obl) == <a class="code hl_define" href="mutt_2charset_8h.html#aa492c8da74811c680daecd5cc99fd506">ICONV_ILLEGAL_SEQ</a>) ||</div>
<div class="line"><span class="lineno">  209</span>        (iconv(cd, NULL, NULL, &amp;ob, &amp;obl) == <a class="code hl_define" href="mutt_2charset_8h.html#aa492c8da74811c680daecd5cc99fd506">ICONV_ILLEGAL_SEQ</a>))</div>
<div class="line"><span class="lineno">  210</span>    {</div>
<div class="line"><span class="lineno">  211</span>      <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>(errno == E2BIG);</div>
<div class="line"><span class="lineno">  212</span>      <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>(ib &gt; d);</div>
<div class="line"><span class="lineno">  213</span>      <span class="keywordflow">return</span> ((ib - d) == dlen) ? dlen : ib - d + 1;</div>
<div class="line"><span class="lineno">  214</span>    }</div>
<div class="line"><span class="lineno">  215</span>  }</div>
<div class="line"><span class="lineno">  216</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  217</span>  {</div>
<div class="line"><span class="lineno">  218</span>    <span class="keywordflow">if</span> (dlen &gt; (<span class="keyword">sizeof</span>(buf) - strlen(tocode)))</div>
<div class="line"><span class="lineno">  219</span>      <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(buf) - strlen(tocode) + 1;</div>
<div class="line"><span class="lineno">  220</span>    memcpy(buf, d, dlen);</div>
<div class="line"><span class="lineno">  221</span>    ob = buf + dlen;</div>
<div class="line"><span class="lineno">  222</span>  }</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>  count = 0;</div>
<div class="line"><span class="lineno">  225</span>  <span class="keywordflow">for</span> (<span class="keywordtype">char</span> *p = buf; p &lt; ob; p++)</div>
<div class="line"><span class="lineno">  226</span>  {</div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> c = *p;</div>
<div class="line"><span class="lineno">  228</span>    <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>(strchr(<a class="code hl_variable" href="mime_8c.html#a6af4522fba27b690e849f0cfd22da751">MimeSpecials</a>, <span class="charliteral">&#39;?&#39;</span>));</div>
<div class="line"><span class="lineno">  229</span>    <span class="keywordflow">if</span> ((c &gt;= 0x7f) || (c &lt; 0x20) || (*p == <span class="charliteral">&#39;_&#39;</span>) ||</div>
<div class="line"><span class="lineno">  230</span>        ((c != <span class="charliteral">&#39; &#39;</span>) &amp;&amp; strchr(<a class="code hl_variable" href="mime_8c.html#a6af4522fba27b690e849f0cfd22da751">MimeSpecials</a>, *p)))</div>
<div class="line"><span class="lineno">  231</span>    {</div>
<div class="line"><span class="lineno">  232</span>      count++;</div>
<div class="line"><span class="lineno">  233</span>    }</div>
<div class="line"><span class="lineno">  234</span>  }</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>  len = <a class="code hl_define" href="#a72b4275b0634c8faba7296d1c1c9d97e">ENCWORD_LEN_MIN</a> - 2 + strlen(tocode);</div>
<div class="line"><span class="lineno">  237</span>  len_b = len + (((ob - buf) + 2) / 3) * 4;</div>
<div class="line"><span class="lineno">  238</span>  len_q = len + (ob - buf) + 2 * count;</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>  <span class="comment">/* Apparently RFC1468 says to use B encoding for iso-2022-jp. */</span></div>
<div class="line"><span class="lineno">  241</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(tocode, <span class="stringliteral">&quot;ISO-2022-JP&quot;</span>))</div>
<div class="line"><span class="lineno">  242</span>    len_q = <a class="code hl_define" href="#aed2999c145a004bc9c37fbd6248b822e">ENCWORD_LEN_MAX</a> + 1;</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>  <span class="keywordflow">if</span> ((len_b &lt; len_q) &amp;&amp; (len_b &lt;= <a class="code hl_define" href="#aed2999c145a004bc9c37fbd6248b822e">ENCWORD_LEN_MAX</a>))</div>
<div class="line"><span class="lineno">  245</span>  {</div>
<div class="line"><span class="lineno">  246</span>    *encoder = <a class="code hl_function" href="group__encoder__api.html#ga3eedcf9e2c7f60af22ef8bfc5face403">b_encoder</a>;</div>
<div class="line"><span class="lineno">  247</span>    *wlen = len_b;</div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  249</span>  }</div>
<div class="line"><span class="lineno">  250</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len_q &lt;= <a class="code hl_define" href="#aed2999c145a004bc9c37fbd6248b822e">ENCWORD_LEN_MAX</a>)</div>
<div class="line"><span class="lineno">  251</span>  {</div>
<div class="line"><span class="lineno">  252</span>    *encoder = <a class="code hl_function" href="group__encoder__api.html#gad424be4019f3940ef8e1f14b10c6d594">q_encoder</a>;</div>
<div class="line"><span class="lineno">  253</span>    *wlen = len_q;</div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  255</span>  }</div>
<div class="line"><span class="lineno">  256</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  257</span>  {</div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">return</span> dlen;</div>
<div class="line"><span class="lineno">  259</span>  }</div>
<div class="line"><span class="lineno">  260</span>}</div>
<div class="ttc" id="agroup__encoder__api_html_ga3eedcf9e2c7f60af22ef8bfc5face403"><div class="ttname"><a href="group__encoder__api.html#ga3eedcf9e2c7f60af22ef8bfc5face403">b_encoder</a></div><div class="ttdeci">static size_t b_encoder(char *res, const char *src, size_t srclen, const char *tocode)</div><div class="ttdoc">Base64 Encode a string - Implements encoder_t -.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00069">rfc2047.c:69</a></div></div>
<div class="ttc" id="agroup__encoder__api_html_gad424be4019f3940ef8e1f14b10c6d594"><div class="ttname"><a href="group__encoder__api.html#gad424be4019f3940ef8e1f14b10c6d594">q_encoder</a></div><div class="ttdeci">static size_t q_encoder(char *res, const char *src, size_t srclen, const char *tocode)</div><div class="ttdoc">Quoted-printable Encode a string - Implements encoder_t -.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00102">rfc2047.c:102</a></div></div>
<div class="ttc" id="amime_8c_html_a6af4522fba27b690e849f0cfd22da751"><div class="ttname"><a href="mime_8c.html#a6af4522fba27b690e849f0cfd22da751">MimeSpecials</a></div><div class="ttdeci">const char MimeSpecials[]</div><div class="ttdoc">Characters that need special treatment in MIME.</div><div class="ttdef"><b>Definition</b> <a href="mime_8c_source.html#l00067">mime.c:67</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_af7380ef31de4a56ab644b71f0a010ed9"><div class="ttname"><a href="mutt_2charset_8c.html#af7380ef31de4a56ab644b71f0a010ed9">mutt_ch_iconv_open</a></div><div class="ttdeci">iconv_t mutt_ch_iconv_open(const char *tocode, const char *fromcode, uint8_t flags)</div><div class="ttdoc">Set up iconv for conversions.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00580">charset.c:580</a></div></div>
<div class="ttc" id="amutt_2charset_8h_html_a7e8b71716e5c874b2997a2304be23081"><div class="ttname"><a href="mutt_2charset_8h.html#a7e8b71716e5c874b2997a2304be23081">MUTT_ICONV_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_ICONV_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00066">charset.h:66</a></div></div>
<div class="ttc" id="amutt_2charset_8h_html_aa492c8da74811c680daecd5cc99fd506"><div class="ttname"><a href="mutt_2charset_8h.html#aa492c8da74811c680daecd5cc99fd506">ICONV_ILLEGAL_SEQ</a></div><div class="ttdeci">#define ICONV_ILLEGAL_SEQ</div><div class="ttdoc">Error value for iconv() - Illegal sequence.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00114">charset.h:114</a></div></div>
<div class="ttc" id="amutt_2charset_8h_html_af99f0dca1b479b94f1287bc8aa050e4c"><div class="ttname"><a href="mutt_2charset_8h.html#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a></div><div class="ttdeci">static bool iconv_t_valid(const iconv_t cd)</div><div class="ttdoc">Is the conversion descriptor valid?</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00123">charset.h:123</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00674">string.c:674</a></div></div>
<div class="ttc" id="arfc2047_8c_html_a72b4275b0634c8faba7296d1c1c9d97e"><div class="ttname"><a href="#a72b4275b0634c8faba7296d1c1c9d97e">ENCWORD_LEN_MIN</a></div><div class="ttdeci">#define ENCWORD_LEN_MIN</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00047">rfc2047.c:47</a></div></div>
<div class="ttc" id="arfc2047_8c_html_aed2999c145a004bc9c37fbd6248b822e"><div class="ttname"><a href="#aed2999c145a004bc9c37fbd6248b822e">ENCWORD_LEN_MAX</a></div><div class="ttdeci">#define ENCWORD_LEN_MAX</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00046">rfc2047.c:46</a></div></div>
<div class="ttc" id="asignal2_8h_html_a903f9b298be75defd8a3043ebf62bd99"><div class="ttname"><a href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a></div><div class="ttdeci">#define ASSERT(COND)</div><div class="ttdef"><b>Definition</b> <a href="signal2_8h_source.html#l00060">signal2.h:60</a></div></div>
</div><!-- fragment --><div id="dynsection-3" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_af517130be123255c119dae5b47f3cb1c_cgraph.svg" width="430" height="251"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-4" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_af517130be123255c119dae5b47f3cb1c_icgraph.svg" width="355" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a8c4ea35c95b50455b895a18b7e4cbc10" name="a8c4ea35c95b50455b895a18b7e4cbc10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c4ea35c95b50455b895a18b7e4cbc10">&#9670;&#160;</a></span>encode_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t encode_block </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>str</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>buflen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>fromcode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>tocode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a7b92834b648d377605408439bdf8e137">encoder_t</a></td>          <td class="paramname"><span class="paramname"><em>encoder</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Encode a block of text using an encoder. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">str</td><td>String to convert </td></tr>
    <tr><td class="paramname">buf</td><td><a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> for result </td></tr>
    <tr><td class="paramname">buflen</td><td><a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> length </td></tr>
    <tr><td class="paramname">fromcode</td><td>Original encoding </td></tr>
    <tr><td class="paramname">tocode</td><td>New encoding </td></tr>
    <tr><td class="paramname">encoder</td><td>Encoding function </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>Length of the encoded word</td></tr>
  </table>
  </dd>
</dl>
<p>Encode the data (buf, buflen) into str using the encoder. </p>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00274">274</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  276</span>{</div>
<div class="line"><span class="lineno">  277</span>  <span class="keywordflow">if</span> (!fromcode)</div>
<div class="line"><span class="lineno">  278</span>  {</div>
<div class="line"><span class="lineno">  279</span>    <span class="keywordflow">return</span> (*encoder)(str, buf, buflen, tocode);</div>
<div class="line"><span class="lineno">  280</span>  }</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>  <span class="keyword">const</span> iconv_t cd = <a class="code hl_function" href="mutt_2charset_8c.html#af7380ef31de4a56ab644b71f0a010ed9">mutt_ch_iconv_open</a>(tocode, fromcode, <a class="code hl_define" href="mutt_2charset_8h.html#a7e8b71716e5c874b2997a2304be23081">MUTT_ICONV_NO_FLAGS</a>);</div>
<div class="line"><span class="lineno">  283</span>  <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>(<a class="code hl_function" href="mutt_2charset_8h.html#af99f0dca1b479b94f1287bc8aa050e4c">iconv_t_valid</a>(cd));</div>
<div class="line"><span class="lineno">  284</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *ib = buf;</div>
<div class="line"><span class="lineno">  285</span>  <span class="keywordtype">size_t</span> ibl = buflen;</div>
<div class="line"><span class="lineno">  286</span>  <span class="keywordtype">char</span> tmp[<a class="code hl_define" href="#aed2999c145a004bc9c37fbd6248b822e">ENCWORD_LEN_MAX</a> - <a class="code hl_define" href="#a72b4275b0634c8faba7296d1c1c9d97e">ENCWORD_LEN_MIN</a> + 1];</div>
<div class="line"><span class="lineno">  287</span>  <span class="keywordtype">char</span> *ob = tmp;</div>
<div class="line"><span class="lineno">  288</span>  <span class="keywordtype">size_t</span> obl = <span class="keyword">sizeof</span>(tmp) - strlen(tocode);</div>
<div class="line"><span class="lineno">  289</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> n1 = iconv(cd, (ICONV_CONST <span class="keywordtype">char</span> **) &amp;ib, &amp;ibl, &amp;ob, &amp;obl);</div>
<div class="line"><span class="lineno">  290</span>  <span class="keyword">const</span> <span class="keywordtype">size_t</span> n2 = iconv(cd, NULL, NULL, &amp;ob, &amp;obl);</div>
<div class="line"><span class="lineno">  291</span>  <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>((n1 != <a class="code hl_define" href="mutt_2charset_8h.html#aa492c8da74811c680daecd5cc99fd506">ICONV_ILLEGAL_SEQ</a>) &amp;&amp; (n2 != <a class="code hl_define" href="mutt_2charset_8h.html#aa492c8da74811c680daecd5cc99fd506">ICONV_ILLEGAL_SEQ</a>));</div>
<div class="line"><span class="lineno">  292</span>  <span class="keywordflow">return</span> (*encoder)(str, tmp, ob - tmp, tocode);</div>
<div class="line"><span class="lineno">  293</span>}</div>
</div><!-- fragment --><div id="dynsection-5" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a8c4ea35c95b50455b895a18b7e4cbc10_cgraph.svg" width="458" height="66"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-6" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a8c4ea35c95b50455b895a18b7e4cbc10_icgraph.svg" width="232" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a68424d046b66d891da1b80929074f616" name="a68424d046b66d891da1b80929074f616"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68424d046b66d891da1b80929074f616">&#9670;&#160;</a></span>choose_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t choose_block </td>
          <td>(</td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>dlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>col</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>fromcode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>tocode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="#a7b92834b648d377605408439bdf8e137">encoder_t</a> *</td>          <td class="paramname"><span class="paramname"><em>encoder</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>wlen</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculate how much data can be converted. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>String to convert </td></tr>
    <tr><td class="paramname">dlen</td><td>Length of string </td></tr>
    <tr><td class="paramname">col</td><td>Starting column to convert </td></tr>
    <tr><td class="paramname">fromcode</td><td>Original encoding </td></tr>
    <tr><td class="paramname">tocode</td><td>New encoding </td></tr>
    <tr><td class="paramname">encoder</td><td>Encoding function </td></tr>
    <tr><td class="paramname">wlen</td><td>Number of characters converted </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>Bytes that can be converted</td></tr>
  </table>
  </dd>
</dl>
<p>Discover how much of the data (d, dlen) can be converted into a single encoded word. Return how much data can be converted, and set the length *wlen of the encoded word and *encoder. We start in column col, which limits the length of the word. </p>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00311">311</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  313</span>{</div>
<div class="line"><span class="lineno">  314</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> utf8 = fromcode &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(fromcode, <span class="stringliteral">&quot;utf-8&quot;</span>);</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>  <span class="keywordtype">size_t</span> n = dlen;</div>
<div class="line"><span class="lineno">  317</span>  <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno">  318</span>  {</div>
<div class="line"><span class="lineno">  319</span>    <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>(n &gt; 0);</div>
<div class="line"><span class="lineno">  320</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> nn = <a class="code hl_function" href="#af517130be123255c119dae5b47f3cb1c">try_block</a>(d, n, fromcode, tocode, encoder, wlen);</div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordflow">if</span> ((nn == 0) &amp;&amp; (((col + *wlen) &lt;= (<a class="code hl_define" href="#aed2999c145a004bc9c37fbd6248b822e">ENCWORD_LEN_MAX</a> + 1)) || (n &lt;= 1)))</div>
<div class="line"><span class="lineno">  322</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  323</span>    n = ((nn != 0) ? nn : n) - 1;</div>
<div class="line"><span class="lineno">  324</span>    <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>(n &gt; 0);</div>
<div class="line"><span class="lineno">  325</span>    <span class="keywordflow">if</span> (utf8)</div>
<div class="line"><span class="lineno">  326</span>      <span class="keywordflow">while</span> ((n &gt; 1) &amp;&amp; <a class="code hl_define" href="#a470b076f25dc95af370a94d73dbd7cc0">CONTINUATION_BYTE</a>(d[n]))</div>
<div class="line"><span class="lineno">  327</span>        n--;</div>
<div class="line"><span class="lineno">  328</span>  }</div>
<div class="line"><span class="lineno">  329</span>  <span class="keywordflow">return</span> n;</div>
<div class="line"><span class="lineno">  330</span>}</div>
<div class="ttc" id="arfc2047_8c_html_a470b076f25dc95af370a94d73dbd7cc0"><div class="ttname"><a href="#a470b076f25dc95af370a94d73dbd7cc0">CONTINUATION_BYTE</a></div><div class="ttdeci">#define CONTINUATION_BYTE(ch)</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00051">rfc2047.c:51</a></div></div>
<div class="ttc" id="arfc2047_8c_html_af517130be123255c119dae5b47f3cb1c"><div class="ttname"><a href="#af517130be123255c119dae5b47f3cb1c">try_block</a></div><div class="ttdeci">static size_t try_block(const char *d, size_t dlen, const char *fromcode, const char *tocode, encoder_t *encoder, size_t *wlen)</div><div class="ttdoc">Attempt to convert a block of text.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00191">rfc2047.c:191</a></div></div>
</div><!-- fragment --><div id="dynsection-7" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a68424d046b66d891da1b80929074f616_cgraph.svg" width="406" height="66"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-8" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a68424d046b66d891da1b80929074f616_icgraph.svg" width="230" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="afef686b50d1bc6030d76a2c1c5dbb6c4" name="afef686b50d1bc6030d76a2c1c5dbb6c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afef686b50d1bc6030d76a2c1c5dbb6c4">&#9670;&#160;</a></span>finalize_chunk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void finalize_chunk </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBuffer.html">Buffer</a> *</td>          <td class="paramname"><span class="paramname"><em>res</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBuffer.html">Buffer</a> *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>charset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>charsetlen</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform charset conversion and filtering. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">res</td><td><a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> where the resulting string is appended </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td><a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> with the input string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">charset</td><td>Charset to use for the conversion </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">charsetlen</td><td>Length of the charset parameter</td></tr>
  </table>
  </dd>
</dl>
<p>The buffer buf is reinitialized at the end of this function. </p>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00341">341</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  342</span>{</div>
<div class="line"><span class="lineno">  343</span>  <span class="keywordflow">if</span> (!charset)</div>
<div class="line"><span class="lineno">  344</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  345</span>  <span class="keywordtype">char</span> end = charset[charsetlen];</div>
<div class="line"><span class="lineno">  346</span>  charset[charsetlen] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  347</span>  <a class="code hl_function" href="mutt_2charset_8c.html#a6304403ed915a40228aeda4082920a42">mutt_ch_convert_string</a>(&amp;buf-&gt;<a class="code hl_variable" href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">data</a>, charset, <a class="code hl_function" href="config__cache_8c.html#a03027fb835011539c3cbfeb1b0fa8811">cc_charset</a>(), <a class="code hl_define" href="mutt_2charset_8h.html#a1807a22585916adccafa5e09bda9b6a7">MUTT_ICONV_HOOK_FROM</a>);</div>
<div class="line"><span class="lineno">  348</span>  charset[charsetlen] = end;</div>
<div class="line"><span class="lineno">  349</span>  <a class="code hl_function" href="mbyte_8c.html#a2ff7f0c0693d59c4fbb25cff5198a208">mutt_mb_filter_unprintable</a>(&amp;buf-&gt;<a class="code hl_variable" href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">data</a>);</div>
<div class="line"><span class="lineno">  350</span>  <a class="code hl_function" href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a>(res, buf-&gt;<a class="code hl_variable" href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">data</a>);</div>
<div class="line"><span class="lineno">  351</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;buf-&gt;<a class="code hl_variable" href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">data</a>);</div>
<div class="line"><span class="lineno">  352</span>  <a class="code hl_function" href="buffer_8c.html#a6ffb5cf731a68033766b9a084d8b2dc2">buf_init</a>(buf);</div>
<div class="line"><span class="lineno">  353</span>}</div>
<div class="ttc" id="abuffer_8c_html_a6ffb5cf731a68033766b9a084d8b2dc2"><div class="ttname"><a href="buffer_8c.html#a6ffb5cf731a68033766b9a084d8b2dc2">buf_init</a></div><div class="ttdeci">struct Buffer * buf_init(struct Buffer *buf)</div><div class="ttdoc">Initialise a new Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00061">buffer.c:61</a></div></div>
<div class="ttc" id="abuffer_8c_html_a9924e74ddcb5280ab380e4627d1fba99"><div class="ttname"><a href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a></div><div class="ttdeci">size_t buf_addstr(struct Buffer *buf, const char *s)</div><div class="ttdoc">Add a string to a Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00226">buffer.c:226</a></div></div>
<div class="ttc" id="aconfig__cache_8c_html_a03027fb835011539c3cbfeb1b0fa8811"><div class="ttname"><a href="config__cache_8c.html#a03027fb835011539c3cbfeb1b0fa8811">cc_charset</a></div><div class="ttdeci">const char * cc_charset(void)</div><div class="ttdoc">Get the cached value of $charset.</div><div class="ttdef"><b>Definition</b> <a href="config__cache_8c_source.html#l00116">config_cache.c:116</a></div></div>
<div class="ttc" id="ambyte_8c_html_a2ff7f0c0693d59c4fbb25cff5198a208"><div class="ttname"><a href="mbyte_8c.html#a2ff7f0c0693d59c4fbb25cff5198a208">mutt_mb_filter_unprintable</a></div><div class="ttdeci">int mutt_mb_filter_unprintable(char **s)</div><div class="ttdoc">Replace unprintable characters.</div><div class="ttdef"><b>Definition</b> <a href="mbyte_8c_source.html#l00424">mbyte.c:424</a></div></div>
<div class="ttc" id="amemory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00063">memory.h:63</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_a6304403ed915a40228aeda4082920a42"><div class="ttname"><a href="mutt_2charset_8c.html#a6304403ed915a40228aeda4082920a42">mutt_ch_convert_string</a></div><div class="ttdeci">int mutt_ch_convert_string(char **ps, const char *from, const char *to, uint8_t flags)</div><div class="ttdoc">Convert a string between encodings.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00817">charset.c:817</a></div></div>
<div class="ttc" id="amutt_2charset_8h_html_a1807a22585916adccafa5e09bda9b6a7"><div class="ttname"><a href="mutt_2charset_8h.html#a1807a22585916adccafa5e09bda9b6a7">MUTT_ICONV_HOOK_FROM</a></div><div class="ttdeci">#define MUTT_ICONV_HOOK_FROM</div><div class="ttdoc">apply charset-hooks to fromcode</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00067">charset.h:67</a></div></div>
<div class="ttc" id="astructBuffer_html_aeec1fd4af0ddf6765b0187466d4361b8"><div class="ttname"><a href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">Buffer::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">Pointer to data.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00037">buffer.h:37</a></div></div>
</div><!-- fragment --><div id="dynsection-9" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_afef686b50d1bc6030d76a2c1c5dbb6c4_cgraph.svg" width="494" height="235"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-10" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_afef686b50d1bc6030d76a2c1c5dbb6c4_icgraph.svg" width="288" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab1018339402895dc4ec81b2afbcaab57" name="ab1018339402895dc4ec81b2afbcaab57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1018339402895dc4ec81b2afbcaab57">&#9670;&#160;</a></span>decode_word()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char * decode_word </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>len</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61">ContentEncoding</a></td>          <td class="paramname"><span class="paramname"><em>enc</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Decode an RFC2047-encoded string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>String to decode </td></tr>
    <tr><td class="paramname">len</td><td>Length of the string </td></tr>
    <tr><td class="paramname">enc</td><td>Encoding type </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Decoded string</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The input string must be NUL-terminated; the len parameter is an optimization. The caller must free the returned string. </dd></dl>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00365">365</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  366</span>{</div>
<div class="line"><span class="lineno">  367</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *it = s;</div>
<div class="line"><span class="lineno">  368</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *end = s + len;</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>  <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>(*end == <span class="charliteral">&#39;\0&#39;</span>);</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>  <span class="keywordflow">if</span> (enc == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a>)</div>
<div class="line"><span class="lineno">  373</span>  {</div>
<div class="line"><span class="lineno">  374</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *buf = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordflow">for</span> (; it &lt; end; it++)</div>
<div class="line"><span class="lineno">  376</span>    {</div>
<div class="line"><span class="lineno">  377</span>      <span class="keywordflow">if</span> (*it == <span class="charliteral">&#39;_&#39;</span>)</div>
<div class="line"><span class="lineno">  378</span>      {</div>
<div class="line"><span class="lineno">  379</span>        <a class="code hl_function" href="buffer_8c.html#a9765efbb7f2c32e46fb1cb271a02ba20">buf_addch</a>(buf, <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><span class="lineno">  380</span>      }</div>
<div class="line"><span class="lineno">  381</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((it[0] == <span class="charliteral">&#39;=&#39;</span>) &amp;&amp; (!(it[1] &amp; ~127) &amp;&amp; (<a class="code hl_define" href="mime_8h.html#ac212ee80d510d8f8af8fde1675b910a3">hexval</a>(it[1]) != -1)) &amp;&amp;</div>
<div class="line"><span class="lineno">  382</span>               (!(it[2] &amp; ~127) &amp;&amp; (<a class="code hl_define" href="mime_8h.html#ac212ee80d510d8f8af8fde1675b910a3">hexval</a>(it[2]) != -1)))</div>
<div class="line"><span class="lineno">  383</span>      {</div>
<div class="line"><span class="lineno">  384</span>        <a class="code hl_function" href="buffer_8c.html#a9765efbb7f2c32e46fb1cb271a02ba20">buf_addch</a>(buf, (<a class="code hl_define" href="mime_8h.html#ac212ee80d510d8f8af8fde1675b910a3">hexval</a>(it[1]) &lt;&lt; 4) | <a class="code hl_define" href="mime_8h.html#ac212ee80d510d8f8af8fde1675b910a3">hexval</a>(it[2]));</div>
<div class="line"><span class="lineno">  385</span>        it += 2;</div>
<div class="line"><span class="lineno">  386</span>      }</div>
<div class="line"><span class="lineno">  387</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  388</span>      {</div>
<div class="line"><span class="lineno">  389</span>        <a class="code hl_function" href="buffer_8c.html#a9765efbb7f2c32e46fb1cb271a02ba20">buf_addch</a>(buf, *it);</div>
<div class="line"><span class="lineno">  390</span>      }</div>
<div class="line"><span class="lineno">  391</span>    }</div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordtype">char</span> *str = <a class="code hl_function" href="buffer_8c.html#ad76477cc0c660bc50162393e997233eb">buf_strdup</a>(buf);</div>
<div class="line"><span class="lineno">  393</span>    <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;buf);</div>
<div class="line"><span class="lineno">  394</span>    <span class="keywordflow">return</span> str;</div>
<div class="line"><span class="lineno">  395</span>  }</div>
<div class="line"><span class="lineno">  396</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (enc == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a>)</div>
<div class="line"><span class="lineno">  397</span>  {</div>
<div class="line"><span class="lineno">  398</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> olen = 3 * len / 4 + 1;</div>
<div class="line"><span class="lineno">  399</span>    <span class="keywordtype">char</span> *out = <a class="code hl_define" href="memory_8h.html#af997cb3719dc7abbeabae655d0ee1b9e">MUTT_MEM_MALLOC</a>(olen, <span class="keywordtype">char</span>);</div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordtype">int</span> dlen = <a class="code hl_function" href="base64_8c.html#a46d7ee223a298c936fe501e37b06ac58">mutt_b64_decode</a>(it, out, olen);</div>
<div class="line"><span class="lineno">  401</span>    <span class="keywordflow">if</span> (dlen == -1)</div>
<div class="line"><span class="lineno">  402</span>    {</div>
<div class="line"><span class="lineno">  403</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;out);</div>
<div class="line"><span class="lineno">  404</span>      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  405</span>    }</div>
<div class="line"><span class="lineno">  406</span>    out[dlen] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  407</span>    <span class="keywordflow">return</span> out;</div>
<div class="line"><span class="lineno">  408</span>  }</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>  <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>(0); <span class="comment">/* The enc parameter has an invalid value */</span></div>
<div class="line"><span class="lineno">  411</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  412</span>}</div>
<div class="ttc" id="abase64_8c_html_a46d7ee223a298c936fe501e37b06ac58"><div class="ttname"><a href="base64_8c.html#a46d7ee223a298c936fe501e37b06ac58">mutt_b64_decode</a></div><div class="ttdeci">int mutt_b64_decode(const char *in, char *out, size_t olen)</div><div class="ttdoc">Convert NUL-terminated base64 string to raw bytes.</div><div class="ttdef"><b>Definition</b> <a href="base64_8c_source.html#l00180">base64.c:180</a></div></div>
<div class="ttc" id="abuffer_8c_html_a9765efbb7f2c32e46fb1cb271a02ba20"><div class="ttname"><a href="buffer_8c.html#a9765efbb7f2c32e46fb1cb271a02ba20">buf_addch</a></div><div class="ttdeci">size_t buf_addch(struct Buffer *buf, char c)</div><div class="ttdoc">Add a single character to a Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00241">buffer.c:241</a></div></div>
<div class="ttc" id="abuffer_8c_html_ad76477cc0c660bc50162393e997233eb"><div class="ttname"><a href="buffer_8c.html#ad76477cc0c660bc50162393e997233eb">buf_strdup</a></div><div class="ttdeci">char * buf_strdup(const struct Buffer *buf)</div><div class="ttdoc">Copy a Buffer&#39;s string.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00571">buffer.c:571</a></div></div>
<div class="ttc" id="amemory_8h_html_af997cb3719dc7abbeabae655d0ee1b9e"><div class="ttname"><a href="memory_8h.html#af997cb3719dc7abbeabae655d0ee1b9e">MUTT_MEM_MALLOC</a></div><div class="ttdeci">#define MUTT_MEM_MALLOC(n, type)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00049">memory.h:49</a></div></div>
<div class="ttc" id="amime_8h_html_ac212ee80d510d8f8af8fde1675b910a3"><div class="ttname"><a href="mime_8h.html#ac212ee80d510d8f8af8fde1675b910a3">hexval</a></div><div class="ttdeci">#define hexval(ch)</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00080">mime.h:80</a></div></div>
<div class="ttc" id="apool_8c_html_a41cba27c25d33cb6822789a2856093f2"><div class="ttname"><a href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a></div><div class="ttdeci">struct Buffer * buf_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00082">pool.c:82</a></div></div>
<div class="ttc" id="apool_8c_html_a4cc6068279461cb8628219586dfa35a1"><div class="ttname"><a href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a></div><div class="ttdeci">void buf_pool_release(struct Buffer **ptr)</div><div class="ttdoc">Return a Buffer to the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00096">pool.c:96</a></div></div>
<div class="ttc" id="astructBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00035">buffer.h:36</a></div></div>
</div><!-- fragment --><div id="dynsection-11" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_ab1018339402895dc4ec81b2afbcaab57_cgraph.svg" width="296" height="254"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-12" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_ab1018339402895dc4ec81b2afbcaab57_icgraph.svg" width="286" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad76ba986603e70d8fcacff83ee5a4dc2" name="ad76ba986603e70d8fcacff83ee5a4dc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad76ba986603e70d8fcacff83ee5a4dc2">&#9670;&#160;</a></span>encode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int encode </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>dlen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>col</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>fromcode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structSlist.html">Slist</a> *</td>          <td class="paramname"><span class="paramname"><em>charsets</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>elen</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>specials</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>RFC2047-encode a string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>String to convert </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dlen</td><td>Length of string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">col</td><td>Starting column to convert </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fromcode</td><td>Original encoding </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">charsets</td><td>List of allowable encodings (colon separated) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">e</td><td>Encoded string </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">elen</td><td>Length of encoded string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">specials</td><td>Special characters to be encoded </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00426">426</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  428</span>{</div>
<div class="line"><span class="lineno">  429</span>  <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><span class="lineno">  430</span>  <span class="keywordtype">char</span> *buf = NULL;</div>
<div class="line"><span class="lineno">  431</span>  <span class="keywordtype">size_t</span> bufpos, buflen;</div>
<div class="line"><span class="lineno">  432</span>  <span class="keywordtype">char</span> *t0 = NULL, *t1 = NULL, *t = NULL;</div>
<div class="line"><span class="lineno">  433</span>  <span class="keywordtype">char</span> *s0 = NULL, *s1 = NULL;</div>
<div class="line"><span class="lineno">  434</span>  <span class="keywordtype">size_t</span> ulen, r, wlen = 0;</div>
<div class="line"><span class="lineno">  435</span>  <a class="code hl_typedef" href="#a7b92834b648d377605408439bdf8e137">encoder_t</a> encoder = NULL;</div>
<div class="line"><span class="lineno">  436</span>  <span class="keywordtype">char</span> *tocode1 = NULL;</div>
<div class="line"><span class="lineno">  437</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *tocode = NULL;</div>
<div class="line"><span class="lineno">  438</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *icode = <span class="stringliteral">&quot;utf-8&quot;</span>;</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>  <span class="comment">/* Try to convert to UTF-8. */</span></div>
<div class="line"><span class="lineno">  441</span>  <span class="keywordtype">char</span> *u = <a class="code hl_function" href="mutt_2string_8c.html#a116d1d2391bc57f2ba3a9d9cfb15db76">mutt_strn_dup</a>(d, dlen);</div>
<div class="line"><span class="lineno">  442</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2charset_8c.html#a6304403ed915a40228aeda4082920a42">mutt_ch_convert_string</a>(&amp;u, fromcode, icode, <a class="code hl_define" href="mutt_2charset_8h.html#a7e8b71716e5c874b2997a2304be23081">MUTT_ICONV_NO_FLAGS</a>) != 0)</div>
<div class="line"><span class="lineno">  443</span>  {</div>
<div class="line"><span class="lineno">  444</span>    rc = 1;</div>
<div class="line"><span class="lineno">  445</span>    icode = 0;</div>
<div class="line"><span class="lineno">  446</span>  }</div>
<div class="line"><span class="lineno">  447</span>  ulen = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(u);</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>  <span class="comment">/* Find earliest and latest things we must encode. */</span></div>
<div class="line"><span class="lineno">  450</span>  s0 = 0;</div>
<div class="line"><span class="lineno">  451</span>  s1 = 0;</div>
<div class="line"><span class="lineno">  452</span>  t0 = 0;</div>
<div class="line"><span class="lineno">  453</span>  t1 = 0;</div>
<div class="line"><span class="lineno">  454</span>  <span class="keywordflow">for</span> (t = u; t &lt; (u + ulen); t++)</div>
<div class="line"><span class="lineno">  455</span>  {</div>
<div class="line"><span class="lineno">  456</span>    <span class="keywordflow">if</span> ((*t &amp; 0x80) || ((*t == <span class="charliteral">&#39;=&#39;</span>) &amp;&amp; (t[1] == <span class="charliteral">&#39;?&#39;</span>) &amp;&amp; ((t == u) || <a class="code hl_define" href="#ae5a216c48811ce4274751b1ffed405da">HSPACE</a>(*(t - 1)))))</div>
<div class="line"><span class="lineno">  457</span>    {</div>
<div class="line"><span class="lineno">  458</span>      <span class="keywordflow">if</span> (!t0)</div>
<div class="line"><span class="lineno">  459</span>        t0 = t;</div>
<div class="line"><span class="lineno">  460</span>      t1 = t;</div>
<div class="line"><span class="lineno">  461</span>    }</div>
<div class="line"><span class="lineno">  462</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (specials &amp;&amp; *t &amp;&amp; strchr(specials, *t))</div>
<div class="line"><span class="lineno">  463</span>    {</div>
<div class="line"><span class="lineno">  464</span>      <span class="keywordflow">if</span> (!s0)</div>
<div class="line"><span class="lineno">  465</span>        s0 = t;</div>
<div class="line"><span class="lineno">  466</span>      s1 = t;</div>
<div class="line"><span class="lineno">  467</span>    }</div>
<div class="line"><span class="lineno">  468</span>  }</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>  <span class="comment">/* If we have something to encode, include RFC822 specials */</span></div>
<div class="line"><span class="lineno">  471</span>  <span class="keywordflow">if</span> (t0 &amp;&amp; s0 &amp;&amp; (s0 &lt; t0))</div>
<div class="line"><span class="lineno">  472</span>    t0 = s0;</div>
<div class="line"><span class="lineno">  473</span>  <span class="keywordflow">if</span> (t1 &amp;&amp; s1 &amp;&amp; (s1 &gt; t1))</div>
<div class="line"><span class="lineno">  474</span>    t1 = s1;</div>
<div class="line"><span class="lineno">  475</span> </div>
<div class="line"><span class="lineno">  476</span>  <span class="keywordflow">if</span> (!t0)</div>
<div class="line"><span class="lineno">  477</span>  {</div>
<div class="line"><span class="lineno">  478</span>    <span class="comment">/* No encoding is required. */</span></div>
<div class="line"><span class="lineno">  479</span>    *e = u;</div>
<div class="line"><span class="lineno">  480</span>    *elen = ulen;</div>
<div class="line"><span class="lineno">  481</span>    <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  482</span>  }</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span>  <span class="comment">/* Choose target charset. */</span></div>
<div class="line"><span class="lineno">  485</span>  tocode = fromcode;</div>
<div class="line"><span class="lineno">  486</span>  <span class="keywordflow">if</span> (icode)</div>
<div class="line"><span class="lineno">  487</span>  {</div>
<div class="line"><span class="lineno">  488</span>    tocode1 = <a class="code hl_function" href="mutt_2charset_8c.html#a285a4fac32f6564ee4682edec23142fe">mutt_ch_choose</a>(icode, charsets, u, ulen, 0, 0);</div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordflow">if</span> (tocode1)</div>
<div class="line"><span class="lineno">  490</span>    {</div>
<div class="line"><span class="lineno">  491</span>      tocode = tocode1;</div>
<div class="line"><span class="lineno">  492</span>    }</div>
<div class="line"><span class="lineno">  493</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  494</span>    {</div>
<div class="line"><span class="lineno">  495</span>      rc = 2;</div>
<div class="line"><span class="lineno">  496</span>      icode = 0;</div>
<div class="line"><span class="lineno">  497</span>    }</div>
<div class="line"><span class="lineno">  498</span>  }</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>  <span class="comment">/* Hack to avoid labelling 8-bit data as us-ascii. */</span></div>
<div class="line"><span class="lineno">  501</span>  <span class="keywordflow">if</span> (!icode &amp;&amp; <a class="code hl_define" href="mutt_2charset_8h.html#a3ef43eece2b49fd708887669f556a15b">mutt_ch_is_us_ascii</a>(tocode))</div>
<div class="line"><span class="lineno">  502</span>    tocode = <span class="stringliteral">&quot;unknown-8bit&quot;</span>;</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>  <span class="comment">/* Adjust t0 for maximum length of line. */</span></div>
<div class="line"><span class="lineno">  505</span>  t = u + (<a class="code hl_define" href="#aed2999c145a004bc9c37fbd6248b822e">ENCWORD_LEN_MAX</a> + 1) - col - <a class="code hl_define" href="#a72b4275b0634c8faba7296d1c1c9d97e">ENCWORD_LEN_MIN</a>;</div>
<div class="line"><span class="lineno">  506</span>  <span class="keywordflow">if</span> (t &lt; u)</div>
<div class="line"><span class="lineno">  507</span>    t = u;</div>
<div class="line"><span class="lineno">  508</span>  <span class="keywordflow">if</span> (t &lt; t0)</div>
<div class="line"><span class="lineno">  509</span>    t0 = t;</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span>  <span class="comment">/* Adjust t0 until we can encode a character after a space. */</span></div>
<div class="line"><span class="lineno">  512</span>  <span class="keywordflow">for</span> (; t0 &gt; u; t0--)</div>
<div class="line"><span class="lineno">  513</span>  {</div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="#ae5a216c48811ce4274751b1ffed405da">HSPACE</a>(*(t0 - 1)))</div>
<div class="line"><span class="lineno">  515</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  516</span>    t = t0 + 1;</div>
<div class="line"><span class="lineno">  517</span>    <span class="keywordflow">if</span> (icode)</div>
<div class="line"><span class="lineno">  518</span>      <span class="keywordflow">while</span> ((t &lt; (u + ulen)) &amp;&amp; <a class="code hl_define" href="#a470b076f25dc95af370a94d73dbd7cc0">CONTINUATION_BYTE</a>(*t))</div>
<div class="line"><span class="lineno">  519</span>        t++;</div>
<div class="line"><span class="lineno">  520</span>    <span class="keywordflow">if</span> ((<a class="code hl_function" href="#af517130be123255c119dae5b47f3cb1c">try_block</a>(t0, t - t0, icode, tocode, &amp;encoder, &amp;wlen) == 0) &amp;&amp;</div>
<div class="line"><span class="lineno">  521</span>        ((col + (t0 - u) + wlen) &lt;= (<a class="code hl_define" href="#aed2999c145a004bc9c37fbd6248b822e">ENCWORD_LEN_MAX</a> + 1)))</div>
<div class="line"><span class="lineno">  522</span>    {</div>
<div class="line"><span class="lineno">  523</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  524</span>    }</div>
<div class="line"><span class="lineno">  525</span>  }</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>  <span class="comment">/* Adjust t1 until we can encode a character before a space. */</span></div>
<div class="line"><span class="lineno">  528</span>  <span class="keywordflow">for</span> (; t1 &lt; (u + ulen); t1++)</div>
<div class="line"><span class="lineno">  529</span>  {</div>
<div class="line"><span class="lineno">  530</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="#ae5a216c48811ce4274751b1ffed405da">HSPACE</a>(*t1))</div>
<div class="line"><span class="lineno">  531</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  532</span>    t = t1 - 1;</div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordflow">if</span> (icode)</div>
<div class="line"><span class="lineno">  534</span>      <span class="keywordflow">while</span> (<a class="code hl_define" href="#a470b076f25dc95af370a94d73dbd7cc0">CONTINUATION_BYTE</a>(*t))</div>
<div class="line"><span class="lineno">  535</span>        t--;</div>
<div class="line"><span class="lineno">  536</span>    <span class="keywordflow">if</span> ((<a class="code hl_function" href="#af517130be123255c119dae5b47f3cb1c">try_block</a>(t, t1 - t, icode, tocode, &amp;encoder, &amp;wlen) == 0) &amp;&amp;</div>
<div class="line"><span class="lineno">  537</span>        ((1 + wlen + (u + ulen - t1)) &lt;= (<a class="code hl_define" href="#aed2999c145a004bc9c37fbd6248b822e">ENCWORD_LEN_MAX</a> + 1)))</div>
<div class="line"><span class="lineno">  538</span>    {</div>
<div class="line"><span class="lineno">  539</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  540</span>    }</div>
<div class="line"><span class="lineno">  541</span>  }</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>  <span class="comment">/* We shall encode the region [t0,t1). */</span></div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>  <span class="comment">/* Initialise the output buffer with the us-ascii prefix. */</span></div>
<div class="line"><span class="lineno">  546</span>  buflen = 2 * ulen;</div>
<div class="line"><span class="lineno">  547</span>  buf = <a class="code hl_define" href="memory_8h.html#af997cb3719dc7abbeabae655d0ee1b9e">MUTT_MEM_MALLOC</a>(buflen, <span class="keywordtype">char</span>);</div>
<div class="line"><span class="lineno">  548</span>  bufpos = t0 - u;</div>
<div class="line"><span class="lineno">  549</span>  memcpy(buf, u, t0 - u);</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>  col += t0 - u;</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>  t = t0;</div>
<div class="line"><span class="lineno">  554</span>  <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno">  555</span>  {</div>
<div class="line"><span class="lineno">  556</span>    <span class="comment">/* Find how much we can encode. */</span></div>
<div class="line"><span class="lineno">  557</span>    <span class="keywordtype">size_t</span> n = <a class="code hl_function" href="#a68424d046b66d891da1b80929074f616">choose_block</a>(t, t1 - t, col, icode, tocode, &amp;encoder, &amp;wlen);</div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordflow">if</span> (n == (t1 - t))</div>
<div class="line"><span class="lineno">  559</span>    {</div>
<div class="line"><span class="lineno">  560</span>      <span class="comment">/* See if we can fit the us-ascii suffix, too. */</span></div>
<div class="line"><span class="lineno">  561</span>      <span class="keywordflow">if</span> ((col + wlen + (u + ulen - t1)) &lt;= (<a class="code hl_define" href="#aed2999c145a004bc9c37fbd6248b822e">ENCWORD_LEN_MAX</a> + 1))</div>
<div class="line"><span class="lineno">  562</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  563</span>      n = t1 - t - 1;</div>
<div class="line"><span class="lineno">  564</span>      <span class="keywordflow">if</span> (icode)</div>
<div class="line"><span class="lineno">  565</span>        <span class="keywordflow">while</span> (<a class="code hl_define" href="#a470b076f25dc95af370a94d73dbd7cc0">CONTINUATION_BYTE</a>(t[n]))</div>
<div class="line"><span class="lineno">  566</span>          n--;</div>
<div class="line"><span class="lineno">  567</span>      <span class="keywordflow">if</span> (n == 0)</div>
<div class="line"><span class="lineno">  568</span>      {</div>
<div class="line"><span class="lineno">  569</span>        <span class="comment">/* This should only happen in the really stupid case where the</span></div>
<div class="line"><span class="lineno">  570</span><span class="comment">         * only word that needs encoding is one character long, but</span></div>
<div class="line"><span class="lineno">  571</span><span class="comment">         * there is too much us-ascii stuff after it to use a single</span></div>
<div class="line"><span class="lineno">  572</span><span class="comment">         * encoded word. We add the next word to the encoded region</span></div>
<div class="line"><span class="lineno">  573</span><span class="comment">         * and try again. */</span></div>
<div class="line"><span class="lineno">  574</span>        <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>(t1 &lt; (u + ulen));</div>
<div class="line"><span class="lineno">  575</span>        <span class="keywordflow">for</span> (t1++; (t1 &lt; (u + ulen)) &amp;&amp; !<a class="code hl_define" href="#ae5a216c48811ce4274751b1ffed405da">HSPACE</a>(*t1); t1++)</div>
<div class="line"><span class="lineno">  576</span>          ; <span class="comment">// do nothing</span></div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  579</span>      }</div>
<div class="line"><span class="lineno">  580</span>      n = <a class="code hl_function" href="#a68424d046b66d891da1b80929074f616">choose_block</a>(t, n, col, icode, tocode, &amp;encoder, &amp;wlen);</div>
<div class="line"><span class="lineno">  581</span>    }</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>    <span class="comment">/* Add to output buffer. */</span></div>
<div class="line"><span class="lineno">  584</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *line_break = <span class="stringliteral">&quot;\n\t&quot;</span>;</div>
<div class="line"><span class="lineno">  585</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> lb_len = 2; <span class="comment">/* strlen(line_break) */</span></div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>    <span class="keywordflow">if</span> ((bufpos + wlen + lb_len) &gt; buflen)</div>
<div class="line"><span class="lineno">  588</span>    {</div>
<div class="line"><span class="lineno">  589</span>      buflen = bufpos + wlen + lb_len;</div>
<div class="line"><span class="lineno">  590</span>      <a class="code hl_define" href="memory_8h.html#abd7aad5fe8f11bcd476c64b4243081ba">MUTT_MEM_REALLOC</a>(&amp;buf, buflen, <span class="keywordtype">char</span>);</div>
<div class="line"><span class="lineno">  591</span>    }</div>
<div class="line"><span class="lineno">  592</span>    r = <a class="code hl_function" href="#a8c4ea35c95b50455b895a18b7e4cbc10">encode_block</a>(buf + bufpos, t, n, icode, tocode, encoder);</div>
<div class="line"><span class="lineno">  593</span>    <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>(r == wlen);</div>
<div class="line"><span class="lineno">  594</span>    bufpos += wlen;</div>
<div class="line"><span class="lineno">  595</span>    memcpy(buf + bufpos, line_break, lb_len);</div>
<div class="line"><span class="lineno">  596</span>    bufpos += lb_len;</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>    col = 1;</div>
<div class="line"><span class="lineno">  599</span> </div>
<div class="line"><span class="lineno">  600</span>    t += n;</div>
<div class="line"><span class="lineno">  601</span>  }</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>  <span class="comment">/* Add last encoded word and us-ascii suffix to buffer. */</span></div>
<div class="line"><span class="lineno">  604</span>  buflen = bufpos + wlen + (u + ulen - t1);</div>
<div class="line"><span class="lineno">  605</span>  <a class="code hl_define" href="memory_8h.html#abd7aad5fe8f11bcd476c64b4243081ba">MUTT_MEM_REALLOC</a>(&amp;buf, buflen + 1, <span class="keywordtype">char</span>);</div>
<div class="line"><span class="lineno">  606</span>  r = <a class="code hl_function" href="#a8c4ea35c95b50455b895a18b7e4cbc10">encode_block</a>(buf + bufpos, t, t1 - t, icode, tocode, encoder);</div>
<div class="line"><span class="lineno">  607</span>  <a class="code hl_define" href="signal2_8h.html#a903f9b298be75defd8a3043ebf62bd99">ASSERT</a>(r == wlen);</div>
<div class="line"><span class="lineno">  608</span>  bufpos += wlen;</div>
<div class="line"><span class="lineno">  609</span>  memcpy(buf + bufpos, t1, u + ulen - t1);</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;tocode1);</div>
<div class="line"><span class="lineno">  612</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;u);</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>  buf[buflen] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>  *e = buf;</div>
<div class="line"><span class="lineno">  617</span>  *elen = buflen + 1;</div>
<div class="line"><span class="lineno">  618</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  619</span>}</div>
<div class="ttc" id="amemory_8h_html_abd7aad5fe8f11bcd476c64b4243081ba"><div class="ttname"><a href="memory_8h.html#abd7aad5fe8f11bcd476c64b4243081ba">MUTT_MEM_REALLOC</a></div><div class="ttdeci">#define MUTT_MEM_REALLOC(pptr, n, type)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00051">memory.h:51</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_a285a4fac32f6564ee4682edec23142fe"><div class="ttname"><a href="mutt_2charset_8c.html#a285a4fac32f6564ee4682edec23142fe">mutt_ch_choose</a></div><div class="ttdeci">char * mutt_ch_choose(const char *fromcode, const struct Slist *charsets, const char *u, size_t ulen, char **d, size_t *dlen)</div><div class="ttdoc">Figure the best charset to encode a string.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l01094">charset.c:1094</a></div></div>
<div class="ttc" id="amutt_2charset_8h_html_a3ef43eece2b49fd708887669f556a15b"><div class="ttname"><a href="mutt_2charset_8h.html#a3ef43eece2b49fd708887669f556a15b">mutt_ch_is_us_ascii</a></div><div class="ttdeci">#define mutt_ch_is_us_ascii(str)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00108">charset.h:108</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a116d1d2391bc57f2ba3a9d9cfb15db76"><div class="ttname"><a href="mutt_2string_8c.html#a116d1d2391bc57f2ba3a9d9cfb15db76">mutt_strn_dup</a></div><div class="ttdeci">char * mutt_strn_dup(const char *begin, size_t len)</div><div class="ttdoc">Duplicate a sub-string.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00384">string.c:384</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_acca6786b903b22a5924219f9db96e10d"><div class="ttname"><a href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a></div><div class="ttdeci">size_t mutt_str_len(const char *a)</div><div class="ttdoc">Calculate the length of a string, safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00500">string.c:500</a></div></div>
<div class="ttc" id="arfc2047_8c_html_a68424d046b66d891da1b80929074f616"><div class="ttname"><a href="#a68424d046b66d891da1b80929074f616">choose_block</a></div><div class="ttdeci">static size_t choose_block(char *d, size_t dlen, int col, const char *fromcode, const char *tocode, encoder_t *encoder, size_t *wlen)</div><div class="ttdoc">Calculate how much data can be converted.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00311">rfc2047.c:311</a></div></div>
<div class="ttc" id="arfc2047_8c_html_a7b92834b648d377605408439bdf8e137"><div class="ttname"><a href="#a7b92834b648d377605408439bdf8e137">encoder_t</a></div><div class="ttdeci">size_t(* encoder_t)(char *res, const char *buf, size_t buflen, const char *tocode)</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00064">rfc2047.c:64</a></div></div>
<div class="ttc" id="arfc2047_8c_html_a8c4ea35c95b50455b895a18b7e4cbc10"><div class="ttname"><a href="#a8c4ea35c95b50455b895a18b7e4cbc10">encode_block</a></div><div class="ttdeci">static size_t encode_block(char *str, char *buf, size_t buflen, const char *fromcode, const char *tocode, encoder_t encoder)</div><div class="ttdoc">Encode a block of text using an encoder.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00274">rfc2047.c:274</a></div></div>
<div class="ttc" id="arfc2047_8c_html_ae5a216c48811ce4274751b1ffed405da"><div class="ttname"><a href="#ae5a216c48811ce4274751b1ffed405da">HSPACE</a></div><div class="ttdeci">#define HSPACE(ch)</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00049">rfc2047.c:49</a></div></div>
</div><!-- fragment --><div id="dynsection-13" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_ad76ba986603e70d8fcacff83ee5a4dc2_cgraph.svg" width="463" height="344"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-14" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_ad76ba986603e70d8fcacff83ee5a4dc2_icgraph.svg" width="291" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a61043d0660090027414b220222dbf90b" name="a61043d0660090027414b220222dbf90b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61043d0660090027414b220222dbf90b">&#9670;&#160;</a></span>rfc2047_encode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rfc2047_encode </td>
          <td>(</td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>pd</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>specials</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>col</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structSlist.html">Slist</a> *</td>          <td class="paramname"><span class="paramname"><em>charsets</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RFC-2047-encode a string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pd</td><td>String to be encoded, and resulting encoded string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">specials</td><td>Special characters to be encoded </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">col</td><td>Starting index in string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">charsets</td><td>List of charsets to choose from </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00628">628</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  629</span>{</div>
<div class="line"><span class="lineno">  630</span>  <span class="keywordflow">if</span> (!pd || !*pd)</div>
<div class="line"><span class="lineno">  631</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_charset = <a class="code hl_function" href="config__cache_8c.html#a03027fb835011539c3cbfeb1b0fa8811">cc_charset</a>();</div>
<div class="line"><span class="lineno">  634</span>  <span class="keywordflow">if</span> (!c_charset)</div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structSlist.html">Slist</a> *fallback = NULL;</div>
<div class="line"><span class="lineno">  638</span>  <span class="keywordflow">if</span> (!charsets)</div>
<div class="line"><span class="lineno">  639</span>  {</div>
<div class="line"><span class="lineno">  640</span>    fallback = <a class="code hl_function" href="mutt_2slist_8c.html#a2d02fa5cb8f110a65948963264371bb8">slist_parse</a>(<span class="stringliteral">&quot;utf-8&quot;</span>, <a class="code hl_define" href="types_8h.html#a19d7a62cf6cef8a8e86a91bea7278561">D_SLIST_SEP_COLON</a>);</div>
<div class="line"><span class="lineno">  641</span>    charsets = fallback;</div>
<div class="line"><span class="lineno">  642</span>  }</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>  <span class="keywordtype">char</span> *e = NULL;</div>
<div class="line"><span class="lineno">  645</span>  <span class="keywordtype">size_t</span> elen = 0;</div>
<div class="line"><span class="lineno">  646</span>  <a class="code hl_function" href="#ad76ba986603e70d8fcacff83ee5a4dc2">encode</a>(*pd, strlen(*pd), col, c_charset, charsets, &amp;e, &amp;elen, specials);</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>  <a class="code hl_function" href="mutt_2slist_8c.html#a5df0937ee812d311a487d0401a232bb7">slist_free</a>(&amp;fallback);</div>
<div class="line"><span class="lineno">  649</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(pd);</div>
<div class="line"><span class="lineno">  650</span>  *pd = e;</div>
<div class="line"><span class="lineno">  651</span>}</div>
<div class="ttc" id="amutt_2slist_8c_html_a2d02fa5cb8f110a65948963264371bb8"><div class="ttname"><a href="mutt_2slist_8c.html#a2d02fa5cb8f110a65948963264371bb8">slist_parse</a></div><div class="ttdeci">struct Slist * slist_parse(const char *str, uint32_t flags)</div><div class="ttdoc">Parse a list of strings into a list.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2slist_8c_source.html#l00177">slist.c:177</a></div></div>
<div class="ttc" id="amutt_2slist_8c_html_a5df0937ee812d311a487d0401a232bb7"><div class="ttname"><a href="mutt_2slist_8c.html#a5df0937ee812d311a487d0401a232bb7">slist_free</a></div><div class="ttdeci">void slist_free(struct Slist **ptr)</div><div class="ttdoc">Free an Slist object.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2slist_8c_source.html#l00124">slist.c:124</a></div></div>
<div class="ttc" id="arfc2047_8c_html_ad76ba986603e70d8fcacff83ee5a4dc2"><div class="ttname"><a href="#ad76ba986603e70d8fcacff83ee5a4dc2">encode</a></div><div class="ttdeci">static int encode(const char *d, size_t dlen, int col, const char *fromcode, const struct Slist *charsets, char **e, size_t *elen, const char *specials)</div><div class="ttdoc">RFC2047-encode a string.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00426">rfc2047.c:426</a></div></div>
<div class="ttc" id="astructSlist_html"><div class="ttname"><a href="structSlist.html">Slist</a></div><div class="ttdoc">String list.</div><div class="ttdef"><b>Definition</b> <a href="slist_8h_source.html#l00036">slist.h:37</a></div></div>
<div class="ttc" id="atypes_8h_html_a19d7a62cf6cef8a8e86a91bea7278561"><div class="ttname"><a href="types_8h.html#a19d7a62cf6cef8a8e86a91bea7278561">D_SLIST_SEP_COLON</a></div><div class="ttdeci">#define D_SLIST_SEP_COLON</div><div class="ttdoc">Slist items are colon-separated.</div><div class="ttdef"><b>Definition</b> <a href="types_8h_source.html#l00111">types.h:111</a></div></div>
</div><!-- fragment --><div id="dynsection-15" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a61043d0660090027414b220222dbf90b_cgraph.svg" width="267" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-16" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a61043d0660090027414b220222dbf90b_icgraph.svg" width="600" height="256"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a89c57c82465740567f73641c9397d760" name="a89c57c82465740567f73641c9397d760"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89c57c82465740567f73641c9397d760">&#9670;&#160;</a></span>rfc2047_decode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rfc2047_decode </td>
          <td>(</td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>pd</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode any RFC2047-encoded header fields. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pd</td><td>String to be decoded, and resulting decoded string</td></tr>
  </table>
  </dd>
</dl>
<p>Try to decode anything that looks like a valid RFC2047 encoded header field, ignoring RFC822 parsing rules. If decoding fails, for example due to an invalid base64 string, the original input is left untouched. </p>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00661">661</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  662</span>{</div>
<div class="line"><span class="lineno">  663</span>  <span class="keywordflow">if</span> (!pd || !*pd)</div>
<div class="line"><span class="lineno">  664</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *buf = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();  <span class="comment">// Output buffer</span></div>
<div class="line"><span class="lineno">  667</span>  <span class="keywordtype">char</span> *s = *pd;                        <span class="comment">// Read pointer</span></div>
<div class="line"><span class="lineno">  668</span>  <span class="keywordtype">char</span> *beg = NULL;                     <span class="comment">// Begin of encoded word</span></div>
<div class="line"><span class="lineno">  669</span>  <span class="keyword">enum</span> <a class="code hl_enumeration" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61">ContentEncoding</a> enc = <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a18d61a8aef64facb444f1987ee81c5c9">ENC_OTHER</a>; <span class="comment">// ENC_BASE64 or ENC_QUOTED_PRINTABLE</span></div>
<div class="line"><span class="lineno">  670</span>  <span class="keywordtype">char</span> *charset = NULL;                 <span class="comment">// Which charset</span></div>
<div class="line"><span class="lineno">  671</span>  <span class="keywordtype">size_t</span> charsetlen;                    <span class="comment">// Length of the charset</span></div>
<div class="line"><span class="lineno">  672</span>  <span class="keywordtype">char</span> *text = NULL;                    <span class="comment">// Encoded text</span></div>
<div class="line"><span class="lineno">  673</span>  <span class="keywordtype">size_t</span> textlen = 0;                   <span class="comment">// Length of encoded text</span></div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>  <span class="comment">/* Keep some state in case the next decoded word is using the same charset</span></div>
<div class="line"><span class="lineno">  676</span><span class="comment">   * and it happens to be split in the middle of a multibyte character.</span></div>
<div class="line"><span class="lineno">  677</span><span class="comment">   * See https://github.com/neomutt/neomutt/issues/1015 */</span></div>
<div class="line"><span class="lineno">  678</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *prev = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>(); <span class="comment">/* Previously decoded word  */</span></div>
<div class="line"><span class="lineno">  679</span>  <span class="keywordtype">char</span> *prev_charset = NULL;  <span class="comment">/* Previously used charset                */</span></div>
<div class="line"><span class="lineno">  680</span>  <span class="keywordtype">size_t</span> prev_charsetlen = 0; <span class="comment">/* Length of the previously used charset  */</span></div>
<div class="line"><span class="lineno">  681</span> </div>
<div class="line"><span class="lineno">  682</span>  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structSlist.html">Slist</a> *c_assumed_charset = <a class="code hl_function" href="config__cache_8c.html#addc06d02c91cce26bfe7c3692ddf0046">cc_assumed_charset</a>();</div>
<div class="line"><span class="lineno">  683</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *c_charset = <a class="code hl_function" href="config__cache_8c.html#a03027fb835011539c3cbfeb1b0fa8811">cc_charset</a>();</div>
<div class="line"><span class="lineno">  684</span>  <span class="keywordflow">while</span> (*s)</div>
<div class="line"><span class="lineno">  685</span>  {</div>
<div class="line"><span class="lineno">  686</span>    beg = <a class="code hl_function" href="#a7a1b1661d6ad0bbd2c87ed4883d51bf7">parse_encoded_word</a>(s, &amp;enc, &amp;charset, &amp;charsetlen, &amp;text, &amp;textlen);</div>
<div class="line"><span class="lineno">  687</span>    <span class="keywordflow">if</span> (beg != s)</div>
<div class="line"><span class="lineno">  688</span>    {</div>
<div class="line"><span class="lineno">  689</span>      <span class="comment">/* Some non-encoded text was found */</span></div>
<div class="line"><span class="lineno">  690</span>      <span class="keywordtype">size_t</span> holelen = beg ? beg - s : <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(s);</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>      <span class="comment">/* Ignore whitespace between encoded words */</span></div>
<div class="line"><span class="lineno">  693</span>      <span class="keywordflow">if</span> (beg &amp;&amp; (<a class="code hl_function" href="mutt_2string_8c.html#a64aa5bd37494ee3cbc4285bd06d6c91c">mutt_str_lws_len</a>(s, holelen) == holelen))</div>
<div class="line"><span class="lineno">  694</span>      {</div>
<div class="line"><span class="lineno">  695</span>        s = beg;</div>
<div class="line"><span class="lineno">  696</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  697</span>      }</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>      <span class="comment">/* If we have some previously decoded text, add it now */</span></div>
<div class="line"><span class="lineno">  700</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(prev))</div>
<div class="line"><span class="lineno">  701</span>      {</div>
<div class="line"><span class="lineno">  702</span>        <a class="code hl_function" href="#afef686b50d1bc6030d76a2c1c5dbb6c4">finalize_chunk</a>(buf, prev, prev_charset, prev_charsetlen);</div>
<div class="line"><span class="lineno">  703</span>      }</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>      <span class="comment">/* Add non-encoded part */</span></div>
<div class="line"><span class="lineno">  706</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2slist_8c.html#a4811cefce245ed4de9d8aacd8b4ab43f">slist_is_empty</a>(c_assumed_charset))</div>
<div class="line"><span class="lineno">  707</span>      {</div>
<div class="line"><span class="lineno">  708</span>        <a class="code hl_function" href="buffer_8c.html#a2881936af4a3e3b45079cb9af0cdb3e8">buf_addstr_n</a>(buf, s, holelen);</div>
<div class="line"><span class="lineno">  709</span>      }</div>
<div class="line"><span class="lineno">  710</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  711</span>      {</div>
<div class="line"><span class="lineno">  712</span>        <span class="keywordtype">char</span> *conv = <a class="code hl_function" href="mutt_2string_8c.html#a116d1d2391bc57f2ba3a9d9cfb15db76">mutt_strn_dup</a>(s, holelen);</div>
<div class="line"><span class="lineno">  713</span>        <a class="code hl_function" href="mutt_2charset_8c.html#a328973bb86fd341ba82021d540c0cc0b">mutt_ch_convert_nonmime_string</a>(c_assumed_charset, c_charset, &amp;conv);</div>
<div class="line"><span class="lineno">  714</span>        <a class="code hl_function" href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a>(buf, conv);</div>
<div class="line"><span class="lineno">  715</span>        <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;conv);</div>
<div class="line"><span class="lineno">  716</span>      }</div>
<div class="line"><span class="lineno">  717</span>      s += holelen;</div>
<div class="line"><span class="lineno">  718</span>    }</div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordflow">if</span> (beg)</div>
<div class="line"><span class="lineno">  720</span>    {</div>
<div class="line"><span class="lineno">  721</span>      <span class="comment">/* Some encoded text was found */</span></div>
<div class="line"><span class="lineno">  722</span>      text[textlen] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">  723</span>      <span class="keywordtype">char</span> *decoded = <a class="code hl_function" href="#ab1018339402895dc4ec81b2afbcaab57">decode_word</a>(text, textlen, enc);</div>
<div class="line"><span class="lineno">  724</span>      <span class="keywordflow">if</span> (!decoded)</div>
<div class="line"><span class="lineno">  725</span>      {</div>
<div class="line"><span class="lineno">  726</span>        <span class="keywordflow">goto</span> done;</div>
<div class="line"><span class="lineno">  727</span>      }</div>
<div class="line"><span class="lineno">  728</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(prev) &amp;&amp; ((prev_charsetlen != charsetlen) ||</div>
<div class="line"><span class="lineno">  729</span>                                  !<a class="code hl_function" href="mutt_2string_8c.html#a6f574867aa9db4d434adbc8af1f5f7e7">mutt_strn_equal</a>(prev_charset, charset, charsetlen)))</div>
<div class="line"><span class="lineno">  730</span>      {</div>
<div class="line"><span class="lineno">  731</span>        <span class="comment">/* Different charset, convert the previous chunk and add it to the</span></div>
<div class="line"><span class="lineno">  732</span><span class="comment">         * final result */</span></div>
<div class="line"><span class="lineno">  733</span>        <a class="code hl_function" href="#afef686b50d1bc6030d76a2c1c5dbb6c4">finalize_chunk</a>(buf, prev, prev_charset, prev_charsetlen);</div>
<div class="line"><span class="lineno">  734</span>      }</div>
<div class="line"><span class="lineno">  735</span> </div>
<div class="line"><span class="lineno">  736</span>      <a class="code hl_function" href="buffer_8c.html#a9924e74ddcb5280ab380e4627d1fba99">buf_addstr</a>(prev, decoded);</div>
<div class="line"><span class="lineno">  737</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;decoded);</div>
<div class="line"><span class="lineno">  738</span>      prev_charset = charset;</div>
<div class="line"><span class="lineno">  739</span>      prev_charsetlen = charsetlen;</div>
<div class="line"><span class="lineno">  740</span>      s = text + textlen + 2; <span class="comment">/* Skip final ?= */</span></div>
<div class="line"><span class="lineno">  741</span>    }</div>
<div class="line"><span class="lineno">  742</span>  }</div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span>  <span class="comment">/* Save the last chunk */</span></div>
<div class="line"><span class="lineno">  745</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(prev))</div>
<div class="line"><span class="lineno">  746</span>  {</div>
<div class="line"><span class="lineno">  747</span>    <a class="code hl_function" href="#afef686b50d1bc6030d76a2c1c5dbb6c4">finalize_chunk</a>(buf, prev, prev_charset, prev_charsetlen);</div>
<div class="line"><span class="lineno">  748</span>  }</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(pd);</div>
<div class="line"><span class="lineno">  751</span>  *pd = <a class="code hl_function" href="buffer_8c.html#ad76477cc0c660bc50162393e997233eb">buf_strdup</a>(buf);</div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>done:</div>
<div class="line"><span class="lineno">  754</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;buf);</div>
<div class="line"><span class="lineno">  755</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;prev);</div>
<div class="line"><span class="lineno">  756</span>}</div>
<div class="ttc" id="abuffer_8c_html_a2881936af4a3e3b45079cb9af0cdb3e8"><div class="ttname"><a href="buffer_8c.html#a2881936af4a3e3b45079cb9af0cdb3e8">buf_addstr_n</a></div><div class="ttdeci">size_t buf_addstr_n(struct Buffer *buf, const char *s, size_t len)</div><div class="ttdoc">Add a string to a Buffer, expanding it if necessary.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00096">buffer.c:96</a></div></div>
<div class="ttc" id="abuffer_8c_html_a4245e227baa2a9beb6991917404aab0d"><div class="ttname"><a href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a></div><div class="ttdeci">bool buf_is_empty(const struct Buffer *buf)</div><div class="ttdoc">Is the Buffer empty?</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00291">buffer.c:291</a></div></div>
<div class="ttc" id="aconfig__cache_8c_html_addc06d02c91cce26bfe7c3692ddf0046"><div class="ttname"><a href="config__cache_8c.html#addc06d02c91cce26bfe7c3692ddf0046">cc_assumed_charset</a></div><div class="ttdeci">const struct Slist * cc_assumed_charset(void)</div><div class="ttdoc">Get the cached value of $assumed_charset.</div><div class="ttdef"><b>Definition</b> <a href="config__cache_8c_source.html#l00101">config_cache.c:101</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61">ContentEncoding</a></div><div class="ttdeci">ContentEncoding</div><div class="ttdoc">Content-Transfer-Encoding.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00046">mime.h:47</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a18d61a8aef64facb444f1987ee81c5c9"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a18d61a8aef64facb444f1987ee81c5c9">ENC_OTHER</a></div><div class="ttdeci">@ ENC_OTHER</div><div class="ttdoc">Encoding unknown.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00048">mime.h:48</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_a328973bb86fd341ba82021d540c0cc0b"><div class="ttname"><a href="mutt_2charset_8c.html#a328973bb86fd341ba82021d540c0cc0b">mutt_ch_convert_nonmime_string</a></div><div class="ttdeci">int mutt_ch_convert_nonmime_string(const struct Slist *const assumed_charset, const char *charset, char **ps)</div><div class="ttdoc">Try to convert a string using a list of character sets.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00317">charset.c:317</a></div></div>
<div class="ttc" id="amutt_2slist_8c_html_a4811cefce245ed4de9d8aacd8b4ab43f"><div class="ttname"><a href="mutt_2slist_8c.html#a4811cefce245ed4de9d8aacd8b4ab43f">slist_is_empty</a></div><div class="ttdeci">bool slist_is_empty(const struct Slist *list)</div><div class="ttdoc">Is the slist empty?</div><div class="ttdef"><b>Definition</b> <a href="mutt_2slist_8c_source.html#l00140">slist.c:140</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a64aa5bd37494ee3cbc4285bd06d6c91c"><div class="ttname"><a href="mutt_2string_8c.html#a64aa5bd37494ee3cbc4285bd06d6c91c">mutt_str_lws_len</a></div><div class="ttdeci">size_t mutt_str_lws_len(const char *s, size_t n)</div><div class="ttdoc">Measure the linear-white-space at the beginning of a string.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00630">string.c:630</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a6f574867aa9db4d434adbc8af1f5f7e7"><div class="ttname"><a href="mutt_2string_8c.html#a6f574867aa9db4d434adbc8af1f5f7e7">mutt_strn_equal</a></div><div class="ttdeci">bool mutt_strn_equal(const char *a, const char *b, size_t num)</div><div class="ttdoc">Check for equality of two strings (to a maximum), safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00429">string.c:429</a></div></div>
<div class="ttc" id="arfc2047_8c_html_a7a1b1661d6ad0bbd2c87ed4883d51bf7"><div class="ttname"><a href="#a7a1b1661d6ad0bbd2c87ed4883d51bf7">parse_encoded_word</a></div><div class="ttdeci">static char * parse_encoded_word(char *str, enum ContentEncoding *enc, char **charset, size_t *charsetlen, char **text, size_t *textlen)</div><div class="ttdoc">Parse a string and report RFC2047 elements.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00147">rfc2047.c:147</a></div></div>
<div class="ttc" id="arfc2047_8c_html_ab1018339402895dc4ec81b2afbcaab57"><div class="ttname"><a href="#ab1018339402895dc4ec81b2afbcaab57">decode_word</a></div><div class="ttdeci">static char * decode_word(const char *s, size_t len, enum ContentEncoding enc)</div><div class="ttdoc">Decode an RFC2047-encoded string.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00365">rfc2047.c:365</a></div></div>
<div class="ttc" id="arfc2047_8c_html_afef686b50d1bc6030d76a2c1c5dbb6c4"><div class="ttname"><a href="#afef686b50d1bc6030d76a2c1c5dbb6c4">finalize_chunk</a></div><div class="ttdeci">static void finalize_chunk(struct Buffer *res, struct Buffer *buf, char *charset, size_t charsetlen)</div><div class="ttdoc">Perform charset conversion and filtering.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00341">rfc2047.c:341</a></div></div>
</div><!-- fragment --><div id="dynsection-17" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a89c57c82465740567f73641c9397d760_cgraph.svg" width="696" height="898"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-18" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a89c57c82465740567f73641c9397d760_icgraph.svg" width="851" height="480"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a4f979b4ba087d3291049da868935e005" name="a4f979b4ba087d3291049da868935e005"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f979b4ba087d3291049da868935e005">&#9670;&#160;</a></span>rfc2047_encode_addrlist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rfc2047_encode_addrlist </td>
          <td>(</td>
          <td class="paramtype">struct AddressList *</td>          <td class="paramname"><span class="paramname"><em>al</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>tag</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encode any RFC2047 headers, where required, in an <a class="el" href="structAddress.html" title="An email address.">Address</a> list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">al</td><td>AddressList </td></tr>
    <tr><td class="paramname">tag</td><td>Header tag (used for wrapping calculation)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="#a61043d0660090027414b220222dbf90b" title="RFC-2047-encode a string.">rfc2047_encode()</a> may realloc the data pointer it's given, so work on a copy to avoid breaking the <a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00766">766</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  767</span>{</div>
<div class="line"><span class="lineno">  768</span>  <span class="keywordflow">if</span> (!al)</div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>  <span class="keywordtype">int</span> col = tag ? strlen(tag) + 2 : 32;</div>
<div class="line"><span class="lineno">  772</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structAddress.html">Address</a> *a = NULL;</div>
<div class="line"><span class="lineno">  773</span>  <span class="keywordtype">char</span> *data = NULL;</div>
<div class="line"><span class="lineno">  774</span>  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structSlist.html">Slist</a> *<span class="keyword">const</span> c_send_charset = <a class="code hl_function" href="config_2helpers_8c.html#a72ee0a5d0c0632c4fe911ef5aa6a9b8b">cs_subset_slist</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;send_charset&quot;</span>);</div>
<div class="line"><span class="lineno">  775</span>  <a class="code hl_define" href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a>(a, al, entries)</div>
<div class="line"><span class="lineno">  776</span>  {</div>
<div class="line"><span class="lineno">  777</span>    <span class="keywordflow">if</span> (a-&gt;<a class="code hl_variable" href="structAddress.html#a01b32bc3153d06f852064f1cca3feb61">personal</a>)</div>
<div class="line"><span class="lineno">  778</span>    {</div>
<div class="line"><span class="lineno">  779</span>      data = <a class="code hl_function" href="buffer_8c.html#ad76477cc0c660bc50162393e997233eb">buf_strdup</a>(a-&gt;<a class="code hl_variable" href="structAddress.html#a01b32bc3153d06f852064f1cca3feb61">personal</a>);</div>
<div class="line"><span class="lineno">  780</span>      <a class="code hl_function" href="#a61043d0660090027414b220222dbf90b">rfc2047_encode</a>(&amp;data, <a class="code hl_variable" href="address_2address_8c.html#a930029e50328c7a0b48e302ef87fe023">AddressSpecials</a>, col, c_send_charset);</div>
<div class="line"><span class="lineno">  781</span>      <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(a-&gt;<a class="code hl_variable" href="structAddress.html#a01b32bc3153d06f852064f1cca3feb61">personal</a>, data);</div>
<div class="line"><span class="lineno">  782</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;data);</div>
<div class="line"><span class="lineno">  783</span>    }</div>
<div class="line"><span class="lineno">  784</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a-&gt;<a class="code hl_variable" href="structAddress.html#a12bd44ccc016e50c674ec3a902ba1c28">group</a> &amp;&amp; a-&gt;<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>)</div>
<div class="line"><span class="lineno">  785</span>    {</div>
<div class="line"><span class="lineno">  786</span>      data = <a class="code hl_function" href="buffer_8c.html#ad76477cc0c660bc50162393e997233eb">buf_strdup</a>(a-&gt;<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>);</div>
<div class="line"><span class="lineno">  787</span>      <a class="code hl_function" href="#a61043d0660090027414b220222dbf90b">rfc2047_encode</a>(&amp;data, <a class="code hl_variable" href="address_2address_8c.html#a930029e50328c7a0b48e302ef87fe023">AddressSpecials</a>, col, c_send_charset);</div>
<div class="line"><span class="lineno">  788</span>      <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(a-&gt;<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>, data);</div>
<div class="line"><span class="lineno">  789</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;data);</div>
<div class="line"><span class="lineno">  790</span>    }</div>
<div class="line"><span class="lineno">  791</span>  }</div>
<div class="line"><span class="lineno">  792</span>}</div>
<div class="ttc" id="aaddress_2address_8c_html_a930029e50328c7a0b48e302ef87fe023"><div class="ttname"><a href="address_2address_8c.html#a930029e50328c7a0b48e302ef87fe023">AddressSpecials</a></div><div class="ttdeci">const char AddressSpecials[]</div><div class="ttdoc">Characters with special meaning for email addresses.</div><div class="ttdef"><b>Definition</b> <a href="address_2address_8c_source.html#l00045">address.c:45</a></div></div>
<div class="ttc" id="abuffer_8c_html_ac958acbd189e463a2c3bbc2f23aaeb1e"><div class="ttname"><a href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a></div><div class="ttdeci">size_t buf_strcpy(struct Buffer *buf, const char *s)</div><div class="ttdoc">Copy a string into a Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00395">buffer.c:395</a></div></div>
<div class="ttc" id="aconfig_2helpers_8c_html_a72ee0a5d0c0632c4fe911ef5aa6a9b8b"><div class="ttname"><a href="config_2helpers_8c.html#a72ee0a5d0c0632c4fe911ef5aa6a9b8b">cs_subset_slist</a></div><div class="ttdeci">const struct Slist * cs_subset_slist(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string-list config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00242">helpers.c:242</a></div></div>
<div class="ttc" id="aqueue_8h_html_a16e5fc168e7f3494d4b1df54447d871e"><div class="ttname"><a href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a></div><div class="ttdeci">#define TAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00782">queue.h:782</a></div></div>
<div class="ttc" id="arfc2047_8c_html_a61043d0660090027414b220222dbf90b"><div class="ttname"><a href="#a61043d0660090027414b220222dbf90b">rfc2047_encode</a></div><div class="ttdeci">void rfc2047_encode(char **pd, const char *specials, int col, const struct Slist *charsets)</div><div class="ttdoc">RFC-2047-encode a string.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00628">rfc2047.c:628</a></div></div>
<div class="ttc" id="astructAddress_html"><div class="ttname"><a href="structAddress.html">Address</a></div><div class="ttdoc">An email address.</div><div class="ttdef"><b>Definition</b> <a href="address_8h_source.html#l00034">address.h:35</a></div></div>
<div class="ttc" id="astructAddress_html_a01b32bc3153d06f852064f1cca3feb61"><div class="ttname"><a href="structAddress.html#a01b32bc3153d06f852064f1cca3feb61">Address::personal</a></div><div class="ttdeci">struct Buffer * personal</div><div class="ttdoc">Real name of address.</div><div class="ttdef"><b>Definition</b> <a href="address_8h_source.html#l00036">address.h:36</a></div></div>
<div class="ttc" id="astructAddress_html_a12bd44ccc016e50c674ec3a902ba1c28"><div class="ttname"><a href="structAddress.html#a12bd44ccc016e50c674ec3a902ba1c28">Address::group</a></div><div class="ttdeci">bool group</div><div class="ttdoc">Group mailbox?</div><div class="ttdef"><b>Definition</b> <a href="address_8h_source.html#l00038">address.h:38</a></div></div>
<div class="ttc" id="astructAddress_html_a45cd47ee76ef04b63f55a0345c691fe8"><div class="ttname"><a href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">Address::mailbox</a></div><div class="ttdeci">struct Buffer * mailbox</div><div class="ttdoc">Mailbox and host address.</div><div class="ttdef"><b>Definition</b> <a href="address_8h_source.html#l00037">address.h:37</a></div></div>
<div class="ttc" id="astructNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00042">neomutt.h:43</a></div></div>
<div class="ttc" id="astructNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00047">neomutt.h:47</a></div></div>
</div><!-- fragment --><div id="dynsection-19" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a4f979b4ba087d3291049da868935e005_cgraph.svg" width="356" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-20" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a4f979b4ba087d3291049da868935e005_icgraph.svg" width="420" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac7aa3c6d84c8eaa435d161cc2c227b88" name="ac7aa3c6d84c8eaa435d161cc2c227b88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7aa3c6d84c8eaa435d161cc2c227b88">&#9670;&#160;</a></span>rfc2047_decode_addrlist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rfc2047_decode_addrlist </td>
          <td>(</td>
          <td class="paramtype">struct AddressList *</td>          <td class="paramname"><span class="paramname"><em>al</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode any RFC2047 headers in an <a class="el" href="structAddress.html" title="An email address.">Address</a> list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">al</td><td>AddressList</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="#a89c57c82465740567f73641c9397d760" title="Decode any RFC2047-encoded header fields.">rfc2047_decode()</a> may realloc the data pointer it's given, so work on a copy to avoid breaking the <a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00801">801</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  802</span>{</div>
<div class="line"><span class="lineno">  803</span>  <span class="keywordflow">if</span> (!al)</div>
<div class="line"><span class="lineno">  804</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  805</span> </div>
<div class="line"><span class="lineno">  806</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> assumed = !<a class="code hl_function" href="mutt_2slist_8c.html#a4811cefce245ed4de9d8aacd8b4ab43f">slist_is_empty</a>(<a class="code hl_function" href="config__cache_8c.html#addc06d02c91cce26bfe7c3692ddf0046">cc_assumed_charset</a>());</div>
<div class="line"><span class="lineno">  807</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structAddress.html">Address</a> *a = NULL;</div>
<div class="line"><span class="lineno">  808</span>  <span class="keywordtype">char</span> *data = NULL;</div>
<div class="line"><span class="lineno">  809</span>  <a class="code hl_define" href="queue_8h.html#a16e5fc168e7f3494d4b1df54447d871e">TAILQ_FOREACH</a>(a, al, entries)</div>
<div class="line"><span class="lineno">  810</span>  {</div>
<div class="line"><span class="lineno">  811</span>    <span class="keywordflow">if</span> (a-&gt;<a class="code hl_variable" href="structAddress.html#a01b32bc3153d06f852064f1cca3feb61">personal</a> &amp;&amp; ((<a class="code hl_function" href="buffer_8c.html#a3736b0ddabdd7bb69313bd475cac9a97">buf_find_string</a>(a-&gt;<a class="code hl_variable" href="structAddress.html#a01b32bc3153d06f852064f1cca3feb61">personal</a>, <span class="stringliteral">&quot;=?&quot;</span>)) || assumed))</div>
<div class="line"><span class="lineno">  812</span>    {</div>
<div class="line"><span class="lineno">  813</span>      data = <a class="code hl_function" href="buffer_8c.html#ad76477cc0c660bc50162393e997233eb">buf_strdup</a>(a-&gt;<a class="code hl_variable" href="structAddress.html#a01b32bc3153d06f852064f1cca3feb61">personal</a>);</div>
<div class="line"><span class="lineno">  814</span>      <a class="code hl_function" href="#a89c57c82465740567f73641c9397d760">rfc2047_decode</a>(&amp;data);</div>
<div class="line"><span class="lineno">  815</span>      <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(a-&gt;<a class="code hl_variable" href="structAddress.html#a01b32bc3153d06f852064f1cca3feb61">personal</a>, data);</div>
<div class="line"><span class="lineno">  816</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;data);</div>
<div class="line"><span class="lineno">  817</span>    }</div>
<div class="line"><span class="lineno">  818</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (a-&gt;<a class="code hl_variable" href="structAddress.html#a12bd44ccc016e50c674ec3a902ba1c28">group</a> &amp;&amp; a-&gt;<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a> &amp;&amp; <a class="code hl_function" href="buffer_8c.html#a3736b0ddabdd7bb69313bd475cac9a97">buf_find_string</a>(a-&gt;<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>, <span class="stringliteral">&quot;=?&quot;</span>))</div>
<div class="line"><span class="lineno">  819</span>    {</div>
<div class="line"><span class="lineno">  820</span>      data = <a class="code hl_function" href="buffer_8c.html#ad76477cc0c660bc50162393e997233eb">buf_strdup</a>(a-&gt;<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>);</div>
<div class="line"><span class="lineno">  821</span>      <a class="code hl_function" href="#a89c57c82465740567f73641c9397d760">rfc2047_decode</a>(&amp;data);</div>
<div class="line"><span class="lineno">  822</span>      <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(a-&gt;<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>, data);</div>
<div class="line"><span class="lineno">  823</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;data);</div>
<div class="line"><span class="lineno">  824</span>    }</div>
<div class="line"><span class="lineno">  825</span>  }</div>
<div class="line"><span class="lineno">  826</span>}</div>
<div class="ttc" id="abuffer_8c_html_a3736b0ddabdd7bb69313bd475cac9a97"><div class="ttname"><a href="buffer_8c.html#a3736b0ddabdd7bb69313bd475cac9a97">buf_find_string</a></div><div class="ttdeci">const char * buf_find_string(const struct Buffer *buf, const char *s)</div><div class="ttdoc">Return a pointer to a substring found in the buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00638">buffer.c:638</a></div></div>
<div class="ttc" id="arfc2047_8c_html_a89c57c82465740567f73641c9397d760"><div class="ttname"><a href="#a89c57c82465740567f73641c9397d760">rfc2047_decode</a></div><div class="ttdeci">void rfc2047_decode(char **pd)</div><div class="ttdoc">Decode any RFC2047-encoded header fields.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00661">rfc2047.c:661</a></div></div>
</div><!-- fragment --><div id="dynsection-21" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_ac7aa3c6d84c8eaa435d161cc2c227b88_cgraph.svg" width="550" height="276"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-22" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_ac7aa3c6d84c8eaa435d161cc2c227b88_icgraph.svg" width="420" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a79026f5cfec0b561058f7021e19b9601" name="a79026f5cfec0b561058f7021e19b9601"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79026f5cfec0b561058f7021e19b9601">&#9670;&#160;</a></span>rfc2047_decode_envelope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rfc2047_decode_envelope </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEnvelope.html">Envelope</a> *</td>          <td class="paramname"><span class="paramname"><em>env</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode the fields of an <a class="el" href="structEnvelope.html" title="The header of an Email.">Envelope</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">env</td><td><a class="el" href="structEnvelope.html" title="The header of an Email.">Envelope</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00832">832</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  833</span>{</div>
<div class="line"><span class="lineno">  834</span>  <span class="keywordflow">if</span> (!env)</div>
<div class="line"><span class="lineno">  835</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  836</span>  <a class="code hl_function" href="#ac7aa3c6d84c8eaa435d161cc2c227b88">rfc2047_decode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div>
<div class="line"><span class="lineno">  837</span>  <a class="code hl_function" href="#ac7aa3c6d84c8eaa435d161cc2c227b88">rfc2047_decode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>);</div>
<div class="line"><span class="lineno">  838</span>  <a class="code hl_function" href="#ac7aa3c6d84c8eaa435d161cc2c227b88">rfc2047_decode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>);</div>
<div class="line"><span class="lineno">  839</span>  <a class="code hl_function" href="#ac7aa3c6d84c8eaa435d161cc2c227b88">rfc2047_decode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">bcc</a>);</div>
<div class="line"><span class="lineno">  840</span>  <a class="code hl_function" href="#ac7aa3c6d84c8eaa435d161cc2c227b88">rfc2047_decode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>);</div>
<div class="line"><span class="lineno">  841</span>  <a class="code hl_function" href="#ac7aa3c6d84c8eaa435d161cc2c227b88">rfc2047_decode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>);</div>
<div class="line"><span class="lineno">  842</span>  <a class="code hl_function" href="#ac7aa3c6d84c8eaa435d161cc2c227b88">rfc2047_decode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a1c204b091d782098fc1efa0c2f3b1e20">return_path</a>);</div>
<div class="line"><span class="lineno">  843</span>  <a class="code hl_function" href="#ac7aa3c6d84c8eaa435d161cc2c227b88">rfc2047_decode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>);</div>
<div class="line"><span class="lineno">  844</span>  <a class="code hl_function" href="#a89c57c82465740567f73641c9397d760">rfc2047_decode</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#ac7bed8a507227756030c035a7aad198e">x_label</a>);</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>  <span class="keywordtype">char</span> *subj = env-&gt;<a class="code hl_variable" href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">subject</a>;</div>
<div class="line"><span class="lineno">  847</span>  *(<span class="keywordtype">char</span> **) &amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">subject</a> = NULL;</div>
<div class="line"><span class="lineno">  848</span>  <a class="code hl_function" href="#a89c57c82465740567f73641c9397d760">rfc2047_decode</a>(&amp;subj);</div>
<div class="line"><span class="lineno">  849</span>  <a class="code hl_function" href="envelope_8c.html#a91c00f700ee3ca43aa33487591b0d317">mutt_env_set_subject</a>(env, subj);</div>
<div class="line"><span class="lineno">  850</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;subj);</div>
<div class="line"><span class="lineno">  851</span>}</div>
<div class="ttc" id="aenvelope_8c_html_a91c00f700ee3ca43aa33487591b0d317"><div class="ttname"><a href="envelope_8c.html#a91c00f700ee3ca43aa33487591b0d317">mutt_env_set_subject</a></div><div class="ttdeci">void mutt_env_set_subject(struct Envelope *env, const char *subj)</div><div class="ttdoc">Set both subject and real_subj to subj.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8c_source.html#l00068">envelope.c:68</a></div></div>
<div class="ttc" id="arfc2047_8c_html_ac7aa3c6d84c8eaa435d161cc2c227b88"><div class="ttname"><a href="#ac7aa3c6d84c8eaa435d161cc2c227b88">rfc2047_decode_addrlist</a></div><div class="ttdeci">void rfc2047_decode_addrlist(struct AddressList *al)</div><div class="ttdoc">Decode any RFC2047 headers in an Address list.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00801">rfc2047.c:801</a></div></div>
<div class="ttc" id="astructEnvelope_html_a1c204b091d782098fc1efa0c2f3b1e20"><div class="ttname"><a href="structEnvelope.html#a1c204b091d782098fc1efa0c2f3b1e20">Envelope::return_path</a></div><div class="ttdeci">struct AddressList return_path</div><div class="ttdoc">Return path for the Email.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00058">envelope.h:58</a></div></div>
<div class="ttc" id="astructEnvelope_html_a20d5ccf675db375e011a7791151fa09d"><div class="ttname"><a href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">Envelope::subject</a></div><div class="ttdeci">char *const subject</div><div class="ttdoc">Email&#39;s subject.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00070">envelope.h:70</a></div></div>
<div class="ttc" id="astructEnvelope_html_a2d927371b3b80e025d6f7522b7361fe7"><div class="ttname"><a href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">Envelope::to</a></div><div class="ttdeci">struct AddressList to</div><div class="ttdoc">Email&#39;s &#39;To&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00060">envelope.h:60</a></div></div>
<div class="ttc" id="astructEnvelope_html_a4b75ab1853f95878dec079371bb0d799"><div class="ttname"><a href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">Envelope::reply_to</a></div><div class="ttdeci">struct AddressList reply_to</div><div class="ttdoc">Email&#39;s &#39;reply-to&#39;.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00064">envelope.h:64</a></div></div>
<div class="ttc" id="astructEnvelope_html_a6044b60220b8029a6a505e5b61f1cadc"><div class="ttname"><a href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">Envelope::mail_followup_to</a></div><div class="ttdeci">struct AddressList mail_followup_to</div><div class="ttdoc">Email&#39;s &#39;mail-followup-to&#39;.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00065">envelope.h:65</a></div></div>
<div class="ttc" id="astructEnvelope_html_a6b00837b3cb4b41898b42307135be8b6"><div class="ttname"><a href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">Envelope::cc</a></div><div class="ttdeci">struct AddressList cc</div><div class="ttdoc">Email&#39;s &#39;Cc&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00061">envelope.h:61</a></div></div>
<div class="ttc" id="astructEnvelope_html_a72ee5c0af4f94f83aeb8d31183261611"><div class="ttname"><a href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">Envelope::sender</a></div><div class="ttdeci">struct AddressList sender</div><div class="ttdoc">Email&#39;s sender.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00063">envelope.h:63</a></div></div>
<div class="ttc" id="astructEnvelope_html_aad427832f4ae422f1b16d0896c1d3af6"><div class="ttname"><a href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">Envelope::bcc</a></div><div class="ttdeci">struct AddressList bcc</div><div class="ttdoc">Email&#39;s &#39;Bcc&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00062">envelope.h:62</a></div></div>
<div class="ttc" id="astructEnvelope_html_ac7bed8a507227756030c035a7aad198e"><div class="ttname"><a href="structEnvelope.html#ac7bed8a507227756030c035a7aad198e">Envelope::x_label</a></div><div class="ttdeci">char * x_label</div><div class="ttdoc">X-Label.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00076">envelope.h:76</a></div></div>
<div class="ttc" id="astructEnvelope_html_af1aa00aed4b8767cf98f08e45a432ad8"><div class="ttname"><a href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">Envelope::from</a></div><div class="ttdeci">struct AddressList from</div><div class="ttdoc">Email&#39;s &#39;From&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00059">envelope.h:59</a></div></div>
</div><!-- fragment --><div id="dynsection-23" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a79026f5cfec0b561058f7021e19b9601_cgraph.svg" width="590" height="144"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-24" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_a79026f5cfec0b561058f7021e19b9601_icgraph.svg" width="432" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aceeb3a044de1c06a649af033af856486" name="aceeb3a044de1c06a649af033af856486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceeb3a044de1c06a649af033af856486">&#9670;&#160;</a></span>rfc2047_encode_envelope()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rfc2047_encode_envelope </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEnvelope.html">Envelope</a> *</td>          <td class="paramname"><span class="paramname"><em>env</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encode the fields of an <a class="el" href="structEnvelope.html" title="The header of an Email.">Envelope</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">env</td><td><a class="el" href="structEnvelope.html" title="The header of an Email.">Envelope</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="rfc2047_8c_source.html#l00857">857</a> of file <a class="el" href="rfc2047_8c_source.html">rfc2047.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  858</span>{</div>
<div class="line"><span class="lineno">  859</span>  <span class="keywordflow">if</span> (!env)</div>
<div class="line"><span class="lineno">  860</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  861</span>  <a class="code hl_function" href="#a4f979b4ba087d3291049da868935e005">rfc2047_encode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, <span class="stringliteral">&quot;From&quot;</span>);</div>
<div class="line"><span class="lineno">  862</span>  <a class="code hl_function" href="#a4f979b4ba087d3291049da868935e005">rfc2047_encode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, <span class="stringliteral">&quot;To&quot;</span>);</div>
<div class="line"><span class="lineno">  863</span>  <a class="code hl_function" href="#a4f979b4ba087d3291049da868935e005">rfc2047_encode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, <span class="stringliteral">&quot;Cc&quot;</span>);</div>
<div class="line"><span class="lineno">  864</span>  <a class="code hl_function" href="#a4f979b4ba087d3291049da868935e005">rfc2047_encode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">bcc</a>, <span class="stringliteral">&quot;Bcc&quot;</span>);</div>
<div class="line"><span class="lineno">  865</span>  <a class="code hl_function" href="#a4f979b4ba087d3291049da868935e005">rfc2047_encode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>, <span class="stringliteral">&quot;Reply-To&quot;</span>);</div>
<div class="line"><span class="lineno">  866</span>  <a class="code hl_function" href="#a4f979b4ba087d3291049da868935e005">rfc2047_encode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>, <span class="stringliteral">&quot;Mail-Followup-To&quot;</span>);</div>
<div class="line"><span class="lineno">  867</span>  <a class="code hl_function" href="#a4f979b4ba087d3291049da868935e005">rfc2047_encode_addrlist</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>, <span class="stringliteral">&quot;Sender&quot;</span>);</div>
<div class="line"><span class="lineno">  868</span>  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structSlist.html">Slist</a> *<span class="keyword">const</span> c_send_charset = <a class="code hl_function" href="config_2helpers_8c.html#a72ee0a5d0c0632c4fe911ef5aa6a9b8b">cs_subset_slist</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;send_charset&quot;</span>);</div>
<div class="line"><span class="lineno">  869</span>  <a class="code hl_function" href="#a61043d0660090027414b220222dbf90b">rfc2047_encode</a>(&amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#ac7bed8a507227756030c035a7aad198e">x_label</a>, NULL, <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;X-Label:&quot;</span>), c_send_charset);</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>  <span class="keywordtype">char</span> *subj = env-&gt;<a class="code hl_variable" href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">subject</a>;</div>
<div class="line"><span class="lineno">  872</span>  *(<span class="keywordtype">char</span> **) &amp;env-&gt;<a class="code hl_variable" href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">subject</a> = NULL;</div>
<div class="line"><span class="lineno">  873</span>  <a class="code hl_function" href="#a61043d0660090027414b220222dbf90b">rfc2047_encode</a>(&amp;subj, NULL, <span class="keyword">sizeof</span>(<span class="stringliteral">&quot;Subject:&quot;</span>), c_send_charset);</div>
<div class="line"><span class="lineno">  874</span>  <a class="code hl_function" href="envelope_8c.html#a91c00f700ee3ca43aa33487591b0d317">mutt_env_set_subject</a>(env, subj);</div>
<div class="line"><span class="lineno">  875</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;subj);</div>
<div class="line"><span class="lineno">  876</span>}</div>
<div class="ttc" id="arfc2047_8c_html_a4f979b4ba087d3291049da868935e005"><div class="ttname"><a href="#a4f979b4ba087d3291049da868935e005">rfc2047_encode_addrlist</a></div><div class="ttdeci">void rfc2047_encode_addrlist(struct AddressList *al, const char *tag)</div><div class="ttdoc">Encode any RFC2047 headers, where required, in an Address list.</div><div class="ttdef"><b>Definition</b> <a href="rfc2047_8c_source.html#l00766">rfc2047.c:766</a></div></div>
</div><!-- fragment --><div id="dynsection-25" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_aceeb3a044de1c06a649af033af856486_cgraph.svg" width="590" height="140"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-26" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="rfc2047_8c_aceeb3a044de1c06a649af033af856486_icgraph.svg" width="416" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
