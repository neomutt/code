<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: attach/mutt_attach.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><a href="https://neomutt.org"><img alt="Logo" src="neomutt-64.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <a style="color: black; text-decoration: none;" href="https://neomutt.org">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">2025-09-05-53-g1e05a3</span>
   </div>
   <div id="projectbrief">Teaching an old dog new tricks</div>
   </a>
   <a href="https://github.com/neomutt/neomutt" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000000; color:#fff; position: fixed; top: 0; border: 0; right: 0; z-index: 9999;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </td>
   <td><a style="text-decoration: none; position: absolute; right: 0; top: 25px; margin-right: 100px; color: #66d866; font-size: 400%;" href="http://www.doxygen.org/index.html">DOXYGEN</a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('mutt__attach_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mutt_attach.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Handling of email attachments.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &quot;<a class="el" href="mutt_2lib_8h_source.html">mutt/lib.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for mutt_attach.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h__incl.svg" width="286" height="119"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h__dep__incl.svg" width="586" height="196"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="mutt__attach_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a5dd95d385576ba1b957d7e9c523ec946" id="r_a5dd95d385576ba1b957d7e9c523ec946"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5dd95d385576ba1b957d7e9c523ec946">ViewAttachMode</a> { <a class="el" href="#a5dd95d385576ba1b957d7e9c523ec946a805f2934d475a513bb1294baa8e5d00b">MUTT_VA_REGULAR</a> = 1
, <a class="el" href="#a5dd95d385576ba1b957d7e9c523ec946a0dcfd8a67792775ae3506d2a99bf1b67">MUTT_VA_MAILCAP</a>
, <a class="el" href="#a5dd95d385576ba1b957d7e9c523ec946ae2885fe7d47c03a1f0246d054739da79">MUTT_VA_AS_TEXT</a>
, <a class="el" href="#a5dd95d385576ba1b957d7e9c523ec946ab4f9fd68dbd70c2bd8f4e3795bed15cc">MUTT_VA_PAGER</a>
 }</td></tr>
<tr class="memdesc:a5dd95d385576ba1b957d7e9c523ec946"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for <a class="el" href="#ab2e07f4628b9c8e41529a62c27d1b51a" title="View an attachment.">mutt_view_attachment()</a>  <a href="#a5dd95d385576ba1b957d7e9c523ec946">More...</a><br /></td></tr>
<tr class="separator:a5dd95d385576ba1b957d7e9c523ec946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5675c7a41890711ec4871b592c840faa" id="r_a5675c7a41890711ec4871b592c840faa"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5675c7a41890711ec4871b592c840faa">SaveAttach</a> { <a class="el" href="#a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224">MUTT_SAVE_NO_FLAGS</a> = 0
, <a class="el" href="#a5675c7a41890711ec4871b592c840faaa3f82d6dcb02891511fe91907b398aa1c">MUTT_SAVE_APPEND</a>
 }</td></tr>
<tr class="memdesc:a5675c7a41890711ec4871b592c840faa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options for saving attachments.  <a href="#a5675c7a41890711ec4871b592c840faa">More...</a><br /></td></tr>
<tr class="separator:a5675c7a41890711ec4871b592c840faa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a72c9e19b893d8d4afc5593d9d2b399ff" id="r_a72c9e19b893d8d4afc5593d9d2b399ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a72c9e19b893d8d4afc5593d9d2b399ff">mutt_attach_display_loop</a> (struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *sub, struct <a class="el" href="structMenu.html">Menu</a> *menu, int op, struct <a class="el" href="structEmail.html">Email</a> *e, struct <a class="el" href="structAttachCtx.html">AttachCtx</a> *actx, bool recv)</td></tr>
<tr class="memdesc:a72c9e19b893d8d4afc5593d9d2b399ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Event loop for the Attachment menu.  <br /></td></tr>
<tr class="separator:a72c9e19b893d8d4afc5593d9d2b399ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a588a5719b699c5d062f263711598836e" id="r_a588a5719b699c5d062f263711598836e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a588a5719b699c5d062f263711598836e">mutt_save_attachment_list</a> (struct <a class="el" href="structAttachCtx.html">AttachCtx</a> *actx, FILE *fp, bool tag, struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structEmail.html">Email</a> *e, struct <a class="el" href="structMenu.html">Menu</a> *menu)</td></tr>
<tr class="memdesc:a588a5719b699c5d062f263711598836e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save a list of attachments.  <br /></td></tr>
<tr class="separator:a588a5719b699c5d062f263711598836e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a864d3327398fde25536c45736abde530" id="r_a864d3327398fde25536c45736abde530"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a864d3327398fde25536c45736abde530">mutt_pipe_attachment_list</a> (struct <a class="el" href="structAttachCtx.html">AttachCtx</a> *actx, FILE *fp, bool tag, struct <a class="el" href="structBody.html">Body</a> *b, bool filter)</td></tr>
<tr class="memdesc:a864d3327398fde25536c45736abde530"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pipe a list of attachments to a command.  <br /></td></tr>
<tr class="separator:a864d3327398fde25536c45736abde530"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac869ec7f92735053d33d3143d9866af5" id="r_ac869ec7f92735053d33d3143d9866af5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac869ec7f92735053d33d3143d9866af5">mutt_print_attachment_list</a> (struct <a class="el" href="structAttachCtx.html">AttachCtx</a> *actx, FILE *fp, bool tag, struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:ac869ec7f92735053d33d3143d9866af5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print a list of Attachments.  <br /></td></tr>
<tr class="separator:ac869ec7f92735053d33d3143d9866af5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2e07f4628b9c8e41529a62c27d1b51a" id="r_ab2e07f4628b9c8e41529a62c27d1b51a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2e07f4628b9c8e41529a62c27d1b51a">mutt_view_attachment</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b, enum <a class="el" href="#a5dd95d385576ba1b957d7e9c523ec946">ViewAttachMode</a> mode, struct <a class="el" href="structEmail.html">Email</a> *e, struct <a class="el" href="structAttachCtx.html">AttachCtx</a> *actx, struct <a class="el" href="structMuttWindow.html">MuttWindow</a> *win)</td></tr>
<tr class="memdesc:ab2e07f4628b9c8e41529a62c27d1b51a"><td class="mdescLeft">&#160;</td><td class="mdescRight">View an attachment.  <br /></td></tr>
<tr class="separator:ab2e07f4628b9c8e41529a62c27d1b51a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a97d711180c816108d8866ef7b120cc" id="r_a1a97d711180c816108d8866ef7b120cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a97d711180c816108d8866ef7b120cc">mutt_check_lookup_list</a> (struct <a class="el" href="structBody.html">Body</a> *b, char *type, size_t len)</td></tr>
<tr class="memdesc:a1a97d711180c816108d8866ef7b120cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the mime type.  <br /></td></tr>
<tr class="separator:a1a97d711180c816108d8866ef7b120cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a492006c267947f1d6466f2c32f17aa55" id="r_a492006c267947f1d6466f2c32f17aa55"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a492006c267947f1d6466f2c32f17aa55">mutt_compose_attachment</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a492006c267947f1d6466f2c32f17aa55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an attachment.  <br /></td></tr>
<tr class="separator:a492006c267947f1d6466f2c32f17aa55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac29548ca4501311138dfa43db788bd3" id="r_aac29548ca4501311138dfa43db788bd3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aac29548ca4501311138dfa43db788bd3">mutt_decode_save_attachment</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b, const char *path, <a class="el" href="mutt_2state_8h.html#ad4dd18eb8ded2d275901494289ac3986">StateFlags</a> flags, enum <a class="el" href="#a5675c7a41890711ec4871b592c840faa">SaveAttach</a> opt)</td></tr>
<tr class="memdesc:aac29548ca4501311138dfa43db788bd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decode, then save an attachment.  <br /></td></tr>
<tr class="separator:aac29548ca4501311138dfa43db788bd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b2292184984705d60be088b9dbbecfb" id="r_a0b2292184984705d60be088b9dbbecfb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b2292184984705d60be088b9dbbecfb">mutt_edit_attachment</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a0b2292184984705d60be088b9dbbecfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Edit an attachment.  <br /></td></tr>
<tr class="separator:a0b2292184984705d60be088b9dbbecfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27dfd377ebe2a1b6f3cff2b1acae472d" id="r_a27dfd377ebe2a1b6f3cff2b1acae472d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a27dfd377ebe2a1b6f3cff2b1acae472d">mutt_get_tmp_attachment</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a27dfd377ebe2a1b6f3cff2b1acae472d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a temporary copy of an attachment.  <br /></td></tr>
<tr class="separator:a27dfd377ebe2a1b6f3cff2b1acae472d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3451eb5c8c560a23713547182d1dc9ce" id="r_a3451eb5c8c560a23713547182d1dc9ce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3451eb5c8c560a23713547182d1dc9ce">mutt_pipe_attachment</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b, const char *path, const char *outfile)</td></tr>
<tr class="memdesc:a3451eb5c8c560a23713547182d1dc9ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pipe an attachment to a command.  <br /></td></tr>
<tr class="separator:a3451eb5c8c560a23713547182d1dc9ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0daefbc4f9a1ba1179aa5f2ff9e537c" id="r_ac0daefbc4f9a1ba1179aa5f2ff9e537c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac0daefbc4f9a1ba1179aa5f2ff9e537c">mutt_print_attachment</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:ac0daefbc4f9a1ba1179aa5f2ff9e537c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print out an attachment.  <br /></td></tr>
<tr class="separator:ac0daefbc4f9a1ba1179aa5f2ff9e537c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87e1ea8a7b0c926e02ed3db8b7d3dbd5" id="r_a87e1ea8a7b0c926e02ed3db8b7d3dbd5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a87e1ea8a7b0c926e02ed3db8b7d3dbd5">mutt_save_attachment</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b, const char *path, enum <a class="el" href="#a5675c7a41890711ec4871b592c840faa">SaveAttach</a> opt, struct <a class="el" href="structEmail.html">Email</a> *e)</td></tr>
<tr class="memdesc:a87e1ea8a7b0c926e02ed3db8b7d3dbd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save an attachment.  <br /></td></tr>
<tr class="separator:a87e1ea8a7b0c926e02ed3db8b7d3dbd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc6c49a75e5a6fce41d18c1d95a45948" id="r_acc6c49a75e5a6fce41d18c1d95a45948"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc6c49a75e5a6fce41d18c1d95a45948">mutt_add_temp_attachment</a> (const char *filename)</td></tr>
<tr class="memdesc:acc6c49a75e5a6fce41d18c1d95a45948"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add file to list of temporary attachments.  <br /></td></tr>
<tr class="separator:acc6c49a75e5a6fce41d18c1d95a45948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6276b87d132d5b4e7590eb3d9265c0f8" id="r_a6276b87d132d5b4e7590eb3d9265c0f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6276b87d132d5b4e7590eb3d9265c0f8">mutt_temp_attachments_cleanup</a> (void)</td></tr>
<tr class="memdesc:a6276b87d132d5b4e7590eb3d9265c0f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete all temporary attachments.  <br /></td></tr>
<tr class="separator:a6276b87d132d5b4e7590eb3d9265c0f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Handling of email attachments. </p>
<dl class="section author"><dt>Authors</dt><dd><ul>
<li>Richard Russon</li>
</ul>
</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 2 of the License, or (at your option) any later version.</dd></dl>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>

<p class="definition">Definition in file <a class="el" href="mutt__attach_8h_source.html">mutt_attach.h</a>.</p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a5dd95d385576ba1b957d7e9c523ec946" name="a5dd95d385576ba1b957d7e9c523ec946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dd95d385576ba1b957d7e9c523ec946">&#9670;&#160;</a></span>ViewAttachMode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a5dd95d385576ba1b957d7e9c523ec946">ViewAttachMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Options for <a class="el" href="#ab2e07f4628b9c8e41529a62c27d1b51a" title="View an attachment.">mutt_view_attachment()</a> </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a5dd95d385576ba1b957d7e9c523ec946a805f2934d475a513bb1294baa8e5d00b" name="a5dd95d385576ba1b957d7e9c523ec946a805f2934d475a513bb1294baa8e5d00b"></a>MUTT_VA_REGULAR&#160;</td><td class="fielddoc"><p>View using default method. </p>
</td></tr>
<tr><td class="fieldname"><a id="a5dd95d385576ba1b957d7e9c523ec946a0dcfd8a67792775ae3506d2a99bf1b67" name="a5dd95d385576ba1b957d7e9c523ec946a0dcfd8a67792775ae3506d2a99bf1b67"></a>MUTT_VA_MAILCAP&#160;</td><td class="fielddoc"><p>Force viewing using mailcap entry. </p>
</td></tr>
<tr><td class="fieldname"><a id="a5dd95d385576ba1b957d7e9c523ec946ae2885fe7d47c03a1f0246d054739da79" name="a5dd95d385576ba1b957d7e9c523ec946ae2885fe7d47c03a1f0246d054739da79"></a>MUTT_VA_AS_TEXT&#160;</td><td class="fielddoc"><p>Force viewing as text. </p>
</td></tr>
<tr><td class="fieldname"><a id="a5dd95d385576ba1b957d7e9c523ec946ab4f9fd68dbd70c2bd8f4e3795bed15cc" name="a5dd95d385576ba1b957d7e9c523ec946ab4f9fd68dbd70c2bd8f4e3795bed15cc"></a>MUTT_VA_PAGER&#160;</td><td class="fielddoc"><p>View attachment in pager using copiousoutput mailcap. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8h_source.html#l00042">42</a> of file <a class="el" href="mutt__attach_8h_source.html">mutt_attach.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   43</span>{</div>
<div class="line"><span class="lineno">   44</span>  <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946a805f2934d475a513bb1294baa8e5d00b">MUTT_VA_REGULAR</a> = 1, </div>
<div class="line"><span class="lineno">   45</span>  <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946a0dcfd8a67792775ae3506d2a99bf1b67">MUTT_VA_MAILCAP</a>,     </div>
<div class="line"><span class="lineno">   46</span>  <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946ae2885fe7d47c03a1f0246d054739da79">MUTT_VA_AS_TEXT</a>,     </div>
<div class="line"><span class="lineno">   47</span>  <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946ab4f9fd68dbd70c2bd8f4e3795bed15cc">MUTT_VA_PAGER</a>,       </div>
<div class="line"><span class="lineno">   48</span>};</div>
<div class="ttc" id="amutt__attach_8h_html_a5dd95d385576ba1b957d7e9c523ec946a0dcfd8a67792775ae3506d2a99bf1b67"><div class="ttname"><a href="#a5dd95d385576ba1b957d7e9c523ec946a0dcfd8a67792775ae3506d2a99bf1b67">MUTT_VA_MAILCAP</a></div><div class="ttdeci">@ MUTT_VA_MAILCAP</div><div class="ttdoc">Force viewing using mailcap entry.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8h_source.html#l00045">mutt_attach.h:45</a></div></div>
<div class="ttc" id="amutt__attach_8h_html_a5dd95d385576ba1b957d7e9c523ec946a805f2934d475a513bb1294baa8e5d00b"><div class="ttname"><a href="#a5dd95d385576ba1b957d7e9c523ec946a805f2934d475a513bb1294baa8e5d00b">MUTT_VA_REGULAR</a></div><div class="ttdeci">@ MUTT_VA_REGULAR</div><div class="ttdoc">View using default method.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8h_source.html#l00044">mutt_attach.h:44</a></div></div>
<div class="ttc" id="amutt__attach_8h_html_a5dd95d385576ba1b957d7e9c523ec946ab4f9fd68dbd70c2bd8f4e3795bed15cc"><div class="ttname"><a href="#a5dd95d385576ba1b957d7e9c523ec946ab4f9fd68dbd70c2bd8f4e3795bed15cc">MUTT_VA_PAGER</a></div><div class="ttdeci">@ MUTT_VA_PAGER</div><div class="ttdoc">View attachment in pager using copiousoutput mailcap.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8h_source.html#l00047">mutt_attach.h:47</a></div></div>
<div class="ttc" id="amutt__attach_8h_html_a5dd95d385576ba1b957d7e9c523ec946ae2885fe7d47c03a1f0246d054739da79"><div class="ttname"><a href="#a5dd95d385576ba1b957d7e9c523ec946ae2885fe7d47c03a1f0246d054739da79">MUTT_VA_AS_TEXT</a></div><div class="ttdeci">@ MUTT_VA_AS_TEXT</div><div class="ttdoc">Force viewing as text.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8h_source.html#l00046">mutt_attach.h:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5675c7a41890711ec4871b592c840faa" name="a5675c7a41890711ec4871b592c840faa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5675c7a41890711ec4871b592c840faa">&#9670;&#160;</a></span>SaveAttach</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a5675c7a41890711ec4871b592c840faa">SaveAttach</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Options for saving attachments. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a87e1ea8a7b0c926e02ed3db8b7d3dbd5" title="Save an attachment.">mutt_save_attachment()</a>, <a class="el" href="#aac29548ca4501311138dfa43db788bd3" title="Decode, then save an attachment.">mutt_decode_save_attachment()</a>, <a class="el" href="mutt__attach_8c.html#adaa2b49386e82ac2c19f0ddefa1bbe3f" title="Open a file to write an attachment to.">save_attachment_open()</a>, <a class="el" href="muttlib_8c.html#ae34cbb3670824b1838c0973c88aab15b" title="Ask the user if overwriting is necessary.">mutt_check_overwrite()</a> </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224" name="a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224"></a>MUTT_SAVE_NO_FLAGS&#160;</td><td class="fielddoc"><p>Overwrite existing file (the default) </p>
</td></tr>
<tr><td class="fieldname"><a id="a5675c7a41890711ec4871b592c840faaa3f82d6dcb02891511fe91907b398aa1c" name="a5675c7a41890711ec4871b592c840faaa3f82d6dcb02891511fe91907b398aa1c"></a>MUTT_SAVE_APPEND&#160;</td><td class="fielddoc"><p>Append to existing file. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8h_source.html#l00056">56</a> of file <a class="el" href="mutt__attach_8h_source.html">mutt_attach.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   57</span>{</div>
<div class="line"><span class="lineno">   58</span>  <a class="code hl_enumvalue" href="#a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224">MUTT_SAVE_NO_FLAGS</a>  = 0, </div>
<div class="line"><span class="lineno">   59</span>  <a class="code hl_enumvalue" href="#a5675c7a41890711ec4871b592c840faaa3f82d6dcb02891511fe91907b398aa1c">MUTT_SAVE_APPEND</a>,        </div>
<div class="line"><span class="lineno">   60</span>};</div>
<div class="ttc" id="amutt__attach_8h_html_a5675c7a41890711ec4871b592c840faaa3f82d6dcb02891511fe91907b398aa1c"><div class="ttname"><a href="#a5675c7a41890711ec4871b592c840faaa3f82d6dcb02891511fe91907b398aa1c">MUTT_SAVE_APPEND</a></div><div class="ttdeci">@ MUTT_SAVE_APPEND</div><div class="ttdoc">Append to existing file.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8h_source.html#l00059">mutt_attach.h:59</a></div></div>
<div class="ttc" id="amutt__attach_8h_html_a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224"><div class="ttname"><a href="#a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224">MUTT_SAVE_NO_FLAGS</a></div><div class="ttdeci">@ MUTT_SAVE_NO_FLAGS</div><div class="ttdoc">Overwrite existing file (the default)</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8h_source.html#l00058">mutt_attach.h:58</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a72c9e19b893d8d4afc5593d9d2b399ff" name="a72c9e19b893d8d4afc5593d9d2b399ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72c9e19b893d8d4afc5593d9d2b399ff">&#9670;&#160;</a></span>mutt_attach_display_loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_attach_display_loop </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structConfigSubset.html">ConfigSubset</a> *</td>          <td class="paramname"><span class="paramname"><em>sub</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structMenu.html">Menu</a> *</td>          <td class="paramname"><span class="paramname"><em>menu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>op</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structAttachCtx.html">AttachCtx</a> *</td>          <td class="paramname"><span class="paramname"><em>actx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>recv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Event loop for the Attachment menu. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sub</td><td>Config Subset </td></tr>
    <tr><td class="paramname">menu</td><td><a class="el" href="structMenu.html">Menu</a> listing Attachments </td></tr>
    <tr><td class="paramname">op</td><td>Operation, e.g. OP_ATTACHMENT_VIEW </td></tr>
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> </td></tr>
    <tr><td class="paramname">actx</td><td>Attachment context </td></tr>
    <tr><td class="paramname">recv</td><td>true if these are received attachments (rather than in compose) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>Operation performed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="recvattach_8c_source.html#l00962">962</a> of file <a class="el" href="recvattach_8c_source.html">recvattach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  964</span>{</div>
<div class="line"><span class="lineno">  965</span>  <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  966</span>  {</div>
<div class="line"><span class="lineno">  967</span>    <span class="keywordflow">switch</span> (op)</div>
<div class="line"><span class="lineno">  968</span>    {</div>
<div class="line"><span class="lineno">  969</span>      <span class="keywordflow">case</span> OP_DISPLAY_HEADERS:</div>
<div class="line"><span class="lineno">  970</span>        <a class="code hl_function" href="bool_8c.html#a5ef0a3002d75e9d9a91cda84336c13f5">bool_str_toggle</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;weed&quot;</span>, NULL);</div>
<div class="line"><span class="lineno">  971</span>        <a class="code hl_define" href="mutt_2lib_8h.html#a0cf2d82c57a09723ab59e6f4dcc45b84">FALLTHROUGH</a>;</div>
<div class="line"><span class="lineno">  972</span> </div>
<div class="line"><span class="lineno">  973</span>      <span class="keywordflow">case</span> OP_ATTACHMENT_VIEW:</div>
<div class="line"><span class="lineno">  974</span>      {</div>
<div class="line"><span class="lineno">  975</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structAttachPtr.html">AttachPtr</a> *cur_att = <a class="code hl_function" href="recvattach_8c.html#a718168300f4a21fa0c1a28321aeaa6ee">current_attachment</a>(actx, menu);</div>
<div class="line"><span class="lineno">  976</span>        <span class="keywordflow">if</span> (!cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a776ea6f490cedf7dc47accba055d964c">fp</a>)</div>
<div class="line"><span class="lineno">  977</span>        {</div>
<div class="line"><span class="lineno">  978</span>          <span class="keywordflow">if</span> (cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">body</a>-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>)</div>
<div class="line"><span class="lineno">  979</span>          {</div>
<div class="line"><span class="lineno">  980</span>            <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *b = cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno">  981</span>            <span class="keywordflow">while</span> (b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>)</div>
<div class="line"><span class="lineno">  982</span>              b = b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno">  983</span>            cur_att = b-&gt;<a class="code hl_variable" href="structBody.html#a7f100009f42fd558aaaaaf89bb2f4156">aptr</a>;</div>
<div class="line"><span class="lineno">  984</span>          }</div>
<div class="line"><span class="lineno">  985</span>        }</div>
<div class="line"><span class="lineno">  986</span>        op = <a class="code hl_function" href="mutt__attach_8c.html#ab2e07f4628b9c8e41529a62c27d1b51a">mutt_view_attachment</a>(cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a776ea6f490cedf7dc47accba055d964c">fp</a>, cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">body</a>, <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946a805f2934d475a513bb1294baa8e5d00b">MUTT_VA_REGULAR</a>,</div>
<div class="line"><span class="lineno">  987</span>                                  e, actx, menu-&gt;<a class="code hl_variable" href="structMenu.html#a03edef68cc4422dea828bc89332f3020">win</a>);</div>
<div class="line"><span class="lineno">  988</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  989</span>      }</div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>      <span class="keywordflow">case</span> OP_NEXT_ENTRY:</div>
<div class="line"><span class="lineno">  992</span>      <span class="keywordflow">case</span> OP_MAIN_NEXT_UNDELETED: <span class="comment">/* hack */</span></div>
<div class="line"><span class="lineno">  993</span>      {</div>
<div class="line"><span class="lineno">  994</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> index = <a class="code hl_function" href="menu_2lib_8h.html#a67ee9260e41986eb4487124b004cff18">menu_get_index</a>(menu) + 1;</div>
<div class="line"><span class="lineno">  995</span>        <span class="keywordflow">if</span> (index &lt; menu-&gt;max)</div>
<div class="line"><span class="lineno">  996</span>        {</div>
<div class="line"><span class="lineno">  997</span>          <a class="code hl_function" href="menu_2lib_8h.html#ae279bb826b97fcc88c0714b2a6383851">menu_set_index</a>(menu, index);</div>
<div class="line"><span class="lineno">  998</span>          op = OP_ATTACHMENT_VIEW;</div>
<div class="line"><span class="lineno">  999</span>        }</div>
<div class="line"><span class="lineno"> 1000</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1001</span>        {</div>
<div class="line"><span class="lineno"> 1002</span>          op = OP_NULL;</div>
<div class="line"><span class="lineno"> 1003</span>        }</div>
<div class="line"><span class="lineno"> 1004</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1005</span>      }</div>
<div class="line"><span class="lineno"> 1006</span> </div>
<div class="line"><span class="lineno"> 1007</span>      <span class="keywordflow">case</span> OP_PREV_ENTRY:</div>
<div class="line"><span class="lineno"> 1008</span>      <span class="keywordflow">case</span> OP_MAIN_PREV_UNDELETED: <span class="comment">/* hack */</span></div>
<div class="line"><span class="lineno"> 1009</span>      {</div>
<div class="line"><span class="lineno"> 1010</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> index = <a class="code hl_function" href="menu_2lib_8h.html#a67ee9260e41986eb4487124b004cff18">menu_get_index</a>(menu) - 1;</div>
<div class="line"><span class="lineno"> 1011</span>        <span class="keywordflow">if</span> (index &gt;= 0)</div>
<div class="line"><span class="lineno"> 1012</span>        {</div>
<div class="line"><span class="lineno"> 1013</span>          <a class="code hl_function" href="menu_2lib_8h.html#ae279bb826b97fcc88c0714b2a6383851">menu_set_index</a>(menu, index);</div>
<div class="line"><span class="lineno"> 1014</span>          op = OP_ATTACHMENT_VIEW;</div>
<div class="line"><span class="lineno"> 1015</span>        }</div>
<div class="line"><span class="lineno"> 1016</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1017</span>        {</div>
<div class="line"><span class="lineno"> 1018</span>          op = OP_NULL;</div>
<div class="line"><span class="lineno"> 1019</span>        }</div>
<div class="line"><span class="lineno"> 1020</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1021</span>      }</div>
<div class="line"><span class="lineno"> 1022</span> </div>
<div class="line"><span class="lineno"> 1023</span>      <span class="keywordflow">case</span> OP_ATTACHMENT_EDIT_TYPE:</div>
<div class="line"><span class="lineno"> 1024</span>      {</div>
<div class="line"><span class="lineno"> 1025</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structAttachPtr.html">AttachPtr</a> *cur_att = <a class="code hl_function" href="recvattach_8c.html#a718168300f4a21fa0c1a28321aeaa6ee">current_attachment</a>(actx, menu);</div>
<div class="line"><span class="lineno"> 1026</span>        <span class="comment">/* when we edit the content-type, we should redisplay the attachment</span></div>
<div class="line"><span class="lineno"> 1027</span><span class="comment">         * immediately */</span></div>
<div class="line"><span class="lineno"> 1028</span>        <a class="code hl_function" href="external_8c.html#a9b5874c3558cb300404bb50f60fc6a31">mutt_edit_content_type</a>(e, cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">body</a>, cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a776ea6f490cedf7dc47accba055d964c">fp</a>);</div>
<div class="line"><span class="lineno"> 1029</span>        <span class="keywordflow">if</span> (recv)</div>
<div class="line"><span class="lineno"> 1030</span>          <a class="code hl_function" href="recvattach_8c.html#afcd17795d6d83e3769c264607cfcc3a7">recvattach_edit_content_type</a>(actx, menu, e);</div>
<div class="line"><span class="lineno"> 1031</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1032</span>          <a class="code hl_function" href="external_8c.html#a9b5874c3558cb300404bb50f60fc6a31">mutt_edit_content_type</a>(e, cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">body</a>, cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a776ea6f490cedf7dc47accba055d964c">fp</a>);</div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span>        <a class="code hl_function" href="menu_2lib_8h.html#a5a9733924cc01176ee916515a3683268">menu_queue_redraw</a>(menu, <a class="code hl_define" href="menu_2lib_8h.html#a294a94cf45be93fa7677adb7116ce60b">MENU_REDRAW_INDEX</a>);</div>
<div class="line"><span class="lineno"> 1035</span>        op = OP_ATTACHMENT_VIEW;</div>
<div class="line"><span class="lineno"> 1036</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1037</span>      }</div>
<div class="line"><span class="lineno"> 1038</span>      <span class="comment">/* functions which are passed through from the pager */</span></div>
<div class="line"><span class="lineno"> 1039</span>      <span class="keywordflow">case</span> OP_PIPE:</div>
<div class="line"><span class="lineno"> 1040</span>      {</div>
<div class="line"><span class="lineno"> 1041</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structAttachPtr.html">AttachPtr</a> *cur_att = <a class="code hl_function" href="recvattach_8c.html#a718168300f4a21fa0c1a28321aeaa6ee">current_attachment</a>(actx, menu);</div>
<div class="line"><span class="lineno"> 1042</span>        <a class="code hl_function" href="recvattach_8c.html#a864d3327398fde25536c45736abde530">mutt_pipe_attachment_list</a>(actx, cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a776ea6f490cedf7dc47accba055d964c">fp</a>, <span class="keyword">false</span>, cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">body</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1043</span>        op = OP_ATTACHMENT_VIEW;</div>
<div class="line"><span class="lineno"> 1044</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1045</span>      }</div>
<div class="line"><span class="lineno"> 1046</span>      <span class="keywordflow">case</span> OP_ATTACHMENT_PRINT:</div>
<div class="line"><span class="lineno"> 1047</span>      {</div>
<div class="line"><span class="lineno"> 1048</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structAttachPtr.html">AttachPtr</a> *cur_att = <a class="code hl_function" href="recvattach_8c.html#a718168300f4a21fa0c1a28321aeaa6ee">current_attachment</a>(actx, menu);</div>
<div class="line"><span class="lineno"> 1049</span>        <a class="code hl_function" href="recvattach_8c.html#ac869ec7f92735053d33d3143d9866af5">mutt_print_attachment_list</a>(actx, cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a776ea6f490cedf7dc47accba055d964c">fp</a>, <span class="keyword">false</span>, cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">body</a>);</div>
<div class="line"><span class="lineno"> 1050</span>        op = OP_ATTACHMENT_VIEW;</div>
<div class="line"><span class="lineno"> 1051</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1052</span>      }</div>
<div class="line"><span class="lineno"> 1053</span>      <span class="keywordflow">case</span> OP_ATTACHMENT_SAVE:</div>
<div class="line"><span class="lineno"> 1054</span>      {</div>
<div class="line"><span class="lineno"> 1055</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structAttachPtr.html">AttachPtr</a> *cur_att = <a class="code hl_function" href="recvattach_8c.html#a718168300f4a21fa0c1a28321aeaa6ee">current_attachment</a>(actx, menu);</div>
<div class="line"><span class="lineno"> 1056</span>        <a class="code hl_function" href="recvattach_8c.html#a588a5719b699c5d062f263711598836e">mutt_save_attachment_list</a>(actx, cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a776ea6f490cedf7dc47accba055d964c">fp</a>, <span class="keyword">false</span>, cur_att-&gt;<a class="code hl_variable" href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">body</a>, e, NULL);</div>
<div class="line"><span class="lineno"> 1057</span>        op = OP_ATTACHMENT_VIEW;</div>
<div class="line"><span class="lineno"> 1058</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1059</span>      }</div>
<div class="line"><span class="lineno"> 1060</span>      <span class="keywordflow">case</span> OP_CHECK_TRADITIONAL:</div>
<div class="line"><span class="lineno"> 1061</span>        <span class="keywordflow">if</span> (!(<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) || (e &amp;&amp; e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a3c4cec129dc84794f15f44382c25fc36">PGP_TRADITIONAL_CHECKED</a>))</div>
<div class="line"><span class="lineno"> 1062</span>        {</div>
<div class="line"><span class="lineno"> 1063</span>          op = OP_NULL;</div>
<div class="line"><span class="lineno"> 1064</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1065</span>        }</div>
<div class="line"><span class="lineno"> 1066</span>        <a class="code hl_define" href="mutt_2lib_8h.html#a0cf2d82c57a09723ab59e6f4dcc45b84">FALLTHROUGH</a>;</div>
<div class="line"><span class="lineno"> 1067</span> </div>
<div class="line"><span class="lineno"> 1068</span>      <span class="keywordflow">case</span> OP_ATTACHMENT_COLLAPSE:</div>
<div class="line"><span class="lineno"> 1069</span>        <span class="keywordflow">if</span> (recv)</div>
<div class="line"><span class="lineno"> 1070</span>          <span class="keywordflow">return</span> op;</div>
<div class="line"><span class="lineno"> 1071</span>        <a class="code hl_define" href="mutt_2lib_8h.html#a0cf2d82c57a09723ab59e6f4dcc45b84">FALLTHROUGH</a>;</div>
<div class="line"><span class="lineno"> 1072</span> </div>
<div class="line"><span class="lineno"> 1073</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1074</span>        op = OP_NULL;</div>
<div class="line"><span class="lineno"> 1075</span>    }</div>
<div class="line"><span class="lineno"> 1076</span>  } <span class="keywordflow">while</span> (op != OP_NULL);</div>
<div class="line"><span class="lineno"> 1077</span> </div>
<div class="line"><span class="lineno"> 1078</span>  <span class="keywordflow">return</span> op;</div>
<div class="line"><span class="lineno"> 1079</span>}</div>
<div class="ttc" id="abool_8c_html_a5ef0a3002d75e9d9a91cda84336c13f5"><div class="ttname"><a href="bool_8c.html#a5ef0a3002d75e9d9a91cda84336c13f5">bool_str_toggle</a></div><div class="ttdeci">int bool_str_toggle(struct ConfigSubset *sub, const char *name, struct Buffer *err)</div><div class="ttdoc">Toggle the value of a bool.</div><div class="ttdef"><b>Definition</b> <a href="bool_8c_source.html#l00229">bool.c:229</a></div></div>
<div class="ttc" id="aexternal_8c_html_a9b5874c3558cb300404bb50f60fc6a31"><div class="ttname"><a href="external_8c.html#a9b5874c3558cb300404bb50f60fc6a31">mutt_edit_content_type</a></div><div class="ttdeci">bool mutt_edit_content_type(struct Email *e, struct Body *b, FILE *fp)</div><div class="ttdoc">Edit the content type of an attachment.</div><div class="ttdef"><b>Definition</b> <a href="external_8c_source.html#l01070">external.c:1070</a></div></div>
<div class="ttc" id="amenu_2lib_8h_html_a294a94cf45be93fa7677adb7116ce60b"><div class="ttname"><a href="menu_2lib_8h.html#a294a94cf45be93fa7677adb7116ce60b">MENU_REDRAW_INDEX</a></div><div class="ttdeci">#define MENU_REDRAW_INDEX</div><div class="ttdoc">Redraw the index.</div><div class="ttdef"><b>Definition</b> <a href="menu_2lib_8h_source.html#l00056">lib.h:56</a></div></div>
<div class="ttc" id="amenu_2lib_8h_html_a5a9733924cc01176ee916515a3683268"><div class="ttname"><a href="menu_2lib_8h.html#a5a9733924cc01176ee916515a3683268">menu_queue_redraw</a></div><div class="ttdeci">void menu_queue_redraw(struct Menu *menu, MenuRedrawFlags redraw)</div><div class="ttdoc">Queue a request for a redraw.</div><div class="ttdef"><b>Definition</b> <a href="menu_8c_source.html#l00184">menu.c:184</a></div></div>
<div class="ttc" id="amenu_2lib_8h_html_a67ee9260e41986eb4487124b004cff18"><div class="ttname"><a href="menu_2lib_8h.html#a67ee9260e41986eb4487124b004cff18">menu_get_index</a></div><div class="ttdeci">int menu_get_index(struct Menu *menu)</div><div class="ttdoc">Get the current selection in the Menu.</div><div class="ttdef"><b>Definition</b> <a href="menu_8c_source.html#l00160">menu.c:160</a></div></div>
<div class="ttc" id="amenu_2lib_8h_html_ae279bb826b97fcc88c0714b2a6383851"><div class="ttname"><a href="menu_2lib_8h.html#ae279bb826b97fcc88c0714b2a6383851">menu_set_index</a></div><div class="ttdeci">MenuRedrawFlags menu_set_index(struct Menu *menu, int index)</div><div class="ttdoc">Set the current selection in the Menu.</div><div class="ttdef"><b>Definition</b> <a href="menu_8c_source.html#l00174">menu.c:174</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a></div><div class="ttdeci">@ TYPE_MULTIPART</div><div class="ttdoc">Type: &#39;multipart/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00037">mime.h:37</a></div></div>
<div class="ttc" id="amutt_2lib_8h_html_a0cf2d82c57a09723ab59e6f4dcc45b84"><div class="ttname"><a href="mutt_2lib_8h.html#a0cf2d82c57a09723ab59e6f4dcc45b84">FALLTHROUGH</a></div><div class="ttdeci">#define FALLTHROUGH</div><div class="ttdef"><b>Definition</b> <a href="mutt_2lib_8h_source.html#l00113">lib.h:113</a></div></div>
<div class="ttc" id="amutt__attach_8c_html_ab2e07f4628b9c8e41529a62c27d1b51a"><div class="ttname"><a href="mutt__attach_8c.html#ab2e07f4628b9c8e41529a62c27d1b51a">mutt_view_attachment</a></div><div class="ttdeci">int mutt_view_attachment(FILE *fp, struct Body *b, enum ViewAttachMode mode, struct Email *e, struct AttachCtx *actx, struct MuttWindow *win)</div><div class="ttdoc">View an attachment.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8c_source.html#l00419">mutt_attach.c:419</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a3c4cec129dc84794f15f44382c25fc36"><div class="ttname"><a href="ncrypt_2lib_8h.html#a3c4cec129dc84794f15f44382c25fc36">PGP_TRADITIONAL_CHECKED</a></div><div class="ttdeci">#define PGP_TRADITIONAL_CHECKED</div><div class="ttdoc">Email has a traditional (inline) signature.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00098">lib.h:98</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00096">lib.h:96</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00122">lib.h:122</a></div></div>
<div class="ttc" id="arecvattach_8c_html_a588a5719b699c5d062f263711598836e"><div class="ttname"><a href="recvattach_8c.html#a588a5719b699c5d062f263711598836e">mutt_save_attachment_list</a></div><div class="ttdeci">void mutt_save_attachment_list(struct AttachCtx *actx, FILE *fp, bool tag, struct Body *b, struct Email *e, struct Menu *menu)</div><div class="ttdoc">Save a list of attachments.</div><div class="ttdef"><b>Definition</b> <a href="recvattach_8c_source.html#l00431">recvattach.c:431</a></div></div>
<div class="ttc" id="arecvattach_8c_html_a718168300f4a21fa0c1a28321aeaa6ee"><div class="ttname"><a href="recvattach_8c.html#a718168300f4a21fa0c1a28321aeaa6ee">current_attachment</a></div><div class="ttdeci">struct AttachPtr * current_attachment(struct AttachCtx *actx, struct Menu *menu)</div><div class="ttdoc">Get the current attachment.</div><div class="ttdef"><b>Definition</b> <a href="recvattach_8c_source.html#l00076">recvattach.c:76</a></div></div>
<div class="ttc" id="arecvattach_8c_html_a864d3327398fde25536c45736abde530"><div class="ttname"><a href="recvattach_8c.html#a864d3327398fde25536c45736abde530">mutt_pipe_attachment_list</a></div><div class="ttdeci">void mutt_pipe_attachment_list(struct AttachCtx *actx, FILE *fp, bool tag, struct Body *b, bool filter)</div><div class="ttdoc">Pipe a list of attachments to a command.</div><div class="ttdef"><b>Definition</b> <a href="recvattach_8c_source.html#l00723">recvattach.c:723</a></div></div>
<div class="ttc" id="arecvattach_8c_html_ac869ec7f92735053d33d3143d9866af5"><div class="ttname"><a href="recvattach_8c.html#ac869ec7f92735053d33d3143d9866af5">mutt_print_attachment_list</a></div><div class="ttdeci">void mutt_print_attachment_list(struct AttachCtx *actx, FILE *fp, bool tag, struct Body *b)</div><div class="ttdoc">Print a list of Attachments.</div><div class="ttdef"><b>Definition</b> <a href="recvattach_8c_source.html#l00887">recvattach.c:887</a></div></div>
<div class="ttc" id="arecvattach_8c_html_afcd17795d6d83e3769c264607cfcc3a7"><div class="ttname"><a href="recvattach_8c.html#afcd17795d6d83e3769c264607cfcc3a7">recvattach_edit_content_type</a></div><div class="ttdeci">void recvattach_edit_content_type(struct AttachCtx *actx, struct Menu *menu, struct Email *e)</div><div class="ttdoc">Edit the content type of an attachment.</div><div class="ttdef"><b>Definition</b> <a href="recvattach_8c_source.html#l00932">recvattach.c:932</a></div></div>
<div class="ttc" id="astructAttachPtr_html"><div class="ttname"><a href="structAttachPtr.html">AttachPtr</a></div><div class="ttdoc">An email to which things will be attached.</div><div class="ttdef"><b>Definition</b> <a href="attach_8h_source.html#l00034">attach.h:35</a></div></div>
<div class="ttc" id="astructAttachPtr_html_a0546c0753a6155ae9555c290b80d0356"><div class="ttname"><a href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">AttachPtr::body</a></div><div class="ttdeci">struct Body * body</div><div class="ttdoc">Attachment.</div><div class="ttdef"><b>Definition</b> <a href="attach_8h_source.html#l00036">attach.h:36</a></div></div>
<div class="ttc" id="astructAttachPtr_html_a776ea6f490cedf7dc47accba055d964c"><div class="ttname"><a href="structAttachPtr.html#a776ea6f490cedf7dc47accba055d964c">AttachPtr::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdoc">Used in the recvattach menu.</div><div class="ttdef"><b>Definition</b> <a href="attach_8h_source.html#l00037">attach.h:37</a></div></div>
<div class="ttc" id="astructBody_html"><div class="ttname"><a href="structBody.html">Body</a></div><div class="ttdoc">The body of an email.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00035">body.h:36</a></div></div>
<div class="ttc" id="astructBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00073">body.h:73</a></div></div>
<div class="ttc" id="astructBody_html_a7f100009f42fd558aaaaaf89bb2f4156"><div class="ttname"><a href="structBody.html#a7f100009f42fd558aaaaaf89bb2f4156">Body::aptr</a></div><div class="ttdeci">struct AttachPtr * aptr</div><div class="ttdoc">Menu information, used in recvattach.c.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00075">body.h:75</a></div></div>
<div class="ttc" id="astructBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00040">body.h:40</a></div></div>
<div class="ttc" id="astructEmail_html_a570a81cd747437c9ea4357947731ae10"><div class="ttname"><a href="structEmail.html#a570a81cd747437c9ea4357947731ae10">Email::security</a></div><div class="ttdeci">SecurityFlags security</div><div class="ttdoc">bit 0-10: flags, bit 11,12: application, bit 13: traditional pgp See: ncrypt/lib.h pgplib....</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00043">email.h:43</a></div></div>
<div class="ttc" id="astructMenu_html_a03edef68cc4422dea828bc89332f3020"><div class="ttname"><a href="structMenu.html#a03edef68cc4422dea828bc89332f3020">Menu::win</a></div><div class="ttdeci">struct MuttWindow * win</div><div class="ttdoc">Window holding the Menu.</div><div class="ttdef"><b>Definition</b> <a href="menu_2lib_8h_source.html#l00086">lib.h:86</a></div></div>
<div class="ttc" id="astructNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00042">neomutt.h:43</a></div></div>
<div class="ttc" id="astructNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00047">neomutt.h:47</a></div></div>
</div><!-- fragment --><div id="dynsection-2" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a72c9e19b893d8d4afc5593d9d2b399ff_cgraph.svg" width="827" height="562"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-3" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a72c9e19b893d8d4afc5593d9d2b399ff_icgraph.svg" width="383" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a588a5719b699c5d062f263711598836e" name="a588a5719b699c5d062f263711598836e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a588a5719b699c5d062f263711598836e">&#9670;&#160;</a></span>mutt_save_attachment_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_save_attachment_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structAttachCtx.html">AttachCtx</a> *</td>          <td class="paramname"><span class="paramname"><em>actx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>tag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structMenu.html">Menu</a> *</td>          <td class="paramname"><span class="paramname"><em>menu</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save a list of attachments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">actx</td><td>Attachment context </td></tr>
    <tr><td class="paramname">fp</td><td>File handle for the attachment (OPTIONAL) </td></tr>
    <tr><td class="paramname">tag</td><td>If true, only save the tagged attachments </td></tr>
    <tr><td class="paramname">b</td><td>First Attachment </td></tr>
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> </td></tr>
    <tr><td class="paramname">menu</td><td><a class="el" href="structMenu.html">Menu</a> listing attachments </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="recvattach_8c_source.html#l00431">431</a> of file <a class="el" href="recvattach_8c_source.html">recvattach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  433</span>{</div>
<div class="line"><span class="lineno">  434</span>  <span class="keywordtype">char</span> *directory = NULL;</div>
<div class="line"><span class="lineno">  435</span>  <span class="keywordtype">int</span> rc = 1;</div>
<div class="line"><span class="lineno">  436</span>  <span class="keywordtype">int</span> last = <a class="code hl_function" href="menu_2lib_8h.html#a67ee9260e41986eb4487124b004cff18">menu_get_index</a>(menu);</div>
<div class="line"><span class="lineno">  437</span>  FILE *fp_out = NULL;</div>
<div class="line"><span class="lineno">  438</span>  <span class="keywordtype">int</span> saved_attachments = 0;</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *buf = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  441</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *tfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_attach_split = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;attach_split&quot;</span>);</div>
<div class="line"><span class="lineno">  444</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_attach_sep = <a class="code hl_function" href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;attach_sep&quot;</span>);</div>
<div class="line"><span class="lineno">  445</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_attach_save_without_prompting = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;attach_save_without_prompting&quot;</span>);</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; !tag || (i &lt; actx-&gt;<a class="code hl_variable" href="structAttachCtx.html#af02af835a67d8b3467f3a52ede4897f0">idxlen</a>); i++)</div>
<div class="line"><span class="lineno">  448</span>  {</div>
<div class="line"><span class="lineno">  449</span>    <span class="keywordflow">if</span> (tag)</div>
<div class="line"><span class="lineno">  450</span>    {</div>
<div class="line"><span class="lineno">  451</span>      fp = actx-&gt;<a class="code hl_variable" href="structAttachCtx.html#a8954cda6f07f33628b3addf8bc2621fd">idx</a>[i]-&gt;<a class="code hl_variable" href="structAttachPtr.html#a776ea6f490cedf7dc47accba055d964c">fp</a>;</div>
<div class="line"><span class="lineno">  452</span>      b = actx-&gt;<a class="code hl_variable" href="structAttachCtx.html#a8954cda6f07f33628b3addf8bc2621fd">idx</a>[i]-&gt;<a class="code hl_variable" href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">body</a>;</div>
<div class="line"><span class="lineno">  453</span>    }</div>
<div class="line"><span class="lineno">  454</span>    <span class="keywordflow">if</span> (!tag || b-&gt;<a class="code hl_variable" href="structBody.html#aaaa97781986925aa1f10f24be18243ab">tagged</a>)</div>
<div class="line"><span class="lineno">  455</span>    {</div>
<div class="line"><span class="lineno">  456</span>      <span class="keywordflow">if</span> (c_attach_split)</div>
<div class="line"><span class="lineno">  457</span>      {</div>
<div class="line"><span class="lineno">  458</span>        <span class="keywordflow">if</span> (tag &amp;&amp; menu &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#a7f100009f42fd558aaaaaf89bb2f4156">aptr</a>)</div>
<div class="line"><span class="lineno">  459</span>        {</div>
<div class="line"><span class="lineno">  460</span>          <a class="code hl_function" href="menu_2lib_8h.html#ae279bb826b97fcc88c0714b2a6383851">menu_set_index</a>(menu, b-&gt;<a class="code hl_variable" href="structBody.html#a7f100009f42fd558aaaaaf89bb2f4156">aptr</a>-&gt;<a class="code hl_variable" href="structAttachPtr.html#a71db2d33eefd6c1f41f129f6943fe83a">num</a>);</div>
<div class="line"><span class="lineno">  461</span>          <a class="code hl_function" href="menu_2lib_8h.html#a5a9733924cc01176ee916515a3683268">menu_queue_redraw</a>(menu, <a class="code hl_define" href="menu_2lib_8h.html#afd1295f0c36408826d642e4771b89a1b">MENU_REDRAW_MOTION</a>);</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>          <a class="code hl_function" href="draw_8c.html#a3da31793ff9ae935dccab75ae653a064">menu_redraw</a>(menu);</div>
<div class="line"><span class="lineno">  464</span>        }</div>
<div class="line"><span class="lineno">  465</span>        <span class="keywordflow">if</span> (c_attach_save_without_prompting)</div>
<div class="line"><span class="lineno">  466</span>        {</div>
<div class="line"><span class="lineno">  467</span>          <span class="comment">// Save each file, with no prompting, using the configured &#39;AttachSaveDir&#39;</span></div>
<div class="line"><span class="lineno">  468</span>          rc = <a class="code hl_function" href="recvattach_8c.html#a52c616f195a129f43883a3a3bb8f463f">save_without_prompting</a>(fp, b, e);</div>
<div class="line"><span class="lineno">  469</span>          <span class="keywordflow">if</span> (rc == 0)</div>
<div class="line"><span class="lineno">  470</span>            saved_attachments++;</div>
<div class="line"><span class="lineno">  471</span>        }</div>
<div class="line"><span class="lineno">  472</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  473</span>        {</div>
<div class="line"><span class="lineno">  474</span>          <span class="comment">// Save each file, prompting the user for the location each time.</span></div>
<div class="line"><span class="lineno">  475</span>          <span class="keywordflow">if</span> (<a class="code hl_function" href="recvattach_8c.html#acdb2625453e4a2bacee478c06061ba7a">query_save_attachment</a>(fp, b, e, &amp;directory) == -1)</div>
<div class="line"><span class="lineno">  476</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  477</span>        }</div>
<div class="line"><span class="lineno">  478</span>      }</div>
<div class="line"><span class="lineno">  479</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  480</span>      {</div>
<div class="line"><span class="lineno">  481</span>        <span class="keyword">enum</span> <a class="code hl_enumeration" href="#a5675c7a41890711ec4871b592c840faa">SaveAttach</a> opt = <a class="code hl_enumvalue" href="#a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224">MUTT_SAVE_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(buf))</div>
<div class="line"><span class="lineno">  484</span>        {</div>
<div class="line"><span class="lineno">  485</span>          <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(buf, <a class="code hl_function" href="mutt_2path_8c.html#a3868ea49aae027f4fc188e2c9b933a31">mutt_path_basename</a>(<a class="code hl_define" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>)));</div>
<div class="line"><span class="lineno">  486</span>          <a class="code hl_function" href="recvattach_8c.html#a7ead8fceb1c2b8c8c8a86b08e73a1191">prepend_savedir</a>(buf);</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>          <span class="keyword">struct </span><a class="code hl_struct" href="structFileCompletionData.html">FileCompletionData</a> cdata = { <span class="keyword">false</span>, NULL, NULL, NULL };</div>
<div class="line"><span class="lineno">  489</span>          <span class="keywordflow">if</span> ((<a class="code hl_function" href="group__gui__mw.html#gabcbd2498b412e9f8e9d953cafc01989c">mw_get_field</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Save to file: &quot;</span>), buf, <a class="code hl_define" href="mutt_8h.html#aff320b29c6010a53a17749f6423834a3">MUTT_COMP_CLEAR</a>, <a class="code hl_enumvalue" href="history_2lib_8h.html#acb0a49d94e5b4fe512c30e2c12621234a313ffe25b1e9a86bb1f9afb44e15925c">HC_FILE</a>,</div>
<div class="line"><span class="lineno">  490</span>                            &amp;<a class="code hl_variable" href="browser_2complete_8c.html#a6bd4da54e7d75404519878f3ef32c87e">CompleteFileOps</a>, &amp;cdata) != 0) ||</div>
<div class="line"><span class="lineno">  491</span>              <a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(buf))</div>
<div class="line"><span class="lineno">  492</span>          {</div>
<div class="line"><span class="lineno">  493</span>            <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  494</span>          }</div>
<div class="line"><span class="lineno">  495</span>          <a class="code hl_function" href="muttlib_8c.html#adde3990a0490dfba609fc94dbdbfd6b3">buf_expand_path</a>(buf);</div>
<div class="line"><span class="lineno">  496</span>          <span class="keywordflow">if</span> (<a class="code hl_function" href="muttlib_8c.html#ae34cbb3670824b1838c0973c88aab15b">mutt_check_overwrite</a>(b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf), tfile, &amp;opt, NULL))</div>
<div class="line"><span class="lineno">  497</span>            <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  498</span>        }</div>
<div class="line"><span class="lineno">  499</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  500</span>        {</div>
<div class="line"><span class="lineno">  501</span>          opt = <a class="code hl_enumvalue" href="#a5675c7a41890711ec4871b592c840faaa3f82d6dcb02891511fe91907b398aa1c">MUTT_SAVE_APPEND</a>;</div>
<div class="line"><span class="lineno">  502</span>        }</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>        rc = <a class="code hl_function" href="recvattach_8c.html#a3c36223d243ef6b041baf6e0bb54533f">save_attachment_flowed_helper</a>(fp, b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tfile), opt, e);</div>
<div class="line"><span class="lineno">  505</span>        <span class="keywordflow">if</span> ((rc == 0) &amp;&amp; c_attach_sep &amp;&amp; (fp_out = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tfile), <span class="stringliteral">&quot;a&quot;</span>)))</div>
<div class="line"><span class="lineno">  506</span>        {</div>
<div class="line"><span class="lineno">  507</span>          fprintf(fp_out, <span class="stringliteral">&quot;%s&quot;</span>, c_attach_sep);</div>
<div class="line"><span class="lineno">  508</span>          <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_out);</div>
<div class="line"><span class="lineno">  509</span>        }</div>
<div class="line"><span class="lineno">  510</span>      }</div>
<div class="line"><span class="lineno">  511</span>    }</div>
<div class="line"><span class="lineno">  512</span>    <span class="keywordflow">if</span> (!tag)</div>
<div class="line"><span class="lineno">  513</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  514</span>  }</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;directory);</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>  <span class="keywordflow">if</span> (tag &amp;&amp; menu)</div>
<div class="line"><span class="lineno">  519</span>  {</div>
<div class="line"><span class="lineno">  520</span>    <a class="code hl_function" href="menu_2lib_8h.html#ae279bb826b97fcc88c0714b2a6383851">menu_set_index</a>(menu, last);</div>
<div class="line"><span class="lineno">  521</span>    <a class="code hl_function" href="menu_2lib_8h.html#a5a9733924cc01176ee916515a3683268">menu_queue_redraw</a>(menu, <a class="code hl_define" href="menu_2lib_8h.html#afd1295f0c36408826d642e4771b89a1b">MENU_REDRAW_MOTION</a>);</div>
<div class="line"><span class="lineno">  522</span>  }</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>  <span class="keywordflow">if</span> (rc == 0)</div>
<div class="line"><span class="lineno">  525</span>  {</div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordflow">if</span> (!c_attach_split)</div>
<div class="line"><span class="lineno">  527</span>      saved_attachments = 1;</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>    <span class="keywordflow">if</span> (!c_attach_split || c_attach_save_without_prompting)</div>
<div class="line"><span class="lineno">  530</span>    {</div>
<div class="line"><span class="lineno">  531</span>      <a class="code hl_define" href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a>(ngettext(<span class="stringliteral">&quot;Attachment saved&quot;</span>, <span class="stringliteral">&quot;%d attachments saved&quot;</span>, saved_attachments),</div>
<div class="line"><span class="lineno">  532</span>                   saved_attachments);</div>
<div class="line"><span class="lineno">  533</span>    }</div>
<div class="line"><span class="lineno">  534</span>  }</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>cleanup:</div>
<div class="line"><span class="lineno">  537</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;buf);</div>
<div class="line"><span class="lineno">  538</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;tfile);</div>
<div class="line"><span class="lineno">  539</span>}</div>
<div class="ttc" id="abrowser_2complete_8c_html_a6bd4da54e7d75404519878f3ef32c87e"><div class="ttname"><a href="browser_2complete_8c.html#a6bd4da54e7d75404519878f3ef32c87e">CompleteFileOps</a></div><div class="ttdeci">const struct CompleteOps CompleteFileOps</div><div class="ttdoc">Auto-Completion of Files.</div><div class="ttdef"><b>Definition</b> <a href="browser_2complete_8c_source.html#l00152">complete.c:152</a></div></div>
<div class="ttc" id="abuffer_8c_html_a4245e227baa2a9beb6991917404aab0d"><div class="ttname"><a href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a></div><div class="ttdeci">bool buf_is_empty(const struct Buffer *buf)</div><div class="ttdoc">Is the Buffer empty?</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00291">buffer.c:291</a></div></div>
<div class="ttc" id="abuffer_8c_html_ac958acbd189e463a2c3bbc2f23aaeb1e"><div class="ttname"><a href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a></div><div class="ttdeci">size_t buf_strcpy(struct Buffer *buf, const char *s)</div><div class="ttdoc">Copy a string into a Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00395">buffer.c:395</a></div></div>
<div class="ttc" id="abuffer_8h_html_a728ebc5a947b77c8d56db44ce553a7ab"><div class="ttname"><a href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a></div><div class="ttdeci">static const char * buf_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00096">buffer.h:96</a></div></div>
<div class="ttc" id="aconfig_2helpers_8c_html_a6b1589ee93ff51ef31f1d9324e138078"><div class="ttname"><a href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00291">helpers.c:291</a></div></div>
<div class="ttc" id="aconfig_2helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00047">helpers.c:47</a></div></div>
<div class="ttc" id="adraw_8c_html_a3da31793ff9ae935dccab75ae653a064"><div class="ttname"><a href="draw_8c.html#a3da31793ff9ae935dccab75ae653a064">menu_redraw</a></div><div class="ttdeci">int menu_redraw(struct Menu *menu)</div><div class="ttdoc">Redraw the parts of the screen that have been flagged to be redrawn.</div><div class="ttdef"><b>Definition</b> <a href="draw_8c_source.html#l00480">draw.c:480</a></div></div>
<div class="ttc" id="afile_8h_html_a9b519e795f098be88b93cd72c49a35ec"><div class="ttname"><a href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a></div><div class="ttdeci">#define mutt_file_fclose(FP)</div><div class="ttdef"><b>Definition</b> <a href="file_8h_source.html#l00139">file.h:139</a></div></div>
<div class="ttc" id="afile_8h_html_a9fa358d76519cb6bc8ffca5850976d46"><div class="ttname"><a href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a></div><div class="ttdeci">#define mutt_file_fopen(PATH, MODE)</div><div class="ttdef"><b>Definition</b> <a href="file_8h_source.html#l00138">file.h:138</a></div></div>
<div class="ttc" id="agroup__gui__mw_html_gabcbd2498b412e9f8e9d953cafc01989c"><div class="ttname"><a href="group__gui__mw.html#gabcbd2498b412e9f8e9d953cafc01989c">mw_get_field</a></div><div class="ttdeci">int mw_get_field(const char *prompt, struct Buffer *buf, CompletionFlags complete, enum HistoryClass hclass, const struct CompleteOps *comp_api, void *cdata)</div><div class="ttdoc">Ask the user for a string -.</div><div class="ttdef"><b>Definition</b> <a href="editor_2window_8c_source.html#l00272">window.c:272</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gae108f891125caafa9250cf0959c40c04"><div class="ttname"><a href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a></div><div class="ttdeci">#define mutt_message(...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00092">logging2.h:92</a></div></div>
<div class="ttc" id="ahistory_2lib_8h_html_acb0a49d94e5b4fe512c30e2c12621234a313ffe25b1e9a86bb1f9afb44e15925c"><div class="ttname"><a href="history_2lib_8h.html#acb0a49d94e5b4fe512c30e2c12621234a313ffe25b1e9a86bb1f9afb44e15925c">HC_FILE</a></div><div class="ttdeci">@ HC_FILE</div><div class="ttdoc">Files.</div><div class="ttdef"><b>Definition</b> <a href="history_2lib_8h_source.html#l00057">lib.h:57</a></div></div>
<div class="ttc" id="amemory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00062">memory.h:62</a></div></div>
<div class="ttc" id="amenu_2lib_8h_html_afd1295f0c36408826d642e4771b89a1b"><div class="ttname"><a href="menu_2lib_8h.html#afd1295f0c36408826d642e4771b89a1b">MENU_REDRAW_MOTION</a></div><div class="ttdeci">#define MENU_REDRAW_MOTION</div><div class="ttdoc">Redraw after moving the menu list.</div><div class="ttdef"><b>Definition</b> <a href="menu_2lib_8h_source.html#l00057">lib.h:57</a></div></div>
<div class="ttc" id="amutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="amutt_2path_8c_html_a3868ea49aae027f4fc188e2c9b933a31"><div class="ttname"><a href="mutt_2path_8c.html#a3868ea49aae027f4fc188e2c9b933a31">mutt_path_basename</a></div><div class="ttdeci">const char * mutt_path_basename(const char *path)</div><div class="ttdoc">Find the last component for a pathname.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2path_8c_source.html#l00282">path.c:282</a></div></div>
<div class="ttc" id="amutt_8h_html_aff320b29c6010a53a17749f6423834a3"><div class="ttname"><a href="mutt_8h.html#aff320b29c6010a53a17749f6423834a3">MUTT_COMP_CLEAR</a></div><div class="ttdeci">#define MUTT_COMP_CLEAR</div><div class="ttdoc">Clear input if printable character is pressed.</div><div class="ttdef"><b>Definition</b> <a href="mutt_8h_source.html#l00057">mutt.h:57</a></div></div>
<div class="ttc" id="amutt__attach_8h_html_a5675c7a41890711ec4871b592c840faa"><div class="ttname"><a href="#a5675c7a41890711ec4871b592c840faa">SaveAttach</a></div><div class="ttdeci">SaveAttach</div><div class="ttdoc">Options for saving attachments.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8h_source.html#l00056">mutt_attach.h:57</a></div></div>
<div class="ttc" id="amuttlib_8c_html_adde3990a0490dfba609fc94dbdbfd6b3"><div class="ttname"><a href="muttlib_8c.html#adde3990a0490dfba609fc94dbdbfd6b3">buf_expand_path</a></div><div class="ttdeci">void buf_expand_path(struct Buffer *buf)</div><div class="ttdoc">Create the canonical path.</div><div class="ttdef"><b>Definition</b> <a href="muttlib_8c_source.html#l00314">muttlib.c:314</a></div></div>
<div class="ttc" id="amuttlib_8c_html_ae34cbb3670824b1838c0973c88aab15b"><div class="ttname"><a href="muttlib_8c.html#ae34cbb3670824b1838c0973c88aab15b">mutt_check_overwrite</a></div><div class="ttdeci">int mutt_check_overwrite(const char *attname, const char *path, struct Buffer *fname, enum SaveAttach *opt, char **directory)</div><div class="ttdoc">Ask the user if overwriting is necessary.</div><div class="ttdef"><b>Definition</b> <a href="muttlib_8c_source.html#l00540">muttlib.c:540</a></div></div>
<div class="ttc" id="apool_8c_html_a41cba27c25d33cb6822789a2856093f2"><div class="ttname"><a href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a></div><div class="ttdeci">struct Buffer * buf_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00082">pool.c:82</a></div></div>
<div class="ttc" id="apool_8c_html_a4cc6068279461cb8628219586dfa35a1"><div class="ttname"><a href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a></div><div class="ttdeci">void buf_pool_release(struct Buffer **ptr)</div><div class="ttdoc">Return a Buffer to the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00096">pool.c:96</a></div></div>
<div class="ttc" id="arecvattach_8c_html_a3c36223d243ef6b041baf6e0bb54533f"><div class="ttname"><a href="recvattach_8c.html#a3c36223d243ef6b041baf6e0bb54533f">save_attachment_flowed_helper</a></div><div class="ttdeci">static int save_attachment_flowed_helper(FILE *fp, struct Body *b, const char *path, enum SaveAttach flags, struct Email *e)</div><div class="ttdoc">Helper for unstuffing attachments.</div><div class="ttdef"><b>Definition</b> <a href="recvattach_8c_source.html#l00231">recvattach.c:231</a></div></div>
<div class="ttc" id="arecvattach_8c_html_a52c616f195a129f43883a3a3bb8f463f"><div class="ttname"><a href="recvattach_8c.html#a52c616f195a129f43883a3a3bb8f463f">save_without_prompting</a></div><div class="ttdeci">static int save_without_prompting(FILE *fp, struct Body *b, struct Email *e)</div><div class="ttdoc">Save the attachment, without prompting each time.</div><div class="ttdef"><b>Definition</b> <a href="recvattach_8c_source.html#l00381">recvattach.c:381</a></div></div>
<div class="ttc" id="arecvattach_8c_html_a7ead8fceb1c2b8c8c8a86b08e73a1191"><div class="ttname"><a href="recvattach_8c.html#a7ead8fceb1c2b8c8c8a86b08e73a1191">prepend_savedir</a></div><div class="ttdeci">static void prepend_savedir(struct Buffer *buf)</div><div class="ttdoc">Add $attach_save_dir to the beginning of a path.</div><div class="ttdef"><b>Definition</b> <a href="recvattach_8c_source.html#l00172">recvattach.c:172</a></div></div>
<div class="ttc" id="arecvattach_8c_html_acdb2625453e4a2bacee478c06061ba7a"><div class="ttname"><a href="recvattach_8c.html#acdb2625453e4a2bacee478c06061ba7a">query_save_attachment</a></div><div class="ttdeci">static int query_save_attachment(FILE *fp, struct Body *b, struct Email *e, char **directory)</div><div class="ttdoc">Ask the user if we should save the attachment.</div><div class="ttdef"><b>Definition</b> <a href="recvattach_8c_source.html#l00277">recvattach.c:277</a></div></div>
<div class="ttc" id="astring2_8h_html_a7e0481bed27661ea2679f256b24e0283"><div class="ttname"><a href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a></div><div class="ttdeci">#define NONULL(x)</div><div class="ttdef"><b>Definition</b> <a href="string2_8h_source.html#l00043">string2.h:43</a></div></div>
<div class="ttc" id="astructAttachCtx_html_a8954cda6f07f33628b3addf8bc2621fd"><div class="ttname"><a href="structAttachCtx.html#a8954cda6f07f33628b3addf8bc2621fd">AttachCtx::idx</a></div><div class="ttdeci">struct AttachPtr ** idx</div><div class="ttdoc">Array of attachments.</div><div class="ttdef"><b>Definition</b> <a href="attach_8h_source.html#l00067">attach.h:67</a></div></div>
<div class="ttc" id="astructAttachCtx_html_af02af835a67d8b3467f3a52ede4897f0"><div class="ttname"><a href="structAttachCtx.html#af02af835a67d8b3467f3a52ede4897f0">AttachCtx::idxlen</a></div><div class="ttdeci">short idxlen</div><div class="ttdoc">Number of attachmentes.</div><div class="ttdef"><b>Definition</b> <a href="attach_8h_source.html#l00068">attach.h:68</a></div></div>
<div class="ttc" id="astructAttachPtr_html_a71db2d33eefd6c1f41f129f6943fe83a"><div class="ttname"><a href="structAttachPtr.html#a71db2d33eefd6c1f41f129f6943fe83a">AttachPtr::num</a></div><div class="ttdeci">int num</div><div class="ttdoc">Attachment index number.</div><div class="ttdef"><b>Definition</b> <a href="attach_8h_source.html#l00041">attach.h:41</a></div></div>
<div class="ttc" id="astructBody_html_aaaa97781986925aa1f10f24be18243ab"><div class="ttname"><a href="structBody.html#aaaa97781986925aa1f10f24be18243ab">Body::tagged</a></div><div class="ttdeci">bool tagged</div><div class="ttdoc">This attachment is tagged.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00090">body.h:90</a></div></div>
<div class="ttc" id="astructBody_html_afe3cd2c4b1070e3d0edbf1fed939ac5a"><div class="ttname"><a href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">Body::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">When sending a message, this is the file to which this structure refers.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00059">body.h:59</a></div></div>
<div class="ttc" id="astructBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00035">buffer.h:36</a></div></div>
<div class="ttc" id="astructFileCompletionData_html"><div class="ttname"><a href="structFileCompletionData.html">FileCompletionData</a></div><div class="ttdoc">Input for the file completion function.</div><div class="ttdef"><b>Definition</b> <a href="curs__lib_8h_source.html#l00038">curs_lib.h:39</a></div></div>
</div><!-- fragment --><div id="dynsection-4" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a588a5719b699c5d062f263711598836e_cgraph.svg" width="976" height="1070"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-5" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a588a5719b699c5d062f263711598836e_icgraph.svg" width="420" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a864d3327398fde25536c45736abde530" name="a864d3327398fde25536c45736abde530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a864d3327398fde25536c45736abde530">&#9670;&#160;</a></span>mutt_pipe_attachment_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_pipe_attachment_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structAttachCtx.html">AttachCtx</a> *</td>          <td class="paramname"><span class="paramname"><em>actx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>tag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>filter</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pipe a list of attachments to a command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">actx</td><td>Attachment context </td></tr>
    <tr><td class="paramname">fp</td><td>File handle to the attachment (OPTIONAL) </td></tr>
    <tr><td class="paramname">tag</td><td>If true, only save the tagged attachments </td></tr>
    <tr><td class="paramname">b</td><td>First Attachment </td></tr>
    <tr><td class="paramname">filter</td><td>Is this command a filter? </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="recvattach_8c_source.html#l00723">723</a> of file <a class="el" href="recvattach_8c_source.html">recvattach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  725</span>{</div>
<div class="line"><span class="lineno">  726</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structState.html">State</a> state = { 0 };</div>
<div class="line"><span class="lineno">  727</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *buf = NULL;</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>  <span class="keywordflow">if</span> (fp)</div>
<div class="line"><span class="lineno">  730</span>    filter = <span class="keyword">false</span>; <span class="comment">/* sanity check: we can&#39;t filter in the recv case yet */</span></div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>  buf = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  733</span>  <span class="comment">/* perform charset conversion on text attachments when piping */</span></div>
<div class="line"><span class="lineno">  734</span>  state.<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> = <a class="code hl_define" href="mutt_2state_8h.html#abff873a2f7f4f3e664c8c4f90a11f44a">STATE_CHARCONV</a>;</div>
<div class="line"><span class="lineno">  735</span> </div>
<div class="line"><span class="lineno">  736</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="group__gui__mw.html#gabcbd2498b412e9f8e9d953cafc01989c">mw_get_field</a>((filter ? <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Filter through: &quot;</span>) : <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Pipe to: &quot;</span>)), buf,</div>
<div class="line"><span class="lineno">  737</span>                   <a class="code hl_define" href="mutt_8h.html#ab0d3fda521b45dec654ff46bac59c8c2">MUTT_COMP_NO_FLAGS</a>, <a class="code hl_enumvalue" href="history_2lib_8h.html#acb0a49d94e5b4fe512c30e2c12621234a350c302f5ffad1c98c763828089f37bd">HC_EXT_COMMAND</a>, &amp;<a class="code hl_variable" href="browser_2complete_8c.html#a6bd4da54e7d75404519878f3ef32c87e">CompleteFileOps</a>, NULL) != 0)</div>
<div class="line"><span class="lineno">  738</span>  {</div>
<div class="line"><span class="lineno">  739</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  740</span>  }</div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(buf))</div>
<div class="line"><span class="lineno">  743</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>  <a class="code hl_function" href="muttlib_8c.html#adde3990a0490dfba609fc94dbdbfd6b3">buf_expand_path</a>(buf);</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_attach_split = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;attach_split&quot;</span>);</div>
<div class="line"><span class="lineno">  748</span>  <span class="keywordflow">if</span> (!filter &amp;&amp; !c_attach_split)</div>
<div class="line"><span class="lineno">  749</span>  {</div>
<div class="line"><span class="lineno">  750</span>    <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  751</span>    pid_t pid = <a class="code hl_function" href="mutt_2filter_8c.html#ad1ec6916f8ee2520af1711891f6b5302">filter_create</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf), &amp;state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, NULL, NULL,</div>
<div class="line"><span class="lineno">  752</span>                              <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">env</a>);</div>
<div class="line"><span class="lineno">  753</span>    <a class="code hl_function" href="recvattach_8c.html#a5966c1c4dd427e245631eb236129a5e2">pipe_attachment_list</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf), actx, fp, tag, b, filter, &amp;state);</div>
<div class="line"><span class="lineno">  754</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>);</div>
<div class="line"><span class="lineno">  755</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_wait_key = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;wait_key&quot;</span>);</div>
<div class="line"><span class="lineno">  756</span>    <span class="keywordflow">if</span> ((<a class="code hl_function" href="mutt_2filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a>(pid) != 0) || c_wait_key)</div>
<div class="line"><span class="lineno">  757</span>      <a class="code hl_function" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a>(NULL);</div>
<div class="line"><span class="lineno">  758</span>  }</div>
<div class="line"><span class="lineno">  759</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  760</span>  {</div>
<div class="line"><span class="lineno">  761</span>    <a class="code hl_function" href="recvattach_8c.html#a5966c1c4dd427e245631eb236129a5e2">pipe_attachment_list</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(buf), actx, fp, tag, b, filter, &amp;state);</div>
<div class="line"><span class="lineno">  762</span>  }</div>
<div class="line"><span class="lineno">  763</span> </div>
<div class="line"><span class="lineno">  764</span>cleanup:</div>
<div class="line"><span class="lineno">  765</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;buf);</div>
<div class="line"><span class="lineno">  766</span>}</div>
<div class="ttc" id="acurs__lib_8c_html_ab6a61cdfcf8c2c73ee59381c79c79774"><div class="ttname"><a href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a></div><div class="ttdeci">int mutt_any_key_to_continue(const char *s)</div><div class="ttdoc">Prompt the user to &#39;press any key&#39; and wait.</div><div class="ttdef"><b>Definition</b> <a href="curs__lib_8c_source.html#l00174">curs_lib.c:174</a></div></div>
<div class="ttc" id="acurs__lib_8c_html_acd14d074d8b9e6cb21e851dd573cdec2"><div class="ttname"><a href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a></div><div class="ttdeci">void mutt_endwin(void)</div><div class="ttdoc">Shutdown curses.</div><div class="ttdef"><b>Definition</b> <a href="curs__lib_8c_source.html#l00152">curs_lib.c:152</a></div></div>
<div class="ttc" id="ahistory_2lib_8h_html_acb0a49d94e5b4fe512c30e2c12621234a350c302f5ffad1c98c763828089f37bd"><div class="ttname"><a href="history_2lib_8h.html#acb0a49d94e5b4fe512c30e2c12621234a350c302f5ffad1c98c763828089f37bd">HC_EXT_COMMAND</a></div><div class="ttdeci">@ HC_EXT_COMMAND</div><div class="ttdoc">External commands.</div><div class="ttdef"><b>Definition</b> <a href="history_2lib_8h_source.html#l00054">lib.h:54</a></div></div>
<div class="ttc" id="amutt_2filter_8c_html_a22c6912b837b1114c3276c990e73dca3"><div class="ttname"><a href="mutt_2filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a></div><div class="ttdeci">int filter_wait(pid_t pid)</div><div class="ttdoc">Wait for the exit of a process and return its status.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2filter_8c_source.html#l00220">filter.c:220</a></div></div>
<div class="ttc" id="amutt_2filter_8c_html_ad1ec6916f8ee2520af1711891f6b5302"><div class="ttname"><a href="mutt_2filter_8c.html#ad1ec6916f8ee2520af1711891f6b5302">filter_create</a></div><div class="ttdeci">pid_t filter_create(const char *cmd, FILE **fp_in, FILE **fp_out, FILE **fp_err, char **envlist)</div><div class="ttdoc">Set up filter program.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2filter_8c_source.html#l00209">filter.c:209</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_abff873a2f7f4f3e664c8c4f90a11f44a"><div class="ttname"><a href="mutt_2state_8h.html#abff873a2f7f4f3e664c8c4f90a11f44a">STATE_CHARCONV</a></div><div class="ttdeci">#define STATE_CHARCONV</div><div class="ttdoc">Do character set conversions.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00037">state.h:37</a></div></div>
<div class="ttc" id="amutt_8h_html_ab0d3fda521b45dec654ff46bac59c8c2"><div class="ttname"><a href="mutt_8h.html#ab0d3fda521b45dec654ff46bac59c8c2">MUTT_COMP_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_COMP_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="mutt_8h_source.html#l00056">mutt.h:56</a></div></div>
<div class="ttc" id="arecvattach_8c_html_a5966c1c4dd427e245631eb236129a5e2"><div class="ttname"><a href="recvattach_8c.html#a5966c1c4dd427e245631eb236129a5e2">pipe_attachment_list</a></div><div class="ttdeci">static void pipe_attachment_list(const char *command, struct AttachCtx *actx, FILE *fp, bool tag, struct Body *top, bool filter, struct State *state)</div><div class="ttdoc">Pipe a list of attachments to a command.</div><div class="ttdef"><b>Definition</b> <a href="recvattach_8c_source.html#l00691">recvattach.c:691</a></div></div>
<div class="ttc" id="astructNeoMutt_html_a5410041863c473ba1f27b415c0a40482"><div class="ttname"><a href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">NeoMutt::env</a></div><div class="ttdeci">char ** env</div><div class="ttdoc">Private copy of the environment variables.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00055">neomutt.h:55</a></div></div>
<div class="ttc" id="astructState_html"><div class="ttname"><a href="structState.html">State</a></div><div class="ttdoc">Keep track when processing files.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00047">state.h:48</a></div></div>
<div class="ttc" id="astructState_html_a5d855f7d518fde2ac4e8e409cbb24ad3"><div class="ttname"><a href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">State::flags</a></div><div class="ttdeci">StateFlags flags</div><div class="ttdoc">Flags, e.g. STATE_DISPLAY.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00052">state.h:52</a></div></div>
<div class="ttc" id="astructState_html_a88fc722d3012ebf69d3a061cbf6bc296"><div class="ttname"><a href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">State::fp_out</a></div><div class="ttdeci">FILE * fp_out</div><div class="ttdoc">File to write to.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00050">state.h:50</a></div></div>
</div><!-- fragment --><div id="dynsection-6" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a864d3327398fde25536c45736abde530_cgraph.svg" width="590" height="612"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-7" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a864d3327398fde25536c45736abde530_icgraph.svg" width="420" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac869ec7f92735053d33d3143d9866af5" name="ac869ec7f92735053d33d3143d9866af5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac869ec7f92735053d33d3143d9866af5">&#9670;&#160;</a></span>mutt_print_attachment_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_print_attachment_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structAttachCtx.html">AttachCtx</a> *</td>          <td class="paramname"><span class="paramname"><em>actx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>tag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print a list of Attachments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">actx</td><td>Attachment context </td></tr>
    <tr><td class="paramname">fp</td><td>File handle to the attachment (OPTIONAL) </td></tr>
    <tr><td class="paramname">tag</td><td>Apply to all tagged Attachments </td></tr>
    <tr><td class="paramname">b</td><td>First Attachment </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="recvattach_8c_source.html#l00887">887</a> of file <a class="el" href="recvattach_8c_source.html">recvattach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  888</span>{</div>
<div class="line"><span class="lineno">  889</span>  <span class="keywordtype">char</span> prompt[128] = { 0 };</div>
<div class="line"><span class="lineno">  890</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structState.html">State</a> state = { 0 };</div>
<div class="line"><span class="lineno">  891</span>  <span class="keywordtype">int</span> tagmsgcount = 0;</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>  <span class="keywordflow">if</span> (tag)</div>
<div class="line"><span class="lineno">  894</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; actx-&gt;<a class="code hl_variable" href="structAttachCtx.html#af02af835a67d8b3467f3a52ede4897f0">idxlen</a>; i++)</div>
<div class="line"><span class="lineno">  895</span>      <span class="keywordflow">if</span> (actx-&gt;<a class="code hl_variable" href="structAttachCtx.html#a8954cda6f07f33628b3addf8bc2621fd">idx</a>[i]-&gt;<a class="code hl_variable" href="structAttachPtr.html#a0546c0753a6155ae9555c290b80d0356">body</a>-&gt;<a class="code hl_variable" href="structBody.html#aaaa97781986925aa1f10f24be18243ab">tagged</a>)</div>
<div class="line"><span class="lineno">  896</span>        tagmsgcount++;</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>  snprintf(prompt, <span class="keyword">sizeof</span>(prompt),</div>
<div class="line"><span class="lineno">  899</span>           tag ? ngettext(<span class="stringliteral">&quot;Print tagged attachment?&quot;</span>, <span class="stringliteral">&quot;Print %d tagged attachments?&quot;</span>, tagmsgcount) :</div>
<div class="line"><span class="lineno">  900</span>                 <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Print attachment?&quot;</span>),</div>
<div class="line"><span class="lineno">  901</span>           tagmsgcount);</div>
<div class="line"><span class="lineno">  902</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="question_2lib_8h.html#a8ba883bf53e8ab425a03d17368de84b4">query_quadoption</a>(prompt, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;print&quot;</span>) != <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div>
<div class="line"><span class="lineno">  903</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_attach_split = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;attach_split&quot;</span>);</div>
<div class="line"><span class="lineno">  906</span>  <span class="keywordflow">if</span> (c_attach_split)</div>
<div class="line"><span class="lineno">  907</span>  {</div>
<div class="line"><span class="lineno">  908</span>    <a class="code hl_function" href="recvattach_8c.html#a455edbcf4058a6732d4b69cc54399cb4">print_attachment_list</a>(actx, fp, tag, b, &amp;state);</div>
<div class="line"><span class="lineno">  909</span>  }</div>
<div class="line"><span class="lineno">  910</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  911</span>  {</div>
<div class="line"><span class="lineno">  912</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="recvattach_8c.html#a93c04f1721c1f04db77f3e8dc5906913">can_print</a>(actx, b, tag))</div>
<div class="line"><span class="lineno">  913</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  914</span>    <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  915</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_print_command = <a class="code hl_function" href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;print_command&quot;</span>);</div>
<div class="line"><span class="lineno">  916</span>    pid_t pid = <a class="code hl_function" href="mutt_2filter_8c.html#ad1ec6916f8ee2520af1711891f6b5302">filter_create</a>(<a class="code hl_define" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(c_print_command), &amp;state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>, NULL,</div>
<div class="line"><span class="lineno">  917</span>                              NULL, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">env</a>);</div>
<div class="line"><span class="lineno">  918</span>    <a class="code hl_function" href="recvattach_8c.html#a455edbcf4058a6732d4b69cc54399cb4">print_attachment_list</a>(actx, fp, tag, b, &amp;state);</div>
<div class="line"><span class="lineno">  919</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>);</div>
<div class="line"><span class="lineno">  920</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_wait_key = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;wait_key&quot;</span>);</div>
<div class="line"><span class="lineno">  921</span>    <span class="keywordflow">if</span> ((<a class="code hl_function" href="mutt_2filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a>(pid) != 0) || c_wait_key)</div>
<div class="line"><span class="lineno">  922</span>      <a class="code hl_function" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a>(NULL);</div>
<div class="line"><span class="lineno">  923</span>  }</div>
<div class="line"><span class="lineno">  924</span>}</div>
<div class="ttc" id="aquad_8h_html_a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a></div><div class="ttdeci">@ MUTT_YES</div><div class="ttdoc">User answered &#39;Yes&#39;, or assume &#39;Yes&#39;.</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00039">quad.h:39</a></div></div>
<div class="ttc" id="aquestion_2lib_8h_html_a8ba883bf53e8ab425a03d17368de84b4"><div class="ttname"><a href="question_2lib_8h.html#a8ba883bf53e8ab425a03d17368de84b4">query_quadoption</a></div><div class="ttdeci">enum QuadOption query_quadoption(const char *prompt, struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Ask the user a quad-question.</div><div class="ttdef"><b>Definition</b> <a href="question_8c_source.html#l00377">question.c:377</a></div></div>
<div class="ttc" id="arecvattach_8c_html_a455edbcf4058a6732d4b69cc54399cb4"><div class="ttname"><a href="recvattach_8c.html#a455edbcf4058a6732d4b69cc54399cb4">print_attachment_list</a></div><div class="ttdeci">static void print_attachment_list(struct AttachCtx *actx, FILE *fp, bool tag, struct Body *b, struct State *state)</div><div class="ttdoc">Print a list of Attachments.</div><div class="ttdef"><b>Definition</b> <a href="recvattach_8c_source.html#l00815">recvattach.c:815</a></div></div>
<div class="ttc" id="arecvattach_8c_html_a93c04f1721c1f04db77f3e8dc5906913"><div class="ttname"><a href="recvattach_8c.html#a93c04f1721c1f04db77f3e8dc5906913">can_print</a></div><div class="ttdeci">static bool can_print(struct AttachCtx *actx, struct Body *b, bool tag)</div><div class="ttdoc">Do we know how to print this attachment type?</div><div class="ttdef"><b>Definition</b> <a href="recvattach_8c_source.html#l00775">recvattach.c:775</a></div></div>
</div><!-- fragment --><div id="dynsection-8" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_ac869ec7f92735053d33d3143d9866af5_cgraph.svg" width="602" height="462"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-9" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_ac869ec7f92735053d33d3143d9866af5_icgraph.svg" width="423" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab2e07f4628b9c8e41529a62c27d1b51a" name="ab2e07f4628b9c8e41529a62c27d1b51a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2e07f4628b9c8e41529a62c27d1b51a">&#9670;&#160;</a></span>mutt_view_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_view_attachment </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="#a5dd95d385576ba1b957d7e9c523ec946">ViewAttachMode</a></td>          <td class="paramname"><span class="paramname"><em>mode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structAttachCtx.html">AttachCtx</a> *</td>          <td class="paramname"><span class="paramname"><em>actx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structMuttWindow.html">MuttWindow</a> *</td>          <td class="paramname"><span class="paramname"><em>win</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>View an attachment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>Source file stream. Can be NULL </td></tr>
    <tr><td class="paramname">b</td><td>The message body containing the attachment </td></tr>
    <tr><td class="paramname">mode</td><td>How the attachment should be viewed, see <a class="el" href="#a5dd95d385576ba1b957d7e9c523ec946" title="Options for mutt_view_attachment()">ViewAttachMode</a> </td></tr>
    <tr><td class="paramname">e</td><td>Current <a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a>. Can be NULL </td></tr>
    <tr><td class="paramname">actx</td><td>Attachment context </td></tr>
    <tr><td class="paramname">win</td><td>Window </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>The viewer is run and exited successfully </td></tr>
    <tr><td class="paramname">-1</td><td>Error </td></tr>
    <tr><td class="paramname">num</td><td>Return value of <a class="el" href="do__pager_8c.html#a9d3af21b7fdf24249c261a9a1aa9f3be" title="Display some page-able text to the user (help or attachment)">mutt_do_pager()</a> when it is used</td></tr>
  </table>
  </dd>
</dl>
<p>Display a message attachment using the viewer program configured in mailcap. If there is no mailcap entry for a file type, view the image as text. Viewer processes are opened and waited on synchronously so viewing an attachment this way will block the main neomutt process until the viewer process exits. </p>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8c_source.html#l00419">419</a> of file <a class="el" href="mutt__attach_8c_source.html">mutt_attach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  421</span>{</div>
<div class="line"><span class="lineno">  422</span>  <span class="keywordtype">bool</span> use_mailcap = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  423</span>  <span class="keywordtype">bool</span> use_pipe = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  424</span>  <span class="keywordtype">bool</span> use_pager = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  425</span>  <span class="keywordtype">char</span> type[256] = { 0 };</div>
<div class="line"><span class="lineno">  426</span>  <span class="keywordtype">char</span> desc[512] = { 0 };</div>
<div class="line"><span class="lineno">  427</span>  <span class="keywordtype">char</span> *fname = NULL;</div>
<div class="line"><span class="lineno">  428</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structMailcapEntry.html">MailcapEntry</a> *entry = NULL;</div>
<div class="line"><span class="lineno">  429</span>  <span class="keywordtype">int</span> rc = -1;</div>
<div class="line"><span class="lineno">  430</span>  <span class="keywordtype">bool</span> has_tempfile = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  431</span>  <span class="keywordtype">bool</span> unlink_pagerfile = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>  <span class="keywordtype">bool</span> is_message = <a class="code hl_function" href="email_2parse_8c.html#adcc90fb584fec1be116777c533e9b3d4">mutt_is_message_type</a>(b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a>, b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>);</div>
<div class="line"><span class="lineno">  434</span>  <span class="keywordflow">if</span> ((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp; is_message &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  435</span>      (b-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>) &amp;&amp; !<a class="code hl_function" href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a>(b-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a>))</div>
<div class="line"><span class="lineno">  436</span>  {</div>
<div class="line"><span class="lineno">  437</span>    <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  438</span>  }</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *tempfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  441</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *pagerfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  442</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *cmd = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>  use_mailcap = ((mode == <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946a0dcfd8a67792775ae3506d2a99bf1b67">MUTT_VA_MAILCAP</a>) ||</div>
<div class="line"><span class="lineno">  445</span>                 ((mode == <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946a805f2934d475a513bb1294baa8e5d00b">MUTT_VA_REGULAR</a>) &amp;&amp; <a class="code hl_function" href="muttlib_8c.html#a8973b2e5185609bfc5e0ef136fcd3177">mutt_needs_mailcap</a>(b)) ||</div>
<div class="line"><span class="lineno">  446</span>                 (mode == <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946ab4f9fd68dbd70c2bd8f4e3795bed15cc">MUTT_VA_PAGER</a>));</div>
<div class="line"><span class="lineno">  447</span>  snprintf(type, <span class="keyword">sizeof</span>(type), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code hl_define" href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a>(b), b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>);</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>  <span class="keywordtype">char</span> columns[16] = { 0 };</div>
<div class="line"><span class="lineno">  450</span>  snprintf(columns, <span class="keyword">sizeof</span>(columns), <span class="stringliteral">&quot;%d&quot;</span>, win-&gt;<a class="code hl_variable" href="structMuttWindow.html#a406b976fc50b1cb5beca6c85e7a3be7f">state</a>.<a class="code hl_variable" href="structWindowState.html#a557cf2197f9df8fe60f6e1dbfd49ec43">cols</a>);</div>
<div class="line"><span class="lineno">  451</span>  <a class="code hl_function" href="envlist_8c.html#a8643dfebf12ab95f38021cf7fac716cc">envlist_set</a>(&amp;<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">env</a>, <span class="stringliteral">&quot;COLUMNS&quot;</span>, columns, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>  <span class="keywordflow">if</span> (use_mailcap)</div>
<div class="line"><span class="lineno">  454</span>  {</div>
<div class="line"><span class="lineno">  455</span>    entry = <a class="code hl_function" href="mailcap_8c.html#a8114f2f64a9bf84055e0e1d624b8c050">mailcap_entry_new</a>();</div>
<div class="line"><span class="lineno">  456</span>    <span class="keyword">enum</span> <a class="code hl_enumeration" href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1">MailcapLookup</a> mailcap_opt = (mode == <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946ab4f9fd68dbd70c2bd8f4e3795bed15cc">MUTT_VA_PAGER</a>) ? <a class="code hl_enumvalue" href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1a685052e871afa17028f0e1c11e056a60">MUTT_MC_AUTOVIEW</a> : <a class="code hl_enumvalue" href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1abe09e527550677b514f34f0fd421d8f8">MUTT_MC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="mailcap_8c.html#af76f3b2c5819c22f1470723cc30a9ad1">mailcap_lookup</a>(b, type, <span class="keyword">sizeof</span>(type), entry, mailcap_opt))</div>
<div class="line"><span class="lineno">  458</span>    {</div>
<div class="line"><span class="lineno">  459</span>      <span class="keywordflow">if</span> ((mode == <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946a805f2934d475a513bb1294baa8e5d00b">MUTT_VA_REGULAR</a>) || (mode == <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946ab4f9fd68dbd70c2bd8f4e3795bed15cc">MUTT_VA_PAGER</a>))</div>
<div class="line"><span class="lineno">  460</span>      {</div>
<div class="line"><span class="lineno">  461</span>        <span class="comment">/* fallback to view as text */</span></div>
<div class="line"><span class="lineno">  462</span>        <a class="code hl_function" href="mailcap_8c.html#a49fd88d8bb73a7a56c4cc0fe28dfb645">mailcap_entry_free</a>(&amp;entry);</div>
<div class="line"><span class="lineno">  463</span>        <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No matching mailcap entry found.  Viewing as text.&quot;</span>));</div>
<div class="line"><span class="lineno">  464</span>        mode = <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946ae2885fe7d47c03a1f0246d054739da79">MUTT_VA_AS_TEXT</a>;</div>
<div class="line"><span class="lineno">  465</span>        use_mailcap = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  466</span>      }</div>
<div class="line"><span class="lineno">  467</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  468</span>      {</div>
<div class="line"><span class="lineno">  469</span>        <span class="keywordflow">goto</span> return_error;</div>
<div class="line"><span class="lineno">  470</span>      }</div>
<div class="line"><span class="lineno">  471</span>    }</div>
<div class="line"><span class="lineno">  472</span>  }</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>  <span class="keywordflow">if</span> (use_mailcap)</div>
<div class="line"><span class="lineno">  475</span>  {</div>
<div class="line"><span class="lineno">  476</span>    <span class="keywordflow">if</span> (!entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#ad682bf5b0b80e72f2a9b9196728514e3">command</a>)</div>
<div class="line"><span class="lineno">  477</span>    {</div>
<div class="line"><span class="lineno">  478</span>      <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;MIME type not defined.  Can&#39;t view attachment.&quot;</span>));</div>
<div class="line"><span class="lineno">  479</span>      <span class="keywordflow">goto</span> return_error;</div>
<div class="line"><span class="lineno">  480</span>    }</div>
<div class="line"><span class="lineno">  481</span>    <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(cmd, entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#ad682bf5b0b80e72f2a9b9196728514e3">command</a>);</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>    fname = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div>
<div class="line"><span class="lineno">  484</span>    <span class="comment">/* In send mode(!fp), we allow slashes because those are part of</span></div>
<div class="line"><span class="lineno">  485</span><span class="comment">     * the tempfile.  The path will be removed in expand_filename */</span></div>
<div class="line"><span class="lineno">  486</span>    <a class="code hl_function" href="file_8c.html#a4deebaf3a646b3075a2b51eda5dc03ca">mutt_file_sanitize_filename</a>(fname, fp ? <span class="keyword">true</span> : <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  487</span>    <a class="code hl_function" href="mailcap_8c.html#accb5ae6e2f507053e8436a2f00b834ea">mailcap_expand_filename</a>(entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a85835d27aa930e64eef4eae5f9498401">nametemplate</a>, fname, tempfile);</div>
<div class="line"><span class="lineno">  488</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;fname);</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt__attach_8c.html#a87e1ea8a7b0c926e02ed3db8b7d3dbd5">mutt_save_attachment</a>(fp, b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), 0, NULL) == -1)</div>
<div class="line"><span class="lineno">  491</span>      <span class="keywordflow">goto</span> return_error;</div>
<div class="line"><span class="lineno">  492</span>    has_tempfile = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>    <a class="code hl_function" href="rfc3676_8c.html#aafc5472c7687d8941a25999aa30d2be4">mutt_rfc3676_space_unstuff_attachment</a>(b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>    <span class="comment">/* check for multipart/related and save attachments with b Content-ID */</span></div>
<div class="line"><span class="lineno">  497</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(type, <span class="stringliteral">&quot;text/html&quot;</span>))</div>
<div class="line"><span class="lineno">  498</span>    {</div>
<div class="line"><span class="lineno">  499</span>      <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *related_ancestor = NULL;</div>
<div class="line"><span class="lineno">  500</span>      <span class="keywordflow">if</span> (actx-&gt;<a class="code hl_variable" href="structAttachCtx.html#a91b62fe3fb812a138c34f793b6a543d6">body_idx</a> &amp;&amp; (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> != 0) &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>))</div>
<div class="line"><span class="lineno">  501</span>        related_ancestor = <a class="code hl_function" href="attach_2lib_8c.html#ae5935160eaa47aaf0cb4568a9ba404b0">attach_body_ancestor</a>(actx-&gt;<a class="code hl_variable" href="structAttachCtx.html#a91b62fe3fb812a138c34f793b6a543d6">body_idx</a>[0], b, <span class="stringliteral">&quot;related&quot;</span>);</div>
<div class="line"><span class="lineno">  502</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  503</span>        related_ancestor = <a class="code hl_function" href="attach_2lib_8c.html#ae5935160eaa47aaf0cb4568a9ba404b0">attach_body_ancestor</a>(e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, b, <span class="stringliteral">&quot;related&quot;</span>);</div>
<div class="line"><span class="lineno">  504</span>      <span class="keywordflow">if</span> (related_ancestor)</div>
<div class="line"><span class="lineno">  505</span>      {</div>
<div class="line"><span class="lineno">  506</span>        <span class="keyword">struct </span>CidMapList cid_map_list = <a class="code hl_define" href="queue_8h.html#a3d41ce2c3f1dd21c0d4051d13204c321">STAILQ_HEAD_INITIALIZER</a>(cid_map_list);</div>
<div class="line"><span class="lineno">  507</span>        <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;viewing text/html attachment in multipart/related group\n&quot;</span>);</div>
<div class="line"><span class="lineno">  508</span>        <span class="comment">/* save attachments and build cid_map_list Content-ID to filename mapping list */</span></div>
<div class="line"><span class="lineno">  509</span>        <a class="code hl_function" href="cid_8c.html#a7a714280dc42ab8d32f72fec1a94388d">cid_save_attachments</a>(related_ancestor-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>, &amp;cid_map_list);</div>
<div class="line"><span class="lineno">  510</span>        <span class="comment">/* replace Content-IDs with filenames */</span></div>
<div class="line"><span class="lineno">  511</span>        <a class="code hl_function" href="cid_8c.html#ad9ca67dad4234a2cd06f1ee2b8d0b2a4">cid_to_filename</a>(tempfile, &amp;cid_map_list);</div>
<div class="line"><span class="lineno">  512</span>        <span class="comment">/* empty Content-ID to filename mapping list */</span></div>
<div class="line"><span class="lineno">  513</span>        <a class="code hl_function" href="cid_8c.html#aed54252a3604cd8dc1dac5ce2045c3a8">cid_map_list_clear</a>(&amp;cid_map_list);</div>
<div class="line"><span class="lineno">  514</span>      }</div>
<div class="line"><span class="lineno">  515</span>    }</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    use_pipe = <a class="code hl_function" href="mailcap_8c.html#ac95deddbed52214ab8797bf9d19c1b8b">mailcap_expand_command</a>(b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), type, cmd);</div>
<div class="line"><span class="lineno">  518</span>    use_pager = entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#adcea89b25743514d268e8fde508d6295">copiousoutput</a>;</div>
<div class="line"><span class="lineno">  519</span>  }</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>  <span class="keywordflow">if</span> (use_pager)</div>
<div class="line"><span class="lineno">  522</span>  {</div>
<div class="line"><span class="lineno">  523</span>    <span class="keywordflow">if</span> (fp &amp;&amp; !use_mailcap &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>)</div>
<div class="line"><span class="lineno">  524</span>    {</div>
<div class="line"><span class="lineno">  525</span>      <span class="comment">/* recv case */</span></div>
<div class="line"><span class="lineno">  526</span>      <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(pagerfile, b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div>
<div class="line"><span class="lineno">  527</span>      <a class="code hl_function" href="muttlib_8c.html#acf3a46e57ab84223b270c763ccb166ca">mutt_adv_mktemp</a>(pagerfile);</div>
<div class="line"><span class="lineno">  528</span>    }</div>
<div class="line"><span class="lineno">  529</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  530</span>    {</div>
<div class="line"><span class="lineno">  531</span>      <a class="code hl_define" href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a>(pagerfile);</div>
<div class="line"><span class="lineno">  532</span>    }</div>
<div class="line"><span class="lineno">  533</span>  }</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>  <span class="keywordflow">if</span> (use_mailcap)</div>
<div class="line"><span class="lineno">  536</span>  {</div>
<div class="line"><span class="lineno">  537</span>    pid_t pid = 0;</div>
<div class="line"><span class="lineno">  538</span>    <span class="keywordtype">int</span> fd_temp = -1, fd_pager = -1;</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>    <span class="keywordflow">if</span> (!use_pager)</div>
<div class="line"><span class="lineno">  541</span>      <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_wait_key = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;wait_key&quot;</span>);</div>
<div class="line"><span class="lineno">  544</span>    <span class="keywordflow">if</span> (use_pager || use_pipe)</div>
<div class="line"><span class="lineno">  545</span>    {</div>
<div class="line"><span class="lineno">  546</span>      <span class="keywordflow">if</span> (use_pager &amp;&amp;</div>
<div class="line"><span class="lineno">  547</span>          ((fd_pager = <a class="code hl_function" href="file_8c.html#adf06802ad33e6b1bff09f31d8cbfab67">mutt_file_open</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(pagerfile),</div>
<div class="line"><span class="lineno">  548</span>                                      O_CREAT | O_EXCL | O_WRONLY, 0600)) == -1))</div>
<div class="line"><span class="lineno">  549</span>      {</div>
<div class="line"><span class="lineno">  550</span>        <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;open&quot;</span>);</div>
<div class="line"><span class="lineno">  551</span>        <span class="keywordflow">goto</span> return_error;</div>
<div class="line"><span class="lineno">  552</span>      }</div>
<div class="line"><span class="lineno">  553</span>      unlink_pagerfile = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>      <span class="keywordflow">if</span> (use_pipe &amp;&amp; ((fd_temp = open(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), 0)) == -1))</div>
<div class="line"><span class="lineno">  556</span>      {</div>
<div class="line"><span class="lineno">  557</span>        <span class="keywordflow">if</span> (fd_pager != -1)</div>
<div class="line"><span class="lineno">  558</span>          close(fd_pager);</div>
<div class="line"><span class="lineno">  559</span>        <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;open&quot;</span>);</div>
<div class="line"><span class="lineno">  560</span>        <span class="keywordflow">goto</span> return_error;</div>
<div class="line"><span class="lineno">  561</span>      }</div>
<div class="line"><span class="lineno">  562</span>      unlink_pagerfile = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>      pid = <a class="code hl_function" href="mutt_2filter_8c.html#a8b8175018aa96307b2cf569d719ca6dc">filter_create_fd</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd), NULL, NULL, NULL, use_pipe ? fd_temp : -1,</div>
<div class="line"><span class="lineno">  565</span>                             use_pager ? fd_pager : -1, -1, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">env</a>);</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>      <span class="keywordflow">if</span> (pid == -1)</div>
<div class="line"><span class="lineno">  568</span>      {</div>
<div class="line"><span class="lineno">  569</span>        <span class="keywordflow">if</span> (fd_pager != -1)</div>
<div class="line"><span class="lineno">  570</span>          close(fd_pager);</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>        <span class="keywordflow">if</span> (fd_temp != -1)</div>
<div class="line"><span class="lineno">  573</span>          close(fd_temp);</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span>        <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t create filter&quot;</span>));</div>
<div class="line"><span class="lineno">  576</span>        <span class="keywordflow">goto</span> return_error;</div>
<div class="line"><span class="lineno">  577</span>      }</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>      <span class="keywordflow">if</span> (use_pager)</div>
<div class="line"><span class="lineno">  580</span>      {</div>
<div class="line"><span class="lineno">  581</span>        <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>)</div>
<div class="line"><span class="lineno">  582</span>        {</div>
<div class="line"><span class="lineno">  583</span>          snprintf(desc, <span class="keyword">sizeof</span>(desc), <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;---Command: %-20.20s Description: %s&quot;</span>),</div>
<div class="line"><span class="lineno">  584</span>                   <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd), b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>);</div>
<div class="line"><span class="lineno">  585</span>        }</div>
<div class="line"><span class="lineno">  586</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  587</span>        {</div>
<div class="line"><span class="lineno">  588</span>          snprintf(desc, <span class="keyword">sizeof</span>(desc), <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;---Command: %-30.30s Attachment: %s&quot;</span>),</div>
<div class="line"><span class="lineno">  589</span>                   <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd), type);</div>
<div class="line"><span class="lineno">  590</span>        }</div>
<div class="line"><span class="lineno">  591</span>        <a class="code hl_function" href="mutt_2filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a>(pid);</div>
<div class="line"><span class="lineno">  592</span>      }</div>
<div class="line"><span class="lineno">  593</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  594</span>      {</div>
<div class="line"><span class="lineno">  595</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt__attach_8c.html#a6e3181c7c2c23232e591fd65c2b431da">wait_interactive_filter</a>(pid) || (entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a4cc66616bac929499b83944fb8e2911d">needsterminal</a> &amp;&amp; c_wait_key))</div>
<div class="line"><span class="lineno">  596</span>          <a class="code hl_function" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a>(NULL);</div>
<div class="line"><span class="lineno">  597</span>      }</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>      <span class="keywordflow">if</span> (fd_temp != -1)</div>
<div class="line"><span class="lineno">  600</span>        close(fd_temp);</div>
<div class="line"><span class="lineno">  601</span>      <span class="keywordflow">if</span> (fd_pager != -1)</div>
<div class="line"><span class="lineno">  602</span>        close(fd_pager);</div>
<div class="line"><span class="lineno">  603</span>    }</div>
<div class="line"><span class="lineno">  604</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  605</span>    {</div>
<div class="line"><span class="lineno">  606</span>      <span class="comment">/* interactive cmd */</span></div>
<div class="line"><span class="lineno">  607</span>      <span class="keywordtype">int</span> rv = <a class="code hl_function" href="protos_8h.html#aa1d4ad04b000036513ca3f741059942c">mutt_system</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd));</div>
<div class="line"><span class="lineno">  608</span>      <span class="keywordflow">if</span> (rv == -1)</div>
<div class="line"><span class="lineno">  609</span>        <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;Error running \&quot;%s\&quot;\n&quot;</span>, cmd-&gt;<a class="code hl_variable" href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">data</a>);</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>      <span class="keywordflow">if</span> ((rv != 0) || (entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a4cc66616bac929499b83944fb8e2911d">needsterminal</a> &amp;&amp; c_wait_key))</div>
<div class="line"><span class="lineno">  612</span>        <a class="code hl_function" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a>(NULL);</div>
<div class="line"><span class="lineno">  613</span>    }</div>
<div class="line"><span class="lineno">  614</span>  }</div>
<div class="line"><span class="lineno">  615</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  616</span>  {</div>
<div class="line"><span class="lineno">  617</span>    <span class="comment">/* Don&#39;t use mailcap; the attachment is viewed in the pager */</span></div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>    <span class="keywordflow">if</span> (mode == <a class="code hl_enumvalue" href="#a5dd95d385576ba1b957d7e9c523ec946ae2885fe7d47c03a1f0246d054739da79">MUTT_VA_AS_TEXT</a>)</div>
<div class="line"><span class="lineno">  620</span>    {</div>
<div class="line"><span class="lineno">  621</span>      <span class="comment">/* just let me see the raw data */</span></div>
<div class="line"><span class="lineno">  622</span>      <span class="keywordflow">if</span> (fp)</div>
<div class="line"><span class="lineno">  623</span>      {</div>
<div class="line"><span class="lineno">  624</span>        <span class="comment">/* Viewing from a received message.</span></div>
<div class="line"><span class="lineno">  625</span><span class="comment">         *</span></div>
<div class="line"><span class="lineno">  626</span><span class="comment">         * Don&#39;t use mutt_save_attachment() because we want to perform charset</span></div>
<div class="line"><span class="lineno">  627</span><span class="comment">         * conversion since this will be displayed by the internal pager.  */</span></div>
<div class="line"><span class="lineno">  628</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structState.html">State</a> state = { 0 };</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>        state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a> = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(pagerfile), <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">  631</span>        <span class="keywordflow">if</span> (!state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>)</div>
<div class="line"><span class="lineno">  632</span>        {</div>
<div class="line"><span class="lineno">  633</span>          <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;mutt_file_fopen(%s) errno=%d %s\n&quot;</span>,</div>
<div class="line"><span class="lineno">  634</span>                     <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(pagerfile), errno, strerror(errno));</div>
<div class="line"><span class="lineno">  635</span>          <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(pagerfile));</div>
<div class="line"><span class="lineno">  636</span>          <span class="keywordflow">goto</span> return_error;</div>
<div class="line"><span class="lineno">  637</span>        }</div>
<div class="line"><span class="lineno">  638</span>        state.<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a> = fp;</div>
<div class="line"><span class="lineno">  639</span>        state.<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> = <a class="code hl_define" href="mutt_2state_8h.html#abff873a2f7f4f3e664c8c4f90a11f44a">STATE_CHARCONV</a>;</div>
<div class="line"><span class="lineno">  640</span>        <a class="code hl_function" href="handler_8c.html#ad6e9c66285fee73e4d9553c565e10fa2">mutt_decode_attachment</a>(b, &amp;state);</div>
<div class="line"><span class="lineno">  641</span>        <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>);</div>
<div class="line"><span class="lineno">  642</span>      }</div>
<div class="line"><span class="lineno">  643</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  644</span>      {</div>
<div class="line"><span class="lineno">  645</span>        <span class="comment">/* in compose mode, just copy the file.  we can&#39;t use</span></div>
<div class="line"><span class="lineno">  646</span><span class="comment">         * mutt_decode_attachment() since it assumes the content-encoding has</span></div>
<div class="line"><span class="lineno">  647</span><span class="comment">         * already been applied */</span></div>
<div class="line"><span class="lineno">  648</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt__attach_8c.html#a87e1ea8a7b0c926e02ed3db8b7d3dbd5">mutt_save_attachment</a>(fp, b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(pagerfile), <a class="code hl_enumvalue" href="#a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224">MUTT_SAVE_NO_FLAGS</a>, NULL))</div>
<div class="line"><span class="lineno">  649</span>          <span class="keywordflow">goto</span> return_error;</div>
<div class="line"><span class="lineno">  650</span>        unlink_pagerfile = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  651</span>      }</div>
<div class="line"><span class="lineno">  652</span>      <a class="code hl_function" href="rfc3676_8c.html#aafc5472c7687d8941a25999aa30d2be4">mutt_rfc3676_space_unstuff_attachment</a>(b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(pagerfile));</div>
<div class="line"><span class="lineno">  653</span>    }</div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  655</span>    {</div>
<div class="line"><span class="lineno">  656</span>      <a class="code hl_typedef" href="mutt_2state_8h.html#ad4dd18eb8ded2d275901494289ac3986">StateFlags</a> <a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> = <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a> | <a class="code hl_define" href="mutt_2state_8h.html#a3171fa8309d985818811324b9f865934">STATE_DISPLAY_ATTACH</a>;</div>
<div class="line"><span class="lineno">  657</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_pager = <a class="code hl_function" href="pager_2config_8c.html#a3f9c594c9fdc97ee3fd49052f0914892">pager_get_pager</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno">  658</span>      <span class="keywordflow">if</span> (!c_pager)</div>
<div class="line"><span class="lineno">  659</span>        <a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> |= <a class="code hl_define" href="mutt_2state_8h.html#a023fcd08c98fb87f7179cef68e4b3e4c">STATE_PAGER</a>;</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>      <span class="comment">/* Use built-in handler */</span></div>
<div class="line"><span class="lineno">  662</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt__attach_8c.html#aac29548ca4501311138dfa43db788bd3">mutt_decode_save_attachment</a>(fp, b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(pagerfile), <a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a>, <a class="code hl_enumvalue" href="#a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224">MUTT_SAVE_NO_FLAGS</a>))</div>
<div class="line"><span class="lineno">  663</span>      {</div>
<div class="line"><span class="lineno">  664</span>        <span class="keywordflow">goto</span> return_error;</div>
<div class="line"><span class="lineno">  665</span>      }</div>
<div class="line"><span class="lineno">  666</span>      unlink_pagerfile = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  667</span>    }</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>    <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>)</div>
<div class="line"><span class="lineno">  670</span>      <a class="code hl_function" href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a>(desc, b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>, <span class="keyword">sizeof</span>(desc));</div>
<div class="line"><span class="lineno">  671</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>)</div>
<div class="line"><span class="lineno">  672</span>      snprintf(desc, <span class="keyword">sizeof</span>(desc), <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;---Attachment: %s: %s&quot;</span>), b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, type);</div>
<div class="line"><span class="lineno">  673</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  674</span>      snprintf(desc, <span class="keyword">sizeof</span>(desc), <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;---Attachment: %s&quot;</span>), type);</div>
<div class="line"><span class="lineno">  675</span>  }</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>  <span class="comment">/* We only reach this point if there have been no errors */</span></div>
<div class="line"><span class="lineno">  678</span> </div>
<div class="line"><span class="lineno">  679</span>  <span class="keywordflow">if</span> (use_pager)</div>
<div class="line"><span class="lineno">  680</span>  {</div>
<div class="line"><span class="lineno">  681</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structPagerData.html">PagerData</a> pdata = { 0 };</div>
<div class="line"><span class="lineno">  682</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structPagerView.html">PagerView</a> pview = { &amp;<a class="code hl_variable" href="structPagerView.html#a29102d8862e5aabcfcfe86da4c8e3921">pdata</a> };</div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>    <a class="code hl_variable" href="structPagerView.html#a29102d8862e5aabcfcfe86da4c8e3921">pdata</a>.<a class="code hl_variable" href="structPagerData.html#ac3d3557c153f3bd6614896865b29a943">actx</a> = actx;</div>
<div class="line"><span class="lineno">  685</span>    <a class="code hl_variable" href="structPagerView.html#a29102d8862e5aabcfcfe86da4c8e3921">pdata</a>.<a class="code hl_variable" href="structPagerData.html#a926094814a0a9c0c7de62f1e2532ab8a">body</a> = b;</div>
<div class="line"><span class="lineno">  686</span>    <a class="code hl_variable" href="structPagerView.html#a29102d8862e5aabcfcfe86da4c8e3921">pdata</a>.<a class="code hl_variable" href="structPagerData.html#a00d514b3bce57dcd4d5e1e493045ae5e">fname</a> = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(pagerfile);</div>
<div class="line"><span class="lineno">  687</span>    <a class="code hl_variable" href="structPagerView.html#a29102d8862e5aabcfcfe86da4c8e3921">pdata</a>.<a class="code hl_variable" href="structPagerData.html#a75f5f2991771544bd5c9298eb5a4832d">fp</a> = fp;</div>
<div class="line"><span class="lineno">  688</span> </div>
<div class="line"><span class="lineno">  689</span>    pview.<a class="code hl_variable" href="structPagerView.html#a90f35bb89f5efbd6cb5c23226f316e17">banner</a> = desc;</div>
<div class="line"><span class="lineno">  690</span>    pview.<a class="code hl_variable" href="structPagerView.html#a8e4d312c9fefeba6f1c4fd8cf84eb101">flags</a> = <a class="code hl_define" href="pager_2lib_8h.html#aea42b8def2b025d157e3da6a1be2b20e">MUTT_PAGER_ATTACHMENT</a> |</div>
<div class="line"><span class="lineno">  691</span>                  (is_message ? <a class="code hl_define" href="pager_2lib_8h.html#ac14f9120c844296965a8a2c87dc5f541">MUTT_PAGER_MESSAGE</a> : <a class="code hl_define" href="pager_2lib_8h.html#a0a536da5cd7ad9b881a8079052853818">MUTT_PAGER_NO_FLAGS</a>) |</div>
<div class="line"><span class="lineno">  692</span>                  ((use_mailcap &amp;&amp; entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#af97dc2368515b5451ce9212d681f30f4">xneomuttnowrap</a>) ? <a class="code hl_define" href="pager_2lib_8h.html#a325eecb6e92fd9ea24c0ea630a84df6f">MUTT_PAGER_NOWRAP</a> :</div>
<div class="line"><span class="lineno">  693</span>                                                            <a class="code hl_define" href="pager_2lib_8h.html#a0a536da5cd7ad9b881a8079052853818">MUTT_PAGER_NO_FLAGS</a>);</div>
<div class="line"><span class="lineno">  694</span>    pview.<a class="code hl_variable" href="structPagerView.html#a4f7074be59cdcb518630e81e5ef8c3b7">mode</a> = <a class="code hl_enumvalue" href="pager_2lib_8h.html#a97661d5482310b15dc29f620e955991aadd398541040aaa71d6e0c4cbb3d4bfa6">PAGER_MODE_ATTACH</a>;</div>
<div class="line"><span class="lineno">  695</span> </div>
<div class="line"><span class="lineno">  696</span>    rc = <a class="code hl_function" href="do__pager_8c.html#a9d3af21b7fdf24249c261a9a1aa9f3be">mutt_do_pager</a>(&amp;pview, e);</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span>    <a class="code hl_function" href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a>(pagerfile);</div>
<div class="line"><span class="lineno">  699</span>    unlink_pagerfile = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  700</span>  }</div>
<div class="line"><span class="lineno">  701</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  702</span>  {</div>
<div class="line"><span class="lineno">  703</span>    rc = 0;</div>
<div class="line"><span class="lineno">  704</span>  }</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>return_error:</div>
<div class="line"><span class="lineno">  707</span> </div>
<div class="line"><span class="lineno">  708</span>  <span class="keywordflow">if</span> (!entry || !entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#af711c81e4798bf4790fb6dd58d739d68">xneomuttkeep</a>)</div>
<div class="line"><span class="lineno">  709</span>  {</div>
<div class="line"><span class="lineno">  710</span>    <span class="keywordflow">if</span> ((fp &amp;&amp; !<a class="code hl_function" href="buffer_8c.html#a4245e227baa2a9beb6991917404aab0d">buf_is_empty</a>(tempfile)) || has_tempfile)</div>
<div class="line"><span class="lineno">  711</span>    {</div>
<div class="line"><span class="lineno">  712</span>      <span class="comment">/* add temporary file to TempAttachmentsList to be deleted on timeout hook */</span></div>
<div class="line"><span class="lineno">  713</span>      <a class="code hl_function" href="mutt__attach_8c.html#acc6c49a75e5a6fce41d18c1d95a45948">mutt_add_temp_attachment</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  714</span>    }</div>
<div class="line"><span class="lineno">  715</span>  }</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>  <a class="code hl_function" href="mailcap_8c.html#a49fd88d8bb73a7a56c4cc0fe28dfb645">mailcap_entry_free</a>(&amp;entry);</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>  <span class="keywordflow">if</span> (unlink_pagerfile)</div>
<div class="line"><span class="lineno">  720</span>    <a class="code hl_function" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(pagerfile));</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;tempfile);</div>
<div class="line"><span class="lineno">  723</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;pagerfile);</div>
<div class="line"><span class="lineno">  724</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;cmd);</div>
<div class="line"><span class="lineno">  725</span>  <a class="code hl_function" href="envlist_8c.html#adfd13ffecec0c62acf36151a8ea41ac2">envlist_unset</a>(&amp;<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">env</a>, <span class="stringliteral">&quot;COLUMNS&quot;</span>);</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  728</span>}</div>
<div class="ttc" id="aattach_2lib_8c_html_ae5935160eaa47aaf0cb4568a9ba404b0"><div class="ttname"><a href="attach_2lib_8c.html#ae5935160eaa47aaf0cb4568a9ba404b0">attach_body_ancestor</a></div><div class="ttdeci">struct Body * attach_body_ancestor(struct Body *start, struct Body *body, const char *subtype)</div><div class="ttdoc">Find the ancestor of a body with specified subtype.</div><div class="ttdef"><b>Definition</b> <a href="attach_2lib_8c_source.html#l00116">lib.c:116</a></div></div>
<div class="ttc" id="abuffer_8c_html_a3b1f80652b37dc26046f9acdd85a0b05"><div class="ttname"><a href="buffer_8c.html#a3b1f80652b37dc26046f9acdd85a0b05">buf_reset</a></div><div class="ttdeci">void buf_reset(struct Buffer *buf)</div><div class="ttdoc">Reset an existing Buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8c_source.html#l00076">buffer.c:76</a></div></div>
<div class="ttc" id="acid_8c_html_a7a714280dc42ab8d32f72fec1a94388d"><div class="ttname"><a href="cid_8c.html#a7a714280dc42ab8d32f72fec1a94388d">cid_save_attachments</a></div><div class="ttdeci">void cid_save_attachments(struct Body *body, struct CidMapList *cid_map_list)</div><div class="ttdoc">Save all attachments in a &quot;multipart/related&quot; group with a Content-ID.</div><div class="ttdef"><b>Definition</b> <a href="cid_8c_source.html#l00150">cid.c:150</a></div></div>
<div class="ttc" id="acid_8c_html_ad9ca67dad4234a2cd06f1ee2b8d0b2a4"><div class="ttname"><a href="cid_8c.html#ad9ca67dad4234a2cd06f1ee2b8d0b2a4">cid_to_filename</a></div><div class="ttdeci">void cid_to_filename(struct Buffer *filename, const struct CidMapList *cid_map_list)</div><div class="ttdoc">Replace Content-IDs with filenames.</div><div class="ttdef"><b>Definition</b> <a href="cid_8c_source.html#l00169">cid.c:169</a></div></div>
<div class="ttc" id="acid_8c_html_aed54252a3604cd8dc1dac5ce2045c3a8"><div class="ttname"><a href="cid_8c.html#aed54252a3604cd8dc1dac5ce2045c3a8">cid_map_list_clear</a></div><div class="ttdeci">void cid_map_list_clear(struct CidMapList *cid_map_list)</div><div class="ttdoc">Empty a CidMapList.</div><div class="ttdef"><b>Definition</b> <a href="cid_8c_source.html#l00081">cid.c:81</a></div></div>
<div class="ttc" id="acrypt_8c_html_a4ee7f1419a7e39b0e9f1f9d550f4de43"><div class="ttname"><a href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a></div><div class="ttdeci">bool crypt_valid_passphrase(SecurityFlags flags)</div><div class="ttdoc">Check that we have a usable passphrase, ask if not.</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l00131">crypt.c:131</a></div></div>
<div class="ttc" id="ado__pager_8c_html_a9d3af21b7fdf24249c261a9a1aa9f3be"><div class="ttname"><a href="do__pager_8c.html#a9d3af21b7fdf24249c261a9a1aa9f3be">mutt_do_pager</a></div><div class="ttdeci">int mutt_do_pager(struct PagerView *pview, struct Email *e)</div><div class="ttdoc">Display some page-able text to the user (help or attachment)</div><div class="ttdef"><b>Definition</b> <a href="do__pager_8c_source.html#l00122">do_pager.c:122</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_adcc90fb584fec1be116777c533e9b3d4"><div class="ttname"><a href="email_2parse_8c.html#adcc90fb584fec1be116777c533e9b3d4">mutt_is_message_type</a></div><div class="ttdeci">bool mutt_is_message_type(int type, const char *subtype)</div><div class="ttdoc">Determine if a mime type matches a message or not.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01497">parse.c:1497</a></div></div>
<div class="ttc" id="aenvlist_8c_html_a8643dfebf12ab95f38021cf7fac716cc"><div class="ttname"><a href="envlist_8c.html#a8643dfebf12ab95f38021cf7fac716cc">envlist_set</a></div><div class="ttdeci">bool envlist_set(char ***envp, const char *name, const char *value, bool overwrite)</div><div class="ttdoc">Set an environment variable.</div><div class="ttdef"><b>Definition</b> <a href="envlist_8c_source.html#l00088">envlist.c:88</a></div></div>
<div class="ttc" id="aenvlist_8c_html_adfd13ffecec0c62acf36151a8ea41ac2"><div class="ttname"><a href="envlist_8c.html#adfd13ffecec0c62acf36151a8ea41ac2">envlist_unset</a></div><div class="ttdeci">bool envlist_unset(char ***envp, const char *name)</div><div class="ttdoc">Unset an environment variable.</div><div class="ttdef"><b>Definition</b> <a href="envlist_8c_source.html#l00136">envlist.c:136</a></div></div>
<div class="ttc" id="afile_8c_html_a4deebaf3a646b3075a2b51eda5dc03ca"><div class="ttname"><a href="file_8c.html#a4deebaf3a646b3075a2b51eda5dc03ca">mutt_file_sanitize_filename</a></div><div class="ttdeci">void mutt_file_sanitize_filename(char *path, bool slash)</div><div class="ttdoc">Replace unsafe characters in a filename.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00589">file.c:589</a></div></div>
<div class="ttc" id="afile_8c_html_adf06802ad33e6b1bff09f31d8cbfab67"><div class="ttname"><a href="file_8c.html#adf06802ad33e6b1bff09f31d8cbfab67">mutt_file_open</a></div><div class="ttdeci">int mutt_file_open(const char *path, uint32_t flags, mode_t mode)</div><div class="ttdoc">Open a file.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00515">file.c:515</a></div></div>
<div class="ttc" id="afile_8c_html_ae57463c2854c006a3c67b78736e9056e"><div class="ttname"><a href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a></div><div class="ttdeci">void mutt_file_unlink(const char *s)</div><div class="ttdoc">Delete a file, carefully.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00159">file.c:159</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gacc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00093">logging2.h:93</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gae6c5fd73af3410b2d5e8099f8774c8da"><div class="ttname"><a href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a></div><div class="ttdeci">#define mutt_debug(LEVEL,...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00090">logging2.h:90</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gafaa521ab22db877ccf1b87e679e1b43e"><div class="ttname"><a href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a></div><div class="ttdeci">#define mutt_perror(...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00094">logging2.h:94</a></div></div>
<div class="ttc" id="ahandler_8c_html_ad6e9c66285fee73e4d9553c565e10fa2"><div class="ttname"><a href="handler_8c.html#ad6e9c66285fee73e4d9553c565e10fa2">mutt_decode_attachment</a></div><div class="ttdeci">void mutt_decode_attachment(const struct Body *b, struct State *state)</div><div class="ttdoc">Decode an email&#39;s attachment.</div><div class="ttdef"><b>Definition</b> <a href="handler_8c_source.html#l01906">handler.c:1906</a></div></div>
<div class="ttc" id="alogging2_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3"><div class="ttname"><a href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a></div><div class="ttdeci">@ LL_DEBUG2</div><div class="ttdoc">Log at debug level 2.</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00045">logging2.h:45</a></div></div>
<div class="ttc" id="alogging2_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5"><div class="ttname"><a href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a></div><div class="ttdeci">@ LL_DEBUG1</div><div class="ttdoc">Log at debug level 1.</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00044">logging2.h:44</a></div></div>
<div class="ttc" id="amailcap_8c_html_a49fd88d8bb73a7a56c4cc0fe28dfb645"><div class="ttname"><a href="mailcap_8c.html#a49fd88d8bb73a7a56c4cc0fe28dfb645">mailcap_entry_free</a></div><div class="ttdeci">void mailcap_entry_free(struct MailcapEntry **ptr)</div><div class="ttdoc">Deallocate an struct MailcapEntry.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8c_source.html#l00454">mailcap.c:454</a></div></div>
<div class="ttc" id="amailcap_8c_html_a8114f2f64a9bf84055e0e1d624b8c050"><div class="ttname"><a href="mailcap_8c.html#a8114f2f64a9bf84055e0e1d624b8c050">mailcap_entry_new</a></div><div class="ttdeci">struct MailcapEntry * mailcap_entry_new(void)</div><div class="ttdoc">Allocate memory for a new rfc1524 entry.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8c_source.html#l00445">mailcap.c:445</a></div></div>
<div class="ttc" id="amailcap_8c_html_ac95deddbed52214ab8797bf9d19c1b8b"><div class="ttname"><a href="mailcap_8c.html#ac95deddbed52214ab8797bf9d19c1b8b">mailcap_expand_command</a></div><div class="ttdeci">int mailcap_expand_command(struct Body *b, const char *filename, const char *type, struct Buffer *command)</div><div class="ttdoc">Expand expandos in a command.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8c_source.html#l00069">mailcap.c:69</a></div></div>
<div class="ttc" id="amailcap_8c_html_accb5ae6e2f507053e8436a2f00b834ea"><div class="ttname"><a href="mailcap_8c.html#accb5ae6e2f507053e8436a2f00b834ea">mailcap_expand_filename</a></div><div class="ttdeci">void mailcap_expand_filename(const char *nametemplate, const char *oldfile, struct Buffer *newfile)</div><div class="ttdoc">Expand a new filename from a template or existing filename.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8c_source.html#l00552">mailcap.c:552</a></div></div>
<div class="ttc" id="amailcap_8c_html_af76f3b2c5819c22f1470723cc30a9ad1"><div class="ttname"><a href="mailcap_8c.html#af76f3b2c5819c22f1470723cc30a9ad1">mailcap_lookup</a></div><div class="ttdeci">bool mailcap_lookup(struct Body *b, char *type, size_t typelen, struct MailcapEntry *entry, enum MailcapLookup opt)</div><div class="ttdoc">Find given type in the list of mailcap files.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8c_source.html#l00483">mailcap.c:483</a></div></div>
<div class="ttc" id="amailcap_8h_html_a0716f6351a9229990024889ec22b33c1"><div class="ttname"><a href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1">MailcapLookup</a></div><div class="ttdeci">MailcapLookup</div><div class="ttdoc">Mailcap actions.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00055">mailcap.h:56</a></div></div>
<div class="ttc" id="amailcap_8h_html_a0716f6351a9229990024889ec22b33c1a685052e871afa17028f0e1c11e056a60"><div class="ttname"><a href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1a685052e871afa17028f0e1c11e056a60">MUTT_MC_AUTOVIEW</a></div><div class="ttdeci">@ MUTT_MC_AUTOVIEW</div><div class="ttdoc">Mailcap autoview field.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00061">mailcap.h:61</a></div></div>
<div class="ttc" id="amailcap_8h_html_a0716f6351a9229990024889ec22b33c1abe09e527550677b514f34f0fd421d8f8"><div class="ttname"><a href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1abe09e527550677b514f34f0fd421d8f8">MUTT_MC_NO_FLAGS</a></div><div class="ttdeci">@ MUTT_MC_NO_FLAGS</div><div class="ttdoc">No flags set.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00057">mailcap.h:57</a></div></div>
<div class="ttc" id="amime_8h_html_a3e568918dd102d7bfd39661c82ff6c3f"><div class="ttname"><a href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a></div><div class="ttdeci">#define BODY_TYPE(body)</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00089">mime.h:89</a></div></div>
<div class="ttc" id="amutt_2filter_8c_html_a8b8175018aa96307b2cf569d719ca6dc"><div class="ttname"><a href="mutt_2filter_8c.html#a8b8175018aa96307b2cf569d719ca6dc">filter_create_fd</a></div><div class="ttdeci">pid_t filter_create_fd(const char *cmd, FILE **fp_in, FILE **fp_out, FILE **fp_err, int fdin, int fdout, int fderr, char **envlist)</div><div class="ttdoc">Run a command on a pipe (optionally connect stdin/stdout)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2filter_8c_source.html#l00062">filter.c:62</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_a023fcd08c98fb87f7179cef68e4b3e4c"><div class="ttname"><a href="mutt_2state_8h.html#a023fcd08c98fb87f7179cef68e4b3e4c">STATE_PAGER</a></div><div class="ttdeci">#define STATE_PAGER</div><div class="ttdoc">Output will be displayed in the Pager.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00042">state.h:42</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_a2a4ce653367a744f47960bc30b42f3a7"><div class="ttname"><a href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a></div><div class="ttdeci">#define STATE_DISPLAY</div><div class="ttdoc">Output is displayed to the user.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00033">state.h:33</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_a3171fa8309d985818811324b9f865934"><div class="ttname"><a href="mutt_2state_8h.html#a3171fa8309d985818811324b9f865934">STATE_DISPLAY_ATTACH</a></div><div class="ttdeci">#define STATE_DISPLAY_ATTACH</div><div class="ttdoc">We are displaying an attachment.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00041">state.h:41</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_ad4dd18eb8ded2d275901494289ac3986"><div class="ttname"><a href="mutt_2state_8h.html#ad4dd18eb8ded2d275901494289ac3986">StateFlags</a></div><div class="ttdeci">uint16_t StateFlags</div><div class="ttdoc">Flags for State-&gt;flags, e.g. STATE_DISPLAY.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00031">state.h:31</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a3fe33d90e4814281cd57de048119c950"><div class="ttname"><a href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a></div><div class="ttdeci">char * mutt_str_dup(const char *str)</div><div class="ttdoc">Copy a string, safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00255">string.c:255</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a6b6a50296dd2a31863a43379ef4a343d"><div class="ttname"><a href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a></div><div class="ttdeci">bool mutt_str_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00660">string.c:660</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_ad20e00309de897a1e882fc7400335b83"><div class="ttname"><a href="mutt_2string_8c.html#ad20e00309de897a1e882fc7400335b83">mutt_str_copy</a></div><div class="ttdeci">size_t mutt_str_copy(char *dest, const char *src, size_t dsize)</div><div class="ttdoc">Copy a string into a buffer (guaranteeing NUL-termination)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00581">string.c:581</a></div></div>
<div class="ttc" id="amutt__attach_8c_html_a6e3181c7c2c23232e591fd65c2b431da"><div class="ttname"><a href="mutt__attach_8c.html#a6e3181c7c2c23232e591fd65c2b431da">wait_interactive_filter</a></div><div class="ttdeci">static int wait_interactive_filter(pid_t pid)</div><div class="ttdoc">Wait after an interactive filter.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8c_source.html#l00390">mutt_attach.c:390</a></div></div>
<div class="ttc" id="amutt__attach_8c_html_a87e1ea8a7b0c926e02ed3db8b7d3dbd5"><div class="ttname"><a href="mutt__attach_8c.html#a87e1ea8a7b0c926e02ed3db8b7d3dbd5">mutt_save_attachment</a></div><div class="ttdeci">int mutt_save_attachment(FILE *fp, struct Body *b, const char *path, enum SaveAttach opt, struct Email *e)</div><div class="ttdoc">Save an attachment.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8c_source.html#l00905">mutt_attach.c:905</a></div></div>
<div class="ttc" id="amutt__attach_8c_html_aac29548ca4501311138dfa43db788bd3"><div class="ttname"><a href="mutt__attach_8c.html#aac29548ca4501311138dfa43db788bd3">mutt_decode_save_attachment</a></div><div class="ttdeci">int mutt_decode_save_attachment(FILE *fp, struct Body *b, const char *path, StateFlags flags, enum SaveAttach opt)</div><div class="ttdoc">Decode, then save an attachment.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8c_source.html#l01039">mutt_attach.c:1039</a></div></div>
<div class="ttc" id="amutt__attach_8c_html_acc6c49a75e5a6fce41d18c1d95a45948"><div class="ttname"><a href="mutt__attach_8c.html#acc6c49a75e5a6fce41d18c1d95a45948">mutt_add_temp_attachment</a></div><div class="ttdeci">void mutt_add_temp_attachment(const char *filename)</div><div class="ttdoc">Add file to list of temporary attachments.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8c_source.html#l01297">mutt_attach.c:1297</a></div></div>
<div class="ttc" id="amuttlib_8c_html_a8973b2e5185609bfc5e0ef136fcd3177"><div class="ttname"><a href="muttlib_8c.html#a8973b2e5185609bfc5e0ef136fcd3177">mutt_needs_mailcap</a></div><div class="ttdeci">bool mutt_needs_mailcap(struct Body *b)</div><div class="ttdoc">Does this type need a mailcap entry do display.</div><div class="ttdef"><b>Definition</b> <a href="muttlib_8c_source.html#l00378">muttlib.c:378</a></div></div>
<div class="ttc" id="amuttlib_8c_html_acf3a46e57ab84223b270c763ccb166ca"><div class="ttname"><a href="muttlib_8c.html#acf3a46e57ab84223b270c763ccb166ca">mutt_adv_mktemp</a></div><div class="ttdeci">void mutt_adv_mktemp(struct Buffer *buf)</div><div class="ttdoc">Create a temporary file.</div><div class="ttdef"><b>Definition</b> <a href="muttlib_8c_source.html#l00083">muttlib.c:83</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_aacaa4abd4c0696e260b7a0f1d466360a"><div class="ttname"><a href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a></div><div class="ttdeci">#define SEC_ENCRYPT</div><div class="ttdoc">Email is encrypted.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00084">lib.h:84</a></div></div>
<div class="ttc" id="apager_2config_8c_html_a3f9c594c9fdc97ee3fd49052f0914892"><div class="ttname"><a href="pager_2config_8c.html#a3f9c594c9fdc97ee3fd49052f0914892">pager_get_pager</a></div><div class="ttdeci">const char * pager_get_pager(struct ConfigSubset *sub)</div><div class="ttdoc">Get the value of $pager.</div><div class="ttdef"><b>Definition</b> <a href="pager_2config_8c_source.html#l00111">config.c:111</a></div></div>
<div class="ttc" id="apager_2lib_8h_html_a0a536da5cd7ad9b881a8079052853818"><div class="ttname"><a href="pager_2lib_8h.html#a0a536da5cd7ad9b881a8079052853818">MUTT_PAGER_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_PAGER_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00060">lib.h:60</a></div></div>
<div class="ttc" id="apager_2lib_8h_html_a325eecb6e92fd9ea24c0ea630a84df6f"><div class="ttname"><a href="pager_2lib_8h.html#a325eecb6e92fd9ea24c0ea630a84df6f">MUTT_PAGER_NOWRAP</a></div><div class="ttdeci">#define MUTT_PAGER_NOWRAP</div><div class="ttdoc">Format for term width, ignore $wrap.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00071">lib.h:71</a></div></div>
<div class="ttc" id="apager_2lib_8h_html_a97661d5482310b15dc29f620e955991aadd398541040aaa71d6e0c4cbb3d4bfa6"><div class="ttname"><a href="pager_2lib_8h.html#a97661d5482310b15dc29f620e955991aadd398541040aaa71d6e0c4cbb3d4bfa6">PAGER_MODE_ATTACH</a></div><div class="ttdeci">@ PAGER_MODE_ATTACH</div><div class="ttdoc">Pager is invoked via 2nd path. A user-selected attachment (mime part or a nested email) will be shown...</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00137">lib.h:137</a></div></div>
<div class="ttc" id="apager_2lib_8h_html_ac14f9120c844296965a8a2c87dc5f541"><div class="ttname"><a href="pager_2lib_8h.html#ac14f9120c844296965a8a2c87dc5f541">MUTT_PAGER_MESSAGE</a></div><div class="ttdeci">#define MUTT_PAGER_MESSAGE</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00075">lib.h:75</a></div></div>
<div class="ttc" id="apager_2lib_8h_html_aea42b8def2b025d157e3da6a1be2b20e"><div class="ttname"><a href="pager_2lib_8h.html#aea42b8def2b025d157e3da6a1be2b20e">MUTT_PAGER_ATTACHMENT</a></div><div class="ttdeci">#define MUTT_PAGER_ATTACHMENT</div><div class="ttdoc">Attachments may exist.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00070">lib.h:70</a></div></div>
<div class="ttc" id="aprotos_8h_html_aa1d4ad04b000036513ca3f741059942c"><div class="ttname"><a href="protos_8h.html#aa1d4ad04b000036513ca3f741059942c">mutt_system</a></div><div class="ttdeci">int mutt_system(const char *cmd)</div><div class="ttdoc">Run an external command.</div><div class="ttdef"><b>Definition</b> <a href="system_8c_source.html#l00052">system.c:52</a></div></div>
<div class="ttc" id="aqueue_8h_html_a3d41ce2c3f1dd21c0d4051d13204c321"><div class="ttname"><a href="queue_8h.html#a3d41ce2c3f1dd21c0d4051d13204c321">STAILQ_HEAD_INITIALIZER</a></div><div class="ttdeci">#define STAILQ_HEAD_INITIALIZER(head)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00324">queue.h:324</a></div></div>
<div class="ttc" id="arfc3676_8c_html_aafc5472c7687d8941a25999aa30d2be4"><div class="ttname"><a href="rfc3676_8c.html#aafc5472c7687d8941a25999aa30d2be4">mutt_rfc3676_space_unstuff_attachment</a></div><div class="ttdeci">void mutt_rfc3676_space_unstuff_attachment(struct Body *b, const char *filename)</div><div class="ttdoc">Unstuff attachments.</div><div class="ttdef"><b>Definition</b> <a href="rfc3676_8c_source.html#l00518">rfc3676.c:518</a></div></div>
<div class="ttc" id="astructAttachCtx_html_a91b62fe3fb812a138c34f793b6a543d6"><div class="ttname"><a href="structAttachCtx.html#a91b62fe3fb812a138c34f793b6a543d6">AttachCtx::body_idx</a></div><div class="ttdeci">struct Body ** body_idx</div><div class="ttdoc">Extra struct Body* used for decryption.</div><div class="ttdef"><b>Definition</b> <a href="attach_8h_source.html#l00078">attach.h:78</a></div></div>
<div class="ttc" id="astructBody_html_a8e10ba22522218bd12bd3cb38dd3fcc9"><div class="ttname"><a href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">Body::email</a></div><div class="ttdeci">struct Email * email</div><div class="ttdoc">header information for message/rfc822</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00074">body.h:74</a></div></div>
<div class="ttc" id="astructBody_html_a90db5151872e23e56a8f31d68925c121"><div class="ttname"><a href="structBody.html#a90db5151872e23e56a8f31d68925c121">Body::description</a></div><div class="ttdeci">char * description</div><div class="ttdoc">content-description</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00055">body.h:55</a></div></div>
<div class="ttc" id="astructBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00061">body.h:61</a></div></div>
<div class="ttc" id="astructBuffer_html_aeec1fd4af0ddf6765b0187466d4361b8"><div class="ttname"><a href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">Buffer::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">Pointer to data.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00037">buffer.h:37</a></div></div>
<div class="ttc" id="astructEmail_html_a57ad6ac618c0f685804f6f5bb390b3a6"><div class="ttname"><a href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">Email::body</a></div><div class="ttdeci">struct Body * body</div><div class="ttdoc">List of MIME parts.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00069">email.h:69</a></div></div>
<div class="ttc" id="astructMailcapEntry_html"><div class="ttname"><a href="structMailcapEntry.html">MailcapEntry</a></div><div class="ttdoc">A mailcap entry.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00036">mailcap.h:37</a></div></div>
<div class="ttc" id="astructMailcapEntry_html_a4cc66616bac929499b83944fb8e2911d"><div class="ttname"><a href="structMailcapEntry.html#a4cc66616bac929499b83944fb8e2911d">MailcapEntry::needsterminal</a></div><div class="ttdeci">bool needsterminal</div><div class="ttdoc">endwin() and system</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00046">mailcap.h:46</a></div></div>
<div class="ttc" id="astructMailcapEntry_html_a85835d27aa930e64eef4eae5f9498401"><div class="ttname"><a href="structMailcapEntry.html#a85835d27aa930e64eef4eae5f9498401">MailcapEntry::nametemplate</a></div><div class="ttdeci">char * nametemplate</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00044">mailcap.h:44</a></div></div>
<div class="ttc" id="astructMailcapEntry_html_ad682bf5b0b80e72f2a9b9196728514e3"><div class="ttname"><a href="structMailcapEntry.html#ad682bf5b0b80e72f2a9b9196728514e3">MailcapEntry::command</a></div><div class="ttdeci">char * command</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00038">mailcap.h:38</a></div></div>
<div class="ttc" id="astructMailcapEntry_html_adcea89b25743514d268e8fde508d6295"><div class="ttname"><a href="structMailcapEntry.html#adcea89b25743514d268e8fde508d6295">MailcapEntry::copiousoutput</a></div><div class="ttdeci">bool copiousoutput</div><div class="ttdoc">needs pager, basically</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00047">mailcap.h:47</a></div></div>
<div class="ttc" id="astructMailcapEntry_html_af711c81e4798bf4790fb6dd58d739d68"><div class="ttname"><a href="structMailcapEntry.html#af711c81e4798bf4790fb6dd58d739d68">MailcapEntry::xneomuttkeep</a></div><div class="ttdeci">bool xneomuttkeep</div><div class="ttdoc">do not remove the file on command exit</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00048">mailcap.h:48</a></div></div>
<div class="ttc" id="astructMailcapEntry_html_af97dc2368515b5451ce9212d681f30f4"><div class="ttname"><a href="structMailcapEntry.html#af97dc2368515b5451ce9212d681f30f4">MailcapEntry::xneomuttnowrap</a></div><div class="ttdeci">bool xneomuttnowrap</div><div class="ttdoc">do not wrap the output in the pager</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00049">mailcap.h:49</a></div></div>
<div class="ttc" id="astructMuttWindow_html_a406b976fc50b1cb5beca6c85e7a3be7f"><div class="ttname"><a href="structMuttWindow.html#a406b976fc50b1cb5beca6c85e7a3be7f">MuttWindow::state</a></div><div class="ttdeci">struct WindowState state</div><div class="ttdoc">Current state of the Window.</div><div class="ttdef"><b>Definition</b> <a href="mutt__window_8h_source.html#l00127">mutt_window.h:127</a></div></div>
<div class="ttc" id="astructPagerData_html"><div class="ttname"><a href="structPagerData.html">PagerData</a></div><div class="ttdoc">Data to be displayed by PagerView.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00158">lib.h:159</a></div></div>
<div class="ttc" id="astructPagerData_html_a00d514b3bce57dcd4d5e1e493045ae5e"><div class="ttname"><a href="structPagerData.html#a00d514b3bce57dcd4d5e1e493045ae5e">PagerData::fname</a></div><div class="ttdeci">const char * fname</div><div class="ttdoc">Name of the file to read.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00163">lib.h:163</a></div></div>
<div class="ttc" id="astructPagerData_html_a75f5f2991771544bd5c9298eb5a4832d"><div class="ttname"><a href="structPagerData.html#a75f5f2991771544bd5c9298eb5a4832d">PagerData::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdoc">Source stream.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00161">lib.h:161</a></div></div>
<div class="ttc" id="astructPagerData_html_a926094814a0a9c0c7de62f1e2532ab8a"><div class="ttname"><a href="structPagerData.html#a926094814a0a9c0c7de62f1e2532ab8a">PagerData::body</a></div><div class="ttdeci">struct Body * body</div><div class="ttdoc">Current attachment.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00160">lib.h:160</a></div></div>
<div class="ttc" id="astructPagerData_html_ac3d3557c153f3bd6614896865b29a943"><div class="ttname"><a href="structPagerData.html#ac3d3557c153f3bd6614896865b29a943">PagerData::actx</a></div><div class="ttdeci">struct AttachCtx * actx</div><div class="ttdoc">Attachment information.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00162">lib.h:162</a></div></div>
<div class="ttc" id="astructPagerView_html"><div class="ttname"><a href="structPagerView.html">PagerView</a></div><div class="ttdoc">Paged view into some data.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00169">lib.h:170</a></div></div>
<div class="ttc" id="astructPagerView_html_a29102d8862e5aabcfcfe86da4c8e3921"><div class="ttname"><a href="structPagerView.html#a29102d8862e5aabcfcfe86da4c8e3921">PagerView::pdata</a></div><div class="ttdeci">struct PagerData * pdata</div><div class="ttdoc">Data that pager displays. NOTNULL.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00171">lib.h:171</a></div></div>
<div class="ttc" id="astructPagerView_html_a4f7074be59cdcb518630e81e5ef8c3b7"><div class="ttname"><a href="structPagerView.html#a4f7074be59cdcb518630e81e5ef8c3b7">PagerView::mode</a></div><div class="ttdeci">enum PagerMode mode</div><div class="ttdoc">Pager mode.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00172">lib.h:172</a></div></div>
<div class="ttc" id="astructPagerView_html_a8e4d312c9fefeba6f1c4fd8cf84eb101"><div class="ttname"><a href="structPagerView.html#a8e4d312c9fefeba6f1c4fd8cf84eb101">PagerView::flags</a></div><div class="ttdeci">PagerFlags flags</div><div class="ttdoc">Additional settings to tweak pager&#39;s function.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00173">lib.h:173</a></div></div>
<div class="ttc" id="astructPagerView_html_a90f35bb89f5efbd6cb5c23226f316e17"><div class="ttname"><a href="structPagerView.html#a90f35bb89f5efbd6cb5c23226f316e17">PagerView::banner</a></div><div class="ttdeci">const char * banner</div><div class="ttdoc">Title to display in status bar.</div><div class="ttdef"><b>Definition</b> <a href="pager_2lib_8h_source.html#l00174">lib.h:174</a></div></div>
<div class="ttc" id="astructState_html_a9cf7e1f0c5c12399def5ca38b13054ae"><div class="ttname"><a href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">State::fp_in</a></div><div class="ttdeci">FILE * fp_in</div><div class="ttdoc">File to read from.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00049">state.h:49</a></div></div>
<div class="ttc" id="astructWindowState_html_a557cf2197f9df8fe60f6e1dbfd49ec43"><div class="ttname"><a href="structWindowState.html#a557cf2197f9df8fe60f6e1dbfd49ec43">WindowState::cols</a></div><div class="ttdeci">short cols</div><div class="ttdoc">Number of columns, can be MUTT_WIN_SIZE_UNLIMITED.</div><div class="ttdef"><b>Definition</b> <a href="mutt__window_8h_source.html#l00061">mutt_window.h:61</a></div></div>
<div class="ttc" id="atmp_8h_html_a271a7828888985955df49205d7846a45"><div class="ttname"><a href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a></div><div class="ttdeci">#define buf_mktemp(buf)</div><div class="ttdef"><b>Definition</b> <a href="tmp_8h_source.html#l00033">tmp.h:33</a></div></div>
</div><!-- fragment --><div id="dynsection-10" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_ab2e07f4628b9c8e41529a62c27d1b51a_cgraph.svg" width="984" height="2176"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-11" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_ab2e07f4628b9c8e41529a62c27d1b51a_icgraph.svg" width="588" height="343"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a1a97d711180c816108d8866ef7b120cc" name="a1a97d711180c816108d8866ef7b120cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a97d711180c816108d8866ef7b120cc">&#9670;&#160;</a></span>mutt_check_lookup_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_check_lookup_list </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the mime type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> attachment body </td></tr>
    <tr><td class="paramname">type</td><td><a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> with mime type of attachment in "type/subtype" format </td></tr>
    <tr><td class="paramname">len</td><td><a class="el" href="structBuffer.html" title="String manipulation buffer.">Buffer</a> length </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8c_source.html#l00343">343</a> of file <a class="el" href="mutt__attach_8c_source.html">mutt_attach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  344</span>{</div>
<div class="line"><span class="lineno">  345</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structListNode.html">ListNode</a> *np = NULL;</div>
<div class="line"><span class="lineno">  346</span>  <a class="code hl_define" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(np, &amp;<a class="code hl_variable" href="globals_8c.html#a5289e099e9203b04ea2829a957915905">MimeLookupList</a>, entries)</div>
<div class="line"><span class="lineno">  347</span>  {</div>
<div class="line"><span class="lineno">  348</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> i = (int) <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>) - 1;</div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">if</span> (((i &gt; 0) &amp;&amp; (np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>[i - 1] == <span class="charliteral">&#39;/&#39;</span>) &amp;&amp; (np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>[i] == <span class="charliteral">&#39;*&#39;</span>) &amp;&amp;</div>
<div class="line"><span class="lineno">  350</span>         <a class="code hl_function" href="mutt_2string_8c.html#aefa17bf84a5a1cb4b41afb08cd91ceff">mutt_istrn_equal</a>(type, np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, i)) ||</div>
<div class="line"><span class="lineno">  351</span>        <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(type, np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>))</div>
<div class="line"><span class="lineno">  352</span>    {</div>
<div class="line"><span class="lineno">  353</span>      <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> tmp = { 0 };</div>
<div class="line"><span class="lineno">  354</span>      <span class="keyword">enum</span> <a class="code hl_enumeration" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79">ContentType</a> n;</div>
<div class="line"><span class="lineno">  355</span>      <span class="keywordflow">if</span> ((n = <a class="code hl_function" href="sendlib_8c.html#a8022f8bacc7380ec914c526c3ebb69d5">mutt_lookup_mime_type</a>(&amp;tmp, b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>)) != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17">TYPE_OTHER</a> ||</div>
<div class="line"><span class="lineno">  356</span>          (n = <a class="code hl_function" href="sendlib_8c.html#a8022f8bacc7380ec914c526c3ebb69d5">mutt_lookup_mime_type</a>(&amp;tmp, b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>)) != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17">TYPE_OTHER</a>)</div>
<div class="line"><span class="lineno">  357</span>      {</div>
<div class="line"><span class="lineno">  358</span>        snprintf(<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a>, len, <span class="stringliteral">&quot;%s/%s&quot;</span>,</div>
<div class="line"><span class="lineno">  359</span>                 (n == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a17e2dc2b6c45bd9d56010ed4aed3fcf4">TYPE_AUDIO</a>)       ? <span class="stringliteral">&quot;audio&quot;</span> :</div>
<div class="line"><span class="lineno">  360</span>                 (n == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) ? <span class="stringliteral">&quot;application&quot;</span> :</div>
<div class="line"><span class="lineno">  361</span>                 (n == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a1c84f9cd2b0d05b7d3f7711fcc0caad8">TYPE_IMAGE</a>)       ? <span class="stringliteral">&quot;image&quot;</span> :</div>
<div class="line"><span class="lineno">  362</span>                 (n == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a>)     ? <span class="stringliteral">&quot;message&quot;</span> :</div>
<div class="line"><span class="lineno">  363</span>                 (n == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a33cf44e9e129e31bc10bf94ff7d50c03">TYPE_MODEL</a>)       ? <span class="stringliteral">&quot;model&quot;</span> :</div>
<div class="line"><span class="lineno">  364</span>                 (n == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>)   ? <span class="stringliteral">&quot;multipart&quot;</span> :</div>
<div class="line"><span class="lineno">  365</span>                 (n == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>)        ? <span class="stringliteral">&quot;text&quot;</span> :</div>
<div class="line"><span class="lineno">  366</span>                 (n == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79afeeff8542e46439d4b704699ff009323">TYPE_VIDEO</a>)       ? <span class="stringliteral">&quot;video&quot;</span> :</div>
<div class="line"><span class="lineno">  367</span>                                           <span class="stringliteral">&quot;other&quot;</span>,</div>
<div class="line"><span class="lineno">  368</span>                 tmp.<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>);</div>
<div class="line"><span class="lineno">  369</span>        <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;\&quot;%s\&quot; -&gt; %s\n&quot;</span>, b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, <a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a>);</div>
<div class="line"><span class="lineno">  370</span>      }</div>
<div class="line"><span class="lineno">  371</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;tmp.<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>);</div>
<div class="line"><span class="lineno">  372</span>      <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;tmp.<a class="code hl_variable" href="structBody.html#a25c15115b34c11620fc995c13383fd9b">xtype</a>);</div>
<div class="line"><span class="lineno">  373</span>    }</div>
<div class="line"><span class="lineno">  374</span>  }</div>
<div class="line"><span class="lineno">  375</span>}</div>
<div class="ttc" id="aglobals_8c_html_a5289e099e9203b04ea2829a957915905"><div class="ttname"><a href="globals_8c.html#a5289e099e9203b04ea2829a957915905">MimeLookupList</a></div><div class="ttdeci">struct ListHead MimeLookupList</div><div class="ttdoc">List of mime types that that shouldn&#39;t use the mailcap entry.</div><div class="ttdef"><b>Definition</b> <a href="globals_8c_source.html#l00047">globals.c:47</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79">ContentType</a></div><div class="ttdeci">ContentType</div><div class="ttdoc">Content-Type.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00029">mime.h:30</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a17e2dc2b6c45bd9d56010ed4aed3fcf4"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a17e2dc2b6c45bd9d56010ed4aed3fcf4">TYPE_AUDIO</a></div><div class="ttdeci">@ TYPE_AUDIO</div><div class="ttdoc">Type: &#39;audio/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00032">mime.h:32</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a1c84f9cd2b0d05b7d3f7711fcc0caad8"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a1c84f9cd2b0d05b7d3f7711fcc0caad8">TYPE_IMAGE</a></div><div class="ttdeci">@ TYPE_IMAGE</div><div class="ttdoc">Type: &#39;image/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00034">mime.h:34</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2c4c96a2b998731adad0506fabeb9c17">TYPE_OTHER</a></div><div class="ttdeci">@ TYPE_OTHER</div><div class="ttdoc">Unknown Content-Type.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00031">mime.h:31</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a></div><div class="ttdeci">@ TYPE_MESSAGE</div><div class="ttdoc">Type: &#39;message/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00035">mime.h:35</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a33cf44e9e129e31bc10bf94ff7d50c03"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a33cf44e9e129e31bc10bf94ff7d50c03">TYPE_MODEL</a></div><div class="ttdeci">@ TYPE_MODEL</div><div class="ttdoc">Type: &#39;model/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00036">mime.h:36</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdeci">@ TYPE_APPLICATION</div><div class="ttdoc">Type: &#39;application/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdeci">@ TYPE_TEXT</div><div class="ttdoc">Type: &#39;text/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79afeeff8542e46439d4b704699ff009323"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79afeeff8542e46439d4b704699ff009323">TYPE_VIDEO</a></div><div class="ttdeci">@ TYPE_VIDEO</div><div class="ttdoc">Type: &#39;video/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00039">mime.h:39</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00672">string.c:672</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_acca6786b903b22a5924219f9db96e10d"><div class="ttname"><a href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a></div><div class="ttdeci">size_t mutt_str_len(const char *a)</div><div class="ttdoc">Calculate the length of a string, safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00498">string.c:498</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_aefa17bf84a5a1cb4b41afb08cd91ceff"><div class="ttname"><a href="mutt_2string_8c.html#aefa17bf84a5a1cb4b41afb08cd91ceff">mutt_istrn_equal</a></div><div class="ttdeci">bool mutt_istrn_equal(const char *a, const char *b, size_t num)</div><div class="ttdoc">Check for equality of two strings ignoring case (to a maximum), safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00455">string.c:455</a></div></div>
<div class="ttc" id="aqueue_8h_html_a77999ebdf5aaf7af8b8ea22bf208c432"><div class="ttname"><a href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a></div><div class="ttdeci">#define STAILQ_FOREACH(var, head, field)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00390">queue.h:390</a></div></div>
<div class="ttc" id="asendlib_8c_html_a8022f8bacc7380ec914c526c3ebb69d5"><div class="ttname"><a href="sendlib_8c.html#a8022f8bacc7380ec914c526c3ebb69d5">mutt_lookup_mime_type</a></div><div class="ttdeci">enum ContentType mutt_lookup_mime_type(struct Body *b, const char *path)</div><div class="ttdoc">Find the MIME type for an attachment.</div><div class="ttdef"><b>Definition</b> <a href="sendlib_8c_source.html#l00075">sendlib.c:75</a></div></div>
<div class="ttc" id="astructBody_html_a25c15115b34c11620fc995c13383fd9b"><div class="ttname"><a href="structBody.html#a25c15115b34c11620fc995c13383fd9b">Body::xtype</a></div><div class="ttdeci">char * xtype</div><div class="ttdoc">content-type if x-unknown</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00062">body.h:62</a></div></div>
<div class="ttc" id="astructListNode_html"><div class="ttname"><a href="structListNode.html">ListNode</a></div><div class="ttdoc">A List node for strings.</div><div class="ttdef"><b>Definition</b> <a href="list_8h_source.html#l00036">list.h:37</a></div></div>
<div class="ttc" id="astructListNode_html_aafe688d670318196766392d8235d00a7"><div class="ttname"><a href="structListNode.html#aafe688d670318196766392d8235d00a7">ListNode::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">String.</div><div class="ttdef"><b>Definition</b> <a href="list_8h_source.html#l00038">list.h:38</a></div></div>
</div><!-- fragment --><div id="dynsection-12" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a1a97d711180c816108d8866ef7b120cc_cgraph.svg" width="562" height="140"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-13" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a1a97d711180c816108d8866ef7b120cc_icgraph.svg" width="478" height="66"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a492006c267947f1d6466f2c32f17aa55" name="a492006c267947f1d6466f2c32f17aa55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a492006c267947f1d6466f2c32f17aa55">&#9670;&#160;</a></span>mutt_compose_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_compose_attachment </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create an attachment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>Require full screen redraw </td></tr>
    <tr><td class="paramname">0</td><td>Otherwise </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8c_source.html#l00120">120</a> of file <a class="el" href="mutt__attach_8c_source.html">mutt_attach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  121</span>{</div>
<div class="line"><span class="lineno">  122</span>  <span class="keywordtype">char</span> type[256] = { 0 };</div>
<div class="line"><span class="lineno">  123</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structMailcapEntry.html">MailcapEntry</a> *entry = <a class="code hl_function" href="mailcap_8c.html#a8114f2f64a9bf84055e0e1d624b8c050">mailcap_entry_new</a>();</div>
<div class="line"><span class="lineno">  124</span>  <span class="keywordtype">bool</span> unlink_newfile = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  125</span>  <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><span class="lineno">  126</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *cmd = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  127</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *newfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  128</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *tempfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>  snprintf(type, <span class="keyword">sizeof</span>(type), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code hl_define" href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a>(b), b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>);</div>
<div class="line"><span class="lineno">  131</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mailcap_8c.html#af76f3b2c5819c22f1470723cc30a9ad1">mailcap_lookup</a>(b, type, <span class="keyword">sizeof</span>(type), entry, <a class="code hl_enumvalue" href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1adf2bd2611de86e55bd3b472569c40ed9">MUTT_MC_COMPOSE</a>))</div>
<div class="line"><span class="lineno">  132</span>  {</div>
<div class="line"><span class="lineno">  133</span>    <span class="keywordflow">if</span> (entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a365aee1471f7897abec0c347e43426e1">composecommand</a> || entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a9465c493bab0bd5d9ee072025bad7afd">composetypecommand</a>)</div>
<div class="line"><span class="lineno">  134</span>    {</div>
<div class="line"><span class="lineno">  135</span>      <span class="keywordflow">if</span> (entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a9465c493bab0bd5d9ee072025bad7afd">composetypecommand</a>)</div>
<div class="line"><span class="lineno">  136</span>        <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(cmd, entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a9465c493bab0bd5d9ee072025bad7afd">composetypecommand</a>);</div>
<div class="line"><span class="lineno">  137</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  138</span>        <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(cmd, entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a365aee1471f7897abec0c347e43426e1">composecommand</a>);</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>      <a class="code hl_function" href="mailcap_8c.html#accb5ae6e2f507053e8436a2f00b834ea">mailcap_expand_filename</a>(entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a85835d27aa930e64eef4eae5f9498401">nametemplate</a>, b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, newfile);</div>
<div class="line"><span class="lineno">  141</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;oldfile: %s     newfile: %s\n&quot;</span>, b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>,</div>
<div class="line"><span class="lineno">  142</span>                 <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile));</div>
<div class="line"><span class="lineno">  143</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="file_8c.html#a8f150fbd8c72f544d733440b861eda9c">mutt_file_symlink</a>(b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile)) == -1)</div>
<div class="line"><span class="lineno">  144</span>      {</div>
<div class="line"><span class="lineno">  145</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="question_2lib_8h.html#ae359ab94312d9ae6bcad5ab5b52bd529">query_yesorno</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t match &#39;nametemplate&#39;, continue?&quot;</span>), <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>) != <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div>
<div class="line"><span class="lineno">  146</span>          <span class="keywordflow">goto</span> bailout;</div>
<div class="line"><span class="lineno">  147</span>        <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(newfile, b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div>
<div class="line"><span class="lineno">  148</span>      }</div>
<div class="line"><span class="lineno">  149</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  150</span>      {</div>
<div class="line"><span class="lineno">  151</span>        unlink_newfile = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  152</span>      }</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mailcap_8c.html#ac95deddbed52214ab8797bf9d19c1b8b">mailcap_expand_command</a>(b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile), type, cmd))</div>
<div class="line"><span class="lineno">  155</span>      {</div>
<div class="line"><span class="lineno">  156</span>        <span class="comment">/* For now, editing requires a file, no piping */</span></div>
<div class="line"><span class="lineno">  157</span>        <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mailcap compose entry requires %%s&quot;</span>));</div>
<div class="line"><span class="lineno">  158</span>      }</div>
<div class="line"><span class="lineno">  159</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  160</span>      {</div>
<div class="line"><span class="lineno">  161</span>        <span class="keywordtype">int</span> r;</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>        <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  164</span>        r = <a class="code hl_function" href="protos_8h.html#aa1d4ad04b000036513ca3f741059942c">mutt_system</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd));</div>
<div class="line"><span class="lineno">  165</span>        <span class="keywordflow">if</span> (r == -1)</div>
<div class="line"><span class="lineno">  166</span>          <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Error running \&quot;%s\&quot;&quot;</span>), <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd));</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">if</span> ((r != -1) &amp;&amp; entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a9465c493bab0bd5d9ee072025bad7afd">composetypecommand</a>)</div>
<div class="line"><span class="lineno">  169</span>        {</div>
<div class="line"><span class="lineno">  170</span>          FILE *fp = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">  171</span>          <span class="keywordflow">if</span> (!fp)</div>
<div class="line"><span class="lineno">  172</span>          {</div>
<div class="line"><span class="lineno">  173</span>            <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Failure to open file to parse headers&quot;</span>));</div>
<div class="line"><span class="lineno">  174</span>            <span class="keywordflow">goto</span> bailout;</div>
<div class="line"><span class="lineno">  175</span>          }</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>          <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *b_mime = <a class="code hl_function" href="email_2parse_8c.html#a2cfe061d82e6381b14e355c0937ecfc1">mutt_read_mime_header</a>(fp, 0);</div>
<div class="line"><span class="lineno">  178</span>          <span class="keywordflow">if</span> (b_mime)</div>
<div class="line"><span class="lineno">  179</span>          {</div>
<div class="line"><span class="lineno">  180</span>            <span class="keywordflow">if</span> (!<a class="code hl_define" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;b_mime-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>))</div>
<div class="line"><span class="lineno">  181</span>            {</div>
<div class="line"><span class="lineno">  182</span>              <a class="code hl_function" href="parameter_8c.html#ade3b55d0262dc913be1e8307390514a0">mutt_param_free</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>);</div>
<div class="line"><span class="lineno">  183</span>              b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a> = b_mime-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>;</div>
<div class="line"><span class="lineno">  184</span>              <a class="code hl_define" href="queue_8h.html#a449d224023780e46253b83b61e0a50a9">TAILQ_INIT</a>(&amp;b_mime-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>);</div>
<div class="line"><span class="lineno">  185</span>            }</div>
<div class="line"><span class="lineno">  186</span>            <span class="keywordflow">if</span> (b_mime-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>)</div>
<div class="line"><span class="lineno">  187</span>            {</div>
<div class="line"><span class="lineno">  188</span>              <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>);</div>
<div class="line"><span class="lineno">  189</span>              b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a> = b_mime-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>;</div>
<div class="line"><span class="lineno">  190</span>              b_mime-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a> = NULL;</div>
<div class="line"><span class="lineno">  191</span>            }</div>
<div class="line"><span class="lineno">  192</span>            <span class="keywordflow">if</span> (b_mime-&gt;<a class="code hl_variable" href="structBody.html#aea3b13e7e6b68ebf707532938601321a">form_name</a>)</div>
<div class="line"><span class="lineno">  193</span>            {</div>
<div class="line"><span class="lineno">  194</span>              <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#aea3b13e7e6b68ebf707532938601321a">form_name</a>);</div>
<div class="line"><span class="lineno">  195</span>              b-&gt;<a class="code hl_variable" href="structBody.html#aea3b13e7e6b68ebf707532938601321a">form_name</a> = b_mime-&gt;<a class="code hl_variable" href="structBody.html#aea3b13e7e6b68ebf707532938601321a">form_name</a>;</div>
<div class="line"><span class="lineno">  196</span>              b_mime-&gt;<a class="code hl_variable" href="structBody.html#aea3b13e7e6b68ebf707532938601321a">form_name</a> = NULL;</div>
<div class="line"><span class="lineno">  197</span>            }</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>            <span class="comment">/* Remove headers by copying out data to another file, then</span></div>
<div class="line"><span class="lineno">  200</span><span class="comment">             * copying the file back */</span></div>
<div class="line"><span class="lineno">  201</span>            <span class="keyword">const</span> LOFF_T <a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a> = b_mime-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>;</div>
<div class="line"><span class="lineno">  202</span>            <a class="code hl_function" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;b_mime);</div>
<div class="line"><span class="lineno">  203</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a>(fp, <a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>, SEEK_SET))</div>
<div class="line"><span class="lineno">  204</span>            {</div>
<div class="line"><span class="lineno">  205</span>              <span class="keywordflow">goto</span> bailout;</div>
<div class="line"><span class="lineno">  206</span>            }</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>            <a class="code hl_define" href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a>(tempfile);</div>
<div class="line"><span class="lineno">  209</span>            FILE *fp_tmp = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">  210</span>            <span class="keywordflow">if</span> (!fp_tmp)</div>
<div class="line"><span class="lineno">  211</span>            {</div>
<div class="line"><span class="lineno">  212</span>              <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Failure to open file to strip headers&quot;</span>));</div>
<div class="line"><span class="lineno">  213</span>              <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp);</div>
<div class="line"><span class="lineno">  214</span>              <span class="keywordflow">goto</span> bailout;</div>
<div class="line"><span class="lineno">  215</span>            }</div>
<div class="line"><span class="lineno">  216</span>            <a class="code hl_function" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(fp, fp_tmp);</div>
<div class="line"><span class="lineno">  217</span>            <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp);</div>
<div class="line"><span class="lineno">  218</span>            <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_tmp);</div>
<div class="line"><span class="lineno">  219</span>            <a class="code hl_function" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div>
<div class="line"><span class="lineno">  220</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="file_8c.html#a8154bfd014904ca57b0ba2cfb31e26bc">mutt_file_rename</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>) != 0)</div>
<div class="line"><span class="lineno">  221</span>            {</div>
<div class="line"><span class="lineno">  222</span>              <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Failure to rename file&quot;</span>));</div>
<div class="line"><span class="lineno">  223</span>              <span class="keywordflow">goto</span> bailout;</div>
<div class="line"><span class="lineno">  224</span>            }</div>
<div class="line"><span class="lineno">  225</span>          }</div>
<div class="line"><span class="lineno">  226</span>        }</div>
<div class="line"><span class="lineno">  227</span>      }</div>
<div class="line"><span class="lineno">  228</span>    }</div>
<div class="line"><span class="lineno">  229</span>  }</div>
<div class="line"><span class="lineno">  230</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  231</span>  {</div>
<div class="line"><span class="lineno">  232</span>    <a class="code hl_define" href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No mailcap compose entry for %s, creating empty file&quot;</span>), <a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a>);</div>
<div class="line"><span class="lineno">  233</span>    rc = 1;</div>
<div class="line"><span class="lineno">  234</span>    <span class="keywordflow">goto</span> bailout;</div>
<div class="line"><span class="lineno">  235</span>  }</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>  rc = 1;</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>bailout:</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>  <span class="keywordflow">if</span> (unlink_newfile)</div>
<div class="line"><span class="lineno">  242</span>    <a class="code hl_variable" href="structBody.html#a47191eabf16d34d0deb412c898ed629b">unlink</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile));</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;cmd);</div>
<div class="line"><span class="lineno">  245</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;newfile);</div>
<div class="line"><span class="lineno">  246</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;tempfile);</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>  <a class="code hl_function" href="mailcap_8c.html#a49fd88d8bb73a7a56c4cc0fe28dfb645">mailcap_entry_free</a>(&amp;entry);</div>
<div class="line"><span class="lineno">  249</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  250</span>}</div>
<div class="ttc" id="aemail_2body_8c_html_a129af1c316fcbc26b55fb48957bab2cb"><div class="ttname"><a href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a></div><div class="ttdeci">void mutt_body_free(struct Body **ptr)</div><div class="ttdoc">Free a Body.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8c_source.html#l00058">body.c:58</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a2cfe061d82e6381b14e355c0937ecfc1"><div class="ttname"><a href="email_2parse_8c.html#a2cfe061d82e6381b14e355c0937ecfc1">mutt_read_mime_header</a></div><div class="ttdeci">struct Body * mutt_read_mime_header(FILE *fp, bool digest)</div><div class="ttdoc">Parse a MIME header.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01361">parse.c:1361</a></div></div>
<div class="ttc" id="afile_8c_html_a0a6ff09a685fb6fa1120a582a5a6ef4a"><div class="ttname"><a href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a></div><div class="ttdeci">int mutt_file_copy_stream(FILE *fp_in, FILE *fp_out)</div><div class="ttdoc">Copy the contents of one file into another.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00225">file.c:225</a></div></div>
<div class="ttc" id="afile_8c_html_a6b60cb2044041374689e6e6641c5cc05"><div class="ttname"><a href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a></div><div class="ttdeci">bool mutt_file_seek(FILE *fp, LOFF_T offset, int whence)</div><div class="ttdoc">Wrapper for fseeko with error handling.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00655">file.c:655</a></div></div>
<div class="ttc" id="afile_8c_html_a8154bfd014904ca57b0ba2cfb31e26bc"><div class="ttname"><a href="file_8c.html#a8154bfd014904ca57b0ba2cfb31e26bc">mutt_file_rename</a></div><div class="ttdeci">int mutt_file_rename(const char *oldfile, const char *newfile)</div><div class="ttdoc">Rename a file.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l01264">file.c:1264</a></div></div>
<div class="ttc" id="afile_8c_html_a8f150fbd8c72f544d733440b861eda9c"><div class="ttname"><a href="file_8c.html#a8f150fbd8c72f544d733440b861eda9c">mutt_file_symlink</a></div><div class="ttdeci">int mutt_file_symlink(const char *oldpath, const char *newpath)</div><div class="ttdoc">Create a symlink.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00253">file.c:253</a></div></div>
<div class="ttc" id="amailcap_8h_html_a0716f6351a9229990024889ec22b33c1adf2bd2611de86e55bd3b472569c40ed9"><div class="ttname"><a href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1adf2bd2611de86e55bd3b472569c40ed9">MUTT_MC_COMPOSE</a></div><div class="ttdeci">@ MUTT_MC_COMPOSE</div><div class="ttdoc">Mailcap compose field.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00059">mailcap.h:59</a></div></div>
<div class="ttc" id="aparameter_8c_html_ade3b55d0262dc913be1e8307390514a0"><div class="ttname"><a href="parameter_8c.html#ade3b55d0262dc913be1e8307390514a0">mutt_param_free</a></div><div class="ttdeci">void mutt_param_free(struct ParameterList *pl)</div><div class="ttdoc">Free a ParameterList.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8c_source.html#l00062">parameter.c:62</a></div></div>
<div class="ttc" id="aquestion_2lib_8h_html_ae359ab94312d9ae6bcad5ab5b52bd529"><div class="ttname"><a href="question_2lib_8h.html#ae359ab94312d9ae6bcad5ab5b52bd529">query_yesorno</a></div><div class="ttdeci">enum QuadOption query_yesorno(const char *prompt, enum QuadOption def)</div><div class="ttdoc">Ask the user a Yes/No question.</div><div class="ttdef"><b>Definition</b> <a href="question_8c_source.html#l00325">question.c:325</a></div></div>
<div class="ttc" id="aqueue_8h_html_a449d224023780e46253b83b61e0a50a9"><div class="ttname"><a href="queue_8h.html#a449d224023780e46253b83b61e0a50a9">TAILQ_INIT</a></div><div class="ttdeci">#define TAILQ_INIT(head)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00822">queue.h:822</a></div></div>
<div class="ttc" id="aqueue_8h_html_ac3c9da7ac712eacbbad5cc54d7a3477e"><div class="ttname"><a href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a></div><div class="ttdeci">#define TAILQ_EMPTY(head)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00778">queue.h:778</a></div></div>
<div class="ttc" id="astructBody_html_a1969dfeb0a155ccb16153fe777a103b0"><div class="ttname"><a href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">Body::offset</a></div><div class="ttdeci">LOFF_T offset</div><div class="ttdoc">offset where the actual data begins</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00052">body.h:52</a></div></div>
<div class="ttc" id="astructBody_html_a47191eabf16d34d0deb412c898ed629b"><div class="ttname"><a href="structBody.html#a47191eabf16d34d0deb412c898ed629b">Body::unlink</a></div><div class="ttdeci">bool unlink</div><div class="ttdoc">If true, filename should be unlink()ed before free()ing this structure.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00068">body.h:68</a></div></div>
<div class="ttc" id="astructBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">Parameters of the content-type.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00063">body.h:63</a></div></div>
<div class="ttc" id="astructBody_html_aea3b13e7e6b68ebf707532938601321a"><div class="ttname"><a href="structBody.html#aea3b13e7e6b68ebf707532938601321a">Body::form_name</a></div><div class="ttdeci">char * form_name</div><div class="ttdoc">Content-Disposition form-data name param.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00060">body.h:60</a></div></div>
<div class="ttc" id="astructMailcapEntry_html_a365aee1471f7897abec0c347e43426e1"><div class="ttname"><a href="structMailcapEntry.html#a365aee1471f7897abec0c347e43426e1">MailcapEntry::composecommand</a></div><div class="ttdeci">char * composecommand</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00040">mailcap.h:40</a></div></div>
<div class="ttc" id="astructMailcapEntry_html_a9465c493bab0bd5d9ee072025bad7afd"><div class="ttname"><a href="structMailcapEntry.html#a9465c493bab0bd5d9ee072025bad7afd">MailcapEntry::composetypecommand</a></div><div class="ttdeci">char * composetypecommand</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00041">mailcap.h:41</a></div></div>
</div><!-- fragment --><div id="dynsection-14" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a492006c267947f1d6466f2c32f17aa55_cgraph.svg" width="643" height="1048"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-15" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a492006c267947f1d6466f2c32f17aa55_icgraph.svg" width="436" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aac29548ca4501311138dfa43db788bd3" name="aac29548ca4501311138dfa43db788bd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac29548ca4501311138dfa43db788bd3">&#9670;&#160;</a></span>mutt_decode_save_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_decode_save_attachment </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="mutt_2state_8h.html#ad4dd18eb8ded2d275901494289ac3986">StateFlags</a></td>          <td class="paramname"><span class="paramname"><em>flags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="#a5675c7a41890711ec4871b592c840faa">SaveAttach</a></td>          <td class="paramname"><span class="paramname"><em>opt</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decode, then save an attachment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>File to read from (OPTIONAL) </td></tr>
    <tr><td class="paramname">b</td><td>Attachment </td></tr>
    <tr><td class="paramname">path</td><td>Path to save the Attachment to </td></tr>
    <tr><td class="paramname">flags</td><td>Flags, e.g. <a class="el" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7" title="Output is displayed to the user.">STATE_DISPLAY</a> </td></tr>
    <tr><td class="paramname">opt</td><td>Save option, see <a class="el" href="#a5675c7a41890711ec4871b592c840faa" title="Options for saving attachments.">SaveAttach</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8c_source.html#l01039">1039</a> of file <a class="el" href="mutt__attach_8c_source.html">mutt_attach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1041</span>{</div>
<div class="line"><span class="lineno"> 1042</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structState.html">State</a> state = { 0 };</div>
<div class="line"><span class="lineno"> 1043</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> saved_encoding = 0;</div>
<div class="line"><span class="lineno"> 1044</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *saved_parts = NULL;</div>
<div class="line"><span class="lineno"> 1045</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structEmail.html">Email</a> *e_saved = NULL;</div>
<div class="line"><span class="lineno"> 1046</span>  <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span>  state.<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> = flags;</div>
<div class="line"><span class="lineno"> 1049</span> </div>
<div class="line"><span class="lineno"> 1050</span>  <span class="keywordflow">if</span> (opt == <a class="code hl_enumvalue" href="#a5675c7a41890711ec4871b592c840faaa3f82d6dcb02891511fe91907b398aa1c">MUTT_SAVE_APPEND</a>)</div>
<div class="line"><span class="lineno"> 1051</span>    state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a> = <a class="code hl_define" href="neomutt_8h.html#a32de36debf7caa2f77cbd94d576bd380">mutt_file_fopen_masked</a>(<a class="code hl_variable" href="structEmail.html#ac041599cfe41b49e7b8f9d752d07bb39">path</a>, <span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><span class="lineno"> 1052</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1053</span>    state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a> = <a class="code hl_define" href="neomutt_8h.html#a32de36debf7caa2f77cbd94d576bd380">mutt_file_fopen_masked</a>(<a class="code hl_variable" href="structEmail.html#ac041599cfe41b49e7b8f9d752d07bb39">path</a>, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>  <span class="keywordflow">if</span> (!state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>)</div>
<div class="line"><span class="lineno"> 1056</span>  {</div>
<div class="line"><span class="lineno"> 1057</span>    <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;fopen&quot;</span>);</div>
<div class="line"><span class="lineno"> 1058</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1059</span>  }</div>
<div class="line"><span class="lineno"> 1060</span> </div>
<div class="line"><span class="lineno"> 1061</span>  <span class="keywordflow">if</span> (fp)</div>
<div class="line"><span class="lineno"> 1062</span>  {</div>
<div class="line"><span class="lineno"> 1063</span>    state.<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a> = fp;</div>
<div class="line"><span class="lineno"> 1064</span>    state.<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> |= <a class="code hl_define" href="mutt_2state_8h.html#abff873a2f7f4f3e664c8c4f90a11f44a">STATE_CHARCONV</a>;</div>
<div class="line"><span class="lineno"> 1065</span>  }</div>
<div class="line"><span class="lineno"> 1066</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1067</span>  {</div>
<div class="line"><span class="lineno"> 1068</span>    <span class="comment">/* When called from the compose menu, the attachment isn&#39;t parsed,</span></div>
<div class="line"><span class="lineno"> 1069</span><span class="comment">     * so we need to do it here. */</span></div>
<div class="line"><span class="lineno"> 1070</span>    state.<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a> = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno"> 1071</span>    <span class="keywordflow">if</span> (!state.<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>)</div>
<div class="line"><span class="lineno"> 1072</span>    {</div>
<div class="line"><span class="lineno"> 1073</span>      <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;fopen&quot;</span>);</div>
<div class="line"><span class="lineno"> 1074</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>);</div>
<div class="line"><span class="lineno"> 1075</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1076</span>    }</div>
<div class="line"><span class="lineno"> 1077</span> </div>
<div class="line"><span class="lineno"> 1078</span>    <span class="keyword">struct </span>stat st = { 0 };</div>
<div class="line"><span class="lineno"> 1079</span>    <span class="keywordflow">if</span> (fstat(fileno(state.<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>), &amp;st) == -1)</div>
<div class="line"><span class="lineno"> 1080</span>    {</div>
<div class="line"><span class="lineno"> 1081</span>      <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;stat&quot;</span>);</div>
<div class="line"><span class="lineno"> 1082</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;state.<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>);</div>
<div class="line"><span class="lineno"> 1083</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>);</div>
<div class="line"><span class="lineno"> 1084</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1085</span>    }</div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span>    saved_encoding = b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a>;</div>
<div class="line"><span class="lineno"> 1088</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="mime_8h.html#aeaf0dc750233c21ac5b499082c6ff62f">is_multipart</a>(b))</div>
<div class="line"><span class="lineno"> 1089</span>      b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466">ENC_8BIT</a>;</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = st.st_size;</div>
<div class="line"><span class="lineno"> 1092</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a> = 0;</div>
<div class="line"><span class="lineno"> 1093</span>    saved_parts = b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno"> 1094</span>    e_saved = b-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>;</div>
<div class="line"><span class="lineno"> 1095</span>    <a class="code hl_function" href="email_2parse_8c.html#a0b38ac4f44b3414d0e18d26324861369">mutt_parse_part</a>(state.<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, b);</div>
<div class="line"><span class="lineno"> 1096</span> </div>
<div class="line"><span class="lineno"> 1097</span>    <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#a2f795dc4337b500fbf2ae6682dc5360b">noconv</a> || <a class="code hl_define" href="mime_8h.html#aeaf0dc750233c21ac5b499082c6ff62f">is_multipart</a>(b))</div>
<div class="line"><span class="lineno"> 1098</span>      state.<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> |= <a class="code hl_define" href="mutt_2state_8h.html#abff873a2f7f4f3e664c8c4f90a11f44a">STATE_CHARCONV</a>;</div>
<div class="line"><span class="lineno"> 1099</span>  }</div>
<div class="line"><span class="lineno"> 1100</span> </div>
<div class="line"><span class="lineno"> 1101</span>  <a class="code hl_function" href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a>(b, &amp;state);</div>
<div class="line"><span class="lineno"> 1102</span> </div>
<div class="line"><span class="lineno"> 1103</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="file_8c.html#ae6b2571365b85d78aa796fd220c740ce">mutt_file_fsync_close</a>(&amp;state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>) != 0)</div>
<div class="line"><span class="lineno"> 1104</span>  {</div>
<div class="line"><span class="lineno"> 1105</span>    <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;fclose&quot;</span>);</div>
<div class="line"><span class="lineno"> 1106</span>    rc = -1;</div>
<div class="line"><span class="lineno"> 1107</span>  }</div>
<div class="line"><span class="lineno"> 1108</span>  <span class="keywordflow">if</span> (!fp)</div>
<div class="line"><span class="lineno"> 1109</span>  {</div>
<div class="line"><span class="lineno"> 1110</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = 0;</div>
<div class="line"><span class="lineno"> 1111</span>    b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = saved_encoding;</div>
<div class="line"><span class="lineno"> 1112</span>    <span class="keywordflow">if</span> (saved_parts)</div>
<div class="line"><span class="lineno"> 1113</span>    {</div>
<div class="line"><span class="lineno"> 1114</span>      <a class="code hl_function" href="email_2email_8c.html#ae9f719d3fc31d00b92bcf9f77d56ee67">email_free</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>);</div>
<div class="line"><span class="lineno"> 1115</span>      b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = saved_parts;</div>
<div class="line"><span class="lineno"> 1116</span>      b-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a> = e_saved;</div>
<div class="line"><span class="lineno"> 1117</span>    }</div>
<div class="line"><span class="lineno"> 1118</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;state.<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>);</div>
<div class="line"><span class="lineno"> 1119</span>  }</div>
<div class="line"><span class="lineno"> 1120</span> </div>
<div class="line"><span class="lineno"> 1121</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno"> 1122</span>}</div>
<div class="ttc" id="aemail_2email_8c_html_ae9f719d3fc31d00b92bcf9f77d56ee67"><div class="ttname"><a href="email_2email_8c.html#ae9f719d3fc31d00b92bcf9f77d56ee67">email_free</a></div><div class="ttdeci">void email_free(struct Email **ptr)</div><div class="ttdoc">Free an Email.</div><div class="ttdef"><b>Definition</b> <a href="email_2email_8c_source.html#l00046">email.c:46</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a0b38ac4f44b3414d0e18d26324861369"><div class="ttname"><a href="email_2parse_8c.html#a0b38ac4f44b3414d0e18d26324861369">mutt_parse_part</a></div><div class="ttdeci">void mutt_parse_part(FILE *fp, struct Body *b)</div><div class="ttdoc">Parse a MIME part.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01821">parse.c:1821</a></div></div>
<div class="ttc" id="afile_8c_html_ae6b2571365b85d78aa796fd220c740ce"><div class="ttname"><a href="file_8c.html#ae6b2571365b85d78aa796fd220c740ce">mutt_file_fsync_close</a></div><div class="ttdeci">int mutt_file_fsync_close(FILE **fp)</div><div class="ttdoc">Flush the data, before closing a file (and NULL the pointer)</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00131">file.c:131</a></div></div>
<div class="ttc" id="ahandler_8c_html_a3e520d3004995a6c0cf0696edfd209fb"><div class="ttname"><a href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a></div><div class="ttdeci">int mutt_body_handler(struct Body *b, struct State *state)</div><div class="ttdoc">Handler for the Body of an email.</div><div class="ttdef"><b>Definition</b> <a href="handler_8c_source.html#l01632">handler.c:1632</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466">ENC_8BIT</a></div><div class="ttdeci">@ ENC_8BIT</div><div class="ttdoc">8-bit text</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00050">mime.h:50</a></div></div>
<div class="ttc" id="amime_8h_html_aeaf0dc750233c21ac5b499082c6ff62f"><div class="ttname"><a href="mime_8h.html#aeaf0dc750233c21ac5b499082c6ff62f">is_multipart</a></div><div class="ttdeci">#define is_multipart(body)</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00082">mime.h:82</a></div></div>
<div class="ttc" id="aneomutt_8h_html_a32de36debf7caa2f77cbd94d576bd380"><div class="ttname"><a href="neomutt_8h.html#a32de36debf7caa2f77cbd94d576bd380">mutt_file_fopen_masked</a></div><div class="ttdeci">#define mutt_file_fopen_masked(PATH, MODE)</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00081">neomutt.h:81</a></div></div>
<div class="ttc" id="astructBody_html_a2f795dc4337b500fbf2ae6682dc5360b"><div class="ttname"><a href="structBody.html#a2f795dc4337b500fbf2ae6682dc5360b">Body::noconv</a></div><div class="ttdeci">bool noconv</div><div class="ttdoc">Don&#39;t do character set conversion.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00046">body.h:46</a></div></div>
<div class="ttc" id="astructBody_html_a6f92d7ec8568ca04ae07931c56dd0790"><div class="ttname"><a href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">Body::length</a></div><div class="ttdeci">LOFF_T length</div><div class="ttdoc">length (in bytes) of attachment</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00053">body.h:53</a></div></div>
<div class="ttc" id="astructBody_html_ad2f05b8ff24813de41988e63de5d6a31"><div class="ttname"><a href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">Body::encoding</a></div><div class="ttdeci">unsigned int encoding</div><div class="ttdoc">content-transfer-encoding, ContentEncoding</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00041">body.h:41</a></div></div>
<div class="ttc" id="astructEmail_html"><div class="ttname"><a href="structEmail.html">Email</a></div><div class="ttdoc">The envelope/body of an email.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00038">email.h:39</a></div></div>
<div class="ttc" id="astructEmail_html_ac041599cfe41b49e7b8f9d752d07bb39"><div class="ttname"><a href="structEmail.html#ac041599cfe41b49e7b8f9d752d07bb39">Email::path</a></div><div class="ttdeci">char * path</div><div class="ttdoc">Path of Email (for local Mailboxes)</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00070">email.h:70</a></div></div>
</div><!-- fragment --><div id="dynsection-16" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_aac29548ca4501311138dfa43db788bd3_cgraph.svg" width="424" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-17" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_aac29548ca4501311138dfa43db788bd3_icgraph.svg" width="638" height="290"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0b2292184984705d60be088b9dbbecfb" name="a0b2292184984705d60be088b9dbbecfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2292184984705d60be088b9dbbecfb">&#9670;&#160;</a></span>mutt_edit_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mutt_edit_attachment </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Edit an attachment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> containing attachment </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Editor found </td></tr>
    <tr><td class="paramname">false</td><td>Editor not found</td></tr>
  </table>
  </dd>
</dl>
<p>Currently, this only works for send mode, as it assumes that the Body-&gt;filename actually contains the information. I'm not sure we want to deal with editing attachments we've already received, so this should be ok.</p>
<p>Returning 0 is useful to tell the calling menu to redraw </p>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8c_source.html#l00265">265</a> of file <a class="el" href="mutt__attach_8c_source.html">mutt_attach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  266</span>{</div>
<div class="line"><span class="lineno">  267</span>  <span class="keywordtype">char</span> type[256] = { 0 };</div>
<div class="line"><span class="lineno">  268</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structMailcapEntry.html">MailcapEntry</a> *entry = <a class="code hl_function" href="mailcap_8c.html#a8114f2f64a9bf84055e0e1d624b8c050">mailcap_entry_new</a>();</div>
<div class="line"><span class="lineno">  269</span>  <span class="keywordtype">bool</span> unlink_newfile = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  270</span>  <span class="keywordtype">bool</span> rc = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  271</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *cmd = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  272</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *newfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>  snprintf(type, <span class="keyword">sizeof</span>(type), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code hl_define" href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a>(b), b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>);</div>
<div class="line"><span class="lineno">  275</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mailcap_8c.html#af76f3b2c5819c22f1470723cc30a9ad1">mailcap_lookup</a>(b, type, <span class="keyword">sizeof</span>(type), entry, <a class="code hl_enumvalue" href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1a573dc2a7dcdf2058404b201a98906fdc">MUTT_MC_EDIT</a>))</div>
<div class="line"><span class="lineno">  276</span>  {</div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">if</span> (entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#ac195e10d836eb0b886580310c2cf0554">editcommand</a>)</div>
<div class="line"><span class="lineno">  278</span>    {</div>
<div class="line"><span class="lineno">  279</span>      <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(cmd, entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#ac195e10d836eb0b886580310c2cf0554">editcommand</a>);</div>
<div class="line"><span class="lineno">  280</span>      <a class="code hl_function" href="mailcap_8c.html#accb5ae6e2f507053e8436a2f00b834ea">mailcap_expand_filename</a>(entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a85835d27aa930e64eef4eae5f9498401">nametemplate</a>, b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, newfile);</div>
<div class="line"><span class="lineno">  281</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;oldfile: %s     newfile: %s\n&quot;</span>, b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>,</div>
<div class="line"><span class="lineno">  282</span>                 <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile));</div>
<div class="line"><span class="lineno">  283</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="file_8c.html#a8f150fbd8c72f544d733440b861eda9c">mutt_file_symlink</a>(b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile)) == -1)</div>
<div class="line"><span class="lineno">  284</span>      {</div>
<div class="line"><span class="lineno">  285</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="question_2lib_8h.html#ae359ab94312d9ae6bcad5ab5b52bd529">query_yesorno</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t match &#39;nametemplate&#39;, continue?&quot;</span>), <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>) != <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div>
<div class="line"><span class="lineno">  286</span>          <span class="keywordflow">goto</span> bailout;</div>
<div class="line"><span class="lineno">  287</span>        <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(newfile, b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div>
<div class="line"><span class="lineno">  288</span>      }</div>
<div class="line"><span class="lineno">  289</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  290</span>      {</div>
<div class="line"><span class="lineno">  291</span>        unlink_newfile = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  292</span>      }</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mailcap_8c.html#ac95deddbed52214ab8797bf9d19c1b8b">mailcap_expand_command</a>(b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile), type, cmd))</div>
<div class="line"><span class="lineno">  295</span>      {</div>
<div class="line"><span class="lineno">  296</span>        <span class="comment">/* For now, editing requires a file, no piping */</span></div>
<div class="line"><span class="lineno">  297</span>        <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mailcap Edit entry requires %%s&quot;</span>));</div>
<div class="line"><span class="lineno">  298</span>        <span class="keywordflow">goto</span> bailout;</div>
<div class="line"><span class="lineno">  299</span>      }</div>
<div class="line"><span class="lineno">  300</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  301</span>      {</div>
<div class="line"><span class="lineno">  302</span>        <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="protos_8h.html#aa1d4ad04b000036513ca3f741059942c">mutt_system</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd)) == -1)</div>
<div class="line"><span class="lineno">  304</span>        {</div>
<div class="line"><span class="lineno">  305</span>          <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Error running \&quot;%s\&quot;&quot;</span>), <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd));</div>
<div class="line"><span class="lineno">  306</span>          <span class="keywordflow">goto</span> bailout;</div>
<div class="line"><span class="lineno">  307</span>        }</div>
<div class="line"><span class="lineno">  308</span>      }</div>
<div class="line"><span class="lineno">  309</span>    }</div>
<div class="line"><span class="lineno">  310</span>  }</div>
<div class="line"><span class="lineno">  311</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>)</div>
<div class="line"><span class="lineno">  312</span>  {</div>
<div class="line"><span class="lineno">  313</span>    <span class="comment">/* On text, default to editor */</span></div>
<div class="line"><span class="lineno">  314</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_editor = <a class="code hl_function" href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;editor&quot;</span>);</div>
<div class="line"><span class="lineno">  315</span>    <a class="code hl_function" href="curs__lib_8c.html#a0590f11f42a6242002ea4c842438231b">mutt_edit_file</a>(<a class="code hl_define" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(c_editor), b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div>
<div class="line"><span class="lineno">  316</span>  }</div>
<div class="line"><span class="lineno">  317</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  318</span>  {</div>
<div class="line"><span class="lineno">  319</span>    <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No mailcap edit entry for %s&quot;</span>), type);</div>
<div class="line"><span class="lineno">  320</span>    <span class="keywordflow">goto</span> bailout;</div>
<div class="line"><span class="lineno">  321</span>  }</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>  rc = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>bailout:</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>  <span class="keywordflow">if</span> (unlink_newfile)</div>
<div class="line"><span class="lineno">  328</span>    unlink(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile));</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;cmd);</div>
<div class="line"><span class="lineno">  331</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;newfile);</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>  <a class="code hl_function" href="mailcap_8c.html#a49fd88d8bb73a7a56c4cc0fe28dfb645">mailcap_entry_free</a>(&amp;entry);</div>
<div class="line"><span class="lineno">  334</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  335</span>}</div>
<div class="ttc" id="acurs__lib_8c_html_a0590f11f42a6242002ea4c842438231b"><div class="ttname"><a href="curs__lib_8c.html#a0590f11f42a6242002ea4c842438231b">mutt_edit_file</a></div><div class="ttdeci">void mutt_edit_file(const char *editor, const char *file)</div><div class="ttdoc">Let the user edit a file.</div><div class="ttdef"><b>Definition</b> <a href="curs__lib_8c_source.html#l00117">curs_lib.c:117</a></div></div>
<div class="ttc" id="amailcap_8h_html_a0716f6351a9229990024889ec22b33c1a573dc2a7dcdf2058404b201a98906fdc"><div class="ttname"><a href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1a573dc2a7dcdf2058404b201a98906fdc">MUTT_MC_EDIT</a></div><div class="ttdeci">@ MUTT_MC_EDIT</div><div class="ttdoc">Mailcap edit field.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00058">mailcap.h:58</a></div></div>
<div class="ttc" id="astructMailcapEntry_html_ac195e10d836eb0b886580310c2cf0554"><div class="ttname"><a href="structMailcapEntry.html#ac195e10d836eb0b886580310c2cf0554">MailcapEntry::editcommand</a></div><div class="ttdeci">char * editcommand</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00042">mailcap.h:42</a></div></div>
</div><!-- fragment --><div id="dynsection-18" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a0b2292184984705d60be088b9dbbecfb_cgraph.svg" width="578" height="744"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-19" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a0b2292184984705d60be088b9dbbecfb_icgraph.svg" width="403" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a27dfd377ebe2a1b6f3cff2b1acae472d" name="a27dfd377ebe2a1b6f3cff2b1acae472d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27dfd377ebe2a1b6f3cff2b1acae472d">&#9670;&#160;</a></span>mutt_get_tmp_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_get_tmp_attachment </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a temporary copy of an attachment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Attachment to copy </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8c_source.html#l00072">72</a> of file <a class="el" href="mutt__attach_8c_source.html">mutt_attach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>{</div>
<div class="line"><span class="lineno">   74</span>  <span class="keywordtype">char</span> type[256] = { 0 };</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>  <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#a47191eabf16d34d0deb412c898ed629b">unlink</a>)</div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *tempfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">   80</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structMailcapEntry.html">MailcapEntry</a> *entry = <a class="code hl_function" href="mailcap_8c.html#a8114f2f64a9bf84055e0e1d624b8c050">mailcap_entry_new</a>();</div>
<div class="line"><span class="lineno">   81</span>  snprintf(type, <span class="keyword">sizeof</span>(type), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code hl_define" href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a>(b), b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>);</div>
<div class="line"><span class="lineno">   82</span>  <a class="code hl_function" href="mailcap_8c.html#af76f3b2c5819c22f1470723cc30a9ad1">mailcap_lookup</a>(b, type, <span class="keyword">sizeof</span>(type), entry, <a class="code hl_enumvalue" href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1abe09e527550677b514f34f0fd421d8f8">MUTT_MC_NO_FLAGS</a>);</div>
<div class="line"><span class="lineno">   83</span>  <a class="code hl_function" href="mailcap_8c.html#accb5ae6e2f507053e8436a2f00b834ea">mailcap_expand_filename</a>(entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a85835d27aa930e64eef4eae5f9498401">nametemplate</a>, b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, tempfile);</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>  <a class="code hl_function" href="mailcap_8c.html#a49fd88d8bb73a7a56c4cc0fe28dfb645">mailcap_entry_free</a>(&amp;entry);</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>  FILE *fp_in = NULL, *fp_out = NULL;</div>
<div class="line"><span class="lineno">   88</span>  <span class="keywordflow">if</span> ((fp_in = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, <span class="stringliteral">&quot;r&quot;</span>)) &amp;&amp;</div>
<div class="line"><span class="lineno">   89</span>      (fp_out = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), <span class="stringliteral">&quot;w&quot;</span>)))</div>
<div class="line"><span class="lineno">   90</span>  {</div>
<div class="line"><span class="lineno">   91</span>    <a class="code hl_function" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(fp_in, fp_out);</div>
<div class="line"><span class="lineno">   92</span>    <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">   93</span>    b-&gt;<a class="code hl_variable" href="structBody.html#a47191eabf16d34d0deb412c898ed629b">unlink</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>    <span class="keyword">struct </span>stat st = { 0 };</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">if</span> ((fstat(fileno(fp_in), &amp;st) == 0) &amp;&amp; (b-&gt;<a class="code hl_variable" href="structBody.html#a4fb2c1a3bc453c5451720c0ddcc99c5b">stamp</a> &gt;= st.st_mtime))</div>
<div class="line"><span class="lineno">   97</span>    {</div>
<div class="line"><span class="lineno">   98</span>      <a class="code hl_function" href="sendlib_8c.html#ae75843a591a8292e4f4e42df29c8b2d0">mutt_stamp_attachment</a>(b);</div>
<div class="line"><span class="lineno">   99</span>    }</div>
<div class="line"><span class="lineno">  100</span>  }</div>
<div class="line"><span class="lineno">  101</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  102</span>  {</div>
<div class="line"><span class="lineno">  103</span>    <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;%s&quot;</span>, fp_in ? <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile) : b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div>
<div class="line"><span class="lineno">  104</span>  }</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_in);</div>
<div class="line"><span class="lineno">  107</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_out);</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;tempfile);</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>  <span class="keywordflow">return</span> b-&gt;<a class="code hl_variable" href="structBody.html#a47191eabf16d34d0deb412c898ed629b">unlink</a> ? 0 : -1;</div>
<div class="line"><span class="lineno">  112</span>}</div>
<div class="ttc" id="amutt_2string_8c_html_af8c32ffc64dd55e92001a974a4be6bbf"><div class="ttname"><a href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a></div><div class="ttdeci">char * mutt_str_replace(char **p, const char *s)</div><div class="ttdoc">Replace one string with another.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00282">string.c:282</a></div></div>
<div class="ttc" id="asendlib_8c_html_ae75843a591a8292e4f4e42df29c8b2d0"><div class="ttname"><a href="sendlib_8c.html#ae75843a591a8292e4f4e42df29c8b2d0">mutt_stamp_attachment</a></div><div class="ttdeci">void mutt_stamp_attachment(struct Body *b)</div><div class="ttdoc">Timestamp an Attachment.</div><div class="ttdef"><b>Definition</b> <a href="sendlib_8c_source.html#l00409">sendlib.c:409</a></div></div>
<div class="ttc" id="astructBody_html_a4fb2c1a3bc453c5451720c0ddcc99c5b"><div class="ttname"><a href="structBody.html#a4fb2c1a3bc453c5451720c0ddcc99c5b">Body::stamp</a></div><div class="ttdeci">time_t stamp</div><div class="ttdoc">Time stamp of last encoding update.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00077">body.h:77</a></div></div>
</div><!-- fragment --><div id="dynsection-20" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a27dfd377ebe2a1b6f3cff2b1acae472d_cgraph.svg" width="598" height="500"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-21" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a27dfd377ebe2a1b6f3cff2b1acae472d_icgraph.svg" width="464" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3451eb5c8c560a23713547182d1dc9ce" name="a3451eb5c8c560a23713547182d1dc9ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3451eb5c8c560a23713547182d1dc9ce">&#9670;&#160;</a></span>mutt_pipe_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_pipe_attachment </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>outfile</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pipe an attachment to a command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>File to pipe into the command </td></tr>
    <tr><td class="paramname">b</td><td>Attachment </td></tr>
    <tr><td class="paramname">path</td><td>Path to command </td></tr>
    <tr><td class="paramname">outfile</td><td>File to save output to </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>Success </td></tr>
    <tr><td class="paramname">0</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8c_source.html#l00739">739</a> of file <a class="el" href="mutt__attach_8c_source.html">mutt_attach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  740</span>{</div>
<div class="line"><span class="lineno">  741</span>  pid_t pid = 0;</div>
<div class="line"><span class="lineno">  742</span>  <span class="keywordtype">int</span> out = -1, rc = 0;</div>
<div class="line"><span class="lineno">  743</span>  <span class="keywordtype">bool</span> is_flowed = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  744</span>  <span class="keywordtype">bool</span> unlink_unstuff = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  745</span>  FILE *fp_filter = NULL, *fp_unstuff = NULL, *fp_in = NULL;</div>
<div class="line"><span class="lineno">  746</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *unstuff_tempfile = NULL;</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>  <span class="keywordflow">if</span> (outfile &amp;&amp; *outfile)</div>
<div class="line"><span class="lineno">  749</span>  {</div>
<div class="line"><span class="lineno">  750</span>    out = <a class="code hl_function" href="file_8c.html#adf06802ad33e6b1bff09f31d8cbfab67">mutt_file_open</a>(outfile, O_CREAT | O_EXCL | O_WRONLY, 0600);</div>
<div class="line"><span class="lineno">  751</span>    <span class="keywordflow">if</span> (out &lt; 0)</div>
<div class="line"><span class="lineno">  752</span>    {</div>
<div class="line"><span class="lineno">  753</span>      <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;open&quot;</span>);</div>
<div class="line"><span class="lineno">  754</span>      <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  755</span>    }</div>
<div class="line"><span class="lineno">  756</span>  }</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="rfc3676_8c.html#adc6a5cc71d87432efb771f495c6efb9c">mutt_rfc3676_is_format_flowed</a>(b))</div>
<div class="line"><span class="lineno">  759</span>  {</div>
<div class="line"><span class="lineno">  760</span>    is_flowed = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  761</span>    unstuff_tempfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  762</span>    <a class="code hl_define" href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a>(unstuff_tempfile);</div>
<div class="line"><span class="lineno">  763</span>  }</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>  <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>  <span class="keywordflow">if</span> (outfile &amp;&amp; *outfile)</div>
<div class="line"><span class="lineno">  768</span>    pid = <a class="code hl_function" href="mutt_2filter_8c.html#a8b8175018aa96307b2cf569d719ca6dc">filter_create_fd</a>(path, &amp;fp_filter, NULL, NULL, -1, out, -1, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">env</a>);</div>
<div class="line"><span class="lineno">  769</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  770</span>    pid = <a class="code hl_function" href="mutt_2filter_8c.html#ad1ec6916f8ee2520af1711891f6b5302">filter_create</a>(path, &amp;fp_filter, NULL, NULL, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">env</a>);</div>
<div class="line"><span class="lineno">  771</span>  <span class="keywordflow">if</span> (pid &lt; 0)</div>
<div class="line"><span class="lineno">  772</span>  {</div>
<div class="line"><span class="lineno">  773</span>    <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t create filter&quot;</span>));</div>
<div class="line"><span class="lineno">  774</span>    <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  775</span>  }</div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span>  <span class="comment">/* recv case */</span></div>
<div class="line"><span class="lineno">  778</span>  <span class="keywordflow">if</span> (fp)</div>
<div class="line"><span class="lineno">  779</span>  {</div>
<div class="line"><span class="lineno">  780</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structState.html">State</a> state = { 0 };</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>    <span class="comment">/* perform charset conversion on text attachments when piping */</span></div>
<div class="line"><span class="lineno">  783</span>    state.<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> = <a class="code hl_define" href="mutt_2state_8h.html#abff873a2f7f4f3e664c8c4f90a11f44a">STATE_CHARCONV</a>;</div>
<div class="line"><span class="lineno">  784</span> </div>
<div class="line"><span class="lineno">  785</span>    <span class="keywordflow">if</span> (is_flowed)</div>
<div class="line"><span class="lineno">  786</span>    {</div>
<div class="line"><span class="lineno">  787</span>      fp_unstuff = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(unstuff_tempfile), <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">  788</span>      <span class="keywordflow">if</span> (!fp_unstuff)</div>
<div class="line"><span class="lineno">  789</span>      {</div>
<div class="line"><span class="lineno">  790</span>        <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;mutt_file_fopen&quot;</span>);</div>
<div class="line"><span class="lineno">  791</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  792</span>      }</div>
<div class="line"><span class="lineno">  793</span>      unlink_unstuff = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>      state.<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a> = fp;</div>
<div class="line"><span class="lineno">  796</span>      state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a> = fp_unstuff;</div>
<div class="line"><span class="lineno">  797</span>      <a class="code hl_function" href="handler_8c.html#ad6e9c66285fee73e4d9553c565e10fa2">mutt_decode_attachment</a>(b, &amp;state);</div>
<div class="line"><span class="lineno">  798</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_unstuff);</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>      <a class="code hl_function" href="rfc3676_8c.html#aafc5472c7687d8941a25999aa30d2be4">mutt_rfc3676_space_unstuff_attachment</a>(b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(unstuff_tempfile));</div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span>      fp_unstuff = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(unstuff_tempfile), <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">  803</span>      <span class="keywordflow">if</span> (!fp_unstuff)</div>
<div class="line"><span class="lineno">  804</span>      {</div>
<div class="line"><span class="lineno">  805</span>        <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;mutt_file_fopen&quot;</span>);</div>
<div class="line"><span class="lineno">  806</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  807</span>      }</div>
<div class="line"><span class="lineno">  808</span>      <a class="code hl_function" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(fp_unstuff, fp_filter);</div>
<div class="line"><span class="lineno">  809</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_unstuff);</div>
<div class="line"><span class="lineno">  810</span>    }</div>
<div class="line"><span class="lineno">  811</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  812</span>    {</div>
<div class="line"><span class="lineno">  813</span>      state.<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a> = fp;</div>
<div class="line"><span class="lineno">  814</span>      state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a> = fp_filter;</div>
<div class="line"><span class="lineno">  815</span>      <a class="code hl_function" href="handler_8c.html#ad6e9c66285fee73e4d9553c565e10fa2">mutt_decode_attachment</a>(b, &amp;state);</div>
<div class="line"><span class="lineno">  816</span>    }</div>
<div class="line"><span class="lineno">  817</span>  }</div>
<div class="line"><span class="lineno">  818</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  819</span>  {</div>
<div class="line"><span class="lineno">  820</span>    <span class="comment">/* send case */</span></div>
<div class="line"><span class="lineno">  821</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *infile = NULL;</div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span>    <span class="keywordflow">if</span> (is_flowed)</div>
<div class="line"><span class="lineno">  824</span>    {</div>
<div class="line"><span class="lineno">  825</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt__attach_8c.html#a87e1ea8a7b0c926e02ed3db8b7d3dbd5">mutt_save_attachment</a>(fp, b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(unstuff_tempfile),</div>
<div class="line"><span class="lineno">  826</span>                               <a class="code hl_enumvalue" href="#a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224">MUTT_SAVE_NO_FLAGS</a>, NULL) == -1)</div>
<div class="line"><span class="lineno">  827</span>      {</div>
<div class="line"><span class="lineno">  828</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  829</span>      }</div>
<div class="line"><span class="lineno">  830</span>      unlink_unstuff = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  831</span>      <a class="code hl_function" href="rfc3676_8c.html#aafc5472c7687d8941a25999aa30d2be4">mutt_rfc3676_space_unstuff_attachment</a>(b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(unstuff_tempfile));</div>
<div class="line"><span class="lineno">  832</span>      infile = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(unstuff_tempfile);</div>
<div class="line"><span class="lineno">  833</span>    }</div>
<div class="line"><span class="lineno">  834</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  835</span>    {</div>
<div class="line"><span class="lineno">  836</span>      infile = b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>;</div>
<div class="line"><span class="lineno">  837</span>    }</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>    <a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a> = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(infile, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">  840</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>)</div>
<div class="line"><span class="lineno">  841</span>    {</div>
<div class="line"><span class="lineno">  842</span>      <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;fopen&quot;</span>);</div>
<div class="line"><span class="lineno">  843</span>      <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  844</span>    }</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>    <a class="code hl_function" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, fp_filter);</div>
<div class="line"><span class="lineno">  847</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>);</div>
<div class="line"><span class="lineno">  848</span>  }</div>
<div class="line"><span class="lineno">  849</span> </div>
<div class="line"><span class="lineno">  850</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_filter);</div>
<div class="line"><span class="lineno">  851</span>  rc = 1;</div>
<div class="line"><span class="lineno">  852</span> </div>
<div class="line"><span class="lineno">  853</span>bail:</div>
<div class="line"><span class="lineno">  854</span>  <span class="keywordflow">if</span> (outfile &amp;&amp; *outfile)</div>
<div class="line"><span class="lineno">  855</span>  {</div>
<div class="line"><span class="lineno">  856</span>    close(out);</div>
<div class="line"><span class="lineno">  857</span>    <span class="keywordflow">if</span> (rc == 0)</div>
<div class="line"><span class="lineno">  858</span>      unlink(outfile);</div>
<div class="line"><span class="lineno">  859</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_flowed)</div>
<div class="line"><span class="lineno">  860</span>      <a class="code hl_function" href="rfc3676_8c.html#a9cd1b3af0b88c1d0179e890b444c5be0">mutt_rfc3676_space_stuff_attachment</a>(NULL, outfile);</div>
<div class="line"><span class="lineno">  861</span>  }</div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_unstuff);</div>
<div class="line"><span class="lineno">  864</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_filter);</div>
<div class="line"><span class="lineno">  865</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>);</div>
<div class="line"><span class="lineno">  866</span> </div>
<div class="line"><span class="lineno">  867</span>  <span class="keywordflow">if</span> (unlink_unstuff)</div>
<div class="line"><span class="lineno">  868</span>    <a class="code hl_function" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(unstuff_tempfile));</div>
<div class="line"><span class="lineno">  869</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;unstuff_tempfile);</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>  <span class="comment">/* check for error exit from child process */</span></div>
<div class="line"><span class="lineno">  872</span>  <span class="keywordflow">if</span> ((pid &gt; 0) &amp;&amp; (<a class="code hl_function" href="mutt_2filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a>(pid) != 0))</div>
<div class="line"><span class="lineno">  873</span>    rc = 0;</div>
<div class="line"><span class="lineno">  874</span> </div>
<div class="line"><span class="lineno">  875</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_wait_key = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;wait_key&quot;</span>);</div>
<div class="line"><span class="lineno">  876</span>  <span class="keywordflow">if</span> ((rc == 0) || c_wait_key)</div>
<div class="line"><span class="lineno">  877</span>    <a class="code hl_function" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a>(NULL);</div>
<div class="line"><span class="lineno">  878</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  879</span>}</div>
<div class="ttc" id="arfc3676_8c_html_a9cd1b3af0b88c1d0179e890b444c5be0"><div class="ttname"><a href="rfc3676_8c.html#a9cd1b3af0b88c1d0179e890b444c5be0">mutt_rfc3676_space_stuff_attachment</a></div><div class="ttdeci">void mutt_rfc3676_space_stuff_attachment(struct Body *b, const char *filename)</div><div class="ttdoc">Stuff attachments.</div><div class="ttdef"><b>Definition</b> <a href="rfc3676_8c_source.html#l00539">rfc3676.c:539</a></div></div>
<div class="ttc" id="arfc3676_8c_html_adc6a5cc71d87432efb771f495c6efb9c"><div class="ttname"><a href="rfc3676_8c.html#adc6a5cc71d87432efb771f495c6efb9c">mutt_rfc3676_is_format_flowed</a></div><div class="ttdeci">bool mutt_rfc3676_is_format_flowed(struct Body *b)</div><div class="ttdoc">Is the Email &quot;format-flowed&quot;?</div><div class="ttdef"><b>Definition</b> <a href="rfc3676_8c_source.html#l00394">rfc3676.c:394</a></div></div>
</div><!-- fragment --><div id="dynsection-22" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a3451eb5c8c560a23713547182d1dc9ce_cgraph.svg" width="634" height="938"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-23" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a3451eb5c8c560a23713547182d1dc9ce_icgraph.svg" width="388" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac0daefbc4f9a1ba1179aa5f2ff9e537c" name="ac0daefbc4f9a1ba1179aa5f2ff9e537c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0daefbc4f9a1ba1179aa5f2ff9e537c">&#9670;&#160;</a></span>mutt_print_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_print_attachment </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print out an attachment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>File to write to </td></tr>
    <tr><td class="paramname">b</td><td>Attachment </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>Success </td></tr>
    <tr><td class="paramname">0</td><td>Error</td></tr>
  </table>
  </dd>
</dl>
<p>Ok, the difference between send and receive: recv: Body-&gt;filename is a suggested name, and Mailbox|Email points to the attachment in mailbox which is encoded send: Body-&gt;filename points to the un-encoded file which contains the attachment </p>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8c_source.html#l01137">1137</a> of file <a class="el" href="mutt__attach_8c_source.html">mutt_attach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1138</span>{</div>
<div class="line"><span class="lineno"> 1139</span>  <span class="keywordtype">char</span> type[256] = { 0 };</div>
<div class="line"><span class="lineno"> 1140</span>  pid_t pid;</div>
<div class="line"><span class="lineno"> 1141</span>  FILE *fp_in = NULL, *fp_out = NULL;</div>
<div class="line"><span class="lineno"> 1142</span>  <span class="keywordtype">bool</span> unlink_newfile = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1143</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *newfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno"> 1144</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *cmd = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span>  <span class="keywordtype">int</span> rc = 0;</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>  snprintf(type, <span class="keyword">sizeof</span>(type), <span class="stringliteral">&quot;%s/%s&quot;</span>, <a class="code hl_define" href="mime_8h.html#a3e568918dd102d7bfd39661c82ff6c3f">BODY_TYPE</a>(b), b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>);</div>
<div class="line"><span class="lineno"> 1149</span> </div>
<div class="line"><span class="lineno"> 1150</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mailcap_8c.html#af76f3b2c5819c22f1470723cc30a9ad1">mailcap_lookup</a>(b, type, <span class="keyword">sizeof</span>(type), NULL, <a class="code hl_enumvalue" href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1a52af6785e1b3d732fe50654ede5041b2">MUTT_MC_PRINT</a>))</div>
<div class="line"><span class="lineno"> 1151</span>  {</div>
<div class="line"><span class="lineno"> 1152</span>    <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;Using mailcap\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1153</span> </div>
<div class="line"><span class="lineno"> 1154</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structMailcapEntry.html">MailcapEntry</a> *entry = <a class="code hl_function" href="mailcap_8c.html#a8114f2f64a9bf84055e0e1d624b8c050">mailcap_entry_new</a>();</div>
<div class="line"><span class="lineno"> 1155</span>    <a class="code hl_function" href="mailcap_8c.html#af76f3b2c5819c22f1470723cc30a9ad1">mailcap_lookup</a>(b, type, <span class="keyword">sizeof</span>(type), entry, <a class="code hl_enumvalue" href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1a52af6785e1b3d732fe50654ede5041b2">MUTT_MC_PRINT</a>);</div>
<div class="line"><span class="lineno"> 1156</span> </div>
<div class="line"><span class="lineno"> 1157</span>    <span class="keywordtype">char</span> *sanitized_fname = <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>);</div>
<div class="line"><span class="lineno"> 1158</span>    <span class="comment">/* In send mode (!fp), we allow slashes because those are part of</span></div>
<div class="line"><span class="lineno"> 1159</span><span class="comment">     * the tempfile.  The path will be removed in expand_filename */</span></div>
<div class="line"><span class="lineno"> 1160</span>    <a class="code hl_function" href="file_8c.html#a4deebaf3a646b3075a2b51eda5dc03ca">mutt_file_sanitize_filename</a>(sanitized_fname, fp ? <span class="keyword">true</span> : <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1161</span>    <a class="code hl_function" href="mailcap_8c.html#accb5ae6e2f507053e8436a2f00b834ea">mailcap_expand_filename</a>(entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a85835d27aa930e64eef4eae5f9498401">nametemplate</a>, sanitized_fname, newfile);</div>
<div class="line"><span class="lineno"> 1162</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;sanitized_fname);</div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt__attach_8c.html#a87e1ea8a7b0c926e02ed3db8b7d3dbd5">mutt_save_attachment</a>(fp, b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile), <a class="code hl_enumvalue" href="#a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224">MUTT_SAVE_NO_FLAGS</a>, NULL) == -1)</div>
<div class="line"><span class="lineno"> 1165</span>    {</div>
<div class="line"><span class="lineno"> 1166</span>      <span class="keywordflow">goto</span> mailcap_cleanup;</div>
<div class="line"><span class="lineno"> 1167</span>    }</div>
<div class="line"><span class="lineno"> 1168</span>    unlink_newfile = 1;</div>
<div class="line"><span class="lineno"> 1169</span> </div>
<div class="line"><span class="lineno"> 1170</span>    <a class="code hl_function" href="rfc3676_8c.html#aafc5472c7687d8941a25999aa30d2be4">mutt_rfc3676_space_unstuff_attachment</a>(b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile));</div>
<div class="line"><span class="lineno"> 1171</span> </div>
<div class="line"><span class="lineno"> 1172</span>    <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(cmd, entry-&gt;<a class="code hl_variable" href="structMailcapEntry.html#a90972f1dcf7a2510be293e77065e6108">printcommand</a>);</div>
<div class="line"><span class="lineno"> 1173</span> </div>
<div class="line"><span class="lineno"> 1174</span>    <span class="keywordtype">bool</span> piped = <a class="code hl_function" href="mailcap_8c.html#ac95deddbed52214ab8797bf9d19c1b8b">mailcap_expand_command</a>(b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile), type, cmd);</div>
<div class="line"><span class="lineno"> 1175</span> </div>
<div class="line"><span class="lineno"> 1176</span>    <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_wait_key = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;wait_key&quot;</span>);</div>
<div class="line"><span class="lineno"> 1179</span>    <span class="comment">/* interactive program */</span></div>
<div class="line"><span class="lineno"> 1180</span>    <span class="keywordflow">if</span> (piped)</div>
<div class="line"><span class="lineno"> 1181</span>    {</div>
<div class="line"><span class="lineno"> 1182</span>      fp_in = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile), <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno"> 1183</span>      <span class="keywordflow">if</span> (!fp_in)</div>
<div class="line"><span class="lineno"> 1184</span>      {</div>
<div class="line"><span class="lineno"> 1185</span>        <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;fopen&quot;</span>);</div>
<div class="line"><span class="lineno"> 1186</span>        <a class="code hl_function" href="mailcap_8c.html#a49fd88d8bb73a7a56c4cc0fe28dfb645">mailcap_entry_free</a>(&amp;entry);</div>
<div class="line"><span class="lineno"> 1187</span>        <span class="keywordflow">goto</span> mailcap_cleanup;</div>
<div class="line"><span class="lineno"> 1188</span>      }</div>
<div class="line"><span class="lineno"> 1189</span> </div>
<div class="line"><span class="lineno"> 1190</span>      pid = <a class="code hl_function" href="mutt_2filter_8c.html#ad1ec6916f8ee2520af1711891f6b5302">filter_create</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd), &amp;fp_out, NULL, NULL, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">env</a>);</div>
<div class="line"><span class="lineno"> 1191</span>      <span class="keywordflow">if</span> (pid &lt; 0)</div>
<div class="line"><span class="lineno"> 1192</span>      {</div>
<div class="line"><span class="lineno"> 1193</span>        <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t create filter&quot;</span>));</div>
<div class="line"><span class="lineno"> 1194</span>        <a class="code hl_function" href="mailcap_8c.html#a49fd88d8bb73a7a56c4cc0fe28dfb645">mailcap_entry_free</a>(&amp;entry);</div>
<div class="line"><span class="lineno"> 1195</span>        <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_in);</div>
<div class="line"><span class="lineno"> 1196</span>        <span class="keywordflow">goto</span> mailcap_cleanup;</div>
<div class="line"><span class="lineno"> 1197</span>      }</div>
<div class="line"><span class="lineno"> 1198</span>      <a class="code hl_function" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(fp_in, fp_out);</div>
<div class="line"><span class="lineno"> 1199</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_out);</div>
<div class="line"><span class="lineno"> 1200</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_in);</div>
<div class="line"><span class="lineno"> 1201</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a>(pid) || c_wait_key)</div>
<div class="line"><span class="lineno"> 1202</span>        <a class="code hl_function" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a>(NULL);</div>
<div class="line"><span class="lineno"> 1203</span>    }</div>
<div class="line"><span class="lineno"> 1204</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1205</span>    {</div>
<div class="line"><span class="lineno"> 1206</span>      <span class="keywordtype">int</span> rc2 = <a class="code hl_function" href="protos_8h.html#aa1d4ad04b000036513ca3f741059942c">mutt_system</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(cmd));</div>
<div class="line"><span class="lineno"> 1207</span>      <span class="keywordflow">if</span> (rc2 == -1)</div>
<div class="line"><span class="lineno"> 1208</span>        <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab2c99902c587a013b358149516cceeb5">LL_DEBUG1</a>, <span class="stringliteral">&quot;Error running \&quot;%s\&quot;\n&quot;</span>, cmd-&gt;<a class="code hl_variable" href="structBuffer.html#aeec1fd4af0ddf6765b0187466d4361b8">data</a>);</div>
<div class="line"><span class="lineno"> 1209</span> </div>
<div class="line"><span class="lineno"> 1210</span>      <span class="keywordflow">if</span> ((rc2 != 0) || c_wait_key)</div>
<div class="line"><span class="lineno"> 1211</span>        <a class="code hl_function" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a>(NULL);</div>
<div class="line"><span class="lineno"> 1212</span>    }</div>
<div class="line"><span class="lineno"> 1213</span> </div>
<div class="line"><span class="lineno"> 1214</span>    rc = 1;</div>
<div class="line"><span class="lineno"> 1215</span> </div>
<div class="line"><span class="lineno"> 1216</span>  mailcap_cleanup:</div>
<div class="line"><span class="lineno"> 1217</span>    <span class="keywordflow">if</span> (unlink_newfile)</div>
<div class="line"><span class="lineno"> 1218</span>      <a class="code hl_function" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile));</div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>    <a class="code hl_function" href="mailcap_8c.html#a49fd88d8bb73a7a56c4cc0fe28dfb645">mailcap_entry_free</a>(&amp;entry);</div>
<div class="line"><span class="lineno"> 1221</span>    <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno"> 1222</span>  }</div>
<div class="line"><span class="lineno"> 1223</span> </div>
<div class="line"><span class="lineno"> 1224</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_print_command = <a class="code hl_function" href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;print_command&quot;</span>);</div>
<div class="line"><span class="lineno"> 1225</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;text/plain&quot;</span>, type) || <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;application/postscript&quot;</span>, type))</div>
<div class="line"><span class="lineno"> 1226</span>  {</div>
<div class="line"><span class="lineno"> 1227</span>    rc = (<a class="code hl_function" href="mutt__attach_8c.html#a3451eb5c8c560a23713547182d1dc9ce">mutt_pipe_attachment</a>(fp, b, <a class="code hl_define" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(c_print_command), NULL));</div>
<div class="line"><span class="lineno"> 1228</span>    <span class="keywordflow">goto</span> out;</div>
<div class="line"><span class="lineno"> 1229</span>  }</div>
<div class="line"><span class="lineno"> 1230</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="handler_8c.html#a3cc6312b687436c5023e476461662e8e">mutt_can_decode</a>(b))</div>
<div class="line"><span class="lineno"> 1231</span>  {</div>
<div class="line"><span class="lineno"> 1232</span>    <span class="comment">/* decode and print */</span></div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span>    fp_in = NULL;</div>
<div class="line"><span class="lineno"> 1235</span>    fp_out = NULL;</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>    <a class="code hl_define" href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a>(newfile);</div>
<div class="line"><span class="lineno"> 1238</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt__attach_8c.html#aac29548ca4501311138dfa43db788bd3">mutt_decode_save_attachment</a>(fp, b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile), <a class="code hl_define" href="mutt_2state_8h.html#ae6b85563c0a8006aaa87dda06029ba63">STATE_PRINTING</a>,</div>
<div class="line"><span class="lineno"> 1239</span>                                    <a class="code hl_enumvalue" href="#a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224">MUTT_SAVE_NO_FLAGS</a>) == 0)</div>
<div class="line"><span class="lineno"> 1240</span>    {</div>
<div class="line"><span class="lineno"> 1241</span>      unlink_newfile = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1242</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;successfully decoded %s type attachment to %s\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 1243</span>                 type, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile));</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>      fp_in = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile), <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno"> 1246</span>      <span class="keywordflow">if</span> (!fp_in)</div>
<div class="line"><span class="lineno"> 1247</span>      {</div>
<div class="line"><span class="lineno"> 1248</span>        <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;fopen&quot;</span>);</div>
<div class="line"><span class="lineno"> 1249</span>        <span class="keywordflow">goto</span> decode_cleanup;</div>
<div class="line"><span class="lineno"> 1250</span>      }</div>
<div class="line"><span class="lineno"> 1251</span> </div>
<div class="line"><span class="lineno"> 1252</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;successfully opened %s read-only\n&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile));</div>
<div class="line"><span class="lineno"> 1253</span> </div>
<div class="line"><span class="lineno"> 1254</span>      <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno"> 1255</span>      pid = <a class="code hl_function" href="mutt_2filter_8c.html#ad1ec6916f8ee2520af1711891f6b5302">filter_create</a>(<a class="code hl_define" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(c_print_command), &amp;fp_out, NULL, NULL, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">env</a>);</div>
<div class="line"><span class="lineno"> 1256</span>      <span class="keywordflow">if</span> (pid &lt; 0)</div>
<div class="line"><span class="lineno"> 1257</span>      {</div>
<div class="line"><span class="lineno"> 1258</span>        <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t create filter&quot;</span>));</div>
<div class="line"><span class="lineno"> 1259</span>        <span class="keywordflow">goto</span> decode_cleanup;</div>
<div class="line"><span class="lineno"> 1260</span>      }</div>
<div class="line"><span class="lineno"> 1261</span> </div>
<div class="line"><span class="lineno"> 1262</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;Filter created\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>      <a class="code hl_function" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(fp_in, fp_out);</div>
<div class="line"><span class="lineno"> 1265</span> </div>
<div class="line"><span class="lineno"> 1266</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_out);</div>
<div class="line"><span class="lineno"> 1267</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_in);</div>
<div class="line"><span class="lineno"> 1268</span> </div>
<div class="line"><span class="lineno"> 1269</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_wait_key = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;wait_key&quot;</span>);</div>
<div class="line"><span class="lineno"> 1270</span>      <span class="keywordflow">if</span> ((<a class="code hl_function" href="mutt_2filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a>(pid) != 0) || c_wait_key)</div>
<div class="line"><span class="lineno"> 1271</span>        <a class="code hl_function" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a>(NULL);</div>
<div class="line"><span class="lineno"> 1272</span>      rc = 1;</div>
<div class="line"><span class="lineno"> 1273</span>    }</div>
<div class="line"><span class="lineno"> 1274</span>  decode_cleanup:</div>
<div class="line"><span class="lineno"> 1275</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_in);</div>
<div class="line"><span class="lineno"> 1276</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_out);</div>
<div class="line"><span class="lineno"> 1277</span>    <span class="keywordflow">if</span> (unlink_newfile)</div>
<div class="line"><span class="lineno"> 1278</span>      <a class="code hl_function" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(newfile));</div>
<div class="line"><span class="lineno"> 1279</span>  }</div>
<div class="line"><span class="lineno"> 1280</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1281</span>  {</div>
<div class="line"><span class="lineno"> 1282</span>    <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;I don&#39;t know how to print that&quot;</span>));</div>
<div class="line"><span class="lineno"> 1283</span>    rc = 0;</div>
<div class="line"><span class="lineno"> 1284</span>  }</div>
<div class="line"><span class="lineno"> 1285</span> </div>
<div class="line"><span class="lineno"> 1286</span>out:</div>
<div class="line"><span class="lineno"> 1287</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;newfile);</div>
<div class="line"><span class="lineno"> 1288</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;cmd);</div>
<div class="line"><span class="lineno"> 1289</span> </div>
<div class="line"><span class="lineno"> 1290</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno"> 1291</span>}</div>
<div class="ttc" id="ahandler_8c_html_a3cc6312b687436c5023e476461662e8e"><div class="ttname"><a href="handler_8c.html#a3cc6312b687436c5023e476461662e8e">mutt_can_decode</a></div><div class="ttdeci">bool mutt_can_decode(struct Body *b)</div><div class="ttdoc">Will decoding the attachment produce any output.</div><div class="ttdef"><b>Definition</b> <a href="handler_8c_source.html#l01866">handler.c:1866</a></div></div>
<div class="ttc" id="amailcap_8h_html_a0716f6351a9229990024889ec22b33c1a52af6785e1b3d732fe50654ede5041b2"><div class="ttname"><a href="mailcap_8h.html#a0716f6351a9229990024889ec22b33c1a52af6785e1b3d732fe50654ede5041b2">MUTT_MC_PRINT</a></div><div class="ttdeci">@ MUTT_MC_PRINT</div><div class="ttdoc">Mailcap print field.</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00060">mailcap.h:60</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_ae6b85563c0a8006aaa87dda06029ba63"><div class="ttname"><a href="mutt_2state_8h.html#ae6b85563c0a8006aaa87dda06029ba63">STATE_PRINTING</a></div><div class="ttdeci">#define STATE_PRINTING</div><div class="ttdoc">Are we printing? - STATE_DISPLAY &quot;light&quot;.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00038">state.h:38</a></div></div>
<div class="ttc" id="amutt__attach_8c_html_a3451eb5c8c560a23713547182d1dc9ce"><div class="ttname"><a href="mutt__attach_8c.html#a3451eb5c8c560a23713547182d1dc9ce">mutt_pipe_attachment</a></div><div class="ttdeci">int mutt_pipe_attachment(FILE *fp, struct Body *b, const char *path, const char *outfile)</div><div class="ttdoc">Pipe an attachment to a command.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8c_source.html#l00739">mutt_attach.c:739</a></div></div>
<div class="ttc" id="astructMailcapEntry_html_a90972f1dcf7a2510be293e77065e6108"><div class="ttname"><a href="structMailcapEntry.html#a90972f1dcf7a2510be293e77065e6108">MailcapEntry::printcommand</a></div><div class="ttdeci">char * printcommand</div><div class="ttdef"><b>Definition</b> <a href="mailcap_8h_source.html#l00043">mailcap.h:43</a></div></div>
</div><!-- fragment --><div id="dynsection-24" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_ac0daefbc4f9a1ba1179aa5f2ff9e537c_cgraph.svg" width="879" height="1360"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-25" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_ac0daefbc4f9a1ba1179aa5f2ff9e537c_icgraph.svg" width="375" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a87e1ea8a7b0c926e02ed3db8b7d3dbd5" name="a87e1ea8a7b0c926e02ed3db8b7d3dbd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87e1ea8a7b0c926e02ed3db8b7d3dbd5">&#9670;&#160;</a></span>mutt_save_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_save_attachment </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>path</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="#a5675c7a41890711ec4871b592c840faa">SaveAttach</a></td>          <td class="paramname"><span class="paramname"><em>opt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *</td>          <td class="paramname"><span class="paramname"><em>e</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save an attachment. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>Source file stream. Can be NULL </td></tr>
    <tr><td class="paramname">b</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> <a class="el" href="structBody.html" title="The body of an email.">Body</a> </td></tr>
    <tr><td class="paramname">path</td><td>Where to save the attachment </td></tr>
    <tr><td class="paramname">opt</td><td>Save option, see <a class="el" href="#a5675c7a41890711ec4871b592c840faa" title="Options for saving attachments.">SaveAttach</a> </td></tr>
    <tr><td class="paramname">e</td><td>Current <a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a>. Can be NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8c_source.html#l00905">905</a> of file <a class="el" href="mutt__attach_8c_source.html">mutt_attach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  907</span>{</div>
<div class="line"><span class="lineno">  908</span>  <span class="keywordflow">if</span> (!b)</div>
<div class="line"><span class="lineno">  909</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  910</span> </div>
<div class="line"><span class="lineno">  911</span>  <span class="keywordflow">if</span> (fp)</div>
<div class="line"><span class="lineno">  912</span>  {</div>
<div class="line"><span class="lineno">  913</span>    <span class="comment">/* recv mode */</span></div>
<div class="line"><span class="lineno">  914</span> </div>
<div class="line"><span class="lineno">  915</span>    <span class="keywordflow">if</span> (e &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a> &amp;&amp; (b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> != <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  916</span>        (b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> != <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a>) &amp;&amp; <a class="code hl_function" href="email_2parse_8c.html#adcc90fb584fec1be116777c533e9b3d4">mutt_is_message_type</a>(b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a>, b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>))</div>
<div class="line"><span class="lineno">  917</span>    {</div>
<div class="line"><span class="lineno">  918</span>      <span class="comment">/* message type attachments are written to mail folders. */</span></div>
<div class="line"><span class="lineno">  919</span> </div>
<div class="line"><span class="lineno">  920</span>      <span class="keywordtype">char</span> buf[8192] = { 0 };</div>
<div class="line"><span class="lineno">  921</span>      <span class="keyword">struct </span><a class="code hl_struct" href="structMessage.html">Message</a> *msg = NULL;</div>
<div class="line"><span class="lineno">  922</span>      <a class="code hl_typedef" href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a> chflags = <a class="code hl_define" href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  923</span>      <span class="keywordtype">int</span> rc = -1;</div>
<div class="line"><span class="lineno">  924</span> </div>
<div class="line"><span class="lineno">  925</span>      <span class="keyword">struct </span><a class="code hl_struct" href="structEmail.html">Email</a> *e_new = b-&gt;<a class="code hl_variable" href="structBody.html#a8e10ba22522218bd12bd3cb38dd3fcc9">email</a>;</div>
<div class="line"><span class="lineno">  926</span>      e_new-&gt;<a class="code hl_variable" href="structEmail.html#abd3d551204f4ea232a304c1c4c4c149d">msgno</a> = e-&gt;<a class="code hl_variable" href="structEmail.html#abd3d551204f4ea232a304c1c4c4c149d">msgno</a>; <span class="comment">/* required for MH/maildir */</span></div>
<div class="line"><span class="lineno">  927</span>      e_new-&gt;<a class="code hl_variable" href="structEmail.html#a0bd79550be901d44e50953fb43614e10">read</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a>(fp, b-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>, SEEK_SET))</div>
<div class="line"><span class="lineno">  930</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  931</span>      <span class="keywordflow">if</span> (!fgets(buf, <span class="keyword">sizeof</span>(buf), fp))</div>
<div class="line"><span class="lineno">  932</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  933</span>      <span class="keyword">struct </span><a class="code hl_struct" href="structMailbox.html">Mailbox</a> *m_att = <a class="code hl_function" href="mx_8c.html#addbeb100364d5be4dd89b74ac73ef067">mx_path_resolve</a>(path);</div>
<div class="line"><span class="lineno">  934</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="mx_8c.html#a6c4f4c51fa0b086d86a8638197c40578">mx_mbox_open</a>(m_att, <a class="code hl_define" href="mxapi_8h.html#a6168431d3be24912b33a6c486fa11366">MUTT_APPEND</a> | <a class="code hl_define" href="mxapi_8h.html#a75f314042a266df29efcc524d35c4b2d">MUTT_QUIET</a>))</div>
<div class="line"><span class="lineno">  935</span>      {</div>
<div class="line"><span class="lineno">  936</span>        <a class="code hl_function" href="core_2mailbox_8c.html#aba915aae97477d1ecc6428a06f92dac9">mailbox_free</a>(&amp;m_att);</div>
<div class="line"><span class="lineno">  937</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  938</span>      }</div>
<div class="line"><span class="lineno">  939</span>      msg = <a class="code hl_function" href="mx_8c.html#ad7adbbda58c642107eadf33b1fbf0c13">mx_msg_open_new</a>(m_att, e_new,</div>
<div class="line"><span class="lineno">  940</span>                            <a class="code hl_function" href="from_8c.html#af485f9451b398a9beb14a61aaa68ddeb">is_from</a>(buf, NULL, 0, NULL) ? <a class="code hl_define" href="mx_8h.html#a4f461719ebd7d96d0b2f2492c595fc26">MUTT_MSG_NO_FLAGS</a> : <a class="code hl_define" href="mx_8h.html#a49087f3940d59f9624011017e42d9444">MUTT_ADD_FROM</a>);</div>
<div class="line"><span class="lineno">  941</span>      <span class="keywordflow">if</span> (!msg)</div>
<div class="line"><span class="lineno">  942</span>      {</div>
<div class="line"><span class="lineno">  943</span>        <a class="code hl_function" href="mx_8c.html#af9e949965d56e69eb9a6a9aa640614bb">mx_mbox_close</a>(m_att);</div>
<div class="line"><span class="lineno">  944</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  945</span>      }</div>
<div class="line"><span class="lineno">  946</span>      <span class="keywordflow">if</span> ((m_att-&gt;<a class="code hl_variable" href="structMailbox.html#a5638329fb2ebd4bbe1f4a949ec8de174">type</a> == <a class="code hl_enumvalue" href="core_2mailbox_8h.html#af65addf714c28dd5d483cb426100921da817ef3cf5f529965875400b412678525">MUTT_MBOX</a>) || (m_att-&gt;<a class="code hl_variable" href="structMailbox.html#a5638329fb2ebd4bbe1f4a949ec8de174">type</a> == <a class="code hl_enumvalue" href="core_2mailbox_8h.html#af65addf714c28dd5d483cb426100921da09cef4c4e3dc42c9137860413dcdb374">MUTT_MMDF</a>))</div>
<div class="line"><span class="lineno">  947</span>        chflags = <a class="code hl_define" href="copy_8h.html#a3ff472dcfcc60933d0deaba111527d6c">CH_FROM</a> | <a class="code hl_define" href="copy_8h.html#a94e818174cb0508df54058debb1c631a">CH_UPDATE_LEN</a>;</div>
<div class="line"><span class="lineno">  948</span>      chflags |= ((m_att-&gt;<a class="code hl_variable" href="structMailbox.html#a5638329fb2ebd4bbe1f4a949ec8de174">type</a> == <a class="code hl_enumvalue" href="core_2mailbox_8h.html#af65addf714c28dd5d483cb426100921dafd4cdaa9851e1c936b2f648b4bdc6ad4">MUTT_MAILDIR</a>) ? <a class="code hl_define" href="copy_8h.html#a3f2f99c73b0f831bb2902a0517e91a01">CH_NOSTATUS</a> : <a class="code hl_define" href="copy_8h.html#a397b6166af3a14708bddb8ccd0241e11">CH_UPDATE</a>);</div>
<div class="line"><span class="lineno">  949</span>      <span class="keywordflow">if</span> ((<a class="code hl_function" href="copy_8c.html#ac158be102976481a9c8edc42fcd8cd09">mutt_copy_message_fp</a>(msg-&gt;<a class="code hl_variable" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>, fp, e_new, <a class="code hl_define" href="copy_8h.html#ac778c083de78e4fb27889f345f242d13">MUTT_CM_NO_FLAGS</a>, chflags, 0) == 0) &amp;&amp;</div>
<div class="line"><span class="lineno">  950</span>          (<a class="code hl_function" href="mx_8c.html#add0e192c5f27bf6bd096ae2eb7c0b67b">mx_msg_commit</a>(m_att, msg) == 0))</div>
<div class="line"><span class="lineno">  951</span>      {</div>
<div class="line"><span class="lineno">  952</span>        rc = 0;</div>
<div class="line"><span class="lineno">  953</span>      }</div>
<div class="line"><span class="lineno">  954</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  955</span>      {</div>
<div class="line"><span class="lineno">  956</span>        rc = -1;</div>
<div class="line"><span class="lineno">  957</span>      }</div>
<div class="line"><span class="lineno">  958</span> </div>
<div class="line"><span class="lineno">  959</span>      <a class="code hl_function" href="mx_8c.html#a2610a2afe8887bb874131a4ba092aa6a">mx_msg_close</a>(m_att, &amp;msg);</div>
<div class="line"><span class="lineno">  960</span>      <a class="code hl_function" href="mx_8c.html#af9e949965d56e69eb9a6a9aa640614bb">mx_mbox_close</a>(m_att);</div>
<div class="line"><span class="lineno">  961</span>      <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  962</span>    }</div>
<div class="line"><span class="lineno">  963</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  964</span>    {</div>
<div class="line"><span class="lineno">  965</span>      <span class="comment">/* In recv mode, extract from folder and decode */</span></div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>      <span class="keyword">struct </span><a class="code hl_struct" href="structState.html">State</a> state = { 0 };</div>
<div class="line"><span class="lineno">  968</span> </div>
<div class="line"><span class="lineno">  969</span>      state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a> = <a class="code hl_function" href="mutt__attach_8c.html#adaa2b49386e82ac2c19f0ddefa1bbe3f">save_attachment_open</a>(path, opt);</div>
<div class="line"><span class="lineno">  970</span>      <span class="keywordflow">if</span> (!state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>)</div>
<div class="line"><span class="lineno">  971</span>      {</div>
<div class="line"><span class="lineno">  972</span>        <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;fopen&quot;</span>);</div>
<div class="line"><span class="lineno">  973</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  974</span>      }</div>
<div class="line"><span class="lineno">  975</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a>((state.<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a> = fp), b-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>, SEEK_SET))</div>
<div class="line"><span class="lineno">  976</span>      {</div>
<div class="line"><span class="lineno">  977</span>        <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>);</div>
<div class="line"><span class="lineno">  978</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  979</span>      }</div>
<div class="line"><span class="lineno">  980</span>      <a class="code hl_function" href="handler_8c.html#ad6e9c66285fee73e4d9553c565e10fa2">mutt_decode_attachment</a>(b, &amp;state);</div>
<div class="line"><span class="lineno">  981</span> </div>
<div class="line"><span class="lineno">  982</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="file_8c.html#ae6b2571365b85d78aa796fd220c740ce">mutt_file_fsync_close</a>(&amp;state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>) != 0)</div>
<div class="line"><span class="lineno">  983</span>      {</div>
<div class="line"><span class="lineno">  984</span>        <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;fclose&quot;</span>);</div>
<div class="line"><span class="lineno">  985</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  986</span>      }</div>
<div class="line"><span class="lineno">  987</span>    }</div>
<div class="line"><span class="lineno">  988</span>  }</div>
<div class="line"><span class="lineno">  989</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  990</span>  {</div>
<div class="line"><span class="lineno">  991</span>    <span class="keywordflow">if</span> (!b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>)</div>
<div class="line"><span class="lineno">  992</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>    <span class="comment">/* In send mode, just copy file */</span></div>
<div class="line"><span class="lineno">  995</span> </div>
<div class="line"><span class="lineno">  996</span>    FILE *fp_old = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">  997</span>    <span class="keywordflow">if</span> (!fp_old)</div>
<div class="line"><span class="lineno">  998</span>    {</div>
<div class="line"><span class="lineno">  999</span>      <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;fopen&quot;</span>);</div>
<div class="line"><span class="lineno"> 1000</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1001</span>    }</div>
<div class="line"><span class="lineno"> 1002</span> </div>
<div class="line"><span class="lineno"> 1003</span>    FILE *fp_new = <a class="code hl_function" href="mutt__attach_8c.html#adaa2b49386e82ac2c19f0ddefa1bbe3f">save_attachment_open</a>(path, opt);</div>
<div class="line"><span class="lineno"> 1004</span>    <span class="keywordflow">if</span> (!fp_new)</div>
<div class="line"><span class="lineno"> 1005</span>    {</div>
<div class="line"><span class="lineno"> 1006</span>      <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;fopen&quot;</span>);</div>
<div class="line"><span class="lineno"> 1007</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_old);</div>
<div class="line"><span class="lineno"> 1008</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1009</span>    }</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(fp_old, fp_new) == -1)</div>
<div class="line"><span class="lineno"> 1012</span>    {</div>
<div class="line"><span class="lineno"> 1013</span>      <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Write fault&quot;</span>));</div>
<div class="line"><span class="lineno"> 1014</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_old);</div>
<div class="line"><span class="lineno"> 1015</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_new);</div>
<div class="line"><span class="lineno"> 1016</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1017</span>    }</div>
<div class="line"><span class="lineno"> 1018</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_old);</div>
<div class="line"><span class="lineno"> 1019</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="file_8c.html#ae6b2571365b85d78aa796fd220c740ce">mutt_file_fsync_close</a>(&amp;fp_new) != 0)</div>
<div class="line"><span class="lineno"> 1020</span>    {</div>
<div class="line"><span class="lineno"> 1021</span>      <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Write fault&quot;</span>));</div>
<div class="line"><span class="lineno"> 1022</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1023</span>    }</div>
<div class="line"><span class="lineno"> 1024</span>  }</div>
<div class="line"><span class="lineno"> 1025</span> </div>
<div class="line"><span class="lineno"> 1026</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1027</span>}</div>
<div class="ttc" id="acopy_8c_html_ac158be102976481a9c8edc42fcd8cd09"><div class="ttname"><a href="copy_8c.html#ac158be102976481a9c8edc42fcd8cd09">mutt_copy_message_fp</a></div><div class="ttdeci">int mutt_copy_message_fp(FILE *fp_out, FILE *fp_in, struct Email *e, CopyMessageFlags cmflags, CopyHeaderFlags chflags, int wraplen)</div><div class="ttdoc">Make a copy of a message from a FILE pointer.</div><div class="ttdef"><b>Definition</b> <a href="copy_8c_source.html#l00654">copy.c:654</a></div></div>
<div class="ttc" id="acopy_8h_html_a397b6166af3a14708bddb8ccd0241e11"><div class="ttname"><a href="copy_8h.html#a397b6166af3a14708bddb8ccd0241e11">CH_UPDATE</a></div><div class="ttdeci">#define CH_UPDATE</div><div class="ttdoc">Update the status and x-status fields?</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00054">copy.h:54</a></div></div>
<div class="ttc" id="acopy_8h_html_a3f2f99c73b0f831bb2902a0517e91a01"><div class="ttname"><a href="copy_8h.html#a3f2f99c73b0f831bb2902a0517e91a01">CH_NOSTATUS</a></div><div class="ttdeci">#define CH_NOSTATUS</div><div class="ttdoc">Suppress the status and x-status fields.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00060">copy.h:60</a></div></div>
<div class="ttc" id="acopy_8h_html_a3ff472dcfcc60933d0deaba111527d6c"><div class="ttname"><a href="copy_8h.html#a3ff472dcfcc60933d0deaba111527d6c">CH_FROM</a></div><div class="ttdeci">#define CH_FROM</div><div class="ttdoc">Retain the &quot;From &quot; message separator?</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00058">copy.h:58</a></div></div>
<div class="ttc" id="acopy_8h_html_a88a40e8f238a8478b885c90d1ce53e9c"><div class="ttname"><a href="copy_8h.html#a88a40e8f238a8478b885c90d1ce53e9c">CopyHeaderFlags</a></div><div class="ttdeci">uint32_t CopyHeaderFlags</div><div class="ttdoc">Flags for mutt_copy_header(), e.g. CH_UPDATE.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00052">copy.h:52</a></div></div>
<div class="ttc" id="acopy_8h_html_a94e818174cb0508df54058debb1c631a"><div class="ttname"><a href="copy_8h.html#a94e818174cb0508df54058debb1c631a">CH_UPDATE_LEN</a></div><div class="ttdeci">#define CH_UPDATE_LEN</div><div class="ttdoc">Update Lines: and Content-Length:</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00064">copy.h:64</a></div></div>
<div class="ttc" id="acopy_8h_html_ac778c083de78e4fb27889f345f242d13"><div class="ttname"><a href="copy_8h.html#ac778c083de78e4fb27889f345f242d13">MUTT_CM_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_CM_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00037">copy.h:37</a></div></div>
<div class="ttc" id="acopy_8h_html_af310a44d7c96b22de90934cb18634b58"><div class="ttname"><a href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a></div><div class="ttdeci">#define CH_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00053">copy.h:53</a></div></div>
<div class="ttc" id="acore_2mailbox_8c_html_aba915aae97477d1ecc6428a06f92dac9"><div class="ttname"><a href="core_2mailbox_8c.html#aba915aae97477d1ecc6428a06f92dac9">mailbox_free</a></div><div class="ttdeci">void mailbox_free(struct Mailbox **ptr)</div><div class="ttdoc">Free a Mailbox.</div><div class="ttdef"><b>Definition</b> <a href="core_2mailbox_8c_source.html#l00089">mailbox.c:89</a></div></div>
<div class="ttc" id="acore_2mailbox_8h_html_af65addf714c28dd5d483cb426100921da09cef4c4e3dc42c9137860413dcdb374"><div class="ttname"><a href="core_2mailbox_8h.html#af65addf714c28dd5d483cb426100921da09cef4c4e3dc42c9137860413dcdb374">MUTT_MMDF</a></div><div class="ttdeci">@ MUTT_MMDF</div><div class="ttdoc">&#39;mmdf&#39; Mailbox type</div><div class="ttdef"><b>Definition</b> <a href="core_2mailbox_8h_source.html#l00046">mailbox.h:46</a></div></div>
<div class="ttc" id="acore_2mailbox_8h_html_af65addf714c28dd5d483cb426100921da817ef3cf5f529965875400b412678525"><div class="ttname"><a href="core_2mailbox_8h.html#af65addf714c28dd5d483cb426100921da817ef3cf5f529965875400b412678525">MUTT_MBOX</a></div><div class="ttdeci">@ MUTT_MBOX</div><div class="ttdoc">&#39;mbox&#39; Mailbox type</div><div class="ttdef"><b>Definition</b> <a href="core_2mailbox_8h_source.html#l00045">mailbox.h:45</a></div></div>
<div class="ttc" id="acore_2mailbox_8h_html_af65addf714c28dd5d483cb426100921dafd4cdaa9851e1c936b2f648b4bdc6ad4"><div class="ttname"><a href="core_2mailbox_8h.html#af65addf714c28dd5d483cb426100921dafd4cdaa9851e1c936b2f648b4bdc6ad4">MUTT_MAILDIR</a></div><div class="ttdeci">@ MUTT_MAILDIR</div><div class="ttdoc">&#39;Maildir&#39; Mailbox type</div><div class="ttdef"><b>Definition</b> <a href="core_2mailbox_8h_source.html#l00048">mailbox.h:48</a></div></div>
<div class="ttc" id="afrom_8c_html_af485f9451b398a9beb14a61aaa68ddeb"><div class="ttname"><a href="from_8c.html#af485f9451b398a9beb14a61aaa68ddeb">is_from</a></div><div class="ttdeci">bool is_from(const char *s, char *path, size_t pathlen, time_t *tp)</div><div class="ttdoc">Is a string a &#39;From&#39; header line?</div><div class="ttdef"><b>Definition</b> <a href="from_8c_source.html#l00049">from.c:49</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a></div><div class="ttdeci">@ ENC_BASE64</div><div class="ttdoc">Base-64 encoded text.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00052">mime.h:52</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a></div><div class="ttdeci">@ ENC_QUOTED_PRINTABLE</div><div class="ttdoc">Quoted-printable text.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00051">mime.h:51</a></div></div>
<div class="ttc" id="amutt__attach_8c_html_adaa2b49386e82ac2c19f0ddefa1bbe3f"><div class="ttname"><a href="mutt__attach_8c.html#adaa2b49386e82ac2c19f0ddefa1bbe3f">save_attachment_open</a></div><div class="ttdeci">static FILE * save_attachment_open(const char *path, enum SaveAttach opt)</div><div class="ttdoc">Open a file to write an attachment to.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8c_source.html#l00887">mutt_attach.c:887</a></div></div>
<div class="ttc" id="amx_8c_html_a2610a2afe8887bb874131a4ba092aa6a"><div class="ttname"><a href="mx_8c.html#a2610a2afe8887bb874131a4ba092aa6a">mx_msg_close</a></div><div class="ttdeci">int mx_msg_close(struct Mailbox *m, struct Message **ptr)</div><div class="ttdoc">Close a message.</div><div class="ttdef"><b>Definition</b> <a href="mx_8c_source.html#l01185">mx.c:1185</a></div></div>
<div class="ttc" id="amx_8c_html_a6c4f4c51fa0b086d86a8638197c40578"><div class="ttname"><a href="mx_8c.html#a6c4f4c51fa0b086d86a8638197c40578">mx_mbox_open</a></div><div class="ttdeci">bool mx_mbox_open(struct Mailbox *m, OpenMailboxFlags flags)</div><div class="ttdoc">Open a mailbox and parse it.</div><div class="ttdef"><b>Definition</b> <a href="mx_8c_source.html#l00288">mx.c:288</a></div></div>
<div class="ttc" id="amx_8c_html_ad7adbbda58c642107eadf33b1fbf0c13"><div class="ttname"><a href="mx_8c.html#ad7adbbda58c642107eadf33b1fbf0c13">mx_msg_open_new</a></div><div class="ttdeci">struct Message * mx_msg_open_new(struct Mailbox *m, const struct Email *e, MsgOpenFlags flags)</div><div class="ttdoc">Open a new message.</div><div class="ttdef"><b>Definition</b> <a href="mx_8c_source.html#l01044">mx.c:1044</a></div></div>
<div class="ttc" id="amx_8c_html_add0e192c5f27bf6bd096ae2eb7c0b67b"><div class="ttname"><a href="mx_8c.html#add0e192c5f27bf6bd096ae2eb7c0b67b">mx_msg_commit</a></div><div class="ttdeci">int mx_msg_commit(struct Mailbox *m, struct Message *msg)</div><div class="ttdoc">Commit a message to a folder - Wrapper for MxOps::msg_commit()</div><div class="ttdef"><b>Definition</b> <a href="mx_8c_source.html#l01164">mx.c:1164</a></div></div>
<div class="ttc" id="amx_8c_html_addbeb100364d5be4dd89b74ac73ef067"><div class="ttname"><a href="mx_8c.html#addbeb100364d5be4dd89b74ac73ef067">mx_path_resolve</a></div><div class="ttdeci">struct Mailbox * mx_path_resolve(const char *path)</div><div class="ttdoc">Get a Mailbox for a path.</div><div class="ttdef"><b>Definition</b> <a href="mx_8c_source.html#l01641">mx.c:1641</a></div></div>
<div class="ttc" id="amx_8c_html_af9e949965d56e69eb9a6a9aa640614bb"><div class="ttname"><a href="mx_8c.html#af9e949965d56e69eb9a6a9aa640614bb">mx_mbox_close</a></div><div class="ttdeci">enum MxStatus mx_mbox_close(struct Mailbox *m)</div><div class="ttdoc">Save changes and close mailbox.</div><div class="ttdef"><b>Definition</b> <a href="mx_8c_source.html#l00598">mx.c:598</a></div></div>
<div class="ttc" id="amx_8h_html_a49087f3940d59f9624011017e42d9444"><div class="ttname"><a href="mx_8h.html#a49087f3940d59f9624011017e42d9444">MUTT_ADD_FROM</a></div><div class="ttdeci">#define MUTT_ADD_FROM</div><div class="ttdoc">add a From_ line</div><div class="ttdef"><b>Definition</b> <a href="mx_8h_source.html#l00039">mx.h:39</a></div></div>
<div class="ttc" id="amx_8h_html_a4f461719ebd7d96d0b2f2492c595fc26"><div class="ttname"><a href="mx_8h.html#a4f461719ebd7d96d0b2f2492c595fc26">MUTT_MSG_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_MSG_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="mx_8h_source.html#l00038">mx.h:38</a></div></div>
<div class="ttc" id="amxapi_8h_html_a6168431d3be24912b33a6c486fa11366"><div class="ttname"><a href="mxapi_8h.html#a6168431d3be24912b33a6c486fa11366">MUTT_APPEND</a></div><div class="ttdeci">#define MUTT_APPEND</div><div class="ttdoc">Open mailbox for appending messages.</div><div class="ttdef"><b>Definition</b> <a href="mxapi_8h_source.html#l00042">mxapi.h:42</a></div></div>
<div class="ttc" id="amxapi_8h_html_a75f314042a266df29efcc524d35c4b2d"><div class="ttname"><a href="mxapi_8h.html#a75f314042a266df29efcc524d35c4b2d">MUTT_QUIET</a></div><div class="ttdeci">#define MUTT_QUIET</div><div class="ttdoc">Do not print any messages.</div><div class="ttdef"><b>Definition</b> <a href="mxapi_8h_source.html#l00044">mxapi.h:44</a></div></div>
<div class="ttc" id="astructEmail_html_a0bd79550be901d44e50953fb43614e10"><div class="ttname"><a href="structEmail.html#a0bd79550be901d44e50953fb43614e10">Email::read</a></div><div class="ttdeci">bool read</div><div class="ttdoc">Email is read.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00050">email.h:50</a></div></div>
<div class="ttc" id="astructEmail_html_abd3d551204f4ea232a304c1c4c4c149d"><div class="ttname"><a href="structEmail.html#abd3d551204f4ea232a304c1c4c4c149d">Email::msgno</a></div><div class="ttdeci">int msgno</div><div class="ttdoc">Number displayed to the user.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00111">email.h:111</a></div></div>
<div class="ttc" id="astructMailbox_html"><div class="ttname"><a href="structMailbox.html">Mailbox</a></div><div class="ttdoc">A mailbox.</div><div class="ttdef"><b>Definition</b> <a href="core_2mailbox_8h_source.html#l00078">mailbox.h:79</a></div></div>
<div class="ttc" id="astructMailbox_html_a5638329fb2ebd4bbe1f4a949ec8de174"><div class="ttname"><a href="structMailbox.html#a5638329fb2ebd4bbe1f4a949ec8de174">Mailbox::type</a></div><div class="ttdeci">enum MailboxType type</div><div class="ttdoc">Mailbox type.</div><div class="ttdef"><b>Definition</b> <a href="core_2mailbox_8h_source.html#l00102">mailbox.h:102</a></div></div>
<div class="ttc" id="astructMessage_html"><div class="ttname"><a href="structMessage.html">Message</a></div><div class="ttdoc">A local copy of an email.</div><div class="ttdef"><b>Definition</b> <a href="core_2message_8h_source.html#l00033">message.h:34</a></div></div>
<div class="ttc" id="astructMessage_html_a11d53ee4319e8735c1677d8780a7b517"><div class="ttname"><a href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">Message::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdoc">pointer to the message data</div><div class="ttdef"><b>Definition</b> <a href="core_2message_8h_source.html#l00035">message.h:35</a></div></div>
</div><!-- fragment --><div id="dynsection-26" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a87e1ea8a7b0c926e02ed3db8b7d3dbd5_cgraph.svg" width="575" height="800"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-27" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a87e1ea8a7b0c926e02ed3db8b7d3dbd5_icgraph.svg" width="608" height="376"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="acc6c49a75e5a6fce41d18c1d95a45948" name="acc6c49a75e5a6fce41d18c1d95a45948"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc6c49a75e5a6fce41d18c1d95a45948">&#9670;&#160;</a></span>mutt_add_temp_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_add_temp_attachment </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>filename</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add file to list of temporary attachments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>filename with full path </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8c_source.html#l01297">1297</a> of file <a class="el" href="mutt__attach_8c_source.html">mutt_attach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1298</span>{</div>
<div class="line"><span class="lineno"> 1299</span>  <a class="code hl_function" href="list_8c.html#a47252e2b00de607c64a5fec8dc16058d">mutt_list_insert_tail</a>(&amp;<a class="code hl_variable" href="globals_8c.html#a29415171c9dd4ed4f41456275cddf672">TempAttachmentsList</a>, <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(filename));</div>
<div class="line"><span class="lineno"> 1300</span>}</div>
<div class="ttc" id="aglobals_8c_html_a29415171c9dd4ed4f41456275cddf672"><div class="ttname"><a href="globals_8c.html#a29415171c9dd4ed4f41456275cddf672">TempAttachmentsList</a></div><div class="ttdeci">struct ListHead TempAttachmentsList</div><div class="ttdoc">List of temporary files for displaying attachments.</div><div class="ttdef"><b>Definition</b> <a href="globals_8c_source.html#l00048">globals.c:48</a></div></div>
<div class="ttc" id="alist_8c_html_a47252e2b00de607c64a5fec8dc16058d"><div class="ttname"><a href="list_8c.html#a47252e2b00de607c64a5fec8dc16058d">mutt_list_insert_tail</a></div><div class="ttdeci">struct ListNode * mutt_list_insert_tail(struct ListHead *h, char *s)</div><div class="ttdoc">Append a string to the end of a List.</div><div class="ttdef"><b>Definition</b> <a href="list_8c_source.html#l00065">list.c:65</a></div></div>
</div><!-- fragment --><div id="dynsection-28" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_acc6c49a75e5a6fce41d18c1d95a45948_cgraph.svg" width="396" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-29" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_acc6c49a75e5a6fce41d18c1d95a45948_icgraph.svg" width="614" height="120"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6276b87d132d5b4e7590eb3d9265c0f8" name="a6276b87d132d5b4e7590eb3d9265c0f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6276b87d132d5b4e7590eb3d9265c0f8">&#9670;&#160;</a></span>mutt_temp_attachments_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mutt_temp_attachments_cleanup </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete all temporary attachments. </p>

<p class="definition">Definition at line <a class="el" href="mutt__attach_8c_source.html#l01305">1305</a> of file <a class="el" href="mutt__attach_8c_source.html">mutt_attach.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1306</span>{</div>
<div class="line"><span class="lineno"> 1307</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structListNode.html">ListNode</a> *np = NULL;</div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span>  <a class="code hl_define" href="queue_8h.html#a77999ebdf5aaf7af8b8ea22bf208c432">STAILQ_FOREACH</a>(np, &amp;<a class="code hl_variable" href="globals_8c.html#a29415171c9dd4ed4f41456275cddf672">TempAttachmentsList</a>, entries)</div>
<div class="line"><span class="lineno"> 1310</span>  {</div>
<div class="line"><span class="lineno"> 1311</span>    (void) <a class="code hl_function" href="file_8c.html#ada903307ff33738359dd9add40bc5c6a">mutt_file_chmod_add</a>(np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>, S_IWUSR);</div>
<div class="line"><span class="lineno"> 1312</span>    <a class="code hl_function" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(np-&gt;<a class="code hl_variable" href="structListNode.html#aafe688d670318196766392d8235d00a7">data</a>);</div>
<div class="line"><span class="lineno"> 1313</span>  }</div>
<div class="line"><span class="lineno"> 1314</span> </div>
<div class="line"><span class="lineno"> 1315</span>  <a class="code hl_function" href="list_8c.html#ab5c53ce94cc2aafa4299dbc81a37f4a4">mutt_list_free</a>(&amp;<a class="code hl_variable" href="globals_8c.html#a29415171c9dd4ed4f41456275cddf672">TempAttachmentsList</a>);</div>
<div class="line"><span class="lineno"> 1316</span>}</div>
<div class="ttc" id="afile_8c_html_ada903307ff33738359dd9add40bc5c6a"><div class="ttname"><a href="file_8c.html#ada903307ff33738359dd9add40bc5c6a">mutt_file_chmod_add</a></div><div class="ttdeci">int mutt_file_chmod_add(const char *path, mode_t mode)</div><div class="ttdoc">Add permissions to a file.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l01009">file.c:1009</a></div></div>
<div class="ttc" id="alist_8c_html_ab5c53ce94cc2aafa4299dbc81a37f4a4"><div class="ttname"><a href="list_8c.html#ab5c53ce94cc2aafa4299dbc81a37f4a4">mutt_list_free</a></div><div class="ttdeci">void mutt_list_free(struct ListHead *h)</div><div class="ttdoc">Free a List AND its strings.</div><div class="ttdef"><b>Definition</b> <a href="list_8c_source.html#l00123">list.c:123</a></div></div>
</div><!-- fragment --><div id="dynsection-30" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-30-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-30-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-30-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a6276b87d132d5b4e7590eb3d9265c0f8_cgraph.svg" width="386" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-31" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-31-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-31-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-31-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="mutt__attach_8h_a6276b87d132d5b4e7590eb3d9265c0f8_icgraph.svg" width="376" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
