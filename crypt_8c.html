<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: ncrypt/crypt.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><a href="https://neomutt.org"><img alt="Logo" src="neomutt-64.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <a style="color: black; text-decoration: none;" href="https://neomutt.org">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">2025-09-05-43-g177ed6</span>
   </div>
   <div id="projectbrief">Teaching an old dog new tricks</div>
   </a>
   <a href="https://github.com/neomutt/neomutt" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000000; color:#fff; position: fixed; top: 0; border: 0; right: 0; z-index: 9999;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </td>
   <td><a style="text-decoration: none; position: absolute; right: 0; top: 25px; margin-right: 100px; color: #66d866; font-size: 400%;" href="http://www.doxygen.org/index.html">DOXYGEN</a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('crypt_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">crypt.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Signing/encryption multiplexor.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;config.h&quot;</code><br />
<code>#include &lt;locale.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="mutt_2lib_8h_source.html">mutt/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="address_2lib_8h_source.html">address/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_2lib_8h_source.html">config/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="email_2lib_8h_source.html">email/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="core_2lib_8h_source.html">core/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="alias_2lib_8h_source.html">alias/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="gui_2lib_8h_source.html">gui/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mutt_8h_source.html">mutt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypt_8h_source.html">crypt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="attach_2lib_8h_source.html">attach/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="question_2lib_8h_source.html">question/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="send_2lib_8h_source.html">send/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="copy_8h_source.html">copy.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cryptglue_8h_source.html">cryptglue.h</a>&quot;</code><br />
<code>#include &quot;globals.h&quot;</code><br />
<code>#include &quot;<a class="el" href="handler_8h_source.html">handler.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mx_8h_source.html">mx.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="autocrypt_2lib_8h_source.html">autocrypt/lib.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for crypt.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c__incl.svg" width="1999" height="274"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="crypt_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac85f3f9345f53423bce29d478a6d7aaa" id="r_ac85f3f9345f53423bce29d478a6d7aaa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac85f3f9345f53423bce29d478a6d7aaa">crypt_current_time</a> (struct <a class="el" href="structState.html">State</a> *state, const char *app_name)</td></tr>
<tr class="memdesc:ac85f3f9345f53423bce29d478a6d7aaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the current time.  <br /></td></tr>
<tr class="separator:ac85f3f9345f53423bce29d478a6d7aaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a09719065d14c27701c998b48883ac4" id="r_a8a09719065d14c27701c998b48883ac4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8a09719065d14c27701c998b48883ac4">crypt_forget_passphrase</a> (void)</td></tr>
<tr class="memdesc:a8a09719065d14c27701c998b48883ac4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forget a passphrase and display a message.  <br /></td></tr>
<tr class="separator:a8a09719065d14c27701c998b48883ac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ee7f1419a7e39b0e9f1f9d550f4de43" id="r_a4ee7f1419a7e39b0e9f1f9d550f4de43"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a> (<a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> flags)</td></tr>
<tr class="memdesc:a4ee7f1419a7e39b0e9f1f9d550f4de43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check that we have a usable passphrase, ask if not.  <br /></td></tr>
<tr class="separator:a4ee7f1419a7e39b0e9f1f9d550f4de43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a896502d4448fefadaf8786a4f2d5556e" id="r_a896502d4448fefadaf8786a4f2d5556e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a896502d4448fefadaf8786a4f2d5556e">mutt_protect</a> (struct <a class="el" href="structEmail.html">Email</a> *e, char *keylist, bool postpone)</td></tr>
<tr class="memdesc:a896502d4448fefadaf8786a4f2d5556e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt and/or sign a message.  <br /></td></tr>
<tr class="separator:a896502d4448fefadaf8786a4f2d5556e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a345fb1ff241b3fc778632947c2b08d37" id="r_a345fb1ff241b3fc778632947c2b08d37"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a345fb1ff241b3fc778632947c2b08d37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is a message signed?  <br /></td></tr>
<tr class="separator:a345fb1ff241b3fc778632947c2b08d37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a832e4b9f5a0e463876a3d8cfe852f12d" id="r_a832e4b9f5a0e463876a3d8cfe852f12d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a832e4b9f5a0e463876a3d8cfe852f12d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the message have encrypted parts?  <br /></td></tr>
<tr class="separator:a832e4b9f5a0e463876a3d8cfe852f12d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51806f872069460bb7f4fa16d1d92710" id="r_a51806f872069460bb7f4fa16d1d92710"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a51806f872069460bb7f4fa16d1d92710">mutt_is_valid_multipart_pgp_encrypted</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a51806f872069460bb7f4fa16d1d92710"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is this a valid multi-part encrypted message?  <br /></td></tr>
<tr class="separator:a51806f872069460bb7f4fa16d1d92710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9edb0262eaed7c522977a75b76c15770" id="r_a9edb0262eaed7c522977a75b76c15770"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9edb0262eaed7c522977a75b76c15770">mutt_is_malformed_multipart_pgp_encrypted</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a9edb0262eaed7c522977a75b76c15770"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for malformed layout.  <br /></td></tr>
<tr class="separator:a9edb0262eaed7c522977a75b76c15770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5ae8b8d4fea0b6aa61dc38312e99d15" id="r_ad5ae8b8d4fea0b6aa61dc38312e99d15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad5ae8b8d4fea0b6aa61dc38312e99d15">mutt_is_application_pgp</a> (const struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:ad5ae8b8d4fea0b6aa61dc38312e99d15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the message use PGP?  <br /></td></tr>
<tr class="separator:ad5ae8b8d4fea0b6aa61dc38312e99d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4073ce5b5fcec6e245dbfa9369016b8e" id="r_a4073ce5b5fcec6e245dbfa9369016b8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a4073ce5b5fcec6e245dbfa9369016b8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the message use S/MIME?  <br /></td></tr>
<tr class="separator:a4073ce5b5fcec6e245dbfa9369016b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4ab2e337a2477fba687b1f710aa7a61" id="r_af4ab2e337a2477fba687b1f710aa7a61"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4ab2e337a2477fba687b1f710aa7a61">crypt_query</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:af4ab2e337a2477fba687b1f710aa7a61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check out the type of encryption used.  <br /></td></tr>
<tr class="separator:af4ab2e337a2477fba687b1f710aa7a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3dde2a67c95a70df3d498215427863b" id="r_ab3dde2a67c95a70df3d498215427863b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3dde2a67c95a70df3d498215427863b">crypt_write_signed</a> (struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structState.html">State</a> *state, const char *tempfile)</td></tr>
<tr class="memdesc:ab3dde2a67c95a70df3d498215427863b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write the message body/part.  <br /></td></tr>
<tr class="separator:ab3dde2a67c95a70df3d498215427863b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8f7e9a0aff78e25866f228aca6862bd" id="r_ac8f7e9a0aff78e25866f228aca6862bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac8f7e9a0aff78e25866f228aca6862bd">crypt_convert_to_7bit</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:ac8f7e9a0aff78e25866f228aca6862bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert an email to 7bit encoding.  <br /></td></tr>
<tr class="separator:ac8f7e9a0aff78e25866f228aca6862bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a776fef61b47569d4c698411d5e733a0f" id="r_a776fef61b47569d4c698411d5e733a0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a776fef61b47569d4c698411d5e733a0f">crypt_extract_keys_from_messages</a> (struct <a class="el" href="structMailbox.html">Mailbox</a> *m, struct EmailArray *ea)</td></tr>
<tr class="memdesc:a776fef61b47569d4c698411d5e733a0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract keys from a message.  <br /></td></tr>
<tr class="separator:a776fef61b47569d4c698411d5e733a0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb04ccb83d144391034d86704c52b987" id="r_abb04ccb83d144391034d86704c52b987"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abb04ccb83d144391034d86704c52b987">crypt_get_keys</a> (struct <a class="el" href="structEmail.html">Email</a> *e, char **keylist, bool oppenc_mode)</td></tr>
<tr class="memdesc:abb04ccb83d144391034d86704c52b987"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check we have all the keys we need.  <br /></td></tr>
<tr class="separator:abb04ccb83d144391034d86704c52b987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2afe38b474061773d69624018621ff1e" id="r_a2afe38b474061773d69624018621ff1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2afe38b474061773d69624018621ff1e">crypt_opportunistic_encrypt</a> (struct <a class="el" href="structEmail.html">Email</a> *e)</td></tr>
<tr class="memdesc:a2afe38b474061773d69624018621ff1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Can all recipients be determined.  <br /></td></tr>
<tr class="separator:a2afe38b474061773d69624018621ff1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a125731bc0d4f94974c4ccba4a6146c23" id="r_a125731bc0d4f94974c4ccba4a6146c23"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a125731bc0d4f94974c4ccba4a6146c23">crypt_fetch_signatures</a> (struct <a class="el" href="structBody.html">Body</a> ***b_sigs, struct <a class="el" href="structBody.html">Body</a> *b, int *n)</td></tr>
<tr class="memdesc:a125731bc0d4f94974c4ccba4a6146c23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an array of an emails parts.  <br /></td></tr>
<tr class="separator:a125731bc0d4f94974c4ccba4a6146c23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52c65477f5b80ad3dc8028663653771d" id="r_a52c65477f5b80ad3dc8028663653771d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a52c65477f5b80ad3dc8028663653771d">mutt_should_hide_protected_subject</a> (struct <a class="el" href="structEmail.html">Email</a> *e)</td></tr>
<tr class="memdesc:a52c65477f5b80ad3dc8028663653771d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Should <a class="el" href="structNeoMutt.html" title="Container for Accounts, Notifications.">NeoMutt</a> hide the protected subject?  <br /></td></tr>
<tr class="separator:a52c65477f5b80ad3dc8028663653771d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7ccf06ce10b9aed658fcc6c7a40c64b8" id="r_ga7ccf06ce10b9aed658fcc6c7a40c64b8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__handler__api.html#ga7ccf06ce10b9aed658fcc6c7a40c64b8">mutt_protected_headers_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga7ccf06ce10b9aed658fcc6c7a40c64b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for protected headers - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga7ccf06ce10b9aed658fcc6c7a40c64b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad8f7563b8c9aba96de145d0e17e58437" id="r_gad8f7563b8c9aba96de145d0e17e58437"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__handler__api.html#gad8f7563b8c9aba96de145d0e17e58437">mutt_signed_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:gad8f7563b8c9aba96de145d0e17e58437"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for "multipart/signed" - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:gad8f7563b8c9aba96de145d0e17e58437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94562053d94ca97e0c694987beda0fab" id="r_a94562053d94ca97e0c694987beda0fab"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a94562053d94ca97e0c694987beda0fab">crypt_get_fingerprint_or_id</a> (const char *p, const char **pphint, const char **ppl, const char **pps)</td></tr>
<tr class="memdesc:a94562053d94ca97e0c694987beda0fab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the fingerprint or long key ID.  <br /></td></tr>
<tr class="separator:a94562053d94ca97e0c694987beda0fab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3230991ab72820135b5ba8fe94a5f43d" id="r_a3230991ab72820135b5ba8fe94a5f43d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3230991ab72820135b5ba8fe94a5f43d">crypt_is_numerical_keyid</a> (const char *s)</td></tr>
<tr class="memdesc:a3230991ab72820135b5ba8fe94a5f43d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is this a numerical keyid.  <br /></td></tr>
<tr class="separator:a3230991ab72820135b5ba8fe94a5f43d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Signing/encryption multiplexor. </p>
<dl class="section author"><dt>Authors</dt><dd><ul>
<li>Richard Russon</li>
<li>Pietro Cerutti</li>
<li>Anna Figueiredo Gomes</li>
</ul>
</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 2 of the License, or (at your option) any later version.</dd></dl>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>

<p class="definition">Definition in file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac85f3f9345f53423bce29d478a6d7aaa" name="ac85f3f9345f53423bce29d478a6d7aaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac85f3f9345f53423bce29d478a6d7aaa">&#9670;&#160;</a></span>crypt_current_time()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_current_time </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>app_name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the current time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td><a class="el" href="structState.html" title="Keep track when processing files.">State</a> to use </td></tr>
    <tr><td class="paramname">app_name</td><td>App name, e.g. "PGP"</td></tr>
  </table>
  </dd>
</dl>
<p>print the current time to avoid spoofing of the signature output </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00065">65</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   66</span>{</div>
<div class="line"><span class="lineno">   67</span>  <span class="keywordtype">char</span> p[256] = { 0 };</div>
<div class="line"><span class="lineno">   68</span>  <span class="keywordtype">char</span> tmp[512] = { 0 };</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_timestamp = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_timestamp&quot;</span>);</div>
<div class="line"><span class="lineno">   74</span>  <span class="keywordflow">if</span> (c_crypt_timestamp)</div>
<div class="line"><span class="lineno">   75</span>  {</div>
<div class="line"><span class="lineno">   76</span>    <a class="code hl_function" href="mutt_2date_8c.html#a0fab1956f93fd1be1a2dbfb740788ef7">mutt_date_localtime_format</a>(p, <span class="keyword">sizeof</span>(p), <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot; (current time: %c)&quot;</span>), <a class="code hl_function" href="mutt_2date_8c.html#ad1e6304a91c7b6f3c266a9b17c1740fe">mutt_date_now</a>());</div>
<div class="line"><span class="lineno">   77</span>  }</div>
<div class="line"><span class="lineno">   78</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   79</span>  {</div>
<div class="line"><span class="lineno">   80</span>    *p = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><span class="lineno">   81</span>  }</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>  snprintf(tmp, <span class="keyword">sizeof</span>(tmp), <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- %s output follows%s --]\n&quot;</span>), <a class="code hl_define" href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a>(app_name), p);</div>
<div class="line"><span class="lineno">   84</span>  <a class="code hl_function" href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a>(state, tmp);</div>
<div class="line"><span class="lineno">   85</span>}</div>
<div class="ttc" id="aconfig_2helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00047">helpers.c:47</a></div></div>
<div class="ttc" id="amutt_2date_8c_html_a0fab1956f93fd1be1a2dbfb740788ef7"><div class="ttname"><a href="mutt_2date_8c.html#a0fab1956f93fd1be1a2dbfb740788ef7">mutt_date_localtime_format</a></div><div class="ttdeci">size_t mutt_date_localtime_format(char *buf, size_t buflen, const char *format, time_t t)</div><div class="ttdoc">Format localtime.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2date_8c_source.html#l00951">date.c:951</a></div></div>
<div class="ttc" id="amutt_2date_8c_html_ad1e6304a91c7b6f3c266a9b17c1740fe"><div class="ttname"><a href="mutt_2date_8c.html#ad1e6304a91c7b6f3c266a9b17c1740fe">mutt_date_now</a></div><div class="ttdeci">time_t mutt_date_now(void)</div><div class="ttdoc">Return the number of seconds since the Unix epoch.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2date_8c_source.html#l00456">date.c:456</a></div></div>
<div class="ttc" id="amutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="amutt_2state_8c_html_a0d52430e63f8cffdd0e6a78182ad4385"><div class="ttname"><a href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a></div><div class="ttdeci">void state_attach_puts(struct State *state, const char *t)</div><div class="ttdoc">Write a string to the state.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8c_source.html#l00104">state.c:104</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00122">lib.h:122</a></div></div>
<div class="ttc" id="astring2_8h_html_a7e0481bed27661ea2679f256b24e0283"><div class="ttname"><a href="string2_8h.html#a7e0481bed27661ea2679f256b24e0283">NONULL</a></div><div class="ttdeci">#define NONULL(x)</div><div class="ttdef"><b>Definition</b> <a href="string2_8h_source.html#l00043">string2.h:43</a></div></div>
<div class="ttc" id="astructNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00042">neomutt.h:43</a></div></div>
<div class="ttc" id="astructNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00047">neomutt.h:47</a></div></div>
</div><!-- fragment --><div id="dynsection-1" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_ac85f3f9345f53423bce29d478a6d7aaa_cgraph.svg" width="344" height="219"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-2" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_ac85f3f9345f53423bce29d478a6d7aaa_icgraph.svg" width="367" height="292"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a8a09719065d14c27701c998b48883ac4" name="a8a09719065d14c27701c998b48883ac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a09719065d14c27701c998b48883ac4">&#9670;&#160;</a></span>crypt_forget_passphrase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_forget_passphrase </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forget a passphrase and display a message. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00090">90</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   91</span>{</div>
<div class="line"><span class="lineno">   92</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div>
<div class="line"><span class="lineno">   93</span>    <a class="code hl_function" href="cryptglue_8c.html#ab11bb907cc90bcd3aadecfd0000b5350">crypt_pgp_void_passphrase</a>();</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</div>
<div class="line"><span class="lineno">   96</span>    <a class="code hl_function" href="cryptglue_8c.html#a84e2b083debe6ba85cf3deca3e0fe99a">crypt_smime_void_passphrase</a>();</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno">   99</span>  {</div>
<div class="line"><span class="lineno">  100</span>    <span class="comment">/* L10N: Due to the implementation details (e.g. some passwords are managed</span></div>
<div class="line"><span class="lineno">  101</span><span class="comment">       by gpg-agent) we can&#39;t know whether we forgot zero, 1, 12, ...</span></div>
<div class="line"><span class="lineno">  102</span><span class="comment">       passwords. So in English we use &quot;Passphrases&quot;. Your language might</span></div>
<div class="line"><span class="lineno">  103</span><span class="comment">       have other means to express this. */</span></div>
<div class="line"><span class="lineno">  104</span>    <a class="code hl_define" href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Passphrases forgotten&quot;</span>));</div>
<div class="line"><span class="lineno">  105</span>  }</div>
<div class="line"><span class="lineno">  106</span>}</div>
<div class="ttc" id="acryptglue_8c_html_a84e2b083debe6ba85cf3deca3e0fe99a"><div class="ttname"><a href="cryptglue_8c.html#a84e2b083debe6ba85cf3deca3e0fe99a">crypt_smime_void_passphrase</a></div><div class="ttdeci">void crypt_smime_void_passphrase(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::void_passphrase()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00412">cryptglue.c:412</a></div></div>
<div class="ttc" id="acryptglue_8c_html_ab11bb907cc90bcd3aadecfd0000b5350"><div class="ttname"><a href="cryptglue_8c.html#ab11bb907cc90bcd3aadecfd0000b5350">crypt_pgp_void_passphrase</a></div><div class="ttdeci">void crypt_pgp_void_passphrase(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::void_passphrase()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00190">cryptglue.c:190</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gae108f891125caafa9250cf0959c40c04"><div class="ttname"><a href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a></div><div class="ttdeci">#define mutt_message(...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00092">logging2.h:92</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00096">lib.h:96</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00097">lib.h:97</a></div></div>
</div><!-- fragment --><div id="dynsection-3" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a8a09719065d14c27701c998b48883ac4_cgraph.svg" width="440" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-4" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a8a09719065d14c27701c998b48883ac4_icgraph.svg" width="390" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a4ee7f1419a7e39b0e9f1f9d550f4de43" name="a4ee7f1419a7e39b0e9f1f9d550f4de43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ee7f1419a7e39b0e9f1f9d550f4de43">&#9670;&#160;</a></span>crypt_valid_passphrase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool crypt_valid_passphrase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></td>          <td class="paramname"><span class="paramname"><em>flags</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check that we have a usable passphrase, ask if not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>Flags, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT.">SecurityFlags</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Success </td></tr>
    <tr><td class="paramname">false</td><td>Failed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00132">132</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  133</span>{</div>
<div class="line"><span class="lineno">  134</span>  <span class="keywordtype">bool</span> rc = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span><span class="preprocessor">#ifndef DEBUG</span></div>
<div class="line"><span class="lineno">  137</span>  disable_coredumps();</div>
<div class="line"><span class="lineno">  138</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (flags &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  141</span>    rc = <a class="code hl_function" href="cryptglue_8c.html#ad29ef155ee6ccc83b50614068bb5b597">crypt_pgp_valid_passphrase</a>();</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (flags &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno">  144</span>    rc = <a class="code hl_function" href="cryptglue_8c.html#a82c5ed5b55a8c04d810494995152f10d">crypt_smime_valid_passphrase</a>();</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  147</span>}</div>
<div class="ttc" id="acryptglue_8c_html_a82c5ed5b55a8c04d810494995152f10d"><div class="ttname"><a href="cryptglue_8c.html#a82c5ed5b55a8c04d810494995152f10d">crypt_smime_valid_passphrase</a></div><div class="ttdeci">bool crypt_smime_valid_passphrase(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::valid_passphrase()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00421">cryptglue.c:421</a></div></div>
<div class="ttc" id="acryptglue_8c_html_ad29ef155ee6ccc83b50614068bb5b597"><div class="ttname"><a href="cryptglue_8c.html#ad29ef155ee6ccc83b50614068bb5b597">crypt_pgp_valid_passphrase</a></div><div class="ttdeci">bool crypt_pgp_valid_passphrase(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::valid_passphrase()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00199">cryptglue.c:199</a></div></div>
</div><!-- fragment --><div id="dynsection-5" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a4ee7f1419a7e39b0e9f1f9d550f4de43_cgraph.svg" width="431" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-6" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a4ee7f1419a7e39b0e9f1f9d550f4de43_icgraph.svg" width="646" height="814"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a896502d4448fefadaf8786a4f2d5556e" name="a896502d4448fefadaf8786a4f2d5556e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a896502d4448fefadaf8786a4f2d5556e">&#9670;&#160;</a></span>mutt_protect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_protect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>keylist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>postpone</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt and/or sign a message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> </td></tr>
    <tr><td class="paramname">keylist</td><td>List of keys to encrypt to (space-separated) </td></tr>
    <tr><td class="paramname">postpone</td><td>When true, signing is automatically disabled </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00157">157</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  158</span>{</div>
<div class="line"><span class="lineno">  159</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *pbody = NULL, *tmp_pbody = NULL;</div>
<div class="line"><span class="lineno">  160</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *tmp_smime_pbody = NULL;</div>
<div class="line"><span class="lineno">  161</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *tmp_pgp_pbody = NULL;</div>
<div class="line"><span class="lineno">  162</span>  <span class="keywordtype">bool</span> has_retainable_sig = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>  <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> security = e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a>;</div>
<div class="line"><span class="lineno">  168</span>  <span class="keywordtype">int</span> sign = security &amp; (<a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>);</div>
<div class="line"><span class="lineno">  169</span>  <span class="keywordflow">if</span> (postpone)</div>
<div class="line"><span class="lineno">  170</span>  {</div>
<div class="line"><span class="lineno">  171</span>    sign = <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  172</span>    security &amp;= <a class="code hl_define" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">~SEC_SIGN</a>;</div>
<div class="line"><span class="lineno">  173</span>  }</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>  <span class="keywordflow">if</span> (!(security &amp; (<a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)) &amp;&amp; !sign)</div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>  <span class="keywordflow">if</span> (sign &amp;&amp; !(security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>) &amp;&amp; !<a class="code hl_function" href="#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a>(security))</div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; !(security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  182</span>      ((security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a>) == <a class="code hl_define" href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a>))</div>
<div class="line"><span class="lineno">  183</span>  {</div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">if</span> ((e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) || !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;plain&quot;</span>))</div>
<div class="line"><span class="lineno">  185</span>    {</div>
<div class="line"><span class="lineno">  186</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="question_2lib_8h.html#a8ba883bf53e8ab425a03d17368de84b4">query_quadoption</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Inline PGP can&#39;t be used with attachments.  Revert to PGP/MIME?&quot;</span>),</div>
<div class="line"><span class="lineno">  187</span>                           <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_mime_auto&quot;</span>) != <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div>
<div class="line"><span class="lineno">  188</span>      {</div>
<div class="line"><span class="lineno">  189</span>        <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mail not sent: inline PGP can&#39;t be used with attachments&quot;</span>));</div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  191</span>      }</div>
<div class="line"><span class="lineno">  192</span>    }</div>
<div class="line"><span class="lineno">  193</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;flowed&quot;</span>, <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;format&quot;</span>)))</div>
<div class="line"><span class="lineno">  194</span>    {</div>
<div class="line"><span class="lineno">  195</span>      <span class="keywordflow">if</span> ((<a class="code hl_function" href="question_2lib_8h.html#a8ba883bf53e8ab425a03d17368de84b4">query_quadoption</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Inline PGP can&#39;t be used with format=flowed.  Revert to PGP/MIME?&quot;</span>),</div>
<div class="line"><span class="lineno">  196</span>                            <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_mime_auto&quot;</span>)) != <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div>
<div class="line"><span class="lineno">  197</span>      {</div>
<div class="line"><span class="lineno">  198</span>        <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mail not sent: inline PGP can&#39;t be used with format=flowed&quot;</span>));</div>
<div class="line"><span class="lineno">  199</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  200</span>      }</div>
<div class="line"><span class="lineno">  201</span>    }</div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  203</span>    {</div>
<div class="line"><span class="lineno">  204</span>      <span class="comment">/* they really want to send it inline... go for it */</span></div>
<div class="line"><span class="lineno">  205</span>      <span class="keywordflow">if</span> (!isendwin())</div>
<div class="line"><span class="lineno">  206</span>      {</div>
<div class="line"><span class="lineno">  207</span>        <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  208</span>        puts(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Invoking PGP...&quot;</span>));</div>
<div class="line"><span class="lineno">  209</span>      }</div>
<div class="line"><span class="lineno">  210</span>      pbody = <a class="code hl_function" href="cryptglue_8c.html#a3458a0bbc46b247f9dd5ea63d1e9231f">crypt_pgp_traditional_encryptsign</a>(e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, security, keylist);</div>
<div class="line"><span class="lineno">  211</span>      <span class="keywordflow">if</span> (pbody)</div>
<div class="line"><span class="lineno">  212</span>      {</div>
<div class="line"><span class="lineno">  213</span>        e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = pbody;</div>
<div class="line"><span class="lineno">  214</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  215</span>      }</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>      <span class="comment">/* otherwise inline won&#39;t work...ask for revert */</span></div>
<div class="line"><span class="lineno">  218</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="question_2lib_8h.html#a8ba883bf53e8ab425a03d17368de84b4">query_quadoption</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Message can&#39;t be sent inline.  Revert to using PGP/MIME?&quot;</span>),</div>
<div class="line"><span class="lineno">  219</span>                           <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_mime_auto&quot;</span>) != <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div>
<div class="line"><span class="lineno">  220</span>      {</div>
<div class="line"><span class="lineno">  221</span>        <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mail not sent&quot;</span>));</div>
<div class="line"><span class="lineno">  222</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  223</span>      }</div>
<div class="line"><span class="lineno">  224</span>    }</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <span class="comment">/* go ahead with PGP/MIME */</span></div>
<div class="line"><span class="lineno">  227</span>  }</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>  <span class="keywordflow">if</span> (!isendwin())</div>
<div class="line"><span class="lineno">  230</span>    <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</div>
<div class="line"><span class="lineno">  233</span>    tmp_smime_pbody = e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div>
<div class="line"><span class="lineno">  234</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div>
<div class="line"><span class="lineno">  235</span>    tmp_pgp_pbody = e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span><span class="preprocessor">#ifdef CRYPT_BACKEND_GPGME</span></div>
<div class="line"><span class="lineno">  238</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_use_pka = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_use_pka&quot;</span>);</div>
<div class="line"><span class="lineno">  239</span>  <span class="keywordflow">if</span> (sign &amp;&amp; c_crypt_use_pka)</div>
<div class="line"><span class="lineno">  240</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  241</span>  <span class="keywordflow">if</span> (sign)</div>
<div class="line"><span class="lineno">  242</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  243</span>  {</div>
<div class="line"><span class="lineno">  244</span>    <span class="comment">/* Set sender (necessary for e.g. PKA).  */</span></div>
<div class="line"><span class="lineno">  245</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *mailbox = NULL;</div>
<div class="line"><span class="lineno">  246</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structAddress.html">Address</a> *from = <a class="code hl_define" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div>
<div class="line"><span class="lineno">  247</span>    <span class="keywordtype">bool</span> free_from = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>    <span class="keywordflow">if</span> (!from)</div>
<div class="line"><span class="lineno">  250</span>    {</div>
<div class="line"><span class="lineno">  251</span>      free_from = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  252</span>      from = <a class="code hl_function" href="send_8c.html#a90907de4e46f3a56b2889b79a48c9011">mutt_default_from</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno">  253</span>    }</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>    <a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a> = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(from-&gt;<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>);</div>
<div class="line"><span class="lineno">  256</span>    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structAddress.html">Address</a> *c_envelope_from_address = <a class="code hl_function" href="address_2config__type_8c.html#ae303ac83498043a651ec046b572bc707">cs_subset_address</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;envelope_from_address&quot;</span>);</div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a> &amp;&amp; c_envelope_from_address)</div>
<div class="line"><span class="lineno">  258</span>      <a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a> = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(c_envelope_from_address-&gt;<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>);</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno">  261</span>      <a class="code hl_function" href="cryptglue_8c.html#a9f57744c7bcac595aa1a8838f83dc369">crypt_smime_set_sender</a>(<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>);</div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  263</span>      <a class="code hl_function" href="cryptglue_8c.html#a9f42f50373941a87a03df3424ce1b7c4">crypt_pgp_set_sender</a>(<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>);</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">if</span> (free_from)</div>
<div class="line"><span class="lineno">  266</span>      <a class="code hl_function" href="address_2address_8c.html#a40eda06e6e64ff9d9f1e7d3b69e7c846">mutt_addr_free</a>(&amp;from);</div>
<div class="line"><span class="lineno">  267</span>  }</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_protected_headers_write = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_protected_headers_write&quot;</span>);</div>
<div class="line"><span class="lineno">  270</span>  <span class="keywordflow">if</span> (c_crypt_protected_headers_write)</div>
<div class="line"><span class="lineno">  271</span>  {</div>
<div class="line"><span class="lineno">  272</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_devel_security = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;devel_security&quot;</span>);</div>
<div class="line"><span class="lineno">  273</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structEnvelope.html">Envelope</a> *protected_headers = <a class="code hl_function" href="envelope_8c.html#a406e6f76001e7604ce65ffe972fc19c1">mutt_env_new</a>();</div>
<div class="line"><span class="lineno">  274</span>    <a class="code hl_function" href="envelope_8c.html#a91c00f700ee3ca43aa33487591b0d317">mutt_env_set_subject</a>(protected_headers, e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">subject</a>);</div>
<div class="line"><span class="lineno">  275</span>    <span class="keywordflow">if</span> (c_devel_security)</div>
<div class="line"><span class="lineno">  276</span>    {</div>
<div class="line"><span class="lineno">  277</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a1c204b091d782098fc1efa0c2f3b1e20">return_path</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a1c204b091d782098fc1efa0c2f3b1e20">return_path</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  278</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  279</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  280</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  281</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  282</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  283</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>,</div>
<div class="line"><span class="lineno">  284</span>                         &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  285</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">x_original_to</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">x_original_to</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  286</span>      <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a>, e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a>);</div>
<div class="line"><span class="lineno">  287</span>      <a class="code hl_function" href="list_8c.html#a3df8a4dc742babace631d82e71321678">mutt_list_copy_tail</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>);</div>
<div class="line"><span class="lineno">  288</span>      <a class="code hl_function" href="list_8c.html#a3df8a4dc742babace631d82e71321678">mutt_list_copy_tail</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">in_reply_to</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">in_reply_to</a>);</div>
<div class="line"><span class="lineno">  289</span>      <a class="code hl_function" href="envelope_8c.html#a0108f989ca58622df272cf31b610395e">mutt_env_to_intl</a>(protected_headers, NULL, NULL);</div>
<div class="line"><span class="lineno">  290</span>    }</div>
<div class="line"><span class="lineno">  291</span>    <a class="code hl_function" href="sendlib_8c.html#ac35da3d19eb0d95d4f6260adab57b4c9">mutt_prepare_envelope</a>(protected_headers, 0, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    <a class="code hl_function" href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>);</div>
<div class="line"><span class="lineno">  294</span>    e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a> = protected_headers;</div>
<div class="line"><span class="lineno">  295</span>    <a class="code hl_function" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protected-headers&quot;</span>, <span class="stringliteral">&quot;v1&quot;</span>);</div>
<div class="line"><span class="lineno">  296</span>  }</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span><span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div>
<div class="line"><span class="lineno">  299</span>  <span class="comment">/* A note about e-&gt;body-&gt;mime_headers.  If postpone or send</span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">   * fails, the mime_headers is cleared out before returning to the</span></div>
<div class="line"><span class="lineno">  301</span><span class="comment">   * compose menu.  So despite the &quot;robustness&quot; code above and in the</span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">   * gen_gossip_list function below, mime_headers will not be set when</span></div>
<div class="line"><span class="lineno">  303</span><span class="comment">   * entering mutt_protect().</span></div>
<div class="line"><span class="lineno">  304</span><span class="comment">   *</span></div>
<div class="line"><span class="lineno">  305</span><span class="comment">   * This is important to note because the user could toggle</span></div>
<div class="line"><span class="lineno">  306</span><span class="comment">   * $crypt_protected_headers_write or $autocrypt off back in the</span></div>
<div class="line"><span class="lineno">  307</span><span class="comment">   * compose menu.  We don&#39;t want mutt_rfc822_write_header() to write</span></div>
<div class="line"><span class="lineno">  308</span><span class="comment">   * stale data from one option if the other is set.</span></div>
<div class="line"><span class="lineno">  309</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  310</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_autocrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;autocrypt&quot;</span>);</div>
<div class="line"><span class="lineno">  311</span>  <span class="keywordflow">if</span> (c_autocrypt &amp;&amp; !postpone &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>))</div>
<div class="line"><span class="lineno">  312</span>  {</div>
<div class="line"><span class="lineno">  313</span>    <a class="code hl_function" href="autocrypt_8c.html#a30461121efab5b3f112767d63191c507">mutt_autocrypt_generate_gossip_list</a>(e);</div>
<div class="line"><span class="lineno">  314</span>  }</div>
<div class="line"><span class="lineno">  315</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>  <span class="keywordflow">if</span> (sign)</div>
<div class="line"><span class="lineno">  318</span>  {</div>
<div class="line"><span class="lineno">  319</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno">  320</span>    {</div>
<div class="line"><span class="lineno">  321</span>      tmp_pbody = <a class="code hl_function" href="cryptglue_8c.html#a1f1953623a760a5e61931e08dec39b96">crypt_smime_sign_message</a>(e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div>
<div class="line"><span class="lineno">  322</span>      <span class="keywordflow">if</span> (!tmp_pbody)</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  324</span>      pbody = tmp_pbody;</div>
<div class="line"><span class="lineno">  325</span>      tmp_smime_pbody = tmp_pbody;</div>
<div class="line"><span class="lineno">  326</span>    }</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_retainable_sigs = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_retainable_sigs&quot;</span>);</div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  330</span>        (!(security &amp; (<a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)) || c_pgp_retainable_sigs))</div>
<div class="line"><span class="lineno">  331</span>    {</div>
<div class="line"><span class="lineno">  332</span>      tmp_pbody = <a class="code hl_function" href="cryptglue_8c.html#a4e9129743f94b5324f1e4d3ed46db412">crypt_pgp_sign_message</a>(e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div>
<div class="line"><span class="lineno">  333</span>      <span class="keywordflow">if</span> (!tmp_pbody)</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>      has_retainable_sig = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  337</span>      sign = <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  338</span>      pbody = tmp_pbody;</div>
<div class="line"><span class="lineno">  339</span>      tmp_pgp_pbody = tmp_pbody;</div>
<div class="line"><span class="lineno">  340</span>    }</div>
<div class="line"><span class="lineno">  341</span>  }</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>  <span class="keywordflow">if</span> (security &amp; (<a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>))</div>
<div class="line"><span class="lineno">  344</span>  {</div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno">  346</span>    {</div>
<div class="line"><span class="lineno">  347</span>      tmp_pbody = <a class="code hl_function" href="cryptglue_8c.html#a1cc54e2b04340367de82a07781ab68a2">crypt_smime_build_smime_entity</a>(tmp_smime_pbody, keylist);</div>
<div class="line"><span class="lineno">  348</span>      <span class="keywordflow">if</span> (!tmp_pbody)</div>
<div class="line"><span class="lineno">  349</span>      {</div>
<div class="line"><span class="lineno">  350</span>        <span class="comment">/* signed ? free it! */</span></div>
<div class="line"><span class="lineno">  351</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  352</span>      }</div>
<div class="line"><span class="lineno">  353</span>      <span class="comment">/* free tmp_body if messages was signed AND encrypted ... */</span></div>
<div class="line"><span class="lineno">  354</span>      <span class="keywordflow">if</span> ((tmp_smime_pbody != e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>) &amp;&amp; (tmp_smime_pbody != tmp_pbody))</div>
<div class="line"><span class="lineno">  355</span>      {</div>
<div class="line"><span class="lineno">  356</span>        <span class="comment">/* detach and don&#39;t delete e-&gt;body,</span></div>
<div class="line"><span class="lineno">  357</span><span class="comment">         * which tmp_smime_pbody-&gt;parts after signing. */</span></div>
<div class="line"><span class="lineno">  358</span>        tmp_smime_pbody-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = tmp_smime_pbody-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno">  359</span>        e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a> = NULL;</div>
<div class="line"><span class="lineno">  360</span>        <a class="code hl_function" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;tmp_smime_pbody);</div>
<div class="line"><span class="lineno">  361</span>      }</div>
<div class="line"><span class="lineno">  362</span>      pbody = tmp_pbody;</div>
<div class="line"><span class="lineno">  363</span>    }</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  366</span>    {</div>
<div class="line"><span class="lineno">  367</span>      pbody = <a class="code hl_function" href="cryptglue_8c.html#ae2ebaf8e03c2029af925d234447a74d9">crypt_pgp_encrypt_message</a>(e, tmp_pgp_pbody, keylist, sign, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div>
<div class="line"><span class="lineno">  368</span>      <span class="keywordflow">if</span> (!pbody)</div>
<div class="line"><span class="lineno">  369</span>      {</div>
<div class="line"><span class="lineno">  370</span>        <span class="comment">/* did we perform a retainable signature? */</span></div>
<div class="line"><span class="lineno">  371</span>        <span class="keywordflow">if</span> (has_retainable_sig)</div>
<div class="line"><span class="lineno">  372</span>        {</div>
<div class="line"><span class="lineno">  373</span>          <span class="comment">/* remove the outer multipart layer */</span></div>
<div class="line"><span class="lineno">  374</span>          tmp_pgp_pbody = <a class="code hl_function" href="multipart_8c.html#a294249634f22cab1bce592ca8602c5ec">mutt_remove_multipart</a>(tmp_pgp_pbody);</div>
<div class="line"><span class="lineno">  375</span>          <span class="comment">/* get rid of the signature */</span></div>
<div class="line"><span class="lineno">  376</span>          <a class="code hl_function" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;tmp_pgp_pbody-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>);</div>
<div class="line"><span class="lineno">  377</span>        }</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  380</span>      }</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>      <span class="comment">// destroy temporary signature envelope when doing retainable signatures.</span></div>
<div class="line"><span class="lineno">  383</span>      <span class="keywordflow">if</span> (has_retainable_sig)</div>
<div class="line"><span class="lineno">  384</span>      {</div>
<div class="line"><span class="lineno">  385</span>        tmp_pgp_pbody = <a class="code hl_function" href="multipart_8c.html#a294249634f22cab1bce592ca8602c5ec">mutt_remove_multipart</a>(tmp_pgp_pbody);</div>
<div class="line"><span class="lineno">  386</span>        <a class="code hl_function" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;tmp_pgp_pbody-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>);</div>
<div class="line"><span class="lineno">  387</span>      }</div>
<div class="line"><span class="lineno">  388</span>    }</div>
<div class="line"><span class="lineno">  389</span>  }</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>  <span class="keywordflow">if</span> (pbody)</div>
<div class="line"><span class="lineno">  392</span>  {</div>
<div class="line"><span class="lineno">  393</span>    e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = pbody;</div>
<div class="line"><span class="lineno">  394</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  395</span>  }</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>bail:</div>
<div class="line"><span class="lineno">  398</span>  <a class="code hl_function" href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>);</div>
<div class="line"><span class="lineno">  399</span>  <a class="code hl_function" href="parameter_8c.html#a34454ee6af9d43eeabf80898dc7270b8">mutt_param_delete</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protected-headers&quot;</span>);</div>
<div class="line"><span class="lineno">  400</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  401</span>}</div>
<div class="ttc" id="aaddress_2address_8c_html_a16764dc80c9b3f6ad2897c8b7e59bd10"><div class="ttname"><a href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a></div><div class="ttdeci">void mutt_addrlist_copy(struct AddressList *dst, const struct AddressList *src, bool prune)</div><div class="ttdoc">Copy a list of addresses into another list.</div><div class="ttdef"><b>Definition</b> <a href="address_2address_8c_source.html#l00765">address.c:765</a></div></div>
<div class="ttc" id="aaddress_2address_8c_html_a40eda06e6e64ff9d9f1e7d3b69e7c846"><div class="ttname"><a href="address_2address_8c.html#a40eda06e6e64ff9d9f1e7d3b69e7c846">mutt_addr_free</a></div><div class="ttdeci">void mutt_addr_free(struct Address **ptr)</div><div class="ttdoc">Free a single Address.</div><div class="ttdef"><b>Definition</b> <a href="address_2address_8c_source.html#l00462">address.c:462</a></div></div>
<div class="ttc" id="aaddress_2config__type_8c_html_ae303ac83498043a651ec046b572bc707"><div class="ttname"><a href="address_2config__type_8c.html#ae303ac83498043a651ec046b572bc707">cs_subset_address</a></div><div class="ttdeci">const struct Address * cs_subset_address(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get an Address config item by name.</div><div class="ttdef"><b>Definition</b> <a href="address_2config__type_8c_source.html#l00286">config_type.c:286</a></div></div>
<div class="ttc" id="aautocrypt_8c_html_a30461121efab5b3f112767d63191c507"><div class="ttname"><a href="autocrypt_8c.html#a30461121efab5b3f112767d63191c507">mutt_autocrypt_generate_gossip_list</a></div><div class="ttdeci">int mutt_autocrypt_generate_gossip_list(struct Email *e)</div><div class="ttdoc">Create the gossip list headers.</div><div class="ttdef"><b>Definition</b> <a href="autocrypt_8c_source.html#l00823">autocrypt.c:823</a></div></div>
<div class="ttc" id="abuffer_8h_html_a728ebc5a947b77c8d56db44ce553a7ab"><div class="ttname"><a href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a></div><div class="ttdeci">static const char * buf_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00096">buffer.h:96</a></div></div>
<div class="ttc" id="acrypt_8c_html_a4ee7f1419a7e39b0e9f1f9d550f4de43"><div class="ttname"><a href="#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a></div><div class="ttdeci">bool crypt_valid_passphrase(SecurityFlags flags)</div><div class="ttdoc">Check that we have a usable passphrase, ask if not.</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l00132">crypt.c:132</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a1cc54e2b04340367de82a07781ab68a2"><div class="ttname"><a href="cryptglue_8c.html#a1cc54e2b04340367de82a07781ab68a2">crypt_smime_build_smime_entity</a></div><div class="ttdeci">struct Body * crypt_smime_build_smime_entity(struct Body *b, char *certlist)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::smime_build_smime_entity()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00496">cryptglue.c:496</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a1f1953623a760a5e61931e08dec39b96"><div class="ttname"><a href="cryptglue_8c.html#a1f1953623a760a5e61931e08dec39b96">crypt_smime_sign_message</a></div><div class="ttdeci">struct Body * crypt_smime_sign_message(struct Body *b, const struct AddressList *from)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::sign_message()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00485">cryptglue.c:485</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a3458a0bbc46b247f9dd5ea63d1e9231f"><div class="ttname"><a href="cryptglue_8c.html#a3458a0bbc46b247f9dd5ea63d1e9231f">crypt_pgp_traditional_encryptsign</a></div><div class="ttdeci">struct Body * crypt_pgp_traditional_encryptsign(struct Body *b, SecurityFlags flags, char *keylist)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_traditional_encryptsign()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00293">cryptglue.c:293</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a4e9129743f94b5324f1e4d3ed46db412"><div class="ttname"><a href="cryptglue_8c.html#a4e9129743f94b5324f1e4d3ed46db412">crypt_pgp_sign_message</a></div><div class="ttdeci">struct Body * crypt_pgp_sign_message(struct Body *b, const struct AddressList *from)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::sign_message()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00326">cryptglue.c:326</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a9f42f50373941a87a03df3424ce1b7c4"><div class="ttname"><a href="cryptglue_8c.html#a9f42f50373941a87a03df3424ce1b7c4">crypt_pgp_set_sender</a></div><div class="ttdeci">void crypt_pgp_set_sender(const char *sender)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::set_sender()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00403">cryptglue.c:403</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a9f57744c7bcac595aa1a8838f83dc369"><div class="ttname"><a href="cryptglue_8c.html#a9f57744c7bcac595aa1a8838f83dc369">crypt_smime_set_sender</a></div><div class="ttdeci">void crypt_smime_set_sender(const char *sender)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::set_sender()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00538">cryptglue.c:538</a></div></div>
<div class="ttc" id="acryptglue_8c_html_ae2ebaf8e03c2029af925d234447a74d9"><div class="ttname"><a href="cryptglue_8c.html#ae2ebaf8e03c2029af925d234447a74d9">crypt_pgp_encrypt_message</a></div><div class="ttdeci">struct Body * crypt_pgp_encrypt_message(struct Email *e, struct Body *b, char *keylist, int sign, const struct AddressList *from)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_encrypt_message()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00337">cryptglue.c:337</a></div></div>
<div class="ttc" id="acurs__lib_8c_html_acd14d074d8b9e6cb21e851dd573cdec2"><div class="ttname"><a href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a></div><div class="ttdeci">void mutt_endwin(void)</div><div class="ttdoc">Shutdown curses.</div><div class="ttdef"><b>Definition</b> <a href="curs__lib_8c_source.html#l00152">curs_lib.c:152</a></div></div>
<div class="ttc" id="aemail_2body_8c_html_a129af1c316fcbc26b55fb48957bab2cb"><div class="ttname"><a href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a></div><div class="ttdeci">void mutt_body_free(struct Body **ptr)</div><div class="ttdoc">Free a Body.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8c_source.html#l00058">body.c:58</a></div></div>
<div class="ttc" id="aenvelope_8c_html_a0108f989ca58622df272cf31b610395e"><div class="ttname"><a href="envelope_8c.html#a0108f989ca58622df272cf31b610395e">mutt_env_to_intl</a></div><div class="ttdeci">int mutt_env_to_intl(struct Envelope *env, const char **tag, char **err)</div><div class="ttdoc">Convert an Envelope&#39;s Address fields to Punycode format.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8c_source.html#l00355">envelope.c:355</a></div></div>
<div class="ttc" id="aenvelope_8c_html_a244dacf9b1001c9ce1dbd473e001381f"><div class="ttname"><a href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a></div><div class="ttdeci">void mutt_env_free(struct Envelope **ptr)</div><div class="ttdoc">Free an Envelope.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8c_source.html#l00126">envelope.c:126</a></div></div>
<div class="ttc" id="aenvelope_8c_html_a406e6f76001e7604ce65ffe972fc19c1"><div class="ttname"><a href="envelope_8c.html#a406e6f76001e7604ce65ffe972fc19c1">mutt_env_new</a></div><div class="ttdeci">struct Envelope * mutt_env_new(void)</div><div class="ttdoc">Create a new Envelope.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8c_source.html#l00046">envelope.c:46</a></div></div>
<div class="ttc" id="aenvelope_8c_html_a91c00f700ee3ca43aa33487591b0d317"><div class="ttname"><a href="envelope_8c.html#a91c00f700ee3ca43aa33487591b0d317">mutt_env_set_subject</a></div><div class="ttdeci">void mutt_env_set_subject(struct Envelope *env, const char *subj)</div><div class="ttdoc">Set both subject and real_subj to subj.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8c_source.html#l00069">envelope.c:69</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gacc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00093">logging2.h:93</a></div></div>
<div class="ttc" id="alist_8c_html_a3df8a4dc742babace631d82e71321678"><div class="ttname"><a href="list_8c.html#a3df8a4dc742babace631d82e71321678">mutt_list_copy_tail</a></div><div class="ttdeci">void mutt_list_copy_tail(struct ListHead *dst, const struct ListHead *src)</div><div class="ttdoc">Copy a list into another list.</div><div class="ttdef"><b>Definition</b> <a href="list_8c_source.html#l00275">list.c:275</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdeci">@ TYPE_TEXT</div><div class="ttdoc">Type: &#39;text/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="amultipart_8c_html_a294249634f22cab1bce592ca8602c5ec"><div class="ttname"><a href="multipart_8c.html#a294249634f22cab1bce592ca8602c5ec">mutt_remove_multipart</a></div><div class="ttdeci">struct Body * mutt_remove_multipart(struct Body *b)</div><div class="ttdoc">Extract the multipart body if it exists.</div><div class="ttdef"><b>Definition</b> <a href="multipart_8c_source.html#l00126">multipart.c:126</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00672">string.c:672</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_af8c32ffc64dd55e92001a974a4be6bbf"><div class="ttname"><a href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a></div><div class="ttdeci">char * mutt_str_replace(char **p, const char *s)</div><div class="ttdoc">Replace one string with another.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00282">string.c:282</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a0b36be5c32ca90d8f2caef9ea9d627fc"><div class="ttname"><a href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a></div><div class="ttdeci">#define SEC_AUTOCRYPT</div><div class="ttdoc">(Autocrypt) Message will be, or was Autocrypt encrypt+signed</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00093">lib.h:93</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a2073a168ca3a64c3c30d13fa4917a05d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></div><div class="ttdeci">uint16_t SecurityFlags</div><div class="ttdoc">Flags, e.g. SEC_ENCRYPT.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00082">lib.h:82</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a68503f0e36de213094c8546b4f74eef1"><div class="ttname"><a href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a></div><div class="ttdeci">#define PGP_INLINE</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00106">lib.h:106</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00083">lib.h:83</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_aacaa4abd4c0696e260b7a0f1d466360a"><div class="ttname"><a href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a></div><div class="ttdeci">#define SEC_ENCRYPT</div><div class="ttdoc">Email is encrypted.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00084">lib.h:84</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_ae12c003463c99d28f65f1d6b8b053b2c"><div class="ttname"><a href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a></div><div class="ttdeci">#define SEC_SIGN</div><div class="ttdoc">Email is signed.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00085">lib.h:85</a></div></div>
<div class="ttc" id="aparameter_8c_html_a31d10561ad6b3637e7591569b903aa33"><div class="ttname"><a href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a></div><div class="ttdeci">char * mutt_param_get(const struct ParameterList *pl, const char *s)</div><div class="ttdoc">Find a matching Parameter.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8c_source.html#l00085">parameter.c:85</a></div></div>
<div class="ttc" id="aparameter_8c_html_a34454ee6af9d43eeabf80898dc7270b8"><div class="ttname"><a href="parameter_8c.html#a34454ee6af9d43eeabf80898dc7270b8">mutt_param_delete</a></div><div class="ttdeci">void mutt_param_delete(struct ParameterList *pl, const char *attribute)</div><div class="ttdoc">Delete a matching Parameter.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8c_source.html#l00143">parameter.c:143</a></div></div>
<div class="ttc" id="aparameter_8c_html_a42249fc15b1e52df046a0a10de29da44"><div class="ttname"><a href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a></div><div class="ttdeci">void mutt_param_set(struct ParameterList *pl, const char *attribute, const char *value)</div><div class="ttdoc">Set a Parameter.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8c_source.html#l00111">parameter.c:111</a></div></div>
<div class="ttc" id="aquad_8h_html_a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a></div><div class="ttdeci">@ MUTT_YES</div><div class="ttdoc">User answered &#39;Yes&#39;, or assume &#39;Yes&#39;.</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00039">quad.h:39</a></div></div>
<div class="ttc" id="aquestion_2lib_8h_html_a8ba883bf53e8ab425a03d17368de84b4"><div class="ttname"><a href="question_2lib_8h.html#a8ba883bf53e8ab425a03d17368de84b4">query_quadoption</a></div><div class="ttdeci">enum QuadOption query_quadoption(const char *prompt, struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Ask the user a quad-question.</div><div class="ttdef"><b>Definition</b> <a href="question_8c_source.html#l00378">question.c:378</a></div></div>
<div class="ttc" id="aqueue_8h_html_a7d6894360bd1c41e0e6f6d84998c1362"><div class="ttname"><a href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a></div><div class="ttdeci">#define TAILQ_FIRST(head)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00780">queue.h:780</a></div></div>
<div class="ttc" id="asend_8c_html_a90907de4e46f3a56b2889b79a48c9011"><div class="ttname"><a href="send_8c.html#a90907de4e46f3a56b2889b79a48c9011">mutt_default_from</a></div><div class="ttdeci">struct Address * mutt_default_from(struct ConfigSubset *sub)</div><div class="ttdoc">Get a default &#39;from&#39; Address.</div><div class="ttdef"><b>Definition</b> <a href="send_8c_source.html#l01393">send.c:1393</a></div></div>
<div class="ttc" id="asendlib_8c_html_ac35da3d19eb0d95d4f6260adab57b4c9"><div class="ttname"><a href="sendlib_8c.html#ac35da3d19eb0d95d4f6260adab57b4c9">mutt_prepare_envelope</a></div><div class="ttdeci">void mutt_prepare_envelope(struct Envelope *env, bool final, struct ConfigSubset *sub)</div><div class="ttdoc">Prepare an email header.</div><div class="ttdef"><b>Definition</b> <a href="sendlib_8c_source.html#l00779">sendlib.c:779</a></div></div>
<div class="ttc" id="astructAddress_html"><div class="ttname"><a href="structAddress.html">Address</a></div><div class="ttdoc">An email address.</div><div class="ttdef"><b>Definition</b> <a href="address_8h_source.html#l00035">address.h:36</a></div></div>
<div class="ttc" id="astructAddress_html_a45cd47ee76ef04b63f55a0345c691fe8"><div class="ttname"><a href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">Address::mailbox</a></div><div class="ttdeci">struct Buffer * mailbox</div><div class="ttdoc">Mailbox and host address.</div><div class="ttdef"><b>Definition</b> <a href="address_8h_source.html#l00038">address.h:38</a></div></div>
<div class="ttc" id="astructBody_html"><div class="ttname"><a href="structBody.html">Body</a></div><div class="ttdoc">The body of an email.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00035">body.h:36</a></div></div>
<div class="ttc" id="astructBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00073">body.h:73</a></div></div>
<div class="ttc" id="astructBody_html_a62f6c9b4245ed3b6b9296adb45aa4010"><div class="ttname"><a href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">Body::mime_headers</a></div><div class="ttdeci">struct Envelope * mime_headers</div><div class="ttdoc">Memory hole protected headers.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00076">body.h:76</a></div></div>
<div class="ttc" id="astructBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">Parameters of the content-type.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00063">body.h:63</a></div></div>
<div class="ttc" id="astructBody_html_ac55cdfce46eed13151dcfe9b329d254c"><div class="ttname"><a href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">Body::next</a></div><div class="ttdeci">struct Body * next</div><div class="ttdoc">next attachment in the list</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00072">body.h:72</a></div></div>
<div class="ttc" id="astructBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00061">body.h:61</a></div></div>
<div class="ttc" id="astructBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00040">body.h:40</a></div></div>
<div class="ttc" id="astructEmail_html_a34cc4493729d7a3b1f4ed783e739a9ec"><div class="ttname"><a href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">Email::env</a></div><div class="ttdeci">struct Envelope * env</div><div class="ttdoc">Envelope information.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00068">email.h:68</a></div></div>
<div class="ttc" id="astructEmail_html_a570a81cd747437c9ea4357947731ae10"><div class="ttname"><a href="structEmail.html#a570a81cd747437c9ea4357947731ae10">Email::security</a></div><div class="ttdeci">SecurityFlags security</div><div class="ttdoc">bit 0-10: flags, bit 11,12: application, bit 13: traditional pgp See: ncrypt/lib.h pgplib....</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00043">email.h:43</a></div></div>
<div class="ttc" id="astructEmail_html_a57ad6ac618c0f685804f6f5bb390b3a6"><div class="ttname"><a href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">Email::body</a></div><div class="ttdeci">struct Body * body</div><div class="ttdoc">List of MIME parts.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00069">email.h:69</a></div></div>
<div class="ttc" id="astructEnvelope_html"><div class="ttname"><a href="structEnvelope.html">Envelope</a></div><div class="ttdoc">The header of an Email.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00056">envelope.h:57</a></div></div>
<div class="ttc" id="astructEnvelope_html_a1c204b091d782098fc1efa0c2f3b1e20"><div class="ttname"><a href="structEnvelope.html#a1c204b091d782098fc1efa0c2f3b1e20">Envelope::return_path</a></div><div class="ttdeci">struct AddressList return_path</div><div class="ttdoc">Return path for the Email.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00058">envelope.h:58</a></div></div>
<div class="ttc" id="astructEnvelope_html_a20d5ccf675db375e011a7791151fa09d"><div class="ttname"><a href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">Envelope::subject</a></div><div class="ttdeci">char *const subject</div><div class="ttdoc">Email&#39;s subject.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00070">envelope.h:70</a></div></div>
<div class="ttc" id="astructEnvelope_html_a2d927371b3b80e025d6f7522b7361fe7"><div class="ttname"><a href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">Envelope::to</a></div><div class="ttdeci">struct AddressList to</div><div class="ttdoc">Email&#39;s &#39;To&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00060">envelope.h:60</a></div></div>
<div class="ttc" id="astructEnvelope_html_a4b75ab1853f95878dec079371bb0d799"><div class="ttname"><a href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">Envelope::reply_to</a></div><div class="ttdeci">struct AddressList reply_to</div><div class="ttdoc">Email&#39;s &#39;reply-to&#39;.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00064">envelope.h:64</a></div></div>
<div class="ttc" id="astructEnvelope_html_a50418c13a849bf27b22922bd5867e5e1"><div class="ttname"><a href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">Envelope::message_id</a></div><div class="ttdeci">char * message_id</div><div class="ttdoc">Message ID.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00073">envelope.h:73</a></div></div>
<div class="ttc" id="astructEnvelope_html_a525bd5213606067d5c2be2e17fbe956b"><div class="ttname"><a href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">Envelope::x_original_to</a></div><div class="ttdeci">struct AddressList x_original_to</div><div class="ttdoc">Email&#39;s &#39;X-Original-to&#39;.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00066">envelope.h:66</a></div></div>
<div class="ttc" id="astructEnvelope_html_a6044b60220b8029a6a505e5b61f1cadc"><div class="ttname"><a href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">Envelope::mail_followup_to</a></div><div class="ttdeci">struct AddressList mail_followup_to</div><div class="ttdoc">Email&#39;s &#39;mail-followup-to&#39;.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00065">envelope.h:65</a></div></div>
<div class="ttc" id="astructEnvelope_html_a6b00837b3cb4b41898b42307135be8b6"><div class="ttname"><a href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">Envelope::cc</a></div><div class="ttdeci">struct AddressList cc</div><div class="ttdoc">Email&#39;s &#39;Cc&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00061">envelope.h:61</a></div></div>
<div class="ttc" id="astructEnvelope_html_a72ee5c0af4f94f83aeb8d31183261611"><div class="ttname"><a href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">Envelope::sender</a></div><div class="ttdeci">struct AddressList sender</div><div class="ttdoc">Email&#39;s sender.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00063">envelope.h:63</a></div></div>
<div class="ttc" id="astructEnvelope_html_a832eec73356a806761e26f0bc40d9083"><div class="ttname"><a href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">Envelope::references</a></div><div class="ttdeci">struct ListHead references</div><div class="ttdoc">message references (in reverse order)</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00083">envelope.h:83</a></div></div>
<div class="ttc" id="astructEnvelope_html_a9ae6d450b2f012c37d3350f4305fbb90"><div class="ttname"><a href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">Envelope::in_reply_to</a></div><div class="ttdeci">struct ListHead in_reply_to</div><div class="ttdoc">in-reply-to header content</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00084">envelope.h:84</a></div></div>
<div class="ttc" id="astructEnvelope_html_af1aa00aed4b8767cf98f08e45a432ad8"><div class="ttname"><a href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">Envelope::from</a></div><div class="ttdeci">struct AddressList from</div><div class="ttdoc">Email&#39;s &#39;From&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00059">envelope.h:59</a></div></div>
</div><!-- fragment --><div id="dynsection-7" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a896502d4448fefadaf8786a4f2d5556e_cgraph.svg" width="715" height="1642"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-8" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a896502d4448fefadaf8786a4f2d5556e_icgraph.svg" width="499" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a345fb1ff241b3fc778632947c2b08d37" name="a345fb1ff241b3fc778632947c2b08d37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a345fb1ff241b3fc778632947c2b08d37">&#9670;&#160;</a></span>mutt_is_multipart_signed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_multipart_signed </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is a message signed? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> is signed, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT.">SecurityFlags</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> is not signed (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set.">SEC_NO_FLAGS</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00409">409</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  410</span>{</div>
<div class="line"><span class="lineno">  411</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> || !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;signed&quot;</span>))</div>
<div class="line"><span class="lineno">  412</span>  {</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  414</span>  }</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>  <span class="keywordtype">char</span> *p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protocol&quot;</span>);</div>
<div class="line"><span class="lineno">  417</span>  <span class="keywordflow">if</span> (!p)</div>
<div class="line"><span class="lineno">  418</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;multipart/mixed&quot;</span>))</div>
<div class="line"><span class="lineno">  421</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>;</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;application/pgp-signature&quot;</span>))</div>
<div class="line"><span class="lineno">  424</span>  {</div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>;</div>
<div class="line"><span class="lineno">  426</span>  }</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp;</div>
<div class="line"><span class="lineno">  429</span>      (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;application/x-pkcs7-signature&quot;</span>) ||</div>
<div class="line"><span class="lineno">  430</span>       <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;application/pkcs7-signature&quot;</span>)))</div>
<div class="line"><span class="lineno">  431</span>  {</div>
<div class="line"><span class="lineno">  432</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a>;</div>
<div class="line"><span class="lineno">  433</span>  }</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  436</span>}</div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a></div><div class="ttdeci">@ TYPE_MULTIPART</div><div class="ttdoc">Type: &#39;multipart/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00037">mime.h:37</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a14f75a650c49341776276f44881d54b2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a></div><div class="ttdeci">#define PGP_SIGN</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00103">lib.h:103</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a67114d960e61fc36c467f4bf08d37335"><div class="ttname"><a href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a></div><div class="ttdeci">#define SMIME_SIGN</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00109">lib.h:109</a></div></div>
</div><!-- fragment --><div id="dynsection-9" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a345fb1ff241b3fc778632947c2b08d37_cgraph.svg" width="524" height="66"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-10" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a345fb1ff241b3fc778632947c2b08d37_icgraph.svg" width="428" height="495"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a832e4b9f5a0e463876a3d8cfe852f12d" name="a832e4b9f5a0e463876a3d8cfe852f12d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a832e4b9f5a0e463876a3d8cfe852f12d">&#9670;&#160;</a></span>mutt_is_multipart_encrypted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_multipart_encrypted </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the message have encrypted parts? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> has got encrypted parts, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT.">SecurityFlags</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> hasn't got encrypted parts (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set.">SEC_NO_FLAGS</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00444">444</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  445</span>{</div>
<div class="line"><span class="lineno">  446</span>  <span class="keywordflow">if</span> ((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) == 0)</div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>  <span class="keywordtype">char</span> *p = NULL;</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div>
<div class="line"><span class="lineno">  452</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;encrypted&quot;</span>) ||</div>
<div class="line"><span class="lineno">  453</span>      !(p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protocol&quot;</span>)) ||</div>
<div class="line"><span class="lineno">  454</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;application/pgp-encrypted&quot;</span>))</div>
<div class="line"><span class="lineno">  455</span>  {</div>
<div class="line"><span class="lineno">  456</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  457</span>  }</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  460</span>}</div>
<div class="ttc" id="ancrypt_2lib_8h_html_a6694d25dff1ee1958351160a84bb2dc0"><div class="ttname"><a href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a></div><div class="ttdeci">#define PGP_ENCRYPT</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00102">lib.h:102</a></div></div>
</div><!-- fragment --><div id="dynsection-11" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a832e4b9f5a0e463876a3d8cfe852f12d_cgraph.svg" width="547" height="66"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-12" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a832e4b9f5a0e463876a3d8cfe852f12d_icgraph.svg" width="466" height="451"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a51806f872069460bb7f4fa16d1d92710" name="a51806f872069460bb7f4fa16d1d92710"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51806f872069460bb7f4fa16d1d92710">&#9670;&#160;</a></span>mutt_is_valid_multipart_pgp_encrypted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_is_valid_multipart_pgp_encrypted </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is this a valid multi-part encrypted message? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> is valid, with encrypted parts, e.g. <a class="el" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> hasn't got encrypted parts </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00468">468</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  469</span>{</div>
<div class="line"><span class="lineno">  470</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a>(b) == <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>)</div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>  b = b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno">  474</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div>
<div class="line"><span class="lineno">  475</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-encrypted&quot;</span>))</div>
<div class="line"><span class="lineno">  476</span>  {</div>
<div class="line"><span class="lineno">  477</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  478</span>  }</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>  b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno">  481</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div>
<div class="line"><span class="lineno">  482</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;octet-stream&quot;</span>))</div>
<div class="line"><span class="lineno">  483</span>  {</div>
<div class="line"><span class="lineno">  484</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  485</span>  }</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  488</span>}</div>
<div class="ttc" id="acrypt_8c_html_a832e4b9f5a0e463876a3d8cfe852f12d"><div class="ttname"><a href="#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a></div><div class="ttdeci">SecurityFlags mutt_is_multipart_encrypted(struct Body *b)</div><div class="ttdoc">Does the message have encrypted parts?</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l00444">crypt.c:444</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdeci">@ TYPE_APPLICATION</div><div class="ttdoc">Type: &#39;application/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
</div><!-- fragment --><div id="dynsection-13" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a51806f872069460bb7f4fa16d1d92710_cgraph.svg" width="587" height="76"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-14" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a51806f872069460bb7f4fa16d1d92710_icgraph.svg" width="415" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a9edb0262eaed7c522977a75b76c15770" name="a9edb0262eaed7c522977a75b76c15770"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9edb0262eaed7c522977a75b76c15770">&#9670;&#160;</a></span>mutt_is_malformed_multipart_pgp_encrypted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_malformed_multipart_pgp_encrypted </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for malformed layout. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>Success, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT.">SecurityFlags</a> </td></tr>
    <tr><td class="paramname">0</td><td>Error, (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set.">SEC_NO_FLAGS</a>)</td></tr>
  </table>
  </dd>
</dl>
<p>This checks for the malformed layout caused by MS Exchange in some cases: </p><div class="fragment"><div class="line">&lt;multipart/mixed&gt;</div>
<div class="line">   &lt;text/plain&gt;</div>
<div class="line">   &lt;application/pgp-encrypted&gt; [BASE64-encoded]</div>
<div class="line">   &lt;application/octet-stream&gt; [BASE64-encoded]</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00505">505</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  506</span>{</div>
<div class="line"><span class="lineno">  507</span>  <span class="keywordflow">if</span> (!(<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  508</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> || !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;mixed&quot;</span>))</div>
<div class="line"><span class="lineno">  511</span>  {</div>
<div class="line"><span class="lineno">  512</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  513</span>  }</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>  b = b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno">  516</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div>
<div class="line"><span class="lineno">  517</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;plain&quot;</span>) || (b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> != 0))</div>
<div class="line"><span class="lineno">  518</span>  {</div>
<div class="line"><span class="lineno">  519</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  520</span>  }</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>  b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno">  523</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div>
<div class="line"><span class="lineno">  524</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-encrypted&quot;</span>))</div>
<div class="line"><span class="lineno">  525</span>  {</div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  527</span>  }</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>  b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno">  530</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div>
<div class="line"><span class="lineno">  531</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;octet-stream&quot;</span>))</div>
<div class="line"><span class="lineno">  532</span>  {</div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  534</span>  }</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>  b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno">  537</span>  <span class="keywordflow">if</span> (b)</div>
<div class="line"><span class="lineno">  538</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  541</span>}</div>
<div class="ttc" id="astructBody_html_a6f92d7ec8568ca04ae07931c56dd0790"><div class="ttname"><a href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">Body::length</a></div><div class="ttdeci">LOFF_T length</div><div class="ttdoc">length (in bytes) of attachment</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00053">body.h:53</a></div></div>
</div><!-- fragment --><div id="dynsection-15" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a9edb0262eaed7c522977a75b76c15770_cgraph.svg" width="380" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-16" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a9edb0262eaed7c522977a75b76c15770_icgraph.svg" width="471" height="355"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad5ae8b8d4fea0b6aa61dc38312e99d15" name="ad5ae8b8d4fea0b6aa61dc38312e99d15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5ae8b8d4fea0b6aa61dc38312e99d15">&#9670;&#160;</a></span>mutt_is_application_pgp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_application_pgp </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the message use PGP? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> uses PGP, e.g. <a class="el" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> doesn't use PGP, (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set.">SEC_NO_FLAGS</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00549">549</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  550</span>{</div>
<div class="line"><span class="lineno">  551</span>  <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> t = <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  552</span>  <span class="keywordtype">char</span> *p = NULL;</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>  <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>)</div>
<div class="line"><span class="lineno">  555</span>  {</div>
<div class="line"><span class="lineno">  556</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp&quot;</span>) || <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;x-pgp-message&quot;</span>))</div>
<div class="line"><span class="lineno">  557</span>    {</div>
<div class="line"><span class="lineno">  558</span>      p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;x-action&quot;</span>);</div>
<div class="line"><span class="lineno">  559</span>      <span class="keywordflow">if</span> (p &amp;&amp; (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;sign&quot;</span>) || <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;signclear&quot;</span>)))</div>
<div class="line"><span class="lineno">  560</span>      {</div>
<div class="line"><span class="lineno">  561</span>        t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>;</div>
<div class="line"><span class="lineno">  562</span>      }</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>      p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;format&quot;</span>);</div>
<div class="line"><span class="lineno">  565</span>      <span class="keywordflow">if</span> (p &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;keys-only&quot;</span>))</div>
<div class="line"><span class="lineno">  566</span>      {</div>
<div class="line"><span class="lineno">  567</span>        t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a>;</div>
<div class="line"><span class="lineno">  568</span>      }</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>      <span class="keywordflow">if</span> (t == <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>)</div>
<div class="line"><span class="lineno">  571</span>        t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>; <span class="comment">/* not necessarily correct, but... */</span></div>
<div class="line"><span class="lineno">  572</span>    }</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-signed&quot;</span>))</div>
<div class="line"><span class="lineno">  575</span>      t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>;</div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-keys&quot;</span>))</div>
<div class="line"><span class="lineno">  578</span>      t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a>;</div>
<div class="line"><span class="lineno">  579</span>  }</div>
<div class="line"><span class="lineno">  580</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;plain&quot;</span>, b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>))</div>
<div class="line"><span class="lineno">  581</span>  {</div>
<div class="line"><span class="lineno">  582</span>    <span class="keywordflow">if</span> (((p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;x-mutt-action&quot;</span>)) ||</div>
<div class="line"><span class="lineno">  583</span>         (p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;x-action&quot;</span>)) ||</div>
<div class="line"><span class="lineno">  584</span>         (p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;action&quot;</span>))) &amp;&amp;</div>
<div class="line"><span class="lineno">  585</span>        <a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(p, <span class="stringliteral">&quot;pgp-sign&quot;</span>))</div>
<div class="line"><span class="lineno">  586</span>    {</div>
<div class="line"><span class="lineno">  587</span>      t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>;</div>
<div class="line"><span class="lineno">  588</span>    }</div>
<div class="line"><span class="lineno">  589</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(p, <span class="stringliteral">&quot;pgp-encrypt&quot;</span>))</div>
<div class="line"><span class="lineno">  590</span>    {</div>
<div class="line"><span class="lineno">  591</span>      t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  592</span>    }</div>
<div class="line"><span class="lineno">  593</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(p, <span class="stringliteral">&quot;pgp-keys&quot;</span>))</div>
<div class="line"><span class="lineno">  594</span>    {</div>
<div class="line"><span class="lineno">  595</span>      t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a>;</div>
<div class="line"><span class="lineno">  596</span>    }</div>
<div class="line"><span class="lineno">  597</span>  }</div>
<div class="line"><span class="lineno">  598</span>  <span class="keywordflow">if</span> (t)</div>
<div class="line"><span class="lineno">  599</span>    t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a>;</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>  <span class="keywordflow">return</span> t;</div>
<div class="line"><span class="lineno">  602</span>}</div>
<div class="ttc" id="amutt_2string_8c_html_aebd2a8a3f8a30062c31fa1474d87cc41"><div class="ttname"><a href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a></div><div class="ttdeci">size_t mutt_istr_startswith(const char *str, const char *prefix)</div><div class="ttdoc">Check whether a string starts with a prefix, ignoring case.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00244">string.c:244</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_abd2087cae2885c199218f5530ce7945b"><div class="ttname"><a href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a></div><div class="ttdeci">#define PGP_KEY</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00105">lib.h:105</a></div></div>
</div><!-- fragment --><div id="dynsection-17" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_ad5ae8b8d4fea0b6aa61dc38312e99d15_cgraph.svg" width="538" height="111"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-18" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_ad5ae8b8d4fea0b6aa61dc38312e99d15_icgraph.svg" width="855" height="718"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a4073ce5b5fcec6e245dbfa9369016b8e" name="a4073ce5b5fcec6e245dbfa9369016b8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4073ce5b5fcec6e245dbfa9369016b8e">&#9670;&#160;</a></span>mutt_is_application_smime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_application_smime </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the message use S/MIME? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> uses S/MIME, e.g. <a class="el" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> doesn't use S/MIME, (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set.">SEC_NO_FLAGS</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00610">610</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  611</span>{</div>
<div class="line"><span class="lineno">  612</span>  <span class="keywordflow">if</span> (!b)</div>
<div class="line"><span class="lineno">  613</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>  <span class="keywordflow">if</span> (((b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> &amp; <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) == 0) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>)</div>
<div class="line"><span class="lineno">  616</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>  <span class="keywordtype">char</span> *t = NULL;</div>
<div class="line"><span class="lineno">  619</span>  <span class="keywordtype">bool</span> complain = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  620</span>  <span class="comment">/* S/MIME MIME types don&#39;t need x- anymore, see RFC2311 */</span></div>
<div class="line"><span class="lineno">  621</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;x-pkcs7-mime&quot;</span>) || <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pkcs7-mime&quot;</span>))</div>
<div class="line"><span class="lineno">  622</span>  {</div>
<div class="line"><span class="lineno">  623</span>    t = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;smime-type&quot;</span>);</div>
<div class="line"><span class="lineno">  624</span>    <span class="keywordflow">if</span> (t)</div>
<div class="line"><span class="lineno">  625</span>    {</div>
<div class="line"><span class="lineno">  626</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(t, <span class="stringliteral">&quot;enveloped-data&quot;</span>))</div>
<div class="line"><span class="lineno">  627</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  628</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(t, <span class="stringliteral">&quot;signed-data&quot;</span>))</div>
<div class="line"><span class="lineno">  629</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a>;</div>
<div class="line"><span class="lineno">  630</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  631</span>    }</div>
<div class="line"><span class="lineno">  632</span>    <span class="comment">/* Netscape 4.7 uses</span></div>
<div class="line"><span class="lineno">  633</span><span class="comment">     * Content-Description: S/MIME Encrypted Message</span></div>
<div class="line"><span class="lineno">  634</span><span class="comment">     * instead of Content-Type parameter */</span></div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>, <span class="stringliteral">&quot;S/MIME Encrypted Message&quot;</span>))</div>
<div class="line"><span class="lineno">  636</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  637</span>    complain = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  638</span>  }</div>
<div class="line"><span class="lineno">  639</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;octet-stream&quot;</span>))</div>
<div class="line"><span class="lineno">  640</span>  {</div>
<div class="line"><span class="lineno">  641</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  642</span>  }</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>  t = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;name&quot;</span>);</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>  <span class="keywordflow">if</span> (!t)</div>
<div class="line"><span class="lineno">  647</span>    t = b-&gt;<a class="code hl_variable" href="structBody.html#a0a77f105609a64f37c359b9c81d1f263">d_filename</a>;</div>
<div class="line"><span class="lineno">  648</span>  <span class="keywordflow">if</span> (!t)</div>
<div class="line"><span class="lineno">  649</span>    t = b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>;</div>
<div class="line"><span class="lineno">  650</span>  <span class="keywordflow">if</span> (!t)</div>
<div class="line"><span class="lineno">  651</span>  {</div>
<div class="line"><span class="lineno">  652</span>    <span class="keywordflow">if</span> (complain)</div>
<div class="line"><span class="lineno">  653</span>    {</div>
<div class="line"><span class="lineno">  654</span>      <a class="code hl_define" href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;S/MIME messages with no hints on content are unsupported&quot;</span>));</div>
<div class="line"><span class="lineno">  655</span>    }</div>
<div class="line"><span class="lineno">  656</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  657</span>  }</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>  <span class="comment">/* no .p7c, .p10 support yet. */</span></div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>  <span class="keywordtype">int</span> len = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(t) - 4;</div>
<div class="line"><span class="lineno">  662</span>  <span class="keywordflow">if</span> ((len &gt; 0) &amp;&amp; (*(t + len) == <span class="charliteral">&#39;.&#39;</span>))</div>
<div class="line"><span class="lineno">  663</span>  {</div>
<div class="line"><span class="lineno">  664</span>    len++;</div>
<div class="line"><span class="lineno">  665</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>((t + len), <span class="stringliteral">&quot;p7m&quot;</span>))</div>
<div class="line"><span class="lineno">  666</span>    {</div>
<div class="line"><span class="lineno">  667</span>      <span class="comment">/* Not sure if this is the correct thing to do, but</span></div>
<div class="line"><span class="lineno">  668</span><span class="comment">       * it&#39;s required for compatibility with Outlook */</span></div>
<div class="line"><span class="lineno">  669</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a>;</div>
<div class="line"><span class="lineno">  670</span>    }</div>
<div class="line"><span class="lineno">  671</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>((t + len), <span class="stringliteral">&quot;p7s&quot;</span>))</div>
<div class="line"><span class="lineno">  672</span>    {</div>
<div class="line"><span class="lineno">  673</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a>;</div>
<div class="line"><span class="lineno">  674</span>    }</div>
<div class="line"><span class="lineno">  675</span>  }</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  678</span>}</div>
<div class="ttc" id="amutt_2string_8c_html_acca6786b903b22a5924219f9db96e10d"><div class="ttname"><a href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a></div><div class="ttdeci">size_t mutt_str_len(const char *a)</div><div class="ttdoc">Calculate the length of a string, safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00498">string.c:498</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a9c811504abf735623a6dd3ac20287f30"><div class="ttname"><a href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a></div><div class="ttdeci">#define SMIME_OPAQUE</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00112">lib.h:112</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_ac25eb5415ebf34da68c39a3d4e3bc9ad"><div class="ttname"><a href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a></div><div class="ttdeci">#define SMIME_ENCRYPT</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00108">lib.h:108</a></div></div>
<div class="ttc" id="astructBody_html_a0a77f105609a64f37c359b9c81d1f263"><div class="ttname"><a href="structBody.html#a0a77f105609a64f37c359b9c81d1f263">Body::d_filename</a></div><div class="ttdeci">char * d_filename</div><div class="ttdoc">filename to be used for the content-disposition header If NULL, filename is used instead.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00056">body.h:56</a></div></div>
<div class="ttc" id="astructBody_html_a90db5151872e23e56a8f31d68925c121"><div class="ttname"><a href="structBody.html#a90db5151872e23e56a8f31d68925c121">Body::description</a></div><div class="ttdeci">char * description</div><div class="ttdoc">content-description</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00055">body.h:55</a></div></div>
<div class="ttc" id="astructBody_html_afe3cd2c4b1070e3d0edbf1fed939ac5a"><div class="ttname"><a href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">Body::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">When sending a message, this is the file to which this structure refers.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00059">body.h:59</a></div></div>
</div><!-- fragment --><div id="dynsection-19" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a4073ce5b5fcec6e245dbfa9369016b8e_cgraph.svg" width="486" height="119"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-20" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a4073ce5b5fcec6e245dbfa9369016b8e_icgraph.svg" width="844" height="754"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af4ab2e337a2477fba687b1f710aa7a61" name="af4ab2e337a2477fba687b1f710aa7a61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4ab2e337a2477fba687b1f710aa7a61">&#9670;&#160;</a></span>crypt_query()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> crypt_query </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check out the type of encryption used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>Flags, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT.">SecurityFlags</a> </td></tr>
    <tr><td class="paramname">0</td><td>Error (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set.">SEC_NO_FLAGS</a>)</td></tr>
  </table>
  </dd>
</dl>
<p>Set the cached status values if there are any. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00688">688</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  689</span>{</div>
<div class="line"><span class="lineno">  690</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> || !b)</div>
<div class="line"><span class="lineno">  691</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>  <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> rc = <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>  <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>)</div>
<div class="line"><span class="lineno">  696</span>  {</div>
<div class="line"><span class="lineno">  697</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div>
<div class="line"><span class="lineno">  698</span>      rc |= <a class="code hl_function" href="#ad5ae8b8d4fea0b6aa61dc38312e99d15">mutt_is_application_pgp</a>(b);</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</div>
<div class="line"><span class="lineno">  701</span>    {</div>
<div class="line"><span class="lineno">  702</span>      rc |= <a class="code hl_function" href="#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a>(b);</div>
<div class="line"><span class="lineno">  703</span>      <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a>)</div>
<div class="line"><span class="lineno">  704</span>        rc |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>;</div>
<div class="line"><span class="lineno">  705</span>      <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#a4de063a5f09cb7376f9fde6bb0fe48bc">badsig</a>)</div>
<div class="line"><span class="lineno">  706</span>        rc |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">SEC_BADSIGN</a>;</div>
<div class="line"><span class="lineno">  707</span>    }</div>
<div class="line"><span class="lineno">  708</span>  }</div>
<div class="line"><span class="lineno">  709</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>))</div>
<div class="line"><span class="lineno">  710</span>  {</div>
<div class="line"><span class="lineno">  711</span>    rc |= <a class="code hl_function" href="#ad5ae8b8d4fea0b6aa61dc38312e99d15">mutt_is_application_pgp</a>(b);</div>
<div class="line"><span class="lineno">  712</span>    <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a>)</div>
<div class="line"><span class="lineno">  713</span>      rc |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>;</div>
<div class="line"><span class="lineno">  714</span>  }</div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>  <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>)</div>
<div class="line"><span class="lineno">  717</span>  {</div>
<div class="line"><span class="lineno">  718</span>    rc |= <a class="code hl_function" href="#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a>(b);</div>
<div class="line"><span class="lineno">  719</span>    rc |= <a class="code hl_function" href="#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a>(b);</div>
<div class="line"><span class="lineno">  720</span>    rc |= <a class="code hl_function" href="#a9edb0262eaed7c522977a75b76c15770">mutt_is_malformed_multipart_pgp_encrypted</a>(b);</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>    <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a>)</div>
<div class="line"><span class="lineno">  723</span>      rc |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>;</div>
<div class="line"><span class="lineno">  724</span><span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div>
<div class="line"><span class="lineno">  725</span>    <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">is_autocrypt</a>)</div>
<div class="line"><span class="lineno">  726</span>      rc |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>;</div>
<div class="line"><span class="lineno">  727</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  728</span>  }</div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span>  <span class="keywordflow">if</span> ((b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a>))</div>
<div class="line"><span class="lineno">  731</span>  {</div>
<div class="line"><span class="lineno">  732</span>    <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> u = b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> ? <a class="code hl_define" href="ncrypt_2lib_8h.html#a3eec0b09486fe4bfe7613f808f768747">SEC_ALL_FLAGS</a> : <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>; <span class="comment">/* Bits set in all parts */</span></div>
<div class="line"><span class="lineno">  733</span>    <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> w = <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>; <span class="comment">/* Bits set in any part  */</span></div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>    <span class="keywordflow">for</span> (b = b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>; b; b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>)</div>
<div class="line"><span class="lineno">  736</span>    {</div>
<div class="line"><span class="lineno">  737</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> v = <a class="code hl_function" href="#af4ab2e337a2477fba687b1f710aa7a61">crypt_query</a>(b);</div>
<div class="line"><span class="lineno">  738</span>      u &amp;= v;</div>
<div class="line"><span class="lineno">  739</span>      w |= v;</div>
<div class="line"><span class="lineno">  740</span>    }</div>
<div class="line"><span class="lineno">  741</span>    rc |= u | (w &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">~SEC_GOODSIGN</a>);</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>    <span class="keywordflow">if</span> ((w &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>) &amp;&amp; !(u &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>))</div>
<div class="line"><span class="lineno">  744</span>      rc |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a9b0f8af6da383f08d29eb97fac836e3f">SEC_PARTSIGN</a>;</div>
<div class="line"><span class="lineno">  745</span>  }</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  748</span>}</div>
<div class="ttc" id="acrypt_8c_html_a345fb1ff241b3fc778632947c2b08d37"><div class="ttname"><a href="#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a></div><div class="ttdeci">SecurityFlags mutt_is_multipart_signed(struct Body *b)</div><div class="ttdoc">Is a message signed?</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l00409">crypt.c:409</a></div></div>
<div class="ttc" id="acrypt_8c_html_a4073ce5b5fcec6e245dbfa9369016b8e"><div class="ttname"><a href="#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a></div><div class="ttdeci">SecurityFlags mutt_is_application_smime(struct Body *b)</div><div class="ttdoc">Does the message use S/MIME?</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l00610">crypt.c:610</a></div></div>
<div class="ttc" id="acrypt_8c_html_a9edb0262eaed7c522977a75b76c15770"><div class="ttname"><a href="#a9edb0262eaed7c522977a75b76c15770">mutt_is_malformed_multipart_pgp_encrypted</a></div><div class="ttdeci">SecurityFlags mutt_is_malformed_multipart_pgp_encrypted(struct Body *b)</div><div class="ttdoc">Check for malformed layout.</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l00505">crypt.c:505</a></div></div>
<div class="ttc" id="acrypt_8c_html_ad5ae8b8d4fea0b6aa61dc38312e99d15"><div class="ttname"><a href="#ad5ae8b8d4fea0b6aa61dc38312e99d15">mutt_is_application_pgp</a></div><div class="ttdeci">SecurityFlags mutt_is_application_pgp(const struct Body *b)</div><div class="ttdoc">Does the message use PGP?</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l00549">crypt.c:549</a></div></div>
<div class="ttc" id="acrypt_8c_html_af4ab2e337a2477fba687b1f710aa7a61"><div class="ttname"><a href="#af4ab2e337a2477fba687b1f710aa7a61">crypt_query</a></div><div class="ttdeci">SecurityFlags crypt_query(struct Body *b)</div><div class="ttdoc">Check out the type of encryption used.</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l00688">crypt.c:688</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a></div><div class="ttdeci">@ TYPE_MESSAGE</div><div class="ttdoc">Type: &#39;message/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00035">mime.h:35</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a3eec0b09486fe4bfe7613f808f768747"><div class="ttname"><a href="ncrypt_2lib_8h.html#a3eec0b09486fe4bfe7613f808f768747">SEC_ALL_FLAGS</a></div><div class="ttdeci">#define SEC_ALL_FLAGS</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00100">lib.h:100</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a427cda1ba4b173fa708e124afe7b907a"><div class="ttname"><a href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a></div><div class="ttdeci">#define SEC_GOODSIGN</div><div class="ttdoc">Email has a valid signature.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00086">lib.h:86</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a70ffca3c8f9bc49498e3352294c5b8fd"><div class="ttname"><a href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">SEC_BADSIGN</a></div><div class="ttdeci">#define SEC_BADSIGN</div><div class="ttdoc">Email has a bad signature.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a9b0f8af6da383f08d29eb97fac836e3f"><div class="ttname"><a href="ncrypt_2lib_8h.html#a9b0f8af6da383f08d29eb97fac836e3f">SEC_PARTSIGN</a></div><div class="ttdeci">#define SEC_PARTSIGN</div><div class="ttdoc">Not all parts of the email is signed.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="astructBody_html_a4de063a5f09cb7376f9fde6bb0fe48bc"><div class="ttname"><a href="structBody.html#a4de063a5f09cb7376f9fde6bb0fe48bc">Body::badsig</a></div><div class="ttdeci">bool badsig</div><div class="ttdoc">Bad cryptographic signature (needed to check encrypted s/mime-signatures)</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00043">body.h:43</a></div></div>
<div class="ttc" id="astructBody_html_a63e1a4c2a0bacf3d1d5869edfebed0dd"><div class="ttname"><a href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">Body::is_autocrypt</a></div><div class="ttdeci">bool is_autocrypt</div><div class="ttdoc">Flag autocrypt-decrypted messages for replying.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00050">body.h:50</a></div></div>
<div class="ttc" id="astructBody_html_ae4b2706a5c4601ae1497a96e047d8f5e"><div class="ttname"><a href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">Body::goodsig</a></div><div class="ttdeci">bool goodsig</div><div class="ttdoc">Good cryptographic signature.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00045">body.h:45</a></div></div>
</div><!-- fragment --><div id="dynsection-21" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_af4ab2e337a2477fba687b1f710aa7a61_cgraph.svg" width="360" height="292"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-22" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_af4ab2e337a2477fba687b1f710aa7a61_icgraph.svg" width="552" height="406"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab3dde2a67c95a70df3d498215427863b" name="ab3dde2a67c95a70df3d498215427863b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3dde2a67c95a70df3d498215427863b">&#9670;&#160;</a></span>crypt_write_signed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_write_signed </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>tempfile</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write the message body/part. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> to write </td></tr>
    <tr><td class="paramname">state</td><td><a class="el" href="structState.html" title="Keep track when processing files.">State</a> to use </td></tr>
    <tr><td class="paramname">tempfile</td><td>File to write to </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error</td></tr>
  </table>
  </dd>
</dl>
<p>Body/part A described by state state to the given TEMPFILE. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00760">760</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  761</span>{</div>
<div class="line"><span class="lineno">  762</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno">  763</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>  FILE *fp = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(tempfile, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">  766</span>  <span class="keywordflow">if</span> (!fp)</div>
<div class="line"><span class="lineno">  767</span>  {</div>
<div class="line"><span class="lineno">  768</span>    <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;%s&quot;</span>, tempfile);</div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  770</span>  }</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, b-&gt;<a class="code hl_variable" href="structBody.html#ae6ebb9758689003ed9ae055272420dd9">hdr_offset</a>, SEEK_SET))</div>
<div class="line"><span class="lineno">  773</span>  {</div>
<div class="line"><span class="lineno">  774</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp);</div>
<div class="line"><span class="lineno">  775</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  776</span>  }</div>
<div class="line"><span class="lineno">  777</span>  <span class="keywordtype">size_t</span> bytes = b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> + b-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a> - b-&gt;<a class="code hl_variable" href="structBody.html#ae6ebb9758689003ed9ae055272420dd9">hdr_offset</a>;</div>
<div class="line"><span class="lineno">  778</span>  <span class="keywordtype">bool</span> hadcr = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  779</span>  <span class="keywordflow">while</span> (bytes &gt; 0)</div>
<div class="line"><span class="lineno">  780</span>  {</div>
<div class="line"><span class="lineno">  781</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> c = fgetc(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>);</div>
<div class="line"><span class="lineno">  782</span>    <span class="keywordflow">if</span> (c == EOF)</div>
<div class="line"><span class="lineno">  783</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  784</span> </div>
<div class="line"><span class="lineno">  785</span>    bytes--;</div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>    <span class="keywordflow">if</span> (c == <span class="charliteral">&#39;\r&#39;</span>)</div>
<div class="line"><span class="lineno">  788</span>    {</div>
<div class="line"><span class="lineno">  789</span>      hadcr = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  790</span>    }</div>
<div class="line"><span class="lineno">  791</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  792</span>    {</div>
<div class="line"><span class="lineno">  793</span>      <span class="keywordflow">if</span> ((c == <span class="charliteral">&#39;\n&#39;</span>) &amp;&amp; !hadcr)</div>
<div class="line"><span class="lineno">  794</span>        fputc(<span class="charliteral">&#39;\r&#39;</span>, fp);</div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>      hadcr = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  797</span>    }</div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span>    fputc(c, fp);</div>
<div class="line"><span class="lineno">  800</span>  }</div>
<div class="line"><span class="lineno">  801</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp);</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  804</span>}</div>
<div class="ttc" id="afile_8c_html_a6b60cb2044041374689e6e6641c5cc05"><div class="ttname"><a href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a></div><div class="ttdeci">bool mutt_file_seek(FILE *fp, LOFF_T offset, int whence)</div><div class="ttdoc">Wrapper for fseeko with error handling.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00655">file.c:655</a></div></div>
<div class="ttc" id="afile_8h_html_a9b519e795f098be88b93cd72c49a35ec"><div class="ttname"><a href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a></div><div class="ttdeci">#define mutt_file_fclose(FP)</div><div class="ttdef"><b>Definition</b> <a href="file_8h_source.html#l00139">file.h:139</a></div></div>
<div class="ttc" id="afile_8h_html_a9fa358d76519cb6bc8ffca5850976d46"><div class="ttname"><a href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a></div><div class="ttdeci">#define mutt_file_fopen(PATH, MODE)</div><div class="ttdef"><b>Definition</b> <a href="file_8h_source.html#l00138">file.h:138</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gafaa521ab22db877ccf1b87e679e1b43e"><div class="ttname"><a href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a></div><div class="ttdeci">#define mutt_perror(...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00094">logging2.h:94</a></div></div>
<div class="ttc" id="astructBody_html_a1969dfeb0a155ccb16153fe777a103b0"><div class="ttname"><a href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">Body::offset</a></div><div class="ttdeci">LOFF_T offset</div><div class="ttdoc">offset where the actual data begins</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00052">body.h:52</a></div></div>
<div class="ttc" id="astructBody_html_ae6ebb9758689003ed9ae055272420dd9"><div class="ttname"><a href="structBody.html#ae6ebb9758689003ed9ae055272420dd9">Body::hdr_offset</a></div><div class="ttdeci">long hdr_offset</div><div class="ttdoc">Offset in stream where the headers begin.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00081">body.h:81</a></div></div>
<div class="ttc" id="astructState_html_a9cf7e1f0c5c12399def5ca38b13054ae"><div class="ttname"><a href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">State::fp_in</a></div><div class="ttdeci">FILE * fp_in</div><div class="ttdoc">File to read from.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00049">state.h:49</a></div></div>
</div><!-- fragment --><div id="dynsection-23" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_ab3dde2a67c95a70df3d498215427863b_cgraph.svg" width="308" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-24" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_ab3dde2a67c95a70df3d498215427863b_icgraph.svg" width="350" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac8f7e9a0aff78e25866f228aca6862bd" name="ac8f7e9a0aff78e25866f228aca6862bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8f7e9a0aff78e25866f228aca6862bd">&#9670;&#160;</a></span>crypt_convert_to_7bit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_convert_to_7bit </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert an email to 7bit encoding. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email to convert </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00810">810</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  811</span>{</div>
<div class="line"><span class="lineno">  812</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno">  813</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_strict_enc = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_strict_enc&quot;</span>);</div>
<div class="line"><span class="lineno">  816</span>  <span class="keywordflow">while</span> (b)</div>
<div class="line"><span class="lineno">  817</span>  {</div>
<div class="line"><span class="lineno">  818</span>    <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>)</div>
<div class="line"><span class="lineno">  819</span>    {</div>
<div class="line"><span class="lineno">  820</span>      <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> != <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e">ENC_7BIT</a>)</div>
<div class="line"><span class="lineno">  821</span>      {</div>
<div class="line"><span class="lineno">  822</span>        b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e">ENC_7BIT</a>;</div>
<div class="line"><span class="lineno">  823</span>        <a class="code hl_function" href="#ac8f7e9a0aff78e25866f228aca6862bd">crypt_convert_to_7bit</a>(b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>);</div>
<div class="line"><span class="lineno">  824</span>      }</div>
<div class="line"><span class="lineno">  825</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; c_pgp_strict_enc)</div>
<div class="line"><span class="lineno">  826</span>      {</div>
<div class="line"><span class="lineno">  827</span>        <a class="code hl_function" href="#ac8f7e9a0aff78e25866f228aca6862bd">crypt_convert_to_7bit</a>(b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>);</div>
<div class="line"><span class="lineno">  828</span>      }</div>
<div class="line"><span class="lineno">  829</span>    }</div>
<div class="line"><span class="lineno">  830</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a>) &amp;&amp; !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;delivery-status&quot;</span>))</div>
<div class="line"><span class="lineno">  831</span>    {</div>
<div class="line"><span class="lineno">  832</span>      <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> != <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e">ENC_7BIT</a>)</div>
<div class="line"><span class="lineno">  833</span>        <a class="code hl_function" href="sendlib_8c.html#acecf90d13694e354e0b964ea51532a88">mutt_message_to_7bit</a>(b, NULL, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno">  834</span>    }</div>
<div class="line"><span class="lineno">  835</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466">ENC_8BIT</a>)</div>
<div class="line"><span class="lineno">  836</span>    {</div>
<div class="line"><span class="lineno">  837</span>      b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a>;</div>
<div class="line"><span class="lineno">  838</span>    }</div>
<div class="line"><span class="lineno">  839</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> == <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a33a486b063e032293f7615de05f3cfa8">ENC_BINARY</a>)</div>
<div class="line"><span class="lineno">  840</span>    {</div>
<div class="line"><span class="lineno">  841</span>      b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a>;</div>
<div class="line"><span class="lineno">  842</span>    }</div>
<div class="line"><span class="lineno">  843</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#aa1d39136ca054e465e875b8ab9b99565">content</a> &amp;&amp; (b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> != <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  844</span>             (b-&gt;<a class="code hl_variable" href="structBody.html#aa1d39136ca054e465e875b8ab9b99565">content</a>-&gt;<a class="code hl_variable" href="structContent.html#ab0f45d80059bca9d8e33663866f641d0">from</a> || (b-&gt;<a class="code hl_variable" href="structBody.html#aa1d39136ca054e465e875b8ab9b99565">content</a>-&gt;<a class="code hl_variable" href="structContent.html#a63dbba7efe98fef1797b0643b346be32">space</a> &amp;&amp; c_pgp_strict_enc)))</div>
<div class="line"><span class="lineno">  845</span>    {</div>
<div class="line"><span class="lineno">  846</span>      b-&gt;<a class="code hl_variable" href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">encoding</a> = <a class="code hl_enumvalue" href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a>;</div>
<div class="line"><span class="lineno">  847</span>    }</div>
<div class="line"><span class="lineno">  848</span>    b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno">  849</span>  }</div>
<div class="line"><span class="lineno">  850</span>}</div>
<div class="ttc" id="acrypt_8c_html_ac8f7e9a0aff78e25866f228aca6862bd"><div class="ttname"><a href="#ac8f7e9a0aff78e25866f228aca6862bd">crypt_convert_to_7bit</a></div><div class="ttdeci">void crypt_convert_to_7bit(struct Body *b)</div><div class="ttdoc">Convert an email to 7bit encoding.</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l00810">crypt.c:810</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a0bc13f416d890a95b7d7e7c77b155f8e">ENC_7BIT</a></div><div class="ttdeci">@ ENC_7BIT</div><div class="ttdoc">7-bit text</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00049">mime.h:49</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a33a486b063e032293f7615de05f3cfa8"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a33a486b063e032293f7615de05f3cfa8">ENC_BINARY</a></div><div class="ttdeci">@ ENC_BINARY</div><div class="ttdoc">Binary.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00053">mime.h:53</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a5c90b21fa3f41a7c98c862cb39d4370d">ENC_BASE64</a></div><div class="ttdeci">@ ENC_BASE64</div><div class="ttdoc">Base-64 encoded text.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00052">mime.h:52</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61a7c05065f79f9ed33904677a211ec3466">ENC_8BIT</a></div><div class="ttdeci">@ ENC_8BIT</div><div class="ttdoc">8-bit text</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00050">mime.h:50</a></div></div>
<div class="ttc" id="amime_8h_html_a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded"><div class="ttname"><a href="mime_8h.html#a1757cddbe4d3d273bf8fbffde3489a61af96d66ee7716e523971a7b5161f04ded">ENC_QUOTED_PRINTABLE</a></div><div class="ttdeci">@ ENC_QUOTED_PRINTABLE</div><div class="ttdoc">Quoted-printable text.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00051">mime.h:51</a></div></div>
<div class="ttc" id="asendlib_8c_html_acecf90d13694e354e0b964ea51532a88"><div class="ttname"><a href="sendlib_8c.html#acecf90d13694e354e0b964ea51532a88">mutt_message_to_7bit</a></div><div class="ttdeci">void mutt_message_to_7bit(struct Body *b, FILE *fp, struct ConfigSubset *sub)</div><div class="ttdoc">Convert an email&#39;s MIME parts to 7-bit.</div><div class="ttdef"><b>Definition</b> <a href="sendlib_8c_source.html#l00258">sendlib.c:258</a></div></div>
<div class="ttc" id="astructBody_html_aa1d39136ca054e465e875b8ab9b99565"><div class="ttname"><a href="structBody.html#aa1d39136ca054e465e875b8ab9b99565">Body::content</a></div><div class="ttdeci">struct Content * content</div><div class="ttdoc">Detailed info about the content of the attachment.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00070">body.h:70</a></div></div>
<div class="ttc" id="astructBody_html_ad2f05b8ff24813de41988e63de5d6a31"><div class="ttname"><a href="structBody.html#ad2f05b8ff24813de41988e63de5d6a31">Body::encoding</a></div><div class="ttdeci">unsigned int encoding</div><div class="ttdoc">content-transfer-encoding, ContentEncoding</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00041">body.h:41</a></div></div>
<div class="ttc" id="astructContent_html_a63dbba7efe98fef1797b0643b346be32"><div class="ttname"><a href="structContent.html#a63dbba7efe98fef1797b0643b346be32">Content::space</a></div><div class="ttdeci">bool space</div><div class="ttdoc">Whitespace at the end of lines?</div><div class="ttdef"><b>Definition</b> <a href="content_8h_source.html#l00042">content.h:42</a></div></div>
<div class="ttc" id="astructContent_html_ab0f45d80059bca9d8e33663866f641d0"><div class="ttname"><a href="structContent.html#ab0f45d80059bca9d8e33663866f641d0">Content::from</a></div><div class="ttdeci">bool from</div><div class="ttdoc">Has a line beginning with &quot;From &quot;?</div><div class="ttdef"><b>Definition</b> <a href="content_8h_source.html#l00044">content.h:44</a></div></div>
</div><!-- fragment --><div id="dynsection-25" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_ac8f7e9a0aff78e25866f228aca6862bd_cgraph.svg" width="376" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-26" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_ac8f7e9a0aff78e25866f228aca6862bd_icgraph.svg" width="426" height="254"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a776fef61b47569d4c698411d5e733a0f" name="a776fef61b47569d4c698411d5e733a0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a776fef61b47569d4c698411d5e733a0f">&#9670;&#160;</a></span>crypt_extract_keys_from_messages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_extract_keys_from_messages </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structMailbox.html">Mailbox</a> *</td>          <td class="paramname"><span class="paramname"><em>m</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct EmailArray *</td>          <td class="paramname"><span class="paramname"><em>ea</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract keys from a message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td><a class="el" href="structMailbox.html" title="A mailbox.">Mailbox</a> </td></tr>
    <tr><td class="paramname">ea</td><td>Array of Emails to process</td></tr>
  </table>
  </dd>
</dl>
<p>The extracted keys will be added to the user's keyring. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00859">859</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  860</span>{</div>
<div class="line"><span class="lineno">  861</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno">  862</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *tempfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  865</span>  <a class="code hl_define" href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a>(tempfile);</div>
<div class="line"><span class="lineno">  866</span>  FILE *fp_out = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">  867</span>  <span class="keywordflow">if</span> (!fp_out)</div>
<div class="line"><span class="lineno">  868</span>  {</div>
<div class="line"><span class="lineno">  869</span>    <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  870</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  871</span>  }</div>
<div class="line"><span class="lineno">  872</span> </div>
<div class="line"><span class="lineno">  873</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div>
<div class="line"><span class="lineno">  874</span>    <a class="code hl_variable" href="globals_8c.html#a06fbffcecad5ed6656ea2948927b26b8">OptDontHandlePgpKeys</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structEmail.html">Email</a> **ep = NULL;</div>
<div class="line"><span class="lineno">  877</span>  <a class="code hl_define" href="array_8h.html#a6b8ea5fb2f366d7716f5042b347093a6">ARRAY_FOREACH</a>(ep, ea)</div>
<div class="line"><span class="lineno">  878</span>  {</div>
<div class="line"><span class="lineno">  879</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structEmail.html">Email</a> *e = *ep;</div>
<div class="line"><span class="lineno">  880</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structMessage.html">Message</a> *msg = <a class="code hl_function" href="mx_8c.html#a9b2902ecb2bebbd553a8ec733ca59886">mx_msg_open</a>(m, e);</div>
<div class="line"><span class="lineno">  881</span>    <span class="keywordflow">if</span> (!msg)</div>
<div class="line"><span class="lineno">  882</span>    {</div>
<div class="line"><span class="lineno">  883</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  884</span>    }</div>
<div class="line"><span class="lineno">  885</span>    <a class="code hl_function" href="attach_2commands_8c.html#a521686f973cf66e6c60be12cc9659ac3">mutt_parse_mime_message</a>(e, msg-&gt;<a class="code hl_variable" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div>
<div class="line"><span class="lineno">  886</span>    <span class="keywordflow">if</span> (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> &amp;&amp; !<a class="code hl_function" href="#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a>(e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a>))</div>
<div class="line"><span class="lineno">  887</span>    {</div>
<div class="line"><span class="lineno">  888</span>      <a class="code hl_function" href="mx_8c.html#a2610a2afe8887bb874131a4ba092aa6a">mx_msg_close</a>(m, &amp;msg);</div>
<div class="line"><span class="lineno">  889</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_out);</div>
<div class="line"><span class="lineno">  890</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  891</span>    }</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  894</span>    {</div>
<div class="line"><span class="lineno">  895</span>      <a class="code hl_function" href="copy_8c.html#a72172841415fb14e143da3c102be0364">mutt_copy_message</a>(fp_out, e, msg, <a class="code hl_define" href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a> | <a class="code hl_define" href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a>, <a class="code hl_define" href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a>, 0);</div>
<div class="line"><span class="lineno">  896</span>      fflush(fp_out);</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>      <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  899</span>      puts(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Trying to extract PGP keys...\n&quot;</span>));</div>
<div class="line"><span class="lineno">  900</span>      <a class="code hl_function" href="cryptglue_8c.html#a842ab48184b60e3b7b206536b7b78a61">crypt_pgp_invoke_import</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  901</span>    }</div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno">  904</span>    {</div>
<div class="line"><span class="lineno">  905</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> encrypt = e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  906</span>      <a class="code hl_function" href="copy_8c.html#a72172841415fb14e143da3c102be0364">mutt_copy_message</a>(fp_out, e, msg,</div>
<div class="line"><span class="lineno">  907</span>                        encrypt ? <a class="code hl_define" href="copy_8h.html#ad0d836342af33c74966ba719fd33c475">MUTT_CM_NOHEADER</a> | <a class="code hl_define" href="copy_8h.html#acb95a965dc299a0cd0b13bf4ade6fb26">MUTT_CM_DECODE_CRYPT</a> | <a class="code hl_define" href="copy_8h.html#a68c59ce93ab61f8d664fc94e60f61f3c">MUTT_CM_DECODE_SMIME</a> :</div>
<div class="line"><span class="lineno">  908</span>                                  <a class="code hl_define" href="copy_8h.html#ac778c083de78e4fb27889f345f242d13">MUTT_CM_NO_FLAGS</a>,</div>
<div class="line"><span class="lineno">  909</span>                        <a class="code hl_define" href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a>, 0);</div>
<div class="line"><span class="lineno">  910</span>      fflush(fp_out);</div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *mbox = NULL;</div>
<div class="line"><span class="lineno">  913</span>      <span class="keywordflow">if</span> (!<a class="code hl_define" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>))</div>
<div class="line"><span class="lineno">  914</span>      {</div>
<div class="line"><span class="lineno">  915</span>        <a class="code hl_function" href="alias_8c.html#a7c57d5376e9a1cf5e1f504a452996b86">mutt_expand_aliases</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div>
<div class="line"><span class="lineno">  916</span>        mbox = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(<a class="code hl_define" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>)-&gt;mailbox);</div>
<div class="line"><span class="lineno">  917</span>      }</div>
<div class="line"><span class="lineno">  918</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>))</div>
<div class="line"><span class="lineno">  919</span>      {</div>
<div class="line"><span class="lineno">  920</span>        <a class="code hl_function" href="alias_8c.html#a7c57d5376e9a1cf5e1f504a452996b86">mutt_expand_aliases</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>);</div>
<div class="line"><span class="lineno">  921</span>        mbox = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(<a class="code hl_define" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>)-&gt;mailbox);</div>
<div class="line"><span class="lineno">  922</span>      }</div>
<div class="line"><span class="lineno">  923</span>      <span class="keywordflow">if</span> (mbox)</div>
<div class="line"><span class="lineno">  924</span>      {</div>
<div class="line"><span class="lineno">  925</span>        <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  926</span>        puts(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Trying to extract S/MIME certificates...&quot;</span>));</div>
<div class="line"><span class="lineno">  927</span>        <a class="code hl_function" href="cryptglue_8c.html#a9a62b3e7470b9f9e899a63ebae53b4da">crypt_smime_invoke_import</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), mbox);</div>
<div class="line"><span class="lineno">  928</span>      }</div>
<div class="line"><span class="lineno">  929</span>    }</div>
<div class="line"><span class="lineno">  930</span>    <a class="code hl_function" href="mx_8c.html#a2610a2afe8887bb874131a4ba092aa6a">mx_msg_close</a>(m, &amp;msg);</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>    rewind(fp_out);</div>
<div class="line"><span class="lineno">  933</span>  }</div>
<div class="line"><span class="lineno">  934</span> </div>
<div class="line"><span class="lineno">  935</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_out);</div>
<div class="line"><span class="lineno">  936</span>  <span class="keywordflow">if</span> (isendwin())</div>
<div class="line"><span class="lineno">  937</span>    <a class="code hl_function" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a>(NULL);</div>
<div class="line"><span class="lineno">  938</span> </div>
<div class="line"><span class="lineno">  939</span>  <a class="code hl_function" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  940</span> </div>
<div class="line"><span class="lineno">  941</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div>
<div class="line"><span class="lineno">  942</span>    <a class="code hl_variable" href="globals_8c.html#a06fbffcecad5ed6656ea2948927b26b8">OptDontHandlePgpKeys</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>cleanup:</div>
<div class="line"><span class="lineno">  945</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;tempfile);</div>
<div class="line"><span class="lineno">  946</span>}</div>
<div class="ttc" id="aalias_8c_html_a7c57d5376e9a1cf5e1f504a452996b86"><div class="ttname"><a href="alias_8c.html#a7c57d5376e9a1cf5e1f504a452996b86">mutt_expand_aliases</a></div><div class="ttdeci">void mutt_expand_aliases(struct AddressList *al)</div><div class="ttdoc">Expand aliases in a List of Addresses.</div><div class="ttdef"><b>Definition</b> <a href="alias_8c_source.html#l00295">alias.c:295</a></div></div>
<div class="ttc" id="aarray_8h_html_a6b8ea5fb2f366d7716f5042b347093a6"><div class="ttname"><a href="array_8h.html#a6b8ea5fb2f366d7716f5042b347093a6">ARRAY_FOREACH</a></div><div class="ttdeci">#define ARRAY_FOREACH(elem, head)</div><div class="ttdoc">Iterate over all elements of the array.</div><div class="ttdef"><b>Definition</b> <a href="array_8h_source.html#l00214">array.h:214</a></div></div>
<div class="ttc" id="aattach_2commands_8c_html_a521686f973cf66e6c60be12cc9659ac3"><div class="ttname"><a href="attach_2commands_8c.html#a521686f973cf66e6c60be12cc9659ac3">mutt_parse_mime_message</a></div><div class="ttdeci">void mutt_parse_mime_message(struct Email *e, FILE *fp)</div><div class="ttdoc">Parse a MIME email.</div><div class="ttdef"><b>Definition</b> <a href="attach_2commands_8c_source.html#l00596">commands.c:596</a></div></div>
<div class="ttc" id="acopy_8c_html_a72172841415fb14e143da3c102be0364"><div class="ttname"><a href="copy_8c.html#a72172841415fb14e143da3c102be0364">mutt_copy_message</a></div><div class="ttdeci">int mutt_copy_message(FILE *fp_out, struct Email *e, struct Message *msg, CopyMessageFlags cmflags, CopyHeaderFlags chflags, int wraplen)</div><div class="ttdoc">Copy a message from a Mailbox.</div><div class="ttdef"><b>Definition</b> <a href="copy_8c_source.html#l00908">copy.c:908</a></div></div>
<div class="ttc" id="acopy_8h_html_a4898a6c2c88fdba8ce7decdb6c125a96"><div class="ttname"><a href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a></div><div class="ttdeci">#define MUTT_CM_DECODE</div><div class="ttdoc">Decode the message body into text/plain.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00040">copy.h:40</a></div></div>
<div class="ttc" id="acopy_8h_html_a648ee091378fa6c0f6f129f64fc7f22b"><div class="ttname"><a href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a></div><div class="ttdeci">#define MUTT_CM_CHARCONV</div><div class="ttdoc">Perform character set conversions.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00044">copy.h:44</a></div></div>
<div class="ttc" id="acopy_8h_html_a68c59ce93ab61f8d664fc94e60f61f3c"><div class="ttname"><a href="copy_8h.html#a68c59ce93ab61f8d664fc94e60f61f3c">MUTT_CM_DECODE_SMIME</a></div><div class="ttdeci">#define MUTT_CM_DECODE_SMIME</div><div class="ttdoc">Used for decoding S/MIME messages.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00048">copy.h:48</a></div></div>
<div class="ttc" id="acopy_8h_html_ac778c083de78e4fb27889f345f242d13"><div class="ttname"><a href="copy_8h.html#ac778c083de78e4fb27889f345f242d13">MUTT_CM_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_CM_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00037">copy.h:37</a></div></div>
<div class="ttc" id="acopy_8h_html_acb95a965dc299a0cd0b13bf4ade6fb26"><div class="ttname"><a href="copy_8h.html#acb95a965dc299a0cd0b13bf4ade6fb26">MUTT_CM_DECODE_CRYPT</a></div><div class="ttdeci">#define MUTT_CM_DECODE_CRYPT</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00050">copy.h:50</a></div></div>
<div class="ttc" id="acopy_8h_html_ad0d836342af33c74966ba719fd33c475"><div class="ttname"><a href="copy_8h.html#ad0d836342af33c74966ba719fd33c475">MUTT_CM_NOHEADER</a></div><div class="ttdeci">#define MUTT_CM_NOHEADER</div><div class="ttdoc">Don&#39;t copy the message header.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00038">copy.h:38</a></div></div>
<div class="ttc" id="acopy_8h_html_af310a44d7c96b22de90934cb18634b58"><div class="ttname"><a href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a></div><div class="ttdeci">#define CH_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="copy_8h_source.html#l00053">copy.h:53</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a842ab48184b60e3b7b206536b7b78a61"><div class="ttname"><a href="cryptglue_8c.html#a842ab48184b60e3b7b206536b7b78a61">crypt_pgp_invoke_import</a></div><div class="ttdeci">void crypt_pgp_invoke_import(const char *fname)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_invoke_import()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00363">cryptglue.c:363</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a9a62b3e7470b9f9e899a63ebae53b4da"><div class="ttname"><a href="cryptglue_8c.html#a9a62b3e7470b9f9e899a63ebae53b4da">crypt_smime_invoke_import</a></div><div class="ttdeci">void crypt_smime_invoke_import(const char *infile, const char *mailbox)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::smime_invoke_import()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00507">cryptglue.c:507</a></div></div>
<div class="ttc" id="acurs__lib_8c_html_ab6a61cdfcf8c2c73ee59381c79c79774"><div class="ttname"><a href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a></div><div class="ttdeci">int mutt_any_key_to_continue(const char *s)</div><div class="ttdoc">Prompt the user to &#39;press any key&#39; and wait.</div><div class="ttdef"><b>Definition</b> <a href="curs__lib_8c_source.html#l00174">curs_lib.c:174</a></div></div>
<div class="ttc" id="afile_8c_html_ae57463c2854c006a3c67b78736e9056e"><div class="ttname"><a href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a></div><div class="ttdeci">void mutt_file_unlink(const char *s)</div><div class="ttdoc">Delete a file, carefully.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00159">file.c:159</a></div></div>
<div class="ttc" id="aglobals_8c_html_a06fbffcecad5ed6656ea2948927b26b8"><div class="ttname"><a href="globals_8c.html#a06fbffcecad5ed6656ea2948927b26b8">OptDontHandlePgpKeys</a></div><div class="ttdeci">bool OptDontHandlePgpKeys</div><div class="ttdoc">(pseudo) used to extract PGP keys</div><div class="ttdef"><b>Definition</b> <a href="globals_8c_source.html#l00057">globals.c:57</a></div></div>
<div class="ttc" id="amx_8c_html_a2610a2afe8887bb874131a4ba092aa6a"><div class="ttname"><a href="mx_8c.html#a2610a2afe8887bb874131a4ba092aa6a">mx_msg_close</a></div><div class="ttdeci">int mx_msg_close(struct Mailbox *m, struct Message **ptr)</div><div class="ttdoc">Close a message.</div><div class="ttdef"><b>Definition</b> <a href="mx_8c_source.html#l01185">mx.c:1185</a></div></div>
<div class="ttc" id="amx_8c_html_a9b2902ecb2bebbd553a8ec733ca59886"><div class="ttname"><a href="mx_8c.html#a9b2902ecb2bebbd553a8ec733ca59886">mx_msg_open</a></div><div class="ttdeci">struct Message * mx_msg_open(struct Mailbox *m, struct Email *e)</div><div class="ttdoc">Return a stream pointer for a message.</div><div class="ttdef"><b>Definition</b> <a href="mx_8c_source.html#l01139">mx.c:1139</a></div></div>
<div class="ttc" id="apool_8c_html_a41cba27c25d33cb6822789a2856093f2"><div class="ttname"><a href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a></div><div class="ttdeci">struct Buffer * buf_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00082">pool.c:82</a></div></div>
<div class="ttc" id="apool_8c_html_a4cc6068279461cb8628219586dfa35a1"><div class="ttname"><a href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a></div><div class="ttdeci">void buf_pool_release(struct Buffer **ptr)</div><div class="ttdoc">Return a Buffer to the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00096">pool.c:96</a></div></div>
<div class="ttc" id="aqueue_8h_html_ac3c9da7ac712eacbbad5cc54d7a3477e"><div class="ttname"><a href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a></div><div class="ttdeci">#define TAILQ_EMPTY(head)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00778">queue.h:778</a></div></div>
<div class="ttc" id="astructBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00035">buffer.h:36</a></div></div>
<div class="ttc" id="astructEmail_html"><div class="ttname"><a href="structEmail.html">Email</a></div><div class="ttdoc">The envelope/body of an email.</div><div class="ttdef"><b>Definition</b> <a href="email_8h_source.html#l00038">email.h:39</a></div></div>
<div class="ttc" id="astructMessage_html"><div class="ttname"><a href="structMessage.html">Message</a></div><div class="ttdoc">A local copy of an email.</div><div class="ttdef"><b>Definition</b> <a href="core_2message_8h_source.html#l00033">message.h:34</a></div></div>
<div class="ttc" id="astructMessage_html_a11d53ee4319e8735c1677d8780a7b517"><div class="ttname"><a href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">Message::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdoc">pointer to the message data</div><div class="ttdef"><b>Definition</b> <a href="core_2message_8h_source.html#l00035">message.h:35</a></div></div>
<div class="ttc" id="atmp_8h_html_a271a7828888985955df49205d7846a45"><div class="ttname"><a href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a></div><div class="ttdeci">#define buf_mktemp(buf)</div><div class="ttdef"><b>Definition</b> <a href="tmp_8h_source.html#l00033">tmp.h:33</a></div></div>
</div><!-- fragment --><div id="dynsection-27" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a776fef61b47569d4c698411d5e733a0f_cgraph.svg" width="388" height="776"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-28" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a776fef61b47569d4c698411d5e733a0f_icgraph.svg" width="312" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="abb04ccb83d144391034d86704c52b987" name="abb04ccb83d144391034d86704c52b987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb04ccb83d144391034d86704c52b987">&#9670;&#160;</a></span>crypt_get_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_get_keys </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *</td>          <td class="paramname"><span class="paramname"><em>e</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>keylist</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>oppenc_mode</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check we have all the keys we need. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> with addresses to match </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">keylist</td><td>Keys needed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oppenc_mode</td><td>If true, use opportunistic encryption </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error</td></tr>
  </table>
  </dd>
</dl>
<p>Do a quick check to make sure that we can find all of the encryption keys if the user has requested this service. Return the list of keys in KEYLIST. If oppenc_mode is true, only keys that can be determined without prompting will be used. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00962">962</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  963</span>{</div>
<div class="line"><span class="lineno">  964</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno">  965</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>  <span class="keyword">struct </span>AddressList addrlist = <a class="code hl_define" href="queue_8h.html#ac269df7d4126ed9885156cbad2cbf8af">TAILQ_HEAD_INITIALIZER</a>(addrlist);</div>
<div class="line"><span class="lineno">  968</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *fqdn = <a class="code hl_function" href="sendlib_8c.html#a448ec1abcfc24a2a3d61197ef604877d">mutt_fqdn</a>(<span class="keyword">true</span>, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno">  969</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *self_encrypt = NULL;</div>
<div class="line"><span class="lineno">  970</span> </div>
<div class="line"><span class="lineno">  971</span>  <span class="comment">/* Do a quick check to make sure that we can find all of the encryption</span></div>
<div class="line"><span class="lineno">  972</span><span class="comment">   * keys if the user has requested this service.  */</span></div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>  *keylist = NULL;</div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span><span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div>
<div class="line"><span class="lineno">  977</span>  <span class="keywordflow">if</span> (!oppenc_mode &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>))</div>
<div class="line"><span class="lineno">  978</span>  {</div>
<div class="line"><span class="lineno">  979</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="autocrypt_8c.html#a90f0aa8320453b9acc5cf33bd28fe8d0">mutt_autocrypt_ui_recommendation</a>(e, keylist) &lt;= <a class="code hl_enumvalue" href="autocrypt_2lib_8h.html#aed237ffa27e23d83cb0acc07586ffbdaa5243c176ca12aa8812707f39781ebec3">AUTOCRYPT_REC_NO</a>)</div>
<div class="line"><span class="lineno">  980</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  981</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  982</span>  }</div>
<div class="line"><span class="lineno">  983</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div>
<div class="line"><span class="lineno">  986</span>    <a class="code hl_variable" href="globals_8c.html#a3cf441307286abc7db5e6b8213cfad98">OptPgpCheckTrust</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span>  <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;addrlist, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  989</span>  <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;addrlist, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  990</span>  <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;addrlist, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">bcc</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  991</span>  <a class="code hl_function" href="address_2address_8c.html#a1de5e467c74e205ff465fd601c275b88">mutt_addrlist_qualify</a>(&amp;addrlist, fqdn);</div>
<div class="line"><span class="lineno">  992</span>  <a class="code hl_function" href="address_2address_8c.html#aee5d40d84136d3a7adba727e2908ad66">mutt_addrlist_dedupe</a>(&amp;addrlist);</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>  <span class="keywordflow">if</span> (oppenc_mode || (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>))</div>
<div class="line"><span class="lineno">  995</span>  {</div>
<div class="line"><span class="lineno">  996</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  997</span>    {</div>
<div class="line"><span class="lineno">  998</span>      *keylist = <a class="code hl_function" href="cryptglue_8c.html#a34d285974b12e7f0eae09d7d17e1a13b">crypt_pgp_find_keys</a>(&amp;addrlist, oppenc_mode);</div>
<div class="line"><span class="lineno">  999</span>      <span class="keywordflow">if</span> (!*keylist)</div>
<div class="line"><span class="lineno"> 1000</span>      {</div>
<div class="line"><span class="lineno"> 1001</span>        <a class="code hl_function" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;addrlist);</div>
<div class="line"><span class="lineno"> 1002</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1003</span>      }</div>
<div class="line"><span class="lineno"> 1004</span>      <a class="code hl_variable" href="globals_8c.html#a3cf441307286abc7db5e6b8213cfad98">OptPgpCheckTrust</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1005</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_self_encrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_self_encrypt&quot;</span>);</div>
<div class="line"><span class="lineno"> 1006</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_pgp_default_key = <a class="code hl_function" href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_default_key&quot;</span>);</div>
<div class="line"><span class="lineno"> 1007</span>      <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code hl_enumeration" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_pgp_encrypt_self = <a class="code hl_function" href="config_2helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_encrypt_self&quot;</span>);</div>
<div class="line"><span class="lineno"> 1008</span>      <span class="keywordflow">if</span> (c_pgp_self_encrypt || (c_pgp_encrypt_self == <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>))</div>
<div class="line"><span class="lineno"> 1009</span>        self_encrypt = c_pgp_default_key;</div>
<div class="line"><span class="lineno"> 1010</span>    }</div>
<div class="line"><span class="lineno"> 1011</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno"> 1012</span>    {</div>
<div class="line"><span class="lineno"> 1013</span>      *keylist = <a class="code hl_function" href="cryptglue_8c.html#a143eed9672ff73b918294d07abfb8563">crypt_smime_find_keys</a>(&amp;addrlist, oppenc_mode);</div>
<div class="line"><span class="lineno"> 1014</span>      <span class="keywordflow">if</span> (!*keylist)</div>
<div class="line"><span class="lineno"> 1015</span>      {</div>
<div class="line"><span class="lineno"> 1016</span>        <a class="code hl_function" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;addrlist);</div>
<div class="line"><span class="lineno"> 1017</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1018</span>      }</div>
<div class="line"><span class="lineno"> 1019</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_smime_self_encrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;smime_self_encrypt&quot;</span>);</div>
<div class="line"><span class="lineno"> 1020</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_smime_default_key = <a class="code hl_function" href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;smime_default_key&quot;</span>);</div>
<div class="line"><span class="lineno"> 1021</span>      <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code hl_enumeration" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_smime_encrypt_self = <a class="code hl_function" href="config_2helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;smime_encrypt_self&quot;</span>);</div>
<div class="line"><span class="lineno"> 1022</span>      <span class="keywordflow">if</span> (c_smime_self_encrypt || (c_smime_encrypt_self == <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>))</div>
<div class="line"><span class="lineno"> 1023</span>        self_encrypt = c_smime_default_key;</div>
<div class="line"><span class="lineno"> 1024</span>    }</div>
<div class="line"><span class="lineno"> 1025</span>  }</div>
<div class="line"><span class="lineno"> 1026</span> </div>
<div class="line"><span class="lineno"> 1027</span>  <span class="keywordflow">if</span> (!oppenc_mode &amp;&amp; self_encrypt)</div>
<div class="line"><span class="lineno"> 1028</span>  {</div>
<div class="line"><span class="lineno"> 1029</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> keylist_size = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(*keylist);</div>
<div class="line"><span class="lineno"> 1030</span>    <a class="code hl_define" href="memory_8h.html#abd7aad5fe8f11bcd476c64b4243081ba">MUTT_MEM_REALLOC</a>(keylist, keylist_size + <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(self_encrypt) + 2, <span class="keywordtype">char</span>);</div>
<div class="line"><span class="lineno"> 1031</span>    sprintf(*keylist + keylist_size, <span class="stringliteral">&quot; %s&quot;</span>, self_encrypt);</div>
<div class="line"><span class="lineno"> 1032</span>  }</div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span>  <a class="code hl_function" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;addrlist);</div>
<div class="line"><span class="lineno"> 1035</span> </div>
<div class="line"><span class="lineno"> 1036</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1037</span>}</div>
<div class="ttc" id="aaddress_2address_8c_html_a1de5e467c74e205ff465fd601c275b88"><div class="ttname"><a href="address_2address_8c.html#a1de5e467c74e205ff465fd601c275b88">mutt_addrlist_qualify</a></div><div class="ttdeci">void mutt_addrlist_qualify(struct AddressList *al, const char *host)</div><div class="ttdoc">Expand local names in an Address list using a hostname.</div><div class="ttdef"><b>Definition</b> <a href="address_2address_8c_source.html#l00680">address.c:680</a></div></div>
<div class="ttc" id="aaddress_2address_8c_html_a396bcf6adfff6663096fa6ae99c31c9a"><div class="ttname"><a href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a></div><div class="ttdeci">void mutt_addrlist_clear(struct AddressList *al)</div><div class="ttdoc">Unlink and free all Address in an AddressList.</div><div class="ttdef"><b>Definition</b> <a href="address_2address_8c_source.html#l01460">address.c:1460</a></div></div>
<div class="ttc" id="aaddress_2address_8c_html_aee5d40d84136d3a7adba727e2908ad66"><div class="ttname"><a href="address_2address_8c.html#aee5d40d84136d3a7adba727e2908ad66">mutt_addrlist_dedupe</a></div><div class="ttdeci">void mutt_addrlist_dedupe(struct AddressList *al)</div><div class="ttdoc">Remove duplicate addresses.</div><div class="ttdef"><b>Definition</b> <a href="address_2address_8c_source.html#l01397">address.c:1397</a></div></div>
<div class="ttc" id="aautocrypt_2lib_8h_html_aed237ffa27e23d83cb0acc07586ffbdaa5243c176ca12aa8812707f39781ebec3"><div class="ttname"><a href="autocrypt_2lib_8h.html#aed237ffa27e23d83cb0acc07586ffbdaa5243c176ca12aa8812707f39781ebec3">AUTOCRYPT_REC_NO</a></div><div class="ttdeci">@ AUTOCRYPT_REC_NO</div><div class="ttdoc">Do no use Autocrypt.</div><div class="ttdef"><b>Definition</b> <a href="autocrypt_2lib_8h_source.html#l00164">lib.h:164</a></div></div>
<div class="ttc" id="aautocrypt_8c_html_a90f0aa8320453b9acc5cf33bd28fe8d0"><div class="ttname"><a href="autocrypt_8c.html#a90f0aa8320453b9acc5cf33bd28fe8d0">mutt_autocrypt_ui_recommendation</a></div><div class="ttdeci">enum AutocryptRec mutt_autocrypt_ui_recommendation(const struct Email *e, char **keylist)</div><div class="ttdoc">Get the recommended action for an Email.</div><div class="ttdef"><b>Definition</b> <a href="autocrypt_8c_source.html#l00558">autocrypt.c:558</a></div></div>
<div class="ttc" id="aconfig_2helpers_8c_html_a6b1589ee93ff51ef31f1d9324e138078"><div class="ttname"><a href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00291">helpers.c:291</a></div></div>
<div class="ttc" id="aconfig_2helpers_8c_html_a9154ba713ce99b0937f475eec7c61af9"><div class="ttname"><a href="config_2helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a></div><div class="ttdeci">enum QuadOption cs_subset_quad(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a quad-value config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00192">helpers.c:192</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a143eed9672ff73b918294d07abfb8563"><div class="ttname"><a href="cryptglue_8c.html#a143eed9672ff73b918294d07abfb8563">crypt_smime_find_keys</a></div><div class="ttdeci">char * crypt_smime_find_keys(struct AddressList *addrlist, bool oppenc_mode)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::find_keys()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00474">cryptglue.c:474</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a34d285974b12e7f0eae09d7d17e1a13b"><div class="ttname"><a href="cryptglue_8c.html#a34d285974b12e7f0eae09d7d17e1a13b">crypt_pgp_find_keys</a></div><div class="ttdeci">char * crypt_pgp_find_keys(struct AddressList *addrlist, bool oppenc_mode)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::find_keys()</div><div class="ttdef"><b>Definition</b> <a href="cryptglue_8c_source.html#l00315">cryptglue.c:315</a></div></div>
<div class="ttc" id="aglobals_8c_html_a3cf441307286abc7db5e6b8213cfad98"><div class="ttname"><a href="globals_8c.html#a3cf441307286abc7db5e6b8213cfad98">OptPgpCheckTrust</a></div><div class="ttdeci">bool OptPgpCheckTrust</div><div class="ttdoc">(pseudo) used by dlg_pgp()</div><div class="ttdef"><b>Definition</b> <a href="globals_8c_source.html#l00066">globals.c:66</a></div></div>
<div class="ttc" id="amemory_8h_html_abd7aad5fe8f11bcd476c64b4243081ba"><div class="ttname"><a href="memory_8h.html#abd7aad5fe8f11bcd476c64b4243081ba">MUTT_MEM_REALLOC</a></div><div class="ttdeci">#define MUTT_MEM_REALLOC(pptr, n, type)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00050">memory.h:50</a></div></div>
<div class="ttc" id="aquad_8h_html_a738f558a271fe5035e0ee3b700ee35db"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a></div><div class="ttdeci">QuadOption</div><div class="ttdoc">Possible values for a quad-option.</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00035">quad.h:36</a></div></div>
<div class="ttc" id="aqueue_8h_html_ac269df7d4126ed9885156cbad2cbf8af"><div class="ttname"><a href="queue_8h.html#ac269df7d4126ed9885156cbad2cbf8af">TAILQ_HEAD_INITIALIZER</a></div><div class="ttdeci">#define TAILQ_HEAD_INITIALIZER(head)</div><div class="ttdef"><b>Definition</b> <a href="queue_8h_source.html#l00694">queue.h:694</a></div></div>
<div class="ttc" id="asendlib_8c_html_a448ec1abcfc24a2a3d61197ef604877d"><div class="ttname"><a href="sendlib_8c.html#a448ec1abcfc24a2a3d61197ef604877d">mutt_fqdn</a></div><div class="ttdeci">const char * mutt_fqdn(bool may_hide_host, const struct ConfigSubset *sub)</div><div class="ttdoc">Get the Fully-Qualified Domain Name.</div><div class="ttdef"><b>Definition</b> <a href="sendlib_8c_source.html#l00706">sendlib.c:706</a></div></div>
<div class="ttc" id="astructEnvelope_html_aad427832f4ae422f1b16d0896c1d3af6"><div class="ttname"><a href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">Envelope::bcc</a></div><div class="ttdeci">struct AddressList bcc</div><div class="ttdoc">Email&#39;s &#39;Bcc&#39; list.</div><div class="ttdef"><b>Definition</b> <a href="envelope_8h_source.html#l00062">envelope.h:62</a></div></div>
</div><!-- fragment --><div id="dynsection-29" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_abb04ccb83d144391034d86704c52b987_cgraph.svg" width="606" height="616"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-30" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-30-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-30-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-30-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_abb04ccb83d144391034d86704c52b987_icgraph.svg" width="510" height="80"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2afe38b474061773d69624018621ff1e" name="a2afe38b474061773d69624018621ff1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2afe38b474061773d69624018621ff1e">&#9670;&#160;</a></span>crypt_opportunistic_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_opportunistic_encrypt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *</td>          <td class="paramname"><span class="paramname"><em>e</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Can all recipients be determined. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a></td></tr>
  </table>
  </dd>
</dl>
<p>Check if all recipients keys can be automatically determined. Enable encryption if they can, otherwise disable encryption. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01046">1046</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1047</span>{</div>
<div class="line"><span class="lineno"> 1048</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno"> 1049</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1050</span> </div>
<div class="line"><span class="lineno"> 1051</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_opportunistic_encrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_opportunistic_encrypt&quot;</span>);</div>
<div class="line"><span class="lineno"> 1052</span>  <span class="keywordflow">if</span> (!(c_crypt_opportunistic_encrypt &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a>)))</div>
<div class="line"><span class="lineno"> 1053</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>  <span class="keywordtype">char</span> *pgpkeylist = NULL;</div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>  <a class="code hl_function" href="#abb04ccb83d144391034d86704c52b987">crypt_get_keys</a>(e, &amp;pgpkeylist, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1058</span>  <span class="keywordflow">if</span> (pgpkeylist)</div>
<div class="line"><span class="lineno"> 1059</span>  {</div>
<div class="line"><span class="lineno"> 1060</span>    e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>;</div>
<div class="line"><span class="lineno"> 1061</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;pgpkeylist);</div>
<div class="line"><span class="lineno"> 1062</span>  }</div>
<div class="line"><span class="lineno"> 1063</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1064</span>  {</div>
<div class="line"><span class="lineno"> 1065</span>    e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp;= <a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">~SEC_ENCRYPT</a>;</div>
<div class="line"><span class="lineno"> 1066</span>  }</div>
<div class="line"><span class="lineno"> 1067</span>}</div>
<div class="ttc" id="acrypt_8c_html_abb04ccb83d144391034d86704c52b987"><div class="ttname"><a href="#abb04ccb83d144391034d86704c52b987">crypt_get_keys</a></div><div class="ttdeci">int crypt_get_keys(struct Email *e, char **keylist, bool oppenc_mode)</div><div class="ttdoc">Check we have all the keys we need.</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l00962">crypt.c:962</a></div></div>
<div class="ttc" id="amemory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00062">memory.h:62</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a2fb0b0aa796d8d79a746001d09c2a2c7"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a></div><div class="ttdeci">#define SEC_OPPENCRYPT</div><div class="ttdoc">Opportunistic encrypt mode.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00092">lib.h:92</a></div></div>
</div><!-- fragment --><div id="dynsection-31" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-31-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-31-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-31-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a2afe38b474061773d69624018621ff1e_cgraph.svg" width="475" height="76"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-32" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-32-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-32-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-32-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a2afe38b474061773d69624018621ff1e_icgraph.svg" width="780" height="355"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a125731bc0d4f94974c4ccba4a6146c23" name="a125731bc0d4f94974c4ccba4a6146c23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a125731bc0d4f94974c4ccba4a6146c23">&#9670;&#160;</a></span>crypt_fetch_signatures()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void crypt_fetch_signatures </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> ***</td>          <td class="paramname"><span class="paramname"><em>b_sigs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>n</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create an array of an emails parts. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">b_sigs</td><td>Array of <a class="el" href="structBody.html" title="The body of an email.">Body</a> parts </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> part to examine </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">n</td><td>Cumulative count of parts </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01075">1075</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1076</span>{</div>
<div class="line"><span class="lineno"> 1077</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno"> 1078</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1079</span> </div>
<div class="line"><span class="lineno"> 1080</span>  <span class="keywordflow">for</span> (; b; b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>)</div>
<div class="line"><span class="lineno"> 1081</span>  {</div>
<div class="line"><span class="lineno"> 1082</span>    <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>)</div>
<div class="line"><span class="lineno"> 1083</span>    {</div>
<div class="line"><span class="lineno"> 1084</span>      <a class="code hl_function" href="#a125731bc0d4f94974c4ccba4a6146c23">crypt_fetch_signatures</a>(b_sigs, b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>, n);</div>
<div class="line"><span class="lineno"> 1085</span>    }</div>
<div class="line"><span class="lineno"> 1086</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1087</span>    {</div>
<div class="line"><span class="lineno"> 1088</span>      <span class="keywordflow">if</span> ((*n % 5) == 0)</div>
<div class="line"><span class="lineno"> 1089</span>        <a class="code hl_define" href="memory_8h.html#abd7aad5fe8f11bcd476c64b4243081ba">MUTT_MEM_REALLOC</a>(b_sigs, *n + 6, <span class="keyword">struct</span> <a class="code hl_struct" href="structBody.html">Body</a> *);</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>      (*b_sigs)[(*n)++] = b;</div>
<div class="line"><span class="lineno"> 1092</span>    }</div>
<div class="line"><span class="lineno"> 1093</span>  }</div>
<div class="line"><span class="lineno"> 1094</span>}</div>
<div class="ttc" id="acrypt_8c_html_a125731bc0d4f94974c4ccba4a6146c23"><div class="ttname"><a href="#a125731bc0d4f94974c4ccba4a6146c23">crypt_fetch_signatures</a></div><div class="ttdeci">static void crypt_fetch_signatures(struct Body ***b_sigs, struct Body *b, int *n)</div><div class="ttdoc">Create an array of an emails parts.</div><div class="ttdef"><b>Definition</b> <a href="crypt_8c_source.html#l01075">crypt.c:1075</a></div></div>
</div><!-- fragment --><div id="dynsection-33" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-33-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-33-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-33-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a125731bc0d4f94974c4ccba4a6146c23_cgraph.svg" width="172" height="64"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-34" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-34-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-34-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-34-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a125731bc0d4f94974c4ccba4a6146c23_icgraph.svg" width="372" height="64"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a52c65477f5b80ad3dc8028663653771d" name="a52c65477f5b80ad3dc8028663653771d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52c65477f5b80ad3dc8028663653771d">&#9670;&#160;</a></span>mutt_should_hide_protected_subject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mutt_should_hide_protected_subject </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *</td>          <td class="paramname"><span class="paramname"><em>e</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Should <a class="el" href="structNeoMutt.html" title="Container for Accounts, Notifications.">NeoMutt</a> hide the protected subject? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> to test </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>The subject should be protected </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01101">1101</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1102</span>{</div>
<div class="line"><span class="lineno"> 1103</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_protected_headers_write = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_protected_headers_write&quot;</span>);</div>
<div class="line"><span class="lineno"> 1104</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_crypt_protected_headers_subject =</div>
<div class="line"><span class="lineno"> 1105</span>      <a class="code hl_function" href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_protected_headers_subject&quot;</span>);</div>
<div class="line"><span class="lineno"> 1106</span>  <span class="keywordflow">if</span> (c_crypt_protected_headers_write &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1107</span>      !(e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>) &amp;&amp; c_crypt_protected_headers_subject)</div>
<div class="line"><span class="lineno"> 1108</span>  {</div>
<div class="line"><span class="lineno"> 1109</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1110</span>  }</div>
<div class="line"><span class="lineno"> 1111</span> </div>
<div class="line"><span class="lineno"> 1112</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1113</span>}</div>
<div class="ttc" id="ancrypt_2lib_8h_html_a074f827472ad45f11ec1132cdfed2daf"><div class="ttname"><a href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a></div><div class="ttdeci">#define SEC_INLINE</div><div class="ttdoc">Email has an inline signature.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00091">lib.h:91</a></div></div>
</div><!-- fragment --><div id="dynsection-35" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-35-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-35-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-35-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a52c65477f5b80ad3dc8028663653771d_cgraph.svg" width="380" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-36" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-36-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-36-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-36-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a52c65477f5b80ad3dc8028663653771d_icgraph.svg" width="370" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a94562053d94ca97e0c694987beda0fab" name="a94562053d94ca97e0c694987beda0fab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94562053d94ca97e0c694987beda0fab">&#9670;&#160;</a></span>crypt_get_fingerprint_or_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * crypt_get_fingerprint_or_id </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **</td>          <td class="paramname"><span class="paramname"><em>pphint</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **</td>          <td class="paramname"><span class="paramname"><em>ppl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **</td>          <td class="paramname"><span class="paramname"><em>pps</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the fingerprint or long key ID. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>String to examine </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pphint</td><td>Start of string to be passed to <a class="el" href="pgpkey_8c.html#a40177845326ba43e7b01949fa290a368" title="Split a string and add the parts to a List.">pgp_add_string_to_hints()</a> or <a class="el" href="crypt__gpgme_8c.html#a6413c7e6bbfa71d8114053a970ae2ff2" title="Split a string and add the parts to a List.">crypt_add_string_to_hints()</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ppl</td><td>Start of long key ID if detected, else NULL </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pps</td><td>Start of short key ID if detected, else NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Copy of fingerprint, if any, stripped of all spaces. Must be FREE'd by caller </td></tr>
    <tr><td class="paramname">NULL</td><td>Otherwise</td></tr>
  </table>
  </dd>
</dl>
<p>Obtain pointers to fingerprint or short or long key ID, if any.</p>
<p>Upon return, at most one of return, *ppl and *pps pointers is non-NULL, indicating the longest fingerprint or ID found, if any. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01384">1384</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1386</span>{</div>
<div class="line"><span class="lineno"> 1387</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *ps = NULL, *pl = NULL, *phint = NULL;</div>
<div class="line"><span class="lineno"> 1388</span>  <span class="keywordtype">char</span> *pfcopy = NULL, *s1 = NULL, *s2 = NULL;</div>
<div class="line"><span class="lineno"> 1389</span>  <span class="keywordtype">char</span> c;</div>
<div class="line"><span class="lineno"> 1390</span>  <span class="keywordtype">int</span> isid;</div>
<div class="line"><span class="lineno"> 1391</span>  <span class="keywordtype">size_t</span> hexdigits;</div>
<div class="line"><span class="lineno"> 1392</span> </div>
<div class="line"><span class="lineno"> 1393</span>  <span class="comment">/* User input may be partial name, fingerprint or short or long key ID,</span></div>
<div class="line"><span class="lineno"> 1394</span><span class="comment">   * independent of `$pgp_long_ids`.</span></div>
<div class="line"><span class="lineno"> 1395</span><span class="comment">   * Fingerprint without spaces is 40 hex digits (SHA-1) or 32 hex digits (MD5).</span></div>
<div class="line"><span class="lineno"> 1396</span><span class="comment">   * Strip leading &quot;0x&quot; for key ID detection and prepare pl and ps to indicate</span></div>
<div class="line"><span class="lineno"> 1397</span><span class="comment">   * if an ID was found and to simplify logic in the key loop&#39;s inner</span></div>
<div class="line"><span class="lineno"> 1398</span><span class="comment">   * condition of the caller. */</span></div>
<div class="line"><span class="lineno"> 1399</span> </div>
<div class="line"><span class="lineno"> 1400</span>  <span class="keywordtype">char</span> *pf = <a class="code hl_function" href="mutt_2string_8c.html#aa2fa4dcaf72786b58e825349883f14c2">mutt_str_skip_whitespace</a>(p);</div>
<div class="line"><span class="lineno"> 1401</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(pf, <span class="stringliteral">&quot;0x&quot;</span>))</div>
<div class="line"><span class="lineno"> 1402</span>    pf += 2;</div>
<div class="line"><span class="lineno"> 1403</span> </div>
<div class="line"><span class="lineno"> 1404</span>  <span class="comment">/* Check if a fingerprint is given, must be hex digits only, blanks</span></div>
<div class="line"><span class="lineno"> 1405</span><span class="comment">   * separating groups of 4 hex digits are allowed. Also pre-check for ID. */</span></div>
<div class="line"><span class="lineno"> 1406</span>  isid = 2; <span class="comment">/* unknown */</span></div>
<div class="line"><span class="lineno"> 1407</span>  hexdigits = 0;</div>
<div class="line"><span class="lineno"> 1408</span>  s1 = pf;</div>
<div class="line"><span class="lineno"> 1409</span>  <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno"> 1410</span>  {</div>
<div class="line"><span class="lineno"> 1411</span>    c = *(s1++);</div>
<div class="line"><span class="lineno"> 1412</span>    <span class="keywordflow">if</span> (((<span class="charliteral">&#39;0&#39;</span> &lt;= c) &amp;&amp; (c &lt;= <span class="charliteral">&#39;9&#39;</span>)) || ((<span class="charliteral">&#39;A&#39;</span> &lt;= c) &amp;&amp; (c &lt;= <span class="charliteral">&#39;F&#39;</span>)) ||</div>
<div class="line"><span class="lineno"> 1413</span>        ((<span class="charliteral">&#39;a&#39;</span> &lt;= c) &amp;&amp; (c &lt;= <span class="charliteral">&#39;f&#39;</span>)))</div>
<div class="line"><span class="lineno"> 1414</span>    {</div>
<div class="line"><span class="lineno"> 1415</span>      hexdigits++;</div>
<div class="line"><span class="lineno"> 1416</span>      <span class="keywordflow">if</span> (isid == 2)</div>
<div class="line"><span class="lineno"> 1417</span>        isid = 1; <span class="comment">/* it is an ID so far */</span></div>
<div class="line"><span class="lineno"> 1418</span>    }</div>
<div class="line"><span class="lineno"> 1419</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c)</div>
<div class="line"><span class="lineno"> 1420</span>    {</div>
<div class="line"><span class="lineno"> 1421</span>      isid = 0; <span class="comment">/* not an ID */</span></div>
<div class="line"><span class="lineno"> 1422</span>      <span class="keywordflow">if</span> ((c == <span class="charliteral">&#39; &#39;</span>) &amp;&amp; ((hexdigits % 4) == 0))</div>
<div class="line"><span class="lineno"> 1423</span>        ; <span class="comment">/* skip blank before or after 4 hex digits */</span></div>
<div class="line"><span class="lineno"> 1424</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1425</span>        <span class="keywordflow">break</span>; <span class="comment">/* any other character or position */</span></div>
<div class="line"><span class="lineno"> 1426</span>    }</div>
<div class="line"><span class="lineno"> 1427</span>  } <span class="keywordflow">while</span> (c);</div>
<div class="line"><span class="lineno"> 1428</span> </div>
<div class="line"><span class="lineno"> 1429</span>  <span class="comment">/* If at end of input, check for correct fingerprint length and copy if. */</span></div>
<div class="line"><span class="lineno"> 1430</span>  pfcopy = (!c &amp;&amp; ((hexdigits == 40) || (hexdigits == 32)) ? <a class="code hl_function" href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a>(pf) : NULL);</div>
<div class="line"><span class="lineno"> 1431</span> </div>
<div class="line"><span class="lineno"> 1432</span>  <span class="keywordflow">if</span> (pfcopy)</div>
<div class="line"><span class="lineno"> 1433</span>  {</div>
<div class="line"><span class="lineno"> 1434</span>    <span class="comment">/* Use pfcopy to strip all spaces from fingerprint and as hint. */</span></div>
<div class="line"><span class="lineno"> 1435</span>    s1 = pfcopy;</div>
<div class="line"><span class="lineno"> 1436</span>    s2 = pfcopy;</div>
<div class="line"><span class="lineno"> 1437</span>    <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno"> 1438</span>    {</div>
<div class="line"><span class="lineno"> 1439</span>      *(s1++) = *(s2 = <a class="code hl_function" href="mutt_2string_8c.html#aa2fa4dcaf72786b58e825349883f14c2">mutt_str_skip_whitespace</a>(s2));</div>
<div class="line"><span class="lineno"> 1440</span>    } <span class="keywordflow">while</span> (*(s2++));</div>
<div class="line"><span class="lineno"> 1441</span> </div>
<div class="line"><span class="lineno"> 1442</span>    phint = pfcopy;</div>
<div class="line"><span class="lineno"> 1443</span>    ps = NULL;</div>
<div class="line"><span class="lineno"> 1444</span>    pl = NULL;</div>
<div class="line"><span class="lineno"> 1445</span>  }</div>
<div class="line"><span class="lineno"> 1446</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1447</span>  {</div>
<div class="line"><span class="lineno"> 1448</span>    phint = p;</div>
<div class="line"><span class="lineno"> 1449</span>    ps = NULL;</div>
<div class="line"><span class="lineno"> 1450</span>    pl = NULL;</div>
<div class="line"><span class="lineno"> 1451</span>    <span class="keywordflow">if</span> (isid == 1)</div>
<div class="line"><span class="lineno"> 1452</span>    {</div>
<div class="line"><span class="lineno"> 1453</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(pf) == 16)</div>
<div class="line"><span class="lineno"> 1454</span>        pl = pf; <span class="comment">/* long key ID */</span></div>
<div class="line"><span class="lineno"> 1455</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(pf) == 8)</div>
<div class="line"><span class="lineno"> 1456</span>        ps = pf; <span class="comment">/* short key ID */</span></div>
<div class="line"><span class="lineno"> 1457</span>    }</div>
<div class="line"><span class="lineno"> 1458</span>  }</div>
<div class="line"><span class="lineno"> 1459</span> </div>
<div class="line"><span class="lineno"> 1460</span>  *pphint = phint;</div>
<div class="line"><span class="lineno"> 1461</span>  *ppl = pl;</div>
<div class="line"><span class="lineno"> 1462</span>  *pps = ps;</div>
<div class="line"><span class="lineno"> 1463</span>  <span class="keywordflow">return</span> pfcopy;</div>
<div class="line"><span class="lineno"> 1464</span>}</div>
<div class="ttc" id="amutt_2string_8c_html_a3fe33d90e4814281cd57de048119c950"><div class="ttname"><a href="mutt_2string_8c.html#a3fe33d90e4814281cd57de048119c950">mutt_str_dup</a></div><div class="ttdeci">char * mutt_str_dup(const char *str)</div><div class="ttdoc">Copy a string, safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00255">string.c:255</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_aa2fa4dcaf72786b58e825349883f14c2"><div class="ttname"><a href="mutt_2string_8c.html#aa2fa4dcaf72786b58e825349883f14c2">mutt_str_skip_whitespace</a></div><div class="ttdeci">char * mutt_str_skip_whitespace(const char *p)</div><div class="ttdoc">Find the first non-whitespace character in a string.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00551">string.c:551</a></div></div>
</div><!-- fragment --><div id="dynsection-37" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-37-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-37-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-37-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a94562053d94ca97e0c694987beda0fab_cgraph.svg" width="392" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-38" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-38-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-38-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-38-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a94562053d94ca97e0c694987beda0fab_icgraph.svg" width="347" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3230991ab72820135b5ba8fe94a5f43d" name="a3230991ab72820135b5ba8fe94a5f43d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3230991ab72820135b5ba8fe94a5f43d">&#9670;&#160;</a></span>crypt_is_numerical_keyid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool crypt_is_numerical_keyid </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is this a numerical keyid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Key to test </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Keyid is numeric</td></tr>
  </table>
  </dd>
</dl>
<p>Check if a crypt-hook value is a key id. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01473">1473</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1474</span>{</div>
<div class="line"><span class="lineno"> 1475</span>  <span class="comment">/* or should we require the &quot;0x&quot;? */</span></div>
<div class="line"><span class="lineno"> 1476</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a6f574867aa9db4d434adbc8af1f5f7e7">mutt_strn_equal</a>(s, <span class="stringliteral">&quot;0x&quot;</span>, 2))</div>
<div class="line"><span class="lineno"> 1477</span>    s += 2;</div>
<div class="line"><span class="lineno"> 1478</span>  <span class="keywordflow">if</span> (strlen(s) % 8)</div>
<div class="line"><span class="lineno"> 1479</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1480</span>  <span class="keywordflow">while</span> (*s)</div>
<div class="line"><span class="lineno"> 1481</span>    <span class="keywordflow">if</span> (!strchr(<span class="stringliteral">&quot;0123456789ABCDEFabcdef&quot;</span>, *s++))</div>
<div class="line"><span class="lineno"> 1482</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1483</span> </div>
<div class="line"><span class="lineno"> 1484</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1485</span>}</div>
<div class="ttc" id="amutt_2string_8c_html_a6f574867aa9db4d434adbc8af1f5f7e7"><div class="ttname"><a href="mutt_2string_8c.html#a6f574867aa9db4d434adbc8af1f5f7e7">mutt_strn_equal</a></div><div class="ttdeci">bool mutt_strn_equal(const char *a, const char *b, size_t num)</div><div class="ttdoc">Check for equality of two strings (to a maximum), safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00427">string.c:427</a></div></div>
</div><!-- fragment --><div id="dynsection-39" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-39-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-39-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-39-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a3230991ab72820135b5ba8fe94a5f43d_cgraph.svg" width="316" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-40" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-40-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-40-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-40-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="crypt_8c_a3230991ab72820135b5ba8fe94a5f43d_icgraph.svg" width="336" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>
