<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: ncrypt/pgp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><a href="https://neomutt.org"><img alt="Logo" src="neomutt-64.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <a style="color: black; text-decoration: none;" href="https://neomutt.org">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">2025-09-05-43-g177ed6</span>
   </div>
   <div id="projectbrief">Teaching an old dog new tricks</div>
   </a>
   <a href="https://github.com/neomutt/neomutt" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000000; color:#fff; position: fixed; top: 0; border: 0; right: 0; z-index: 9999;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </td>
   <td><a style="text-decoration: none; position: absolute; right: 0; top: 25px; margin-right: 100px; color: #66d866; font-size: 400%;" href="http://www.doxygen.org/index.html">DOXYGEN</a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('pgp_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">pgp.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>PGP sign, encrypt, check routines.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;config.h&quot;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &quot;<a class="el" href="mutt_2lib_8h_source.html">mutt/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="address_2lib_8h_source.html">address/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="config_2lib_8h_source.html">config/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="email_2lib_8h_source.html">email/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="core_2lib_8h_source.html">core/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="gui_2lib_8h_source.html">gui/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mutt_8h_source.html">mutt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="attach_2lib_8h_source.html">attach/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="editor_2lib_8h_source.html">editor/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="history_2lib_8h_source.html">history/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="question_2lib_8h_source.html">question/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="send_2lib_8h_source.html">send/lib.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypt_8h_source.html">crypt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cryptglue_8h_source.html">cryptglue.h</a>&quot;</code><br />
<code>#include &quot;globals.h&quot;</code><br />
<code>#include &quot;<a class="el" href="handler_8h_source.html">handler.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hook_8h_source.html">hook.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pgpinvoke_8h_source.html">pgpinvoke.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pgpkey_8h_source.html">pgpkey.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pgpmicalg_8h_source.html">pgpmicalg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pgp_8h_source.html">pgp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pgplib_8h_source.html">pgplib.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for pgp.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c__incl.svg" width="2320" height="351"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="pgp_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5f22ad399cd8c0e467f61969e762aba0" id="r_ga5f22ad399cd8c0e467f61969e762aba0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__void__passphrase.html#ga5f22ad399cd8c0e467f61969e762aba0">pgp_class_void_passphrase</a> (void)</td></tr>
<tr class="memdesc:ga5f22ad399cd8c0e467f61969e762aba0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forget the cached passphrase - Implements <a class="el" href="structCryptModuleSpecs.html#ac08ed67f7b29c7b6cba6d4999cebf739">CryptModuleSpecs::void_passphrase()</a> -.  <br /></td></tr>
<tr class="separator:ga5f22ad399cd8c0e467f61969e762aba0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e9e718dd04065013a56713bc7b0eae4" id="r_ga0e9e718dd04065013a56713bc7b0eae4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__valid__passphrase.html#ga0e9e718dd04065013a56713bc7b0eae4">pgp_class_valid_passphrase</a> (void)</td></tr>
<tr class="memdesc:ga0e9e718dd04065013a56713bc7b0eae4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ensure we have a valid passphrase - Implements <a class="el" href="structCryptModuleSpecs.html#a8e4fee6a5203c68d854e1d328559889a">CryptModuleSpecs::valid_passphrase()</a> -.  <br /></td></tr>
<tr class="separator:ga0e9e718dd04065013a56713bc7b0eae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab97e1713bb20da422b5a71b68747edf9" id="r_ab97e1713bb20da422b5a71b68747edf9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab97e1713bb20da422b5a71b68747edf9">pgp_use_gpg_agent</a> (void)</td></tr>
<tr class="memdesc:ab97e1713bb20da422b5a71b68747edf9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the user want to use the gpg agent?  <br /></td></tr>
<tr class="separator:ab97e1713bb20da422b5a71b68747edf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ee67a88295a31cfe7653f3f942b1597" id="r_a6ee67a88295a31cfe7653f3f942b1597"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ee67a88295a31cfe7653f3f942b1597">key_parent</a> (struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *k)</td></tr>
<tr class="memdesc:a6ee67a88295a31cfe7653f3f942b1597"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find a key's parent (if it's a subkey)  <br /></td></tr>
<tr class="separator:a6ee67a88295a31cfe7653f3f942b1597"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0594eb9847bb3efa4655f1e879965c67" id="r_a0594eb9847bb3efa4655f1e879965c67"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0594eb9847bb3efa4655f1e879965c67">pgp_long_keyid</a> (struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *k)</td></tr>
<tr class="memdesc:a0594eb9847bb3efa4655f1e879965c67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a key's long id.  <br /></td></tr>
<tr class="separator:a0594eb9847bb3efa4655f1e879965c67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e33e87be2d0787328819b37c572430b" id="r_a7e33e87be2d0787328819b37c572430b"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7e33e87be2d0787328819b37c572430b">pgp_short_keyid</a> (struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *k)</td></tr>
<tr class="memdesc:a7e33e87be2d0787328819b37c572430b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a key's short id.  <br /></td></tr>
<tr class="separator:a7e33e87be2d0787328819b37c572430b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a088244d0cf785e751ed245623703e631" id="r_a088244d0cf785e751ed245623703e631"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a088244d0cf785e751ed245623703e631">pgp_this_keyid</a> (struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *k)</td></tr>
<tr class="memdesc:a088244d0cf785e751ed245623703e631"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the ID of this key.  <br /></td></tr>
<tr class="separator:a088244d0cf785e751ed245623703e631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d96bbbe834f8d04190bc0a2ab462ca" id="r_a67d96bbbe834f8d04190bc0a2ab462ca"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a67d96bbbe834f8d04190bc0a2ab462ca">pgp_keyid</a> (struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *k)</td></tr>
<tr class="memdesc:a67d96bbbe834f8d04190bc0a2ab462ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the ID of the main (parent) key.  <br /></td></tr>
<tr class="separator:a67d96bbbe834f8d04190bc0a2ab462ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a301763381fe67ab793483714022a7e1d" id="r_a301763381fe67ab793483714022a7e1d"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a301763381fe67ab793483714022a7e1d">pgp_fingerprint</a> (struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *k)</td></tr>
<tr class="memdesc:a301763381fe67ab793483714022a7e1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the key's fingerprint.  <br /></td></tr>
<tr class="separator:a301763381fe67ab793483714022a7e1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a692583986765bc89f4fb41de97b3d372" id="r_a692583986765bc89f4fb41de97b3d372"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a692583986765bc89f4fb41de97b3d372">pgp_fpr_or_lkeyid</a> (struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *k)</td></tr>
<tr class="memdesc:a692583986765bc89f4fb41de97b3d372"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the fingerprint or long keyid.  <br /></td></tr>
<tr class="separator:a692583986765bc89f4fb41de97b3d372"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a753f39f0bc86f2260fc9073f7742a19d" id="r_a753f39f0bc86f2260fc9073f7742a19d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a753f39f0bc86f2260fc9073f7742a19d">pgp_copy_checksig</a> (FILE *fp_in, FILE *fp_out)</td></tr>
<tr class="memdesc:a753f39f0bc86f2260fc9073f7742a19d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy PGP output and look for signs of a good signature.  <br /></td></tr>
<tr class="separator:a753f39f0bc86f2260fc9073f7742a19d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bee0ec912711eeaa86cebb084d0c24a" id="r_a3bee0ec912711eeaa86cebb084d0c24a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3bee0ec912711eeaa86cebb084d0c24a">pgp_check_pgp_decryption_okay_regex</a> (FILE *fp_in)</td></tr>
<tr class="memdesc:a3bee0ec912711eeaa86cebb084d0c24a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check PGP output to look for successful outcome.  <br /></td></tr>
<tr class="separator:a3bee0ec912711eeaa86cebb084d0c24a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac53a734c897d0e372496a56c897d1bd6" id="r_ac53a734c897d0e372496a56c897d1bd6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac53a734c897d0e372496a56c897d1bd6">pgp_check_decryption_okay</a> (FILE *fp_in)</td></tr>
<tr class="memdesc:ac53a734c897d0e372496a56c897d1bd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check GPG output for status codes.  <br /></td></tr>
<tr class="separator:ac53a734c897d0e372496a56c897d1bd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82b68cdce916dc016c7d1bfc47acc3ca" id="r_a82b68cdce916dc016c7d1bfc47acc3ca"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a82b68cdce916dc016c7d1bfc47acc3ca">pgp_copy_clearsigned</a> (FILE *fp_in, struct <a class="el" href="structState.html">State</a> *state, char *charset)</td></tr>
<tr class="memdesc:a82b68cdce916dc016c7d1bfc47acc3ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy a clearsigned message, stripping the signature.  <br /></td></tr>
<tr class="separator:a82b68cdce916dc016c7d1bfc47acc3ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga646a1189aba6f7e3d303698fe81b210c" id="r_ga646a1189aba6f7e3d303698fe81b210c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__application__handler.html#ga646a1189aba6f7e3d303698fe81b210c">pgp_class_application_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga646a1189aba6f7e3d303698fe81b210c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage the MIME type "application/pgp" or "application/smime" - Implements <a class="el" href="structCryptModuleSpecs.html#a9d7b47fb748a7cdb4975f2dde8179a98">CryptModuleSpecs::application_handler()</a> -.  <br /></td></tr>
<tr class="separator:ga646a1189aba6f7e3d303698fe81b210c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae84f9751f65e2c9f3d4d6c60e2d1905c" id="r_ae84f9751f65e2c9f3d4d6c60e2d1905c"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae84f9751f65e2c9f3d4d6c60e2d1905c">pgp_check_traditional_one_body</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:ae84f9751f65e2c9f3d4d6c60e2d1905c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the body of an inline PGP message.  <br /></td></tr>
<tr class="separator:ae84f9751f65e2c9f3d4d6c60e2d1905c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3216349cfeba9673dd310fdc76f2e8eb" id="r_ga3216349cfeba9673dd310fdc76f2e8eb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__pgp__check__traditional.html#ga3216349cfeba9673dd310fdc76f2e8eb">pgp_class_check_traditional</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b, bool just_one)</td></tr>
<tr class="memdesc:ga3216349cfeba9673dd310fdc76f2e8eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Look for inline (non-MIME) PGP content - Implements <a class="el" href="structCryptModuleSpecs.html#abbb74e663273948a7e2ad35a1135e6a2">CryptModuleSpecs::pgp_check_traditional()</a> -.  <br /></td></tr>
<tr class="separator:ga3216349cfeba9673dd310fdc76f2e8eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e16e0a79ddb7552c5a6df94dc238a15" id="r_ga3e16e0a79ddb7552c5a6df94dc238a15"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__verify__one.html#ga3e16e0a79ddb7552c5a6df94dc238a15">pgp_class_verify_one</a> (struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structState.html">State</a> *state, const char *tempfile)</td></tr>
<tr class="memdesc:ga3e16e0a79ddb7552c5a6df94dc238a15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check a signed MIME part against a signature - Implements <a class="el" href="structCryptModuleSpecs.html#abe8b95602735ac15f4f3a8d6ab1dc45b">CryptModuleSpecs::verify_one()</a> -.  <br /></td></tr>
<tr class="separator:ga3e16e0a79ddb7552c5a6df94dc238a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2a7bf43d00fb1c2d55a4c2eec3cdcd4" id="r_ab2a7bf43d00fb1c2d55a4c2eec3cdcd4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2a7bf43d00fb1c2d55a4c2eec3cdcd4">pgp_extract_keys_from_attachment</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:ab2a7bf43d00fb1c2d55a4c2eec3cdcd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract pgp keys from messages/attachments.  <br /></td></tr>
<tr class="separator:ab2a7bf43d00fb1c2d55a4c2eec3cdcd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabbed31f62b13dc442e28f334de2dba25" id="r_gabbed31f62b13dc442e28f334de2dba25"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__pgp__extract__key__from__attachment.html#gabbed31f62b13dc442e28f334de2dba25">pgp_class_extract_key_from_attachment</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:gabbed31f62b13dc442e28f334de2dba25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract PGP key from an attachment - Implements <a class="el" href="structCryptModuleSpecs.html#a7660e30a85a5ae60da1a384d1d351272">CryptModuleSpecs::pgp_extract_key_from_attachment()</a> -.  <br /></td></tr>
<tr class="separator:gabbed31f62b13dc442e28f334de2dba25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2710f9de758f312094ad0e30e69a40da" id="r_a2710f9de758f312094ad0e30e69a40da"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2710f9de758f312094ad0e30e69a40da">pgp_decrypt_part</a> (struct <a class="el" href="structBody.html">Body</a> *a, struct <a class="el" href="structState.html">State</a> *state, FILE *fp_out, struct <a class="el" href="structBody.html">Body</a> *p)</td></tr>
<tr class="memdesc:a2710f9de758f312094ad0e30e69a40da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt part of a PGP message.  <br /></td></tr>
<tr class="separator:a2710f9de758f312094ad0e30e69a40da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga43e8362aa45c7f09b13383545fa7a647" id="r_ga43e8362aa45c7f09b13383545fa7a647"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__decrypt__mime.html#ga43e8362aa45c7f09b13383545fa7a647">pgp_class_decrypt_mime</a> (FILE *fp_in, FILE **fp_out, struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structBody.html">Body</a> **b_dec)</td></tr>
<tr class="memdesc:ga43e8362aa45c7f09b13383545fa7a647"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt an encrypted MIME part - Implements <a class="el" href="structCryptModuleSpecs.html#a18cf5903d388ba3cc91431e5076271ee">CryptModuleSpecs::decrypt_mime()</a> -.  <br /></td></tr>
<tr class="separator:ga43e8362aa45c7f09b13383545fa7a647"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf900efa29f642fc76db86fd46b2da83d" id="r_gaf900efa29f642fc76db86fd46b2da83d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__encrypted__handler.html#gaf900efa29f642fc76db86fd46b2da83d">pgp_class_encrypted_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:gaf900efa29f642fc76db86fd46b2da83d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage a PGP or S/MIME encrypted MIME part - Implements <a class="el" href="structCryptModuleSpecs.html#a0a6f227729bf45fc362bc0896a241de2">CryptModuleSpecs::encrypted_handler()</a> -.  <br /></td></tr>
<tr class="separator:gaf900efa29f642fc76db86fd46b2da83d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4b65a3544c6b5557c5ef6d7670c31e34" id="r_ga4b65a3544c6b5557c5ef6d7670c31e34"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__sign__message.html#ga4b65a3544c6b5557c5ef6d7670c31e34">pgp_class_sign_message</a> (struct <a class="el" href="structBody.html">Body</a> *b, const struct AddressList *from)</td></tr>
<tr class="memdesc:ga4b65a3544c6b5557c5ef6d7670c31e34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cryptographically sign the <a class="el" href="structBody.html" title="The body of an email.">Body</a> of a message - Implements <a class="el" href="structCryptModuleSpecs.html#a2b299059989dd0e333b86782f2138ab3">CryptModuleSpecs::sign_message()</a> -.  <br /></td></tr>
<tr class="separator:ga4b65a3544c6b5557c5ef6d7670c31e34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga413b96fceb52c5942da793926865caa0" id="r_ga413b96fceb52c5942da793926865caa0"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__find__keys.html#ga413b96fceb52c5942da793926865caa0">pgp_class_find_keys</a> (const struct AddressList *addrlist, bool oppenc_mode)</td></tr>
<tr class="memdesc:ga413b96fceb52c5942da793926865caa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the keyids of the recipients of a message - Implements <a class="el" href="structCryptModuleSpecs.html#af0b575dd8d3a347cfccd49fe8c2a09b6">CryptModuleSpecs::find_keys()</a> -.  <br /></td></tr>
<tr class="separator:ga413b96fceb52c5942da793926865caa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafe8a926773c49bff3b9c1480150aa23f" id="r_gafe8a926773c49bff3b9c1480150aa23f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__pgp__encrypt__message.html#gafe8a926773c49bff3b9c1480150aa23f">pgp_class_encrypt_message</a> (struct <a class="el" href="structBody.html">Body</a> *b, char *keylist, bool sign, const struct AddressList *from)</td></tr>
<tr class="memdesc:gafe8a926773c49bff3b9c1480150aa23f"><td class="mdescLeft">&#160;</td><td class="mdescRight">PGP encrypt an email - Implements <a class="el" href="structCryptModuleSpecs.html#a9a42ba8d47527a42920e3bc345fdda71">CryptModuleSpecs::pgp_encrypt_message()</a> -.  <br /></td></tr>
<tr class="separator:gafe8a926773c49bff3b9c1480150aa23f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaa1aedb09184862e99651bd5cde64d41" id="r_gaaa1aedb09184862e99651bd5cde64d41"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__pgp__traditional__encryptsign.html#gaaa1aedb09184862e99651bd5cde64d41">pgp_class_traditional_encryptsign</a> (struct <a class="el" href="structBody.html">Body</a> *b, <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> flags, char *keylist)</td></tr>
<tr class="memdesc:gaaa1aedb09184862e99651bd5cde64d41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an inline PGP encrypted, signed email - Implements <a class="el" href="structCryptModuleSpecs.html#af5f45c737edb1e4cb2680bddeb695203">CryptModuleSpecs::pgp_traditional_encryptsign()</a> -.  <br /></td></tr>
<tr class="separator:gaaa1aedb09184862e99651bd5cde64d41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8b0a3fa1ac99d5701063bc472fec560b" id="r_ga8b0a3fa1ac99d5701063bc472fec560b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__send__menu.html#ga8b0a3fa1ac99d5701063bc472fec560b">pgp_class_send_menu</a> (struct <a class="el" href="structEmail.html">Email</a> *e)</td></tr>
<tr class="memdesc:ga8b0a3fa1ac99d5701063bc472fec560b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ask the user whether to sign and/or encrypt the email - Implements <a class="el" href="structCryptModuleSpecs.html#aa5176c9adfe75f78d99e4c2bd7e6671c">CryptModuleSpecs::send_menu()</a> -.  <br /></td></tr>
<tr class="separator:ga8b0a3fa1ac99d5701063bc472fec560b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4bff03001e5dff05a97e4e071e1a1a4d" id="r_a4bff03001e5dff05a97e4e071e1a1a4d"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4bff03001e5dff05a97e4e071e1a1a4d">PgpPass</a> [1024]</td></tr>
<tr class="memdesc:a4bff03001e5dff05a97e4e071e1a1a4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cached PGP Passphrase.  <br /></td></tr>
<tr class="separator:a4bff03001e5dff05a97e4e071e1a1a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67c928e6b6f8be62b399745abd9029e1" id="r_a67c928e6b6f8be62b399745abd9029e1"><td class="memItemLeft" align="right" valign="top">static time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a67c928e6b6f8be62b399745abd9029e1">PgpExptime</a> = 0</td></tr>
<tr class="memdesc:a67c928e6b6f8be62b399745abd9029e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unix time when <a class="el" href="#a4bff03001e5dff05a97e4e071e1a1a4d" title="Cached PGP Passphrase.">PgpPass</a> expires.  <br /></td></tr>
<tr class="separator:a67c928e6b6f8be62b399745abd9029e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>PGP sign, encrypt, check routines. </p>
<dl class="section author"><dt>Authors</dt><dd><ul>
<li>Richard Russon</li>
<li>Pietro Cerutti</li>
<li>Alejandro Colomar</li>
</ul>
</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 2 of the License, or (at your option) any later version.</dd></dl>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>

<p class="definition">Definition in file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab97e1713bb20da422b5a71b68747edf9" name="ab97e1713bb20da422b5a71b68747edf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab97e1713bb20da422b5a71b68747edf9">&#9670;&#160;</a></span>pgp_use_gpg_agent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool pgp_use_gpg_agent </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the user want to use the gpg agent? </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>The user wants to use the gpg agent</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This functions sets the environment variable <code>$GPG_TTY</code> </dd></dl>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00127">127</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  128</span>{</div>
<div class="line"><span class="lineno">  129</span>  <span class="keywordtype">char</span> *tty = NULL;</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  <span class="comment">/* GnuPG 2.1 no longer exports GPG_AGENT_INFO */</span></div>
<div class="line"><span class="lineno">  132</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_use_gpg_agent = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_use_gpg_agent&quot;</span>);</div>
<div class="line"><span class="lineno">  133</span>  <span class="keywordflow">if</span> (!c_pgp_use_gpg_agent)</div>
<div class="line"><span class="lineno">  134</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>  tty = ttyname(0);</div>
<div class="line"><span class="lineno">  137</span>  <span class="keywordflow">if</span> (tty)</div>
<div class="line"><span class="lineno">  138</span>  {</div>
<div class="line"><span class="lineno">  139</span>    setenv(<span class="stringliteral">&quot;GPG_TTY&quot;</span>, tty, 0);</div>
<div class="line"><span class="lineno">  140</span>    <a class="code hl_function" href="envlist_8c.html#a8643dfebf12ab95f38021cf7fac716cc">envlist_set</a>(&amp;<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">env</a>, <span class="stringliteral">&quot;GPG_TTY&quot;</span>, tty, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  141</span>  }</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  144</span>}</div>
<div class="ttc" id="aconfig_2helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00047">helpers.c:47</a></div></div>
<div class="ttc" id="aenvlist_8c_html_a8643dfebf12ab95f38021cf7fac716cc"><div class="ttname"><a href="envlist_8c.html#a8643dfebf12ab95f38021cf7fac716cc">envlist_set</a></div><div class="ttdeci">bool envlist_set(char ***envp, const char *name, const char *value, bool overwrite)</div><div class="ttdoc">Set an environment variable.</div><div class="ttdef"><b>Definition</b> <a href="envlist_8c_source.html#l00088">envlist.c:88</a></div></div>
<div class="ttc" id="astructNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00042">neomutt.h:43</a></div></div>
<div class="ttc" id="astructNeoMutt_html_a5410041863c473ba1f27b415c0a40482"><div class="ttname"><a href="structNeoMutt.html#a5410041863c473ba1f27b415c0a40482">NeoMutt::env</a></div><div class="ttdeci">char ** env</div><div class="ttdoc">Private copy of the environment variables.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00055">neomutt.h:55</a></div></div>
<div class="ttc" id="astructNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items.</div><div class="ttdef"><b>Definition</b> <a href="neomutt_8h_source.html#l00047">neomutt.h:47</a></div></div>
</div><!-- fragment --><div id="dynsection-1" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_ab97e1713bb20da422b5a71b68747edf9_cgraph.svg" width="318" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-2" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_ab97e1713bb20da422b5a71b68747edf9_icgraph.svg" width="598" height="307"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6ee67a88295a31cfe7653f3f942b1597" name="a6ee67a88295a31cfe7653f3f942b1597"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ee67a88295a31cfe7653f3f942b1597">&#9670;&#160;</a></span>key_parent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> * key_parent </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>k</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Find a key's parent (if it's a subkey) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>PGP key </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Parent key </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00151">151</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  152</span>{</div>
<div class="line"><span class="lineno">  153</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_ignore_subkeys = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_ignore_subkeys&quot;</span>);</div>
<div class="line"><span class="lineno">  154</span>  <span class="keywordflow">if</span> ((k-&gt;<a class="code hl_variable" href="structPgpKeyInfo.html#a38de8af2454c2c95cbaad2132de7ba58">flags</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a73a1ead56127b7fac407296e153c0967">KEYFLAG_SUBKEY</a>) &amp;&amp; k-&gt;<a class="code hl_variable" href="structPgpKeyInfo.html#ac918ad0c67f7cda50a3bac661ffa2e4a">parent</a> &amp;&amp; c_pgp_ignore_subkeys)</div>
<div class="line"><span class="lineno">  155</span>    k = k-&gt;<a class="code hl_variable" href="structPgpKeyInfo.html#ac918ad0c67f7cda50a3bac661ffa2e4a">parent</a>;</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>  <span class="keywordflow">return</span> k;</div>
<div class="line"><span class="lineno">  158</span>}</div>
<div class="ttc" id="ancrypt_2lib_8h_html_a73a1ead56127b7fac407296e153c0967"><div class="ttname"><a href="ncrypt_2lib_8h.html#a73a1ead56127b7fac407296e153c0967">KEYFLAG_SUBKEY</a></div><div class="ttdeci">#define KEYFLAG_SUBKEY</div><div class="ttdoc">Key is a subkey.</div><div class="ttdef"><b>Definition</b> <a href="ncrypt_2lib_8h_source.html#l00140">lib.h:140</a></div></div>
<div class="ttc" id="astructPgpKeyInfo_html_a38de8af2454c2c95cbaad2132de7ba58"><div class="ttname"><a href="structPgpKeyInfo.html#a38de8af2454c2c95cbaad2132de7ba58">PgpKeyInfo::flags</a></div><div class="ttdeci">KeyFlags flags</div><div class="ttdef"><b>Definition</b> <a href="pgplib_8h_source.html#l00053">pgplib.h:53</a></div></div>
<div class="ttc" id="astructPgpKeyInfo_html_ac918ad0c67f7cda50a3bac661ffa2e4a"><div class="ttname"><a href="structPgpKeyInfo.html#ac918ad0c67f7cda50a3bac661ffa2e4a">PgpKeyInfo::parent</a></div><div class="ttdeci">struct PgpKeyInfo * parent</div><div class="ttdef"><b>Definition</b> <a href="pgplib_8h_source.html#l00058">pgplib.h:58</a></div></div>
</div><!-- fragment --><div id="dynsection-3" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a6ee67a88295a31cfe7653f3f942b1597_cgraph.svg" width="262" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-4" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a6ee67a88295a31cfe7653f3f942b1597_icgraph.svg" width="271" height="200"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0594eb9847bb3efa4655f1e879965c67" name="a0594eb9847bb3efa4655f1e879965c67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0594eb9847bb3efa4655f1e879965c67">&#9670;&#160;</a></span>pgp_long_keyid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * pgp_long_keyid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>k</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a key's long id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>PGP key </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Long key id string </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00165">165</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  166</span>{</div>
<div class="line"><span class="lineno">  167</span>  k = <a class="code hl_function" href="#a6ee67a88295a31cfe7653f3f942b1597">key_parent</a>(k);</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>  <span class="keywordflow">return</span> k-&gt;<a class="code hl_variable" href="structPgpKeyInfo.html#a14a4c60b65ccf16697bd4578117ed83d">keyid</a>;</div>
<div class="line"><span class="lineno">  170</span>}</div>
<div class="ttc" id="apgp_8c_html_a6ee67a88295a31cfe7653f3f942b1597"><div class="ttname"><a href="#a6ee67a88295a31cfe7653f3f942b1597">key_parent</a></div><div class="ttdeci">static struct PgpKeyInfo * key_parent(struct PgpKeyInfo *k)</div><div class="ttdoc">Find a key&#39;s parent (if it&#39;s a subkey)</div><div class="ttdef"><b>Definition</b> <a href="pgp_8c_source.html#l00151">pgp.c:151</a></div></div>
<div class="ttc" id="astructPgpKeyInfo_html_a14a4c60b65ccf16697bd4578117ed83d"><div class="ttname"><a href="structPgpKeyInfo.html#a14a4c60b65ccf16697bd4578117ed83d">PgpKeyInfo::keyid</a></div><div class="ttdeci">char * keyid</div><div class="ttdef"><b>Definition</b> <a href="pgplib_8h_source.html#l00050">pgplib.h:50</a></div></div>
</div><!-- fragment --><div id="dynsection-5" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a0594eb9847bb3efa4655f1e879965c67_cgraph.svg" width="264" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-6" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a0594eb9847bb3efa4655f1e879965c67_icgraph.svg" width="307" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7e33e87be2d0787328819b37c572430b" name="a7e33e87be2d0787328819b37c572430b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e33e87be2d0787328819b37c572430b">&#9670;&#160;</a></span>pgp_short_keyid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * pgp_short_keyid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>k</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a key's short id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>PGP key </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Short key id string </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00177">177</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  178</span>{</div>
<div class="line"><span class="lineno">  179</span>  k = <a class="code hl_function" href="#a6ee67a88295a31cfe7653f3f942b1597">key_parent</a>(k);</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>  <span class="keywordflow">return</span> k-&gt;<a class="code hl_variable" href="structPgpKeyInfo.html#a14a4c60b65ccf16697bd4578117ed83d">keyid</a> + 8;</div>
<div class="line"><span class="lineno">  182</span>}</div>
</div><!-- fragment --><div id="dynsection-7" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a7e33e87be2d0787328819b37c572430b_cgraph.svg" width="271" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-8" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a7e33e87be2d0787328819b37c572430b_icgraph.svg" width="307" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a088244d0cf785e751ed245623703e631" name="a088244d0cf785e751ed245623703e631"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a088244d0cf785e751ed245623703e631">&#9670;&#160;</a></span>pgp_this_keyid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * pgp_this_keyid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>k</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the ID of this key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>PGP key </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Long/Short key id string</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The string returned depends on <code>$pgp_long_ids</code> </dd></dl>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00191">191</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  192</span>{</div>
<div class="line"><span class="lineno">  193</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_long_ids = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_long_ids&quot;</span>);</div>
<div class="line"><span class="lineno">  194</span>  <span class="keywordflow">if</span> (c_pgp_long_ids)</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">return</span> k-&gt;<a class="code hl_variable" href="structPgpKeyInfo.html#a14a4c60b65ccf16697bd4578117ed83d">keyid</a>;</div>
<div class="line"><span class="lineno">  196</span>  <span class="keywordflow">return</span> k-&gt;<a class="code hl_variable" href="structPgpKeyInfo.html#a14a4c60b65ccf16697bd4578117ed83d">keyid</a> + 8;</div>
<div class="line"><span class="lineno">  197</span>}</div>
</div><!-- fragment --><div id="dynsection-9" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a088244d0cf785e751ed245623703e631_cgraph.svg" width="284" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-10" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a088244d0cf785e751ed245623703e631_icgraph.svg" width="268" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a67d96bbbe834f8d04190bc0a2ab462ca" name="a67d96bbbe834f8d04190bc0a2ab462ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67d96bbbe834f8d04190bc0a2ab462ca">&#9670;&#160;</a></span>pgp_keyid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * pgp_keyid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>k</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the ID of the main (parent) key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>PGP key </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Long/Short key id string </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00204">204</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  205</span>{</div>
<div class="line"><span class="lineno">  206</span>  k = <a class="code hl_function" href="#a6ee67a88295a31cfe7653f3f942b1597">key_parent</a>(k);</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="#a088244d0cf785e751ed245623703e631">pgp_this_keyid</a>(k);</div>
<div class="line"><span class="lineno">  209</span>}</div>
<div class="ttc" id="apgp_8c_html_a088244d0cf785e751ed245623703e631"><div class="ttname"><a href="#a088244d0cf785e751ed245623703e631">pgp_this_keyid</a></div><div class="ttdeci">char * pgp_this_keyid(struct PgpKeyInfo *k)</div><div class="ttdoc">Get the ID of this key.</div><div class="ttdef"><b>Definition</b> <a href="pgp_8c_source.html#l00191">pgp.c:191</a></div></div>
</div><!-- fragment --><div id="dynsection-11" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a67d96bbbe834f8d04190bc0a2ab462ca_cgraph.svg" width="254" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-12" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a67d96bbbe834f8d04190bc0a2ab462ca_icgraph.svg" width="280" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a301763381fe67ab793483714022a7e1d" name="a301763381fe67ab793483714022a7e1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a301763381fe67ab793483714022a7e1d">&#9670;&#160;</a></span>pgp_fingerprint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char * pgp_fingerprint </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>k</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the key's fingerprint. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>PGP key </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>Fingerprint string </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00216">216</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  217</span>{</div>
<div class="line"><span class="lineno">  218</span>  k = <a class="code hl_function" href="#a6ee67a88295a31cfe7653f3f942b1597">key_parent</a>(k);</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>  <span class="keywordflow">return</span> k-&gt;<a class="code hl_variable" href="structPgpKeyInfo.html#a4cdd48d32a130fd8257a26f41508d313">fingerprint</a>;</div>
<div class="line"><span class="lineno">  221</span>}</div>
<div class="ttc" id="astructPgpKeyInfo_html_a4cdd48d32a130fd8257a26f41508d313"><div class="ttname"><a href="structPgpKeyInfo.html#a4cdd48d32a130fd8257a26f41508d313">PgpKeyInfo::fingerprint</a></div><div class="ttdeci">char * fingerprint</div><div class="ttdef"><b>Definition</b> <a href="pgplib_8h_source.html#l00051">pgplib.h:51</a></div></div>
</div><!-- fragment --><div id="dynsection-13" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a301763381fe67ab793483714022a7e1d_cgraph.svg" width="268" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-14" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a301763381fe67ab793483714022a7e1d_icgraph.svg" width="310" height="40"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a692583986765bc89f4fb41de97b3d372" name="a692583986765bc89f4fb41de97b3d372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a692583986765bc89f4fb41de97b3d372">&#9670;&#160;</a></span>pgp_fpr_or_lkeyid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * pgp_fpr_or_lkeyid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structPgpKeyInfo.html">PgpKeyInfo</a> *</td>          <td class="paramname"><span class="paramname"><em>k</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the fingerprint or long keyid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>PGP key </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>String fingerprint or long keyid</td></tr>
  </table>
  </dd>
</dl>
<p>Grab the longest key identifier available: fingerprint or else the long keyid.</p>
<p>The longest available should be used for internally identifying the key and for invoking pgp commands. </p>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00234">234</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  235</span>{</div>
<div class="line"><span class="lineno">  236</span>  <span class="keywordtype">char</span> *fingerprint = <a class="code hl_function" href="#a301763381fe67ab793483714022a7e1d">pgp_fingerprint</a>(k);</div>
<div class="line"><span class="lineno">  237</span>  <span class="keywordflow">return</span> fingerprint ? fingerprint : <a class="code hl_function" href="#a0594eb9847bb3efa4655f1e879965c67">pgp_long_keyid</a>(k);</div>
<div class="line"><span class="lineno">  238</span>}</div>
<div class="ttc" id="apgp_8c_html_a0594eb9847bb3efa4655f1e879965c67"><div class="ttname"><a href="#a0594eb9847bb3efa4655f1e879965c67">pgp_long_keyid</a></div><div class="ttdeci">char * pgp_long_keyid(struct PgpKeyInfo *k)</div><div class="ttdoc">Get a key&#39;s long id.</div><div class="ttdef"><b>Definition</b> <a href="pgp_8c_source.html#l00165">pgp.c:165</a></div></div>
<div class="ttc" id="apgp_8c_html_a301763381fe67ab793483714022a7e1d"><div class="ttname"><a href="#a301763381fe67ab793483714022a7e1d">pgp_fingerprint</a></div><div class="ttdeci">static char * pgp_fingerprint(struct PgpKeyInfo *k)</div><div class="ttdoc">Get the key&#39;s fingerprint.</div><div class="ttdef"><b>Definition</b> <a href="pgp_8c_source.html#l00216">pgp.c:216</a></div></div>
</div><!-- fragment --><div id="dynsection-15" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a692583986765bc89f4fb41de97b3d372_cgraph.svg" width="310" height="94"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-16" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a692583986765bc89f4fb41de97b3d372_icgraph.svg" width="348" height="379"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a753f39f0bc86f2260fc9073f7742a19d" name="a753f39f0bc86f2260fc9073f7742a19d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a753f39f0bc86f2260fc9073f7742a19d">&#9670;&#160;</a></span>pgp_copy_checksig()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int pgp_copy_checksig </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp_in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp_out</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy PGP output and look for signs of a good signature. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp_in</td><td>File to read from </td></tr>
    <tr><td class="paramname">fp_out</td><td>File to write to </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00251">251</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  252</span>{</div>
<div class="line"><span class="lineno">  253</span>  <span class="keywordflow">if</span> (!fp_in || !fp_out)</div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>  <span class="keywordtype">int</span> rc = -1;</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structRegex.html">Regex</a> *c_pgp_good_sign = <a class="code hl_function" href="config_2helpers_8c.html#a1c788f1dbe7b04cec7721fc1c7680b48">cs_subset_regex</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_good_sign&quot;</span>);</div>
<div class="line"><span class="lineno">  259</span>  <span class="keywordflow">if</span> (c_pgp_good_sign &amp;&amp; c_pgp_good_sign-&gt;<a class="code hl_variable" href="structRegex.html#af9ccc25da6324c9055e53966abe9a7b3">regex</a>)</div>
<div class="line"><span class="lineno">  260</span>  {</div>
<div class="line"><span class="lineno">  261</span>    <span class="keywordtype">char</span> *line = NULL;</div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordtype">size_t</span> linelen;</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>    <span class="keywordflow">while</span> ((line = <a class="code hl_function" href="file_8c.html#a1ad76f956147154f16128b7761dadd58">mutt_file_read_line</a>(line, &amp;linelen, fp_in, NULL, <a class="code hl_define" href="file_8h.html#abb6d0dccab49bda4ed23948c7f5d0eaa">MUTT_RL_NO_FLAGS</a>)))</div>
<div class="line"><span class="lineno">  265</span>    {</div>
<div class="line"><span class="lineno">  266</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2regex_8c.html#ad25947e610db74945537b99edf428982">mutt_regex_match</a>(c_pgp_good_sign, line))</div>
<div class="line"><span class="lineno">  267</span>      {</div>
<div class="line"><span class="lineno">  268</span>        <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;\&quot;%s\&quot; matches regex\n&quot;</span>, line);</div>
<div class="line"><span class="lineno">  269</span>        rc = 0;</div>
<div class="line"><span class="lineno">  270</span>      }</div>
<div class="line"><span class="lineno">  271</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  272</span>      {</div>
<div class="line"><span class="lineno">  273</span>        <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;\&quot;%s\&quot; doesn&#39;t match regex\n&quot;</span>, line);</div>
<div class="line"><span class="lineno">  274</span>      }</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a6f574867aa9db4d434adbc8af1f5f7e7">mutt_strn_equal</a>(line, <span class="stringliteral">&quot;[GNUPG:] &quot;</span>, 9))</div>
<div class="line"><span class="lineno">  277</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  278</span>      fputs(line, fp_out);</div>
<div class="line"><span class="lineno">  279</span>      fputc(<span class="charliteral">&#39;\n&#39;</span>, fp_out);</div>
<div class="line"><span class="lineno">  280</span>    }</div>
<div class="line"><span class="lineno">  281</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;line);</div>
<div class="line"><span class="lineno">  282</span>  }</div>
<div class="line"><span class="lineno">  283</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  284</span>  {</div>
<div class="line"><span class="lineno">  285</span>    <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;No pattern\n&quot;</span>);</div>
<div class="line"><span class="lineno">  286</span>    <a class="code hl_function" href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a>(fp_in, fp_out);</div>
<div class="line"><span class="lineno">  287</span>    rc = 1;</div>
<div class="line"><span class="lineno">  288</span>  }</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  291</span>}</div>
<div class="ttc" id="aconfig_2helpers_8c_html_a1c788f1dbe7b04cec7721fc1c7680b48"><div class="ttname"><a href="config_2helpers_8c.html#a1c788f1dbe7b04cec7721fc1c7680b48">cs_subset_regex</a></div><div class="ttdeci">const struct Regex * cs_subset_regex(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a regex config item by name.</div><div class="ttdef"><b>Definition</b> <a href="config_2helpers_8c_source.html#l00217">helpers.c:217</a></div></div>
<div class="ttc" id="afile_8c_html_a0a6ff09a685fb6fa1120a582a5a6ef4a"><div class="ttname"><a href="file_8c.html#a0a6ff09a685fb6fa1120a582a5a6ef4a">mutt_file_copy_stream</a></div><div class="ttdeci">int mutt_file_copy_stream(FILE *fp_in, FILE *fp_out)</div><div class="ttdoc">Copy the contents of one file into another.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00225">file.c:225</a></div></div>
<div class="ttc" id="afile_8c_html_a1ad76f956147154f16128b7761dadd58"><div class="ttname"><a href="file_8c.html#a1ad76f956147154f16128b7761dadd58">mutt_file_read_line</a></div><div class="ttdeci">char * mutt_file_read_line(char *line, size_t *size, FILE *fp, int *line_num, ReadLineFlags flags)</div><div class="ttdoc">Read a line from a file.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00685">file.c:685</a></div></div>
<div class="ttc" id="afile_8h_html_abb6d0dccab49bda4ed23948c7f5d0eaa"><div class="ttname"><a href="file_8h.html#abb6d0dccab49bda4ed23948c7f5d0eaa">MUTT_RL_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_RL_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="file_8h_source.html#l00040">file.h:40</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gae6c5fd73af3410b2d5e8099f8774c8da"><div class="ttname"><a href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a></div><div class="ttdeci">#define mutt_debug(LEVEL,...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00090">logging2.h:90</a></div></div>
<div class="ttc" id="alogging2_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3"><div class="ttname"><a href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a></div><div class="ttdeci">@ LL_DEBUG2</div><div class="ttdoc">Log at debug level 2.</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00045">logging2.h:45</a></div></div>
<div class="ttc" id="amemory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition</b> <a href="memory_8h_source.html#l00062">memory.h:62</a></div></div>
<div class="ttc" id="amutt_2regex_8c_html_ad25947e610db74945537b99edf428982"><div class="ttname"><a href="mutt_2regex_8c.html#ad25947e610db74945537b99edf428982">mutt_regex_match</a></div><div class="ttdeci">bool mutt_regex_match(const struct Regex *regex, const char *str)</div><div class="ttdoc">Shorthand to mutt_regex_capture()</div><div class="ttdef"><b>Definition</b> <a href="mutt_2regex_8c_source.html#l00614">regex.c:614</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a6f574867aa9db4d434adbc8af1f5f7e7"><div class="ttname"><a href="mutt_2string_8c.html#a6f574867aa9db4d434adbc8af1f5f7e7">mutt_strn_equal</a></div><div class="ttdeci">bool mutt_strn_equal(const char *a, const char *b, size_t num)</div><div class="ttdoc">Check for equality of two strings (to a maximum), safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00427">string.c:427</a></div></div>
<div class="ttc" id="astructRegex_html"><div class="ttname"><a href="structRegex.html">Regex</a></div><div class="ttdoc">Cached regular expression.</div><div class="ttdef"><b>Definition</b> <a href="regex3_8h_source.html#l00085">regex3.h:86</a></div></div>
<div class="ttc" id="astructRegex_html_af9ccc25da6324c9055e53966abe9a7b3"><div class="ttname"><a href="structRegex.html#af9ccc25da6324c9055e53966abe9a7b3">Regex::regex</a></div><div class="ttdeci">regex_t * regex</div><div class="ttdoc">compiled expression</div><div class="ttdef"><b>Definition</b> <a href="regex3_8h_source.html#l00088">regex3.h:88</a></div></div>
</div><!-- fragment --><div id="dynsection-17" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a753f39f0bc86f2260fc9073f7742a19d_cgraph.svg" width="358" height="254"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-18" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a753f39f0bc86f2260fc9073f7742a19d_icgraph.svg" width="348" height="166"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3bee0ec912711eeaa86cebb084d0c24a" name="a3bee0ec912711eeaa86cebb084d0c24a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bee0ec912711eeaa86cebb084d0c24a">&#9670;&#160;</a></span>pgp_check_pgp_decryption_okay_regex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int pgp_check_pgp_decryption_okay_regex </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp_in</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check PGP output to look for successful outcome. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp_in</td><td>File to read from </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error</td></tr>
  </table>
  </dd>
</dl>
<p>Checks PGP output messages to look for the $pgp_decryption_okay message. This protects against messages with multipart/encrypted headers but which aren't actually encrypted. </p>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00303">303</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  304</span>{</div>
<div class="line"><span class="lineno">  305</span>  <span class="keywordtype">int</span> rc = -1;</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structRegex.html">Regex</a> *c_pgp_decryption_okay = <a class="code hl_function" href="config_2helpers_8c.html#a1c788f1dbe7b04cec7721fc1c7680b48">cs_subset_regex</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_decryption_okay&quot;</span>);</div>
<div class="line"><span class="lineno">  308</span>  <span class="keywordflow">if</span> (c_pgp_decryption_okay &amp;&amp; c_pgp_decryption_okay-&gt;<a class="code hl_variable" href="structRegex.html#af9ccc25da6324c9055e53966abe9a7b3">regex</a>)</div>
<div class="line"><span class="lineno">  309</span>  {</div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordtype">char</span> *line = NULL;</div>
<div class="line"><span class="lineno">  311</span>    <span class="keywordtype">size_t</span> linelen;</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordflow">while</span> ((line = <a class="code hl_function" href="file_8c.html#a1ad76f956147154f16128b7761dadd58">mutt_file_read_line</a>(line, &amp;linelen, fp_in, NULL, <a class="code hl_define" href="file_8h.html#abb6d0dccab49bda4ed23948c7f5d0eaa">MUTT_RL_NO_FLAGS</a>)))</div>
<div class="line"><span class="lineno">  314</span>    {</div>
<div class="line"><span class="lineno">  315</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2regex_8c.html#ad25947e610db74945537b99edf428982">mutt_regex_match</a>(c_pgp_decryption_okay, line))</div>
<div class="line"><span class="lineno">  316</span>      {</div>
<div class="line"><span class="lineno">  317</span>        <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;\&quot;%s\&quot; matches regex\n&quot;</span>, line);</div>
<div class="line"><span class="lineno">  318</span>        rc = 0;</div>
<div class="line"><span class="lineno">  319</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  320</span>      }</div>
<div class="line"><span class="lineno">  321</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  322</span>      {</div>
<div class="line"><span class="lineno">  323</span>        <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;\&quot;%s\&quot; doesn&#39;t match regex\n&quot;</span>, line);</div>
<div class="line"><span class="lineno">  324</span>      }</div>
<div class="line"><span class="lineno">  325</span>    }</div>
<div class="line"><span class="lineno">  326</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;line);</div>
<div class="line"><span class="lineno">  327</span>  }</div>
<div class="line"><span class="lineno">  328</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  329</span>  {</div>
<div class="line"><span class="lineno">  330</span>    <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;No pattern\n&quot;</span>);</div>
<div class="line"><span class="lineno">  331</span>    rc = 1;</div>
<div class="line"><span class="lineno">  332</span>  }</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  335</span>}</div>
</div><!-- fragment --><div id="dynsection-19" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a3bee0ec912711eeaa86cebb084d0c24a_cgraph.svg" width="387" height="147"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-20" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a3bee0ec912711eeaa86cebb084d0c24a_icgraph.svg" width="443" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac53a734c897d0e372496a56c897d1bd6" name="ac53a734c897d0e372496a56c897d1bd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac53a734c897d0e372496a56c897d1bd6">&#9670;&#160;</a></span>pgp_check_decryption_okay()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int pgp_check_decryption_okay </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp_in</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check GPG output for status codes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp_in</td><td>File to read from </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>- no patterns were matched (if delegated to decryption_okay_regex) </td></tr>
    <tr><td class="paramname">0</td><td>- DECRYPTION_OKAY was seen, with no PLAINTEXT outside </td></tr>
    <tr><td class="paramname">-1</td><td>- No decryption status codes were encountered </td></tr>
    <tr><td class="paramname">-2</td><td>- PLAINTEXT was encountered outside of DECRYPTION delimiters </td></tr>
    <tr><td class="paramname">-3</td><td>- DECRYPTION_FAILED was encountered</td></tr>
  </table>
  </dd>
</dl>
<p>Checks GnuPGP status fd output for various status codes indicating an issue. If $pgp_check_gpg_decrypt_status_fd is unset, it falls back to the old behavior of just scanning for $pgp_decryption_okay.</p>
<p><a class="el" href="#a2710f9de758f312094ad0e30e69a40da" title="Decrypt part of a PGP message.">pgp_decrypt_part()</a> should fail if the part is not encrypted, so we return less than 0 to indicate part or all was NOT actually encrypted.</p>
<p>On the other hand, for pgp_application_pgp_handler(), a "BEGIN PGP MESSAGE" could indicate a signed and armored message. For that we allow -1 and -2 as "valid" (with a warning). </p>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00357">357</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  358</span>{</div>
<div class="line"><span class="lineno">  359</span>  <span class="keywordtype">int</span> rc = -1;</div>
<div class="line"><span class="lineno">  360</span>  <span class="keywordtype">char</span> *line = NULL, *s = NULL;</div>
<div class="line"><span class="lineno">  361</span>  <span class="keywordtype">size_t</span> linelen;</div>
<div class="line"><span class="lineno">  362</span>  <span class="keywordtype">int</span> inside_decrypt = 0;</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_check_gpg_decrypt_status_fd = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_check_gpg_decrypt_status_fd&quot;</span>);</div>
<div class="line"><span class="lineno">  365</span>  <span class="keywordflow">if</span> (!c_pgp_check_gpg_decrypt_status_fd)</div>
<div class="line"><span class="lineno">  366</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#a3bee0ec912711eeaa86cebb084d0c24a">pgp_check_pgp_decryption_okay_regex</a>(fp_in);</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>  <span class="keywordflow">while</span> ((line = <a class="code hl_function" href="file_8c.html#a1ad76f956147154f16128b7761dadd58">mutt_file_read_line</a>(line, &amp;linelen, fp_in, NULL, <a class="code hl_define" href="file_8h.html#abb6d0dccab49bda4ed23948c7f5d0eaa">MUTT_RL_NO_FLAGS</a>)))</div>
<div class="line"><span class="lineno">  369</span>  {</div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordtype">size_t</span> plen = <a class="code hl_function" href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a>(line, <span class="stringliteral">&quot;[GNUPG:] &quot;</span>);</div>
<div class="line"><span class="lineno">  371</span>    <span class="keywordflow">if</span> (plen == 0)</div>
<div class="line"><span class="lineno">  372</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  373</span>    s = line + plen;</div>
<div class="line"><span class="lineno">  374</span>    <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;checking \&quot;%s\&quot;\n&quot;</span>, line);</div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a>(s, <span class="stringliteral">&quot;BEGIN_DECRYPTION&quot;</span>))</div>
<div class="line"><span class="lineno">  376</span>    {</div>
<div class="line"><span class="lineno">  377</span>      inside_decrypt = 1;</div>
<div class="line"><span class="lineno">  378</span>    }</div>
<div class="line"><span class="lineno">  379</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a>(s, <span class="stringliteral">&quot;END_DECRYPTION&quot;</span>))</div>
<div class="line"><span class="lineno">  380</span>    {</div>
<div class="line"><span class="lineno">  381</span>      inside_decrypt = 0;</div>
<div class="line"><span class="lineno">  382</span>    }</div>
<div class="line"><span class="lineno">  383</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a>(s, <span class="stringliteral">&quot;PLAINTEXT&quot;</span>))</div>
<div class="line"><span class="lineno">  384</span>    {</div>
<div class="line"><span class="lineno">  385</span>      <span class="keywordflow">if</span> (!inside_decrypt)</div>
<div class="line"><span class="lineno">  386</span>      {</div>
<div class="line"><span class="lineno">  387</span>        <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;    PLAINTEXT encountered outside of DECRYPTION\n&quot;</span>);</div>
<div class="line"><span class="lineno">  388</span>        rc = -2;</div>
<div class="line"><span class="lineno">  389</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  390</span>      }</div>
<div class="line"><span class="lineno">  391</span>    }</div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a>(s, <span class="stringliteral">&quot;DECRYPTION_FAILED&quot;</span>))</div>
<div class="line"><span class="lineno">  393</span>    {</div>
<div class="line"><span class="lineno">  394</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;    DECRYPTION_FAILED encountered.  Failure\n&quot;</span>);</div>
<div class="line"><span class="lineno">  395</span>      rc = -3;</div>
<div class="line"><span class="lineno">  396</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  397</span>    }</div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a>(s, <span class="stringliteral">&quot;DECRYPTION_OKAY&quot;</span>))</div>
<div class="line"><span class="lineno">  399</span>    {</div>
<div class="line"><span class="lineno">  400</span>      <span class="comment">/* Don&#39;t break out because we still have to check for</span></div>
<div class="line"><span class="lineno">  401</span><span class="comment">       * PLAINTEXT outside of the decryption boundaries. */</span></div>
<div class="line"><span class="lineno">  402</span>      <a class="code hl_define" href="group__logging__api.html#gae6c5fd73af3410b2d5e8099f8774c8da">mutt_debug</a>(<a class="code hl_enumvalue" href="logging2_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab02ab1e1ebe44a7ad67c0d6cf0447be3">LL_DEBUG2</a>, <span class="stringliteral">&quot;    DECRYPTION_OKAY encountered\n&quot;</span>);</div>
<div class="line"><span class="lineno">  403</span>      rc = 0;</div>
<div class="line"><span class="lineno">  404</span>    }</div>
<div class="line"><span class="lineno">  405</span>  }</div>
<div class="line"><span class="lineno">  406</span>  <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;line);</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  409</span>}</div>
<div class="ttc" id="amutt_2string_8c_html_a9bf968304f4f9b49e24215cb2e28d22d"><div class="ttname"><a href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a></div><div class="ttdeci">size_t mutt_str_startswith(const char *str, const char *prefix)</div><div class="ttdoc">Check whether a string starts with a prefix.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00232">string.c:232</a></div></div>
<div class="ttc" id="apgp_8c_html_a3bee0ec912711eeaa86cebb084d0c24a"><div class="ttname"><a href="#a3bee0ec912711eeaa86cebb084d0c24a">pgp_check_pgp_decryption_okay_regex</a></div><div class="ttdeci">static int pgp_check_pgp_decryption_okay_regex(FILE *fp_in)</div><div class="ttdoc">Check PGP output to look for successful outcome.</div><div class="ttdef"><b>Definition</b> <a href="pgp_8c_source.html#l00303">pgp.c:303</a></div></div>
</div><!-- fragment --><div id="dynsection-21" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_ac53a734c897d0e372496a56c897d1bd6_cgraph.svg" width="630" height="216"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-22" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_ac53a734c897d0e372496a56c897d1bd6_icgraph.svg" width="404" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a82b68cdce916dc016c7d1bfc47acc3ca" name="a82b68cdce916dc016c7d1bfc47acc3ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82b68cdce916dc016c7d1bfc47acc3ca">&#9670;&#160;</a></span>pgp_copy_clearsigned()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void pgp_copy_clearsigned </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp_in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>charset</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Copy a clearsigned message, stripping the signature. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp_in</td><td>File to read from </td></tr>
    <tr><td class="paramname">state</td><td><a class="el" href="structState.html" title="Keep track when processing files.">State</a> to use </td></tr>
    <tr><td class="paramname">charset</td><td>Charset of file</td></tr>
  </table>
  </dd>
</dl>
<p>XXX charset handling: We assume that it is safe to do character set decoding first, dash decoding second here, while we do it the other way around in the main handler.</p>
<p>(Note that we aren't worse than Outlook &amp;c in this, and also note that we can successfully handle anything produced by any existing versions of neomutt.) </p>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00424">424</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  425</span>{</div>
<div class="line"><span class="lineno">  426</span>  <span class="keywordtype">char</span> buf[8192] = { 0 };</div>
<div class="line"><span class="lineno">  427</span>  <span class="keywordtype">bool</span> complete, armor_header;</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>  rewind(fp_in);</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>  <span class="comment">/* fromcode comes from the MIME Content-Type charset label. It might</span></div>
<div class="line"><span class="lineno">  432</span><span class="comment">   * be a wrong label, so we want the ability to do corrections via</span></div>
<div class="line"><span class="lineno">  433</span><span class="comment">   * charset-hooks. Therefore we set flags to MUTT_ICONV_HOOK_FROM.  */</span></div>
<div class="line"><span class="lineno">  434</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structFgetConv.html">FgetConv</a> *fc = <a class="code hl_function" href="mutt_2charset_8c.html#acf9480125d36a09af9c0e5c8c13eaed1">mutt_ch_fgetconv_open</a>(fp_in, charset, <a class="code hl_function" href="config__cache_8c.html#a03027fb835011539c3cbfeb1b0fa8811">cc_charset</a>(), <a class="code hl_define" href="mutt_2charset_8h.html#a1807a22585916adccafa5e09bda9b6a7">MUTT_ICONV_HOOK_FROM</a>);</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>  <span class="keywordflow">for</span> (complete = <span class="keyword">true</span>, armor_header = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  437</span>       <a class="code hl_function" href="mutt_2charset_8c.html#ae9ccef550daaa86a0276dbfae78a1c1a">mutt_ch_fgetconvs</a>(buf, <span class="keyword">sizeof</span>(buf), fc); complete = (strchr(buf, <span class="charliteral">&#39;\n&#39;</span>)))</div>
<div class="line"><span class="lineno">  438</span>  {</div>
<div class="line"><span class="lineno">  439</span>    <span class="keywordflow">if</span> (!complete)</div>
<div class="line"><span class="lineno">  440</span>    {</div>
<div class="line"><span class="lineno">  441</span>      <span class="keywordflow">if</span> (!armor_header)</div>
<div class="line"><span class="lineno">  442</span>        <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, buf);</div>
<div class="line"><span class="lineno">  443</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  444</span>    }</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a>(buf, <span class="stringliteral">&quot;-----BEGIN PGP SIGNATURE-----\n&quot;</span>))</div>
<div class="line"><span class="lineno">  447</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>    <span class="keywordflow">if</span> (armor_header)</div>
<div class="line"><span class="lineno">  450</span>    {</div>
<div class="line"><span class="lineno">  451</span>      <span class="keywordtype">char</span> *<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a> = <a class="code hl_function" href="mutt_2string_8c.html#aa2fa4dcaf72786b58e825349883f14c2">mutt_str_skip_whitespace</a>(buf);</div>
<div class="line"><span class="lineno">  452</span>      <span class="keywordflow">if</span> (*<a class="code hl_variable" href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">p</a> == <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno">  453</span>        armor_header = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  454</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  455</span>    }</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>)</div>
<div class="line"><span class="lineno">  458</span>      <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, state-&gt;<a class="code hl_variable" href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">prefix</a>);</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">if</span> ((buf[0] == <span class="charliteral">&#39;-&#39;</span>) &amp;&amp; (buf[1] == <span class="charliteral">&#39; &#39;</span>))</div>
<div class="line"><span class="lineno">  461</span>      <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, buf + 2);</div>
<div class="line"><span class="lineno">  462</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  463</span>      <a class="code hl_define" href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a>(state, buf);</div>
<div class="line"><span class="lineno">  464</span>  }</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>  <a class="code hl_function" href="mutt_2charset_8c.html#af3ab5375dc558a241b9e0d5787954dc5">mutt_ch_fgetconv_close</a>(&amp;fc);</div>
<div class="line"><span class="lineno">  467</span>}</div>
<div class="ttc" id="aconfig__cache_8c_html_a03027fb835011539c3cbfeb1b0fa8811"><div class="ttname"><a href="config__cache_8c.html#a03027fb835011539c3cbfeb1b0fa8811">cc_charset</a></div><div class="ttdeci">const char * cc_charset(void)</div><div class="ttdoc">Get the cached value of $charset.</div><div class="ttdef"><b>Definition</b> <a href="config__cache_8c_source.html#l00116">config_cache.c:116</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_acf9480125d36a09af9c0e5c8c13eaed1"><div class="ttname"><a href="mutt_2charset_8c.html#acf9480125d36a09af9c0e5c8c13eaed1">mutt_ch_fgetconv_open</a></div><div class="ttdeci">struct FgetConv * mutt_ch_fgetconv_open(FILE *fp, const char *from, const char *to, uint8_t flags)</div><div class="ttdoc">Prepare a file for charset conversion.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00933">charset.c:933</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_ae9ccef550daaa86a0276dbfae78a1c1a"><div class="ttname"><a href="mutt_2charset_8c.html#ae9ccef550daaa86a0276dbfae78a1c1a">mutt_ch_fgetconvs</a></div><div class="ttdeci">char * mutt_ch_fgetconvs(char *buf, size_t buflen, struct FgetConv *fc)</div><div class="ttdoc">Convert a file&#39;s charset into a string buffer.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l01042">charset.c:1042</a></div></div>
<div class="ttc" id="amutt_2charset_8c_html_af3ab5375dc558a241b9e0d5787954dc5"><div class="ttname"><a href="mutt_2charset_8c.html#af3ab5375dc558a241b9e0d5787954dc5">mutt_ch_fgetconv_close</a></div><div class="ttdeci">void mutt_ch_fgetconv_close(struct FgetConv **ptr)</div><div class="ttdoc">Close an fgetconv handle.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8c_source.html#l00962">charset.c:962</a></div></div>
<div class="ttc" id="amutt_2charset_8h_html_a1807a22585916adccafa5e09bda9b6a7"><div class="ttname"><a href="mutt_2charset_8h.html#a1807a22585916adccafa5e09bda9b6a7">MUTT_ICONV_HOOK_FROM</a></div><div class="ttdeci">#define MUTT_ICONV_HOOK_FROM</div><div class="ttdoc">apply charset-hooks to fromcode</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00065">charset.h:65</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_a0ea44a0777d9d2712ba6db4350f1e671"><div class="ttname"><a href="mutt_2state_8h.html#a0ea44a0777d9d2712ba6db4350f1e671">state_puts</a></div><div class="ttdeci">#define state_puts(STATE, STR)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00058">state.h:58</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_a6b6a50296dd2a31863a43379ef4a343d"><div class="ttname"><a href="mutt_2string_8c.html#a6b6a50296dd2a31863a43379ef4a343d">mutt_str_equal</a></div><div class="ttdeci">bool mutt_str_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00660">string.c:660</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_aa2fa4dcaf72786b58e825349883f14c2"><div class="ttname"><a href="mutt_2string_8c.html#aa2fa4dcaf72786b58e825349883f14c2">mutt_str_skip_whitespace</a></div><div class="ttdeci">char * mutt_str_skip_whitespace(const char *p)</div><div class="ttdoc">Find the first non-whitespace character in a string.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00551">string.c:551</a></div></div>
<div class="ttc" id="astructFgetConv_html"><div class="ttname"><a href="structFgetConv.html">FgetConv</a></div><div class="ttdoc">Cursor for converting a file&#39;s encoding.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00042">charset.h:43</a></div></div>
<div class="ttc" id="astructFgetConv_html_a723a63c788d0a7f7d007da7a2c0e7ddb"><div class="ttname"><a href="structFgetConv.html#a723a63c788d0a7f7d007da7a2c0e7ddb">FgetConv::p</a></div><div class="ttdeci">char * p</div><div class="ttdef"><b>Definition</b> <a href="mutt_2charset_8h_source.html#l00048">charset.h:48</a></div></div>
<div class="ttc" id="astructState_html_ac92c06846530ad9f3cde7e23d5789d76"><div class="ttname"><a href="structState.html#ac92c06846530ad9f3cde7e23d5789d76">State::prefix</a></div><div class="ttdeci">const char * prefix</div><div class="ttdoc">String to add to the beginning of each output line.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00051">state.h:51</a></div></div>
</div><!-- fragment --><div id="dynsection-23" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a82b68cdce916dc016c7d1bfc47acc3ca_cgraph.svg" width="396" height="307"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-24" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a82b68cdce916dc016c7d1bfc47acc3ca_icgraph.svg" width="368" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae84f9751f65e2c9f3d4d6c60e2d1905c" name="ae84f9751f65e2c9f3d4d6c60e2d1905c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae84f9751f65e2c9f3d4d6c60e2d1905c">&#9670;&#160;</a></span>pgp_check_traditional_one_body()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool pgp_check_traditional_one_body </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check the body of an inline PGP message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>File to read </td></tr>
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> to populate </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Success </td></tr>
    <tr><td class="paramname">false</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00801">801</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  802</span>{</div>
<div class="line"><span class="lineno">  803</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *tempfile = NULL;</div>
<div class="line"><span class="lineno">  804</span>  <span class="keywordtype">char</span> buf[8192] = { 0 };</div>
<div class="line"><span class="lineno">  805</span>  <span class="keywordtype">bool</span> rc = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  806</span> </div>
<div class="line"><span class="lineno">  807</span>  <span class="keywordtype">bool</span> sgn = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  808</span>  <span class="keywordtype">bool</span> enc = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  809</span>  <span class="keywordtype">bool</span> key = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>  <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>)</div>
<div class="line"><span class="lineno">  812</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>  tempfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  815</span>  <a class="code hl_define" href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a>(tempfile);</div>
<div class="line"><span class="lineno">  816</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt__attach_8c.html#aac29548ca4501311138dfa43db788bd3">mutt_decode_save_attachment</a>(fp, b, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), <a class="code hl_define" href="mutt_2state_8h.html#ade99d644543f92ade39406eac478d302">STATE_NO_FLAGS</a>,</div>
<div class="line"><span class="lineno">  817</span>                                  <a class="code hl_enumvalue" href="mutt__attach_8h.html#a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224">MUTT_SAVE_NO_FLAGS</a>) != 0)</div>
<div class="line"><span class="lineno">  818</span>  {</div>
<div class="line"><span class="lineno">  819</span>    unlink(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  820</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  821</span>  }</div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span>  FILE *fp_tmp = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">  824</span>  <span class="keywordflow">if</span> (!fp_tmp)</div>
<div class="line"><span class="lineno">  825</span>  {</div>
<div class="line"><span class="lineno">  826</span>    unlink(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  827</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  828</span>  }</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>  <span class="keywordflow">while</span> (fgets(buf, <span class="keyword">sizeof</span>(buf), fp_tmp))</div>
<div class="line"><span class="lineno">  831</span>  {</div>
<div class="line"><span class="lineno">  832</span>    <span class="keywordtype">size_t</span> plen = <a class="code hl_function" href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a>(buf, <span class="stringliteral">&quot;-----BEGIN PGP &quot;</span>);</div>
<div class="line"><span class="lineno">  833</span>    <span class="keywordflow">if</span> (plen != 0)</div>
<div class="line"><span class="lineno">  834</span>    {</div>
<div class="line"><span class="lineno">  835</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a>(buf + plen, <span class="stringliteral">&quot;MESSAGE-----\n&quot;</span>))</div>
<div class="line"><span class="lineno">  836</span>        enc = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  837</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a>(buf + plen, <span class="stringliteral">&quot;SIGNED MESSAGE-----\n&quot;</span>))</div>
<div class="line"><span class="lineno">  838</span>        sgn = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  839</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a9bf968304f4f9b49e24215cb2e28d22d">mutt_str_startswith</a>(buf + plen, <span class="stringliteral">&quot;PUBLIC KEY BLOCK-----\n&quot;</span>))</div>
<div class="line"><span class="lineno">  840</span>        key = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  841</span>    }</div>
<div class="line"><span class="lineno">  842</span>  }</div>
<div class="line"><span class="lineno">  843</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_tmp);</div>
<div class="line"><span class="lineno">  844</span>  unlink(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>  <span class="keywordflow">if</span> (!enc &amp;&amp; !sgn &amp;&amp; !key)</div>
<div class="line"><span class="lineno">  847</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>  <span class="comment">/* fix the content type */</span></div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>  <a class="code hl_function" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;format&quot;</span>, <span class="stringliteral">&quot;fixed&quot;</span>);</div>
<div class="line"><span class="lineno">  852</span>  <span class="keywordflow">if</span> (enc)</div>
<div class="line"><span class="lineno">  853</span>    <a class="code hl_function" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;x-action&quot;</span>, <span class="stringliteral">&quot;pgp-encrypted&quot;</span>);</div>
<div class="line"><span class="lineno">  854</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sgn)</div>
<div class="line"><span class="lineno">  855</span>    <a class="code hl_function" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;x-action&quot;</span>, <span class="stringliteral">&quot;pgp-signed&quot;</span>);</div>
<div class="line"><span class="lineno">  856</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (key)</div>
<div class="line"><span class="lineno">  857</span>    <a class="code hl_function" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;x-action&quot;</span>, <span class="stringliteral">&quot;pgp-keys&quot;</span>);</div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>  rc = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>cleanup:</div>
<div class="line"><span class="lineno">  862</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;tempfile);</div>
<div class="line"><span class="lineno">  863</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  864</span>}</div>
<div class="ttc" id="abuffer_8h_html_a728ebc5a947b77c8d56db44ce553a7ab"><div class="ttname"><a href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a></div><div class="ttdeci">static const char * buf_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00096">buffer.h:96</a></div></div>
<div class="ttc" id="afile_8h_html_a9b519e795f098be88b93cd72c49a35ec"><div class="ttname"><a href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a></div><div class="ttdeci">#define mutt_file_fclose(FP)</div><div class="ttdef"><b>Definition</b> <a href="file_8h_source.html#l00139">file.h:139</a></div></div>
<div class="ttc" id="afile_8h_html_a9fa358d76519cb6bc8ffca5850976d46"><div class="ttname"><a href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a></div><div class="ttdeci">#define mutt_file_fopen(PATH, MODE)</div><div class="ttdef"><b>Definition</b> <a href="file_8h_source.html#l00138">file.h:138</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdeci">@ TYPE_TEXT</div><div class="ttdoc">Type: &#39;text/*&#39;.</div><div class="ttdef"><b>Definition</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_ade99d644543f92ade39406eac478d302"><div class="ttname"><a href="mutt_2state_8h.html#ade99d644543f92ade39406eac478d302">STATE_NO_FLAGS</a></div><div class="ttdeci">#define STATE_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00032">state.h:32</a></div></div>
<div class="ttc" id="amutt__attach_8c_html_aac29548ca4501311138dfa43db788bd3"><div class="ttname"><a href="mutt__attach_8c.html#aac29548ca4501311138dfa43db788bd3">mutt_decode_save_attachment</a></div><div class="ttdeci">int mutt_decode_save_attachment(FILE *fp, struct Body *b, const char *path, StateFlags flags, enum SaveAttach opt)</div><div class="ttdoc">Decode, then save an attachment.</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8c_source.html#l01039">mutt_attach.c:1039</a></div></div>
<div class="ttc" id="amutt__attach_8h_html_a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224"><div class="ttname"><a href="mutt__attach_8h.html#a5675c7a41890711ec4871b592c840faaaed4c57bafee22c671cdc621feed0b224">MUTT_SAVE_NO_FLAGS</a></div><div class="ttdeci">@ MUTT_SAVE_NO_FLAGS</div><div class="ttdoc">Overwrite existing file (the default)</div><div class="ttdef"><b>Definition</b> <a href="mutt__attach_8h_source.html#l00058">mutt_attach.h:58</a></div></div>
<div class="ttc" id="aparameter_8c_html_a42249fc15b1e52df046a0a10de29da44"><div class="ttname"><a href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a></div><div class="ttdeci">void mutt_param_set(struct ParameterList *pl, const char *attribute, const char *value)</div><div class="ttdoc">Set a Parameter.</div><div class="ttdef"><b>Definition</b> <a href="parameter_8c_source.html#l00111">parameter.c:111</a></div></div>
<div class="ttc" id="apool_8c_html_a41cba27c25d33cb6822789a2856093f2"><div class="ttname"><a href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a></div><div class="ttdeci">struct Buffer * buf_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00082">pool.c:82</a></div></div>
<div class="ttc" id="apool_8c_html_a4cc6068279461cb8628219586dfa35a1"><div class="ttname"><a href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a></div><div class="ttdeci">void buf_pool_release(struct Buffer **ptr)</div><div class="ttdoc">Return a Buffer to the pool.</div><div class="ttdef"><b>Definition</b> <a href="pool_8c_source.html#l00096">pool.c:96</a></div></div>
<div class="ttc" id="astructBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">Parameters of the content-type.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00063">body.h:63</a></div></div>
<div class="ttc" id="astructBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00040">body.h:40</a></div></div>
<div class="ttc" id="astructBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer.</div><div class="ttdef"><b>Definition</b> <a href="buffer_8h_source.html#l00035">buffer.h:36</a></div></div>
<div class="ttc" id="atmp_8h_html_a271a7828888985955df49205d7846a45"><div class="ttname"><a href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a></div><div class="ttdeci">#define buf_mktemp(buf)</div><div class="ttdef"><b>Definition</b> <a href="tmp_8h_source.html#l00033">tmp.h:33</a></div></div>
</div><!-- fragment --><div id="dynsection-25" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_ae84f9751f65e2c9f3d4d6c60e2d1905c_cgraph.svg" width="428" height="331"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-26" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_ae84f9751f65e2c9f3d4d6c60e2d1905c_icgraph.svg" width="402" height="74"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab2a7bf43d00fb1c2d55a4c2eec3cdcd4" name="ab2a7bf43d00fb1c2d55a4c2eec3cdcd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2a7bf43d00fb1c2d55a4c2eec3cdcd4">&#9670;&#160;</a></span>pgp_extract_keys_from_attachment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void pgp_extract_keys_from_attachment </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract pgp keys from messages/attachments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>File to read from </td></tr>
    <tr><td class="paramname">b</td><td>Top Attachment </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00971">971</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  972</span>{</div>
<div class="line"><span class="lineno">  973</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structState.html">State</a> state = { 0 };</div>
<div class="line"><span class="lineno">  974</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *tempfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span>  <a class="code hl_define" href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a>(tempfile);</div>
<div class="line"><span class="lineno">  977</span>  FILE *fp_tmp = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">  978</span>  <span class="keywordflow">if</span> (!fp_tmp)</div>
<div class="line"><span class="lineno">  979</span>  {</div>
<div class="line"><span class="lineno">  980</span>    <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  981</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  982</span>  }</div>
<div class="line"><span class="lineno">  983</span> </div>
<div class="line"><span class="lineno">  984</span>  state.<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a> = fp;</div>
<div class="line"><span class="lineno">  985</span>  state.<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a> = fp_tmp;</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>  <a class="code hl_function" href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a>(b, &amp;state);</div>
<div class="line"><span class="lineno">  988</span> </div>
<div class="line"><span class="lineno">  989</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_tmp);</div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>  <a class="code hl_function" href="group__crypto__pgp__invoke__import.html#gacee2a4b90d106433cf7840a98171491f">pgp_class_invoke_import</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  992</span>  <a class="code hl_function" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a>(NULL);</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>  <a class="code hl_function" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  995</span> </div>
<div class="line"><span class="lineno">  996</span>cleanup:</div>
<div class="line"><span class="lineno">  997</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;tempfile);</div>
<div class="line"><span class="lineno">  998</span>}</div>
<div class="ttc" id="acurs__lib_8c_html_ab6a61cdfcf8c2c73ee59381c79c79774"><div class="ttname"><a href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a></div><div class="ttdeci">int mutt_any_key_to_continue(const char *s)</div><div class="ttdoc">Prompt the user to &#39;press any key&#39; and wait.</div><div class="ttdef"><b>Definition</b> <a href="curs__lib_8c_source.html#l00174">curs_lib.c:174</a></div></div>
<div class="ttc" id="afile_8c_html_ae57463c2854c006a3c67b78736e9056e"><div class="ttname"><a href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a></div><div class="ttdeci">void mutt_file_unlink(const char *s)</div><div class="ttdoc">Delete a file, carefully.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00159">file.c:159</a></div></div>
<div class="ttc" id="agroup__crypto__pgp__invoke__import_html_gacee2a4b90d106433cf7840a98171491f"><div class="ttname"><a href="group__crypto__pgp__invoke__import.html#gacee2a4b90d106433cf7840a98171491f">pgp_class_invoke_import</a></div><div class="ttdeci">void pgp_class_invoke_import(const char *fname)</div><div class="ttdoc">Import a key from a message into the user&#39;s public key ring - Implements CryptModuleSpecs::pgp_invoke...</div><div class="ttdef"><b>Definition</b> <a href="pgpinvoke_8c_source.html#l00287">pgpinvoke.c:287</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gafaa521ab22db877ccf1b87e679e1b43e"><div class="ttname"><a href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a></div><div class="ttdeci">#define mutt_perror(...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00094">logging2.h:94</a></div></div>
<div class="ttc" id="ahandler_8c_html_a3e520d3004995a6c0cf0696edfd209fb"><div class="ttname"><a href="handler_8c.html#a3e520d3004995a6c0cf0696edfd209fb">mutt_body_handler</a></div><div class="ttdeci">int mutt_body_handler(struct Body *b, struct State *state)</div><div class="ttdoc">Handler for the Body of an email.</div><div class="ttdef"><b>Definition</b> <a href="handler_8c_source.html#l01632">handler.c:1632</a></div></div>
<div class="ttc" id="astructState_html"><div class="ttname"><a href="structState.html">State</a></div><div class="ttdoc">Keep track when processing files.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00047">state.h:48</a></div></div>
<div class="ttc" id="astructState_html_a88fc722d3012ebf69d3a061cbf6bc296"><div class="ttname"><a href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">State::fp_out</a></div><div class="ttdeci">FILE * fp_out</div><div class="ttdoc">File to write to.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00050">state.h:50</a></div></div>
<div class="ttc" id="astructState_html_a9cf7e1f0c5c12399def5ca38b13054ae"><div class="ttname"><a href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">State::fp_in</a></div><div class="ttdeci">FILE * fp_in</div><div class="ttdoc">File to read from.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00049">state.h:49</a></div></div>
</div><!-- fragment --><div id="dynsection-27" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_ab2a7bf43d00fb1c2d55a4c2eec3cdcd4_cgraph.svg" width="582" height="336"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-28" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_ab2a7bf43d00fb1c2d55a4c2eec3cdcd4_icgraph.svg" width="376" height="60"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2710f9de758f312094ad0e30e69a40da" name="a2710f9de758f312094ad0e30e69a40da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2710f9de758f312094ad0e30e69a40da">&#9670;&#160;</a></span>pgp_decrypt_part()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structBody.html">Body</a> * pgp_decrypt_part </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structState.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>fp_out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *</td>          <td class="paramname"><span class="paramname"><em>p</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Decrypt part of a PGP message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of attachment </td></tr>
    <tr><td class="paramname">state</td><td><a class="el" href="structState.html" title="Keep track when processing files.">State</a> to use </td></tr>
    <tr><td class="paramname">fp_out</td><td>File to write to </td></tr>
    <tr><td class="paramname">p</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of parent (main email) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>New <a class="el" href="structBody.html" title="The body of an email.">Body</a> for the attachment </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l01026">1026</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1028</span>{</div>
<div class="line"><span class="lineno"> 1029</span>  <span class="keywordflow">if</span> (!a || !state || !fp_out || !p)</div>
<div class="line"><span class="lineno"> 1030</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1031</span> </div>
<div class="line"><span class="lineno"> 1032</span>  <span class="keywordtype">char</span> buf[1024] = { 0 };</div>
<div class="line"><span class="lineno"> 1033</span>  FILE *fp_pgp_in = NULL, *fp_pgp_out = NULL, *fp_pgp_tmp = NULL;</div>
<div class="line"><span class="lineno"> 1034</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *tattach = NULL;</div>
<div class="line"><span class="lineno"> 1035</span>  pid_t pid;</div>
<div class="line"><span class="lineno"> 1036</span>  <span class="keywordtype">int</span> rv;</div>
<div class="line"><span class="lineno"> 1037</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *tempfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>  FILE *fp_pgp_err = <a class="code hl_define" href="tmp_8h.html#a4ad1bdd71a5077a9e7dfc4890e1089f6">mutt_file_mkstemp</a>();</div>
<div class="line"><span class="lineno"> 1040</span>  <span class="keywordflow">if</span> (!fp_pgp_err)</div>
<div class="line"><span class="lineno"> 1041</span>  {</div>
<div class="line"><span class="lineno"> 1042</span>    <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Can&#39;t create temporary file&quot;</span>));</div>
<div class="line"><span class="lineno"> 1043</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno"> 1044</span>  }</div>
<div class="line"><span class="lineno"> 1045</span> </div>
<div class="line"><span class="lineno"> 1046</span>  <a class="code hl_define" href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a>(tempfile);</div>
<div class="line"><span class="lineno"> 1047</span>  fp_pgp_tmp = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno"> 1048</span>  <span class="keywordflow">if</span> (!fp_pgp_tmp)</div>
<div class="line"><span class="lineno"> 1049</span>  {</div>
<div class="line"><span class="lineno"> 1050</span>    <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno"> 1051</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_pgp_err);</div>
<div class="line"><span class="lineno"> 1052</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno"> 1053</span>  }</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>  <span class="comment">/* Position the stream at the beginning of the body, and send the data to</span></div>
<div class="line"><span class="lineno"> 1056</span><span class="comment">   * the temporary file.  */</span></div>
<div class="line"><span class="lineno"> 1057</span> </div>
<div class="line"><span class="lineno"> 1058</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, a-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>, SEEK_SET))</div>
<div class="line"><span class="lineno"> 1059</span>  {</div>
<div class="line"><span class="lineno"> 1060</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_pgp_tmp);</div>
<div class="line"><span class="lineno"> 1061</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_pgp_err);</div>
<div class="line"><span class="lineno"> 1062</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno"> 1063</span>  }</div>
<div class="line"><span class="lineno"> 1064</span>  <a class="code hl_function" href="file_8c.html#a2bafa45ca3c8ce7d96303377d860e2db">mutt_file_copy_bytes</a>(state-&gt;<a class="code hl_variable" href="structState.html#a9cf7e1f0c5c12399def5ca38b13054ae">fp_in</a>, fp_pgp_tmp, a-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a>);</div>
<div class="line"><span class="lineno"> 1065</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_pgp_tmp);</div>
<div class="line"><span class="lineno"> 1066</span> </div>
<div class="line"><span class="lineno"> 1067</span>  pid = <a class="code hl_function" href="pgpinvoke_8c.html#ab0b11dcf9aef414365590f9f6ac0c5a4">pgp_invoke_decrypt</a>(&amp;fp_pgp_in, &amp;fp_pgp_out, NULL, -1, -1,</div>
<div class="line"><span class="lineno"> 1068</span>                           fileno(fp_pgp_err), <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno"> 1069</span>  <span class="keywordflow">if</span> (pid == -1)</div>
<div class="line"><span class="lineno"> 1070</span>  {</div>
<div class="line"><span class="lineno"> 1071</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_pgp_err);</div>
<div class="line"><span class="lineno"> 1072</span>    unlink(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno"> 1073</span>    <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno"> 1074</span>    {</div>
<div class="line"><span class="lineno"> 1075</span>      <a class="code hl_function" href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- Error: could not create a PGP subprocess --]\n\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1076</span>    }</div>
<div class="line"><span class="lineno"> 1077</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno"> 1078</span>  }</div>
<div class="line"><span class="lineno"> 1079</span> </div>
<div class="line"><span class="lineno"> 1080</span>  <span class="comment">/* send the PGP passphrase to the subprocess.  Never do this if the agent is</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="comment">   * active, because this might lead to a passphrase send as the message. */</span></div>
<div class="line"><span class="lineno"> 1082</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="#ab97e1713bb20da422b5a71b68747edf9">pgp_use_gpg_agent</a>())</div>
<div class="line"><span class="lineno"> 1083</span>    fputs(<a class="code hl_variable" href="#a4bff03001e5dff05a97e4e071e1a1a4d">PgpPass</a>, fp_pgp_in);</div>
<div class="line"><span class="lineno"> 1084</span>  fputc(<span class="charliteral">&#39;\n&#39;</span>, fp_pgp_in);</div>
<div class="line"><span class="lineno"> 1085</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_pgp_in);</div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span>  <span class="comment">/* Read the output from PGP, and make sure to change CRLF to LF, otherwise</span></div>
<div class="line"><span class="lineno"> 1088</span><span class="comment">   * read_mime_header has a hard time parsing the message.  */</span></div>
<div class="line"><span class="lineno"> 1089</span>  <span class="keywordflow">while</span> (fgets(buf, <span class="keyword">sizeof</span>(buf) - 1, fp_pgp_out))</div>
<div class="line"><span class="lineno"> 1090</span>  {</div>
<div class="line"><span class="lineno"> 1091</span>    <span class="keywordtype">size_t</span> len = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(buf);</div>
<div class="line"><span class="lineno"> 1092</span>    <span class="keywordflow">if</span> ((len &gt; 1) &amp;&amp; (buf[len - 2] == <span class="charliteral">&#39;\r&#39;</span>))</div>
<div class="line"><span class="lineno"> 1093</span>      strcpy(buf + len - 2, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1094</span>    fputs(buf, fp_out);</div>
<div class="line"><span class="lineno"> 1095</span>  }</div>
<div class="line"><span class="lineno"> 1096</span> </div>
<div class="line"><span class="lineno"> 1097</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_pgp_out);</div>
<div class="line"><span class="lineno"> 1098</span> </div>
<div class="line"><span class="lineno"> 1099</span>  rv = <a class="code hl_function" href="mutt_2filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a>(pid);</div>
<div class="line"><span class="lineno"> 1100</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_use_gpg_agent = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_use_gpg_agent&quot;</span>);</div>
<div class="line"><span class="lineno"> 1101</span>  <span class="keywordflow">if</span> (c_pgp_use_gpg_agent)</div>
<div class="line"><span class="lineno"> 1102</span>    <a class="code hl_function" href="curs__lib_8c.html#abbd51b0f01f2565da12fddf6716c7b9c">mutt_need_hard_redraw</a>();</div>
<div class="line"><span class="lineno"> 1103</span> </div>
<div class="line"><span class="lineno"> 1104</span>  <a class="code hl_function" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno"> 1105</span> </div>
<div class="line"><span class="lineno"> 1106</span>  fflush(fp_pgp_err);</div>
<div class="line"><span class="lineno"> 1107</span>  rewind(fp_pgp_err);</div>
<div class="line"><span class="lineno"> 1108</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="#ac53a734c897d0e372496a56c897d1bd6">pgp_check_decryption_okay</a>(fp_pgp_err) &lt; 0)</div>
<div class="line"><span class="lineno"> 1109</span>  {</div>
<div class="line"><span class="lineno"> 1110</span>    <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Decryption failed&quot;</span>));</div>
<div class="line"><span class="lineno"> 1111</span>    <a class="code hl_function" href="group__crypto__void__passphrase.html#ga5f22ad399cd8c0e467f61969e762aba0">pgp_class_void_passphrase</a>();</div>
<div class="line"><span class="lineno"> 1112</span>    <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_pgp_err);</div>
<div class="line"><span class="lineno"> 1113</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno"> 1114</span>  }</div>
<div class="line"><span class="lineno"> 1115</span> </div>
<div class="line"><span class="lineno"> 1116</span>  <span class="keywordflow">if</span> (state-&gt;<a class="code hl_variable" href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">flags</a> &amp; <a class="code hl_define" href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a>)</div>
<div class="line"><span class="lineno"> 1117</span>  {</div>
<div class="line"><span class="lineno"> 1118</span>    rewind(fp_pgp_err);</div>
<div class="line"><span class="lineno"> 1119</span>    <span class="keywordflow">if</span> ((<a class="code hl_function" href="#a753f39f0bc86f2260fc9073f7742a19d">pgp_copy_checksig</a>(fp_pgp_err, state-&gt;<a class="code hl_variable" href="structState.html#a88fc722d3012ebf69d3a061cbf6bc296">fp_out</a>) == 0) &amp;&amp; !rv)</div>
<div class="line"><span class="lineno"> 1120</span>      p-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1121</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1122</span>      p-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1123</span>    <a class="code hl_function" href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a>(state, <a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;[-- End of PGP output --]\n\n&quot;</span>));</div>
<div class="line"><span class="lineno"> 1124</span>  }</div>
<div class="line"><span class="lineno"> 1125</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_pgp_err);</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>  fflush(fp_out);</div>
<div class="line"><span class="lineno"> 1128</span>  rewind(fp_out);</div>
<div class="line"><span class="lineno"> 1129</span> </div>
<div class="line"><span class="lineno"> 1130</span>  <span class="keywordflow">if</span> (fgetc(fp_out) == EOF)</div>
<div class="line"><span class="lineno"> 1131</span>  {</div>
<div class="line"><span class="lineno"> 1132</span>    <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Decryption failed&quot;</span>));</div>
<div class="line"><span class="lineno"> 1133</span>    <a class="code hl_function" href="group__crypto__void__passphrase.html#ga5f22ad399cd8c0e467f61969e762aba0">pgp_class_void_passphrase</a>();</div>
<div class="line"><span class="lineno"> 1134</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno"> 1135</span>  }</div>
<div class="line"><span class="lineno"> 1136</span> </div>
<div class="line"><span class="lineno"> 1137</span>  rewind(fp_out);</div>
<div class="line"><span class="lineno"> 1138</span>  <span class="keyword">const</span> <span class="keywordtype">long</span> size = <a class="code hl_function" href="file_8c.html#a4cffa4f503de3736198956ebed431f7e">mutt_file_get_size_fp</a>(fp_out);</div>
<div class="line"><span class="lineno"> 1139</span>  <span class="keywordflow">if</span> (size == 0)</div>
<div class="line"><span class="lineno"> 1140</span>  {</div>
<div class="line"><span class="lineno"> 1141</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno"> 1142</span>  }</div>
<div class="line"><span class="lineno"> 1143</span> </div>
<div class="line"><span class="lineno"> 1144</span>  tattach = <a class="code hl_function" href="email_2parse_8c.html#a2cfe061d82e6381b14e355c0937ecfc1">mutt_read_mime_header</a>(fp_out, 0);</div>
<div class="line"><span class="lineno"> 1145</span>  <span class="keywordflow">if</span> (tattach)</div>
<div class="line"><span class="lineno"> 1146</span>  {</div>
<div class="line"><span class="lineno"> 1147</span>    <span class="comment">/* Need to set the length of this body part.  */</span></div>
<div class="line"><span class="lineno"> 1148</span>    tattach-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> = size - tattach-&gt;<a class="code hl_variable" href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">offset</a>;</div>
<div class="line"><span class="lineno"> 1149</span> </div>
<div class="line"><span class="lineno"> 1150</span>    <span class="comment">/* See if we need to recurse on this MIME part.  */</span></div>
<div class="line"><span class="lineno"> 1151</span>    <a class="code hl_function" href="email_2parse_8c.html#a0b38ac4f44b3414d0e18d26324861369">mutt_parse_part</a>(fp_out, tattach);</div>
<div class="line"><span class="lineno"> 1152</span>  }</div>
<div class="line"><span class="lineno"> 1153</span> </div>
<div class="line"><span class="lineno"> 1154</span>cleanup:</div>
<div class="line"><span class="lineno"> 1155</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;tempfile);</div>
<div class="line"><span class="lineno"> 1156</span>  <span class="keywordflow">return</span> tattach;</div>
<div class="line"><span class="lineno"> 1157</span>}</div>
<div class="ttc" id="acurs__lib_8c_html_abbd51b0f01f2565da12fddf6716c7b9c"><div class="ttname"><a href="curs__lib_8c.html#abbd51b0f01f2565da12fddf6716c7b9c">mutt_need_hard_redraw</a></div><div class="ttdeci">void mutt_need_hard_redraw(void)</div><div class="ttdoc">Force a hard refresh.</div><div class="ttdef"><b>Definition</b> <a href="curs__lib_8c_source.html#l00101">curs_lib.c:101</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a0b38ac4f44b3414d0e18d26324861369"><div class="ttname"><a href="email_2parse_8c.html#a0b38ac4f44b3414d0e18d26324861369">mutt_parse_part</a></div><div class="ttdeci">void mutt_parse_part(FILE *fp, struct Body *b)</div><div class="ttdoc">Parse a MIME part.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01821">parse.c:1821</a></div></div>
<div class="ttc" id="aemail_2parse_8c_html_a2cfe061d82e6381b14e355c0937ecfc1"><div class="ttname"><a href="email_2parse_8c.html#a2cfe061d82e6381b14e355c0937ecfc1">mutt_read_mime_header</a></div><div class="ttdeci">struct Body * mutt_read_mime_header(FILE *fp, bool digest)</div><div class="ttdoc">Parse a MIME header.</div><div class="ttdef"><b>Definition</b> <a href="email_2parse_8c_source.html#l01361">parse.c:1361</a></div></div>
<div class="ttc" id="afile_8c_html_a2bafa45ca3c8ce7d96303377d860e2db"><div class="ttname"><a href="file_8c.html#a2bafa45ca3c8ce7d96303377d860e2db">mutt_file_copy_bytes</a></div><div class="ttdeci">int mutt_file_copy_bytes(FILE *fp_in, FILE *fp_out, size_t size)</div><div class="ttdoc">Copy some content from one file to another.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00195">file.c:195</a></div></div>
<div class="ttc" id="afile_8c_html_a4cffa4f503de3736198956ebed431f7e"><div class="ttname"><a href="file_8c.html#a4cffa4f503de3736198956ebed431f7e">mutt_file_get_size_fp</a></div><div class="ttdeci">long mutt_file_get_size_fp(FILE *fp)</div><div class="ttdoc">Get the size of a file.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l01430">file.c:1430</a></div></div>
<div class="ttc" id="afile_8c_html_a6b60cb2044041374689e6e6641c5cc05"><div class="ttname"><a href="file_8c.html#a6b60cb2044041374689e6e6641c5cc05">mutt_file_seek</a></div><div class="ttdeci">bool mutt_file_seek(FILE *fp, LOFF_T offset, int whence)</div><div class="ttdoc">Wrapper for fseeko with error handling.</div><div class="ttdef"><b>Definition</b> <a href="file_8c_source.html#l00655">file.c:655</a></div></div>
<div class="ttc" id="agroup__crypto__void__passphrase_html_ga5f22ad399cd8c0e467f61969e762aba0"><div class="ttname"><a href="group__crypto__void__passphrase.html#ga5f22ad399cd8c0e467f61969e762aba0">pgp_class_void_passphrase</a></div><div class="ttdeci">void pgp_class_void_passphrase(void)</div><div class="ttdoc">Forget the cached passphrase - Implements CryptModuleSpecs::void_passphrase() -.</div><div class="ttdef"><b>Definition</b> <a href="pgp_8c_source.html#l00076">pgp.c:76</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gacc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition</b> <a href="logging2_8h_source.html#l00093">logging2.h:93</a></div></div>
<div class="ttc" id="amutt_2filter_8c_html_a22c6912b837b1114c3276c990e73dca3"><div class="ttname"><a href="mutt_2filter_8c.html#a22c6912b837b1114c3276c990e73dca3">filter_wait</a></div><div class="ttdeci">int filter_wait(pid_t pid)</div><div class="ttdoc">Wait for the exit of a process and return its status.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2filter_8c_source.html#l00220">filter.c:220</a></div></div>
<div class="ttc" id="amutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="amutt_2state_8c_html_a0d52430e63f8cffdd0e6a78182ad4385"><div class="ttname"><a href="mutt_2state_8c.html#a0d52430e63f8cffdd0e6a78182ad4385">state_attach_puts</a></div><div class="ttdeci">void state_attach_puts(struct State *state, const char *t)</div><div class="ttdoc">Write a string to the state.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8c_source.html#l00104">state.c:104</a></div></div>
<div class="ttc" id="amutt_2state_8h_html_a2a4ce653367a744f47960bc30b42f3a7"><div class="ttname"><a href="mutt_2state_8h.html#a2a4ce653367a744f47960bc30b42f3a7">STATE_DISPLAY</a></div><div class="ttdeci">#define STATE_DISPLAY</div><div class="ttdoc">Output is displayed to the user.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00033">state.h:33</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_acca6786b903b22a5924219f9db96e10d"><div class="ttname"><a href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a></div><div class="ttdeci">size_t mutt_str_len(const char *a)</div><div class="ttdoc">Calculate the length of a string, safely.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2string_8c_source.html#l00498">string.c:498</a></div></div>
<div class="ttc" id="apgp_8c_html_a4bff03001e5dff05a97e4e071e1a1a4d"><div class="ttname"><a href="#a4bff03001e5dff05a97e4e071e1a1a4d">PgpPass</a></div><div class="ttdeci">static char PgpPass[1024]</div><div class="ttdoc">Cached PGP Passphrase.</div><div class="ttdef"><b>Definition</b> <a href="pgp_8c_source.html#l00069">pgp.c:69</a></div></div>
<div class="ttc" id="apgp_8c_html_a753f39f0bc86f2260fc9073f7742a19d"><div class="ttname"><a href="#a753f39f0bc86f2260fc9073f7742a19d">pgp_copy_checksig</a></div><div class="ttdeci">static int pgp_copy_checksig(FILE *fp_in, FILE *fp_out)</div><div class="ttdoc">Copy PGP output and look for signs of a good signature.</div><div class="ttdef"><b>Definition</b> <a href="pgp_8c_source.html#l00251">pgp.c:251</a></div></div>
<div class="ttc" id="apgp_8c_html_ab97e1713bb20da422b5a71b68747edf9"><div class="ttname"><a href="#ab97e1713bb20da422b5a71b68747edf9">pgp_use_gpg_agent</a></div><div class="ttdeci">bool pgp_use_gpg_agent(void)</div><div class="ttdoc">Does the user want to use the gpg agent?</div><div class="ttdef"><b>Definition</b> <a href="pgp_8c_source.html#l00127">pgp.c:127</a></div></div>
<div class="ttc" id="apgp_8c_html_ac53a734c897d0e372496a56c897d1bd6"><div class="ttname"><a href="#ac53a734c897d0e372496a56c897d1bd6">pgp_check_decryption_okay</a></div><div class="ttdeci">static int pgp_check_decryption_okay(FILE *fp_in)</div><div class="ttdoc">Check GPG output for status codes.</div><div class="ttdef"><b>Definition</b> <a href="pgp_8c_source.html#l00357">pgp.c:357</a></div></div>
<div class="ttc" id="apgpinvoke_8c_html_ab0b11dcf9aef414365590f9f6ac0c5a4"><div class="ttname"><a href="pgpinvoke_8c.html#ab0b11dcf9aef414365590f9f6ac0c5a4">pgp_invoke_decrypt</a></div><div class="ttdeci">pid_t pgp_invoke_decrypt(FILE **fp_pgp_in, FILE **fp_pgp_out, FILE **fp_pgp_err, int fd_pgp_in, int fd_pgp_out, int fd_pgp_err, const char *fname)</div><div class="ttdoc">Use PGP to decrypt a file.</div><div class="ttdef"><b>Definition</b> <a href="pgpinvoke_8c_source.html#l00181">pgpinvoke.c:181</a></div></div>
<div class="ttc" id="astructBody_html"><div class="ttname"><a href="structBody.html">Body</a></div><div class="ttdoc">The body of an email.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00035">body.h:36</a></div></div>
<div class="ttc" id="astructBody_html_a1969dfeb0a155ccb16153fe777a103b0"><div class="ttname"><a href="structBody.html#a1969dfeb0a155ccb16153fe777a103b0">Body::offset</a></div><div class="ttdeci">LOFF_T offset</div><div class="ttdoc">offset where the actual data begins</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00052">body.h:52</a></div></div>
<div class="ttc" id="astructBody_html_a6f92d7ec8568ca04ae07931c56dd0790"><div class="ttname"><a href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">Body::length</a></div><div class="ttdeci">LOFF_T length</div><div class="ttdoc">length (in bytes) of attachment</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00053">body.h:53</a></div></div>
<div class="ttc" id="astructBody_html_ae4b2706a5c4601ae1497a96e047d8f5e"><div class="ttname"><a href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">Body::goodsig</a></div><div class="ttdeci">bool goodsig</div><div class="ttdoc">Good cryptographic signature.</div><div class="ttdef"><b>Definition</b> <a href="email_2body_8h_source.html#l00045">body.h:45</a></div></div>
<div class="ttc" id="astructState_html_a5d855f7d518fde2ac4e8e409cbb24ad3"><div class="ttname"><a href="structState.html#a5d855f7d518fde2ac4e8e409cbb24ad3">State::flags</a></div><div class="ttdeci">StateFlags flags</div><div class="ttdoc">Flags, e.g. STATE_DISPLAY.</div><div class="ttdef"><b>Definition</b> <a href="mutt_2state_8h_source.html#l00052">state.h:52</a></div></div>
<div class="ttc" id="atmp_8h_html_a4ad1bdd71a5077a9e7dfc4890e1089f6"><div class="ttname"><a href="tmp_8h.html#a4ad1bdd71a5077a9e7dfc4890e1089f6">mutt_file_mkstemp</a></div><div class="ttdeci">#define mutt_file_mkstemp()</div><div class="ttdef"><b>Definition</b> <a href="tmp_8h_source.html#l00036">tmp.h:36</a></div></div>
</div><!-- fragment --><div id="dynsection-29" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a2710f9de758f312094ad0e30e69a40da_cgraph.svg" width="559" height="990"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div id="dynsection-30" onclick="return dynsection.toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-30-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-30-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-30-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="pgp_8c_a2710f9de758f312094ad0e30e69a40da_icgraph.svg" width="364" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a4bff03001e5dff05a97e4e071e1a1a4d" name="a4bff03001e5dff05a97e4e071e1a1a4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bff03001e5dff05a97e4e071e1a1a4d">&#9670;&#160;</a></span>PgpPass</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char PgpPass[1024]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cached PGP Passphrase. </p>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00069">69</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>

</div>
</div>
<a id="a67c928e6b6f8be62b399745abd9029e1" name="a67c928e6b6f8be62b399745abd9029e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67c928e6b6f8be62b399745abd9029e1">&#9670;&#160;</a></span>PgpExptime</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">time_t PgpExptime = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unix time when <a class="el" href="#a4bff03001e5dff05a97e4e071e1a1a4d" title="Cached PGP Passphrase.">PgpPass</a> expires. </p>

<p class="definition">Definition at line <a class="el" href="pgp_8c_source.html#l00071">71</a> of file <a class="el" href="pgp_8c_source.html">pgp.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>
