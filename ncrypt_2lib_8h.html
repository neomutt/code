<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeoMutt: ncrypt/lib.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><a href="https://neomutt.org"><img alt="Logo" src="neomutt-64.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <a style="color: black; text-decoration: none;" href="https://neomutt.org">
   <div id="projectname">NeoMutt
   &#160;<span id="projectnumber">2025-09-05-40-g6a7c50</span>
   </div>
   <div id="projectbrief">Teaching an old dog new tricks</div>
   </a>
   <a href="https://github.com/neomutt/neomutt" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#000000; color:#fff; position: fixed; top: 0; border: 0; right: 0; z-index: 9999;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  </td>
   <td><a style="text-decoration: none; position: absolute; right: 0; top: 25px; margin-right: 100px; color: #66d866; font-size: 400%;" href="http://www.doxygen.org/index.html">DOXYGEN</a></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ncrypt_2lib_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">lib.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>API for encryption/signing of emails.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for lib.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h__incl.svg" width="272" height="110"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
</div>
<p><a href="ncrypt_2lib_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a95845954210adfc850d5602843f858d4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a95845954210adfc850d5602843f858d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">No flags are set.  <br /></td></tr>
<tr class="separator:a95845954210adfc850d5602843f858d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacaa4abd4c0696e260b7a0f1d466360a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>&#160;&#160;&#160;(1 &lt;&lt; 0)</td></tr>
<tr class="memdesc:aacaa4abd4c0696e260b7a0f1d466360a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> is encrypted.  <br /></td></tr>
<tr class="separator:aacaa4abd4c0696e260b7a0f1d466360a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae12c003463c99d28f65f1d6b8b053b2c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>&#160;&#160;&#160;(1 &lt;&lt; 1)</td></tr>
<tr class="memdesc:ae12c003463c99d28f65f1d6b8b053b2c"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> is signed.  <br /></td></tr>
<tr class="separator:ae12c003463c99d28f65f1d6b8b053b2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a427cda1ba4b173fa708e124afe7b907a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>&#160;&#160;&#160;(1 &lt;&lt; 2)</td></tr>
<tr class="memdesc:a427cda1ba4b173fa708e124afe7b907a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> has a valid signature.  <br /></td></tr>
<tr class="separator:a427cda1ba4b173fa708e124afe7b907a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70ffca3c8f9bc49498e3352294c5b8fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">SEC_BADSIGN</a>&#160;&#160;&#160;(1 &lt;&lt; 3)</td></tr>
<tr class="memdesc:a70ffca3c8f9bc49498e3352294c5b8fd"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> has a bad signature.  <br /></td></tr>
<tr class="separator:a70ffca3c8f9bc49498e3352294c5b8fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b0f8af6da383f08d29eb97fac836e3f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a9b0f8af6da383f08d29eb97fac836e3f">SEC_PARTSIGN</a>&#160;&#160;&#160;(1 &lt;&lt; 4)</td></tr>
<tr class="memdesc:a9b0f8af6da383f08d29eb97fac836e3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Not all parts of the email is signed.  <br /></td></tr>
<tr class="separator:a9b0f8af6da383f08d29eb97fac836e3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6522a5e7af7f8624b8a3bbc94d8efb1e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a6522a5e7af7f8624b8a3bbc94d8efb1e">SEC_SIGNOPAQUE</a>&#160;&#160;&#160;(1 &lt;&lt; 5)</td></tr>
<tr class="memdesc:a6522a5e7af7f8624b8a3bbc94d8efb1e"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> has an opaque signature (encrypted)  <br /></td></tr>
<tr class="separator:a6522a5e7af7f8624b8a3bbc94d8efb1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affb64fdb57b996638ce5b783ccb48810"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#affb64fdb57b996638ce5b783ccb48810">SEC_KEYBLOCK</a>&#160;&#160;&#160;(1 &lt;&lt; 6)</td></tr>
<tr class="memdesc:affb64fdb57b996638ce5b783ccb48810"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> has a key attached.  <br /></td></tr>
<tr class="separator:affb64fdb57b996638ce5b783ccb48810"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a074f827472ad45f11ec1132cdfed2daf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>&#160;&#160;&#160;(1 &lt;&lt; 7)</td></tr>
<tr class="memdesc:a074f827472ad45f11ec1132cdfed2daf"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> has an inline signature.  <br /></td></tr>
<tr class="separator:a074f827472ad45f11ec1132cdfed2daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fb0b0aa796d8d79a746001d09c2a2c7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a>&#160;&#160;&#160;(1 &lt;&lt; 8)</td></tr>
<tr class="memdesc:a2fb0b0aa796d8d79a746001d09c2a2c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opportunistic encrypt mode.  <br /></td></tr>
<tr class="separator:a2fb0b0aa796d8d79a746001d09c2a2c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b36be5c32ca90d8f2caef9ea9d627fc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>&#160;&#160;&#160;(1 &lt;&lt; 9)</td></tr>
<tr class="memdesc:a0b36be5c32ca90d8f2caef9ea9d627fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">(Autocrypt) <a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> will be, or was Autocrypt encrypt+signed  <br /></td></tr>
<tr class="separator:a0b36be5c32ca90d8f2caef9ea9d627fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ce4a742538f3ee3e1bfbf143c794fb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ae0ce4a742538f3ee3e1bfbf143c794fb">SEC_AUTOCRYPT_OVERRIDE</a>&#160;&#160;&#160;(1 &lt;&lt; 10)</td></tr>
<tr class="memdesc:ae0ce4a742538f3ee3e1bfbf143c794fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">(Autocrypt) Indicates manual set/unset of encryption  <br /></td></tr>
<tr class="separator:ae0ce4a742538f3ee3e1bfbf143c794fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a587e679a4c9cc44f11f0c467bb22b0af"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>&#160;&#160;&#160;(1 &lt;&lt; 11)</td></tr>
<tr class="memdesc:a587e679a4c9cc44f11f0c467bb22b0af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use PGP to encrypt/sign.  <br /></td></tr>
<tr class="separator:a587e679a4c9cc44f11f0c467bb22b0af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a798dfac1e8839ca89375b4ec62b3eff2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>&#160;&#160;&#160;(1 &lt;&lt; 12)</td></tr>
<tr class="memdesc:a798dfac1e8839ca89375b4ec62b3eff2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use SMIME to encrypt/sign.  <br /></td></tr>
<tr class="separator:a798dfac1e8839ca89375b4ec62b3eff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c4cec129dc84794f15f44382c25fc36"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a3c4cec129dc84794f15f44382c25fc36">PGP_TRADITIONAL_CHECKED</a>&#160;&#160;&#160;(1 &lt;&lt; 13)</td></tr>
<tr class="memdesc:a3c4cec129dc84794f15f44382c25fc36"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> has a traditional (inline) signature.  <br /></td></tr>
<tr class="separator:a3c4cec129dc84794f15f44382c25fc36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eec0b09486fe4bfe7613f808f768747"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a3eec0b09486fe4bfe7613f808f768747">SEC_ALL_FLAGS</a>&#160;&#160;&#160;((1 &lt;&lt; 14) - 1)</td></tr>
<tr class="separator:a3eec0b09486fe4bfe7613f808f768747"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6694d25dff1ee1958351160a84bb2dc0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>)</td></tr>
<tr class="separator:a6694d25dff1ee1958351160a84bb2dc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f75a650c49341776276f44881d54b2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>)</td></tr>
<tr class="separator:a14f75a650c49341776276f44881d54b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae480697fdeb3d6b2c127e0ae36c52e8e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ae480697fdeb3d6b2c127e0ae36c52e8e">PGP_GOODSIGN</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>)</td></tr>
<tr class="separator:ae480697fdeb3d6b2c127e0ae36c52e8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd2087cae2885c199218f5530ce7945b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#affb64fdb57b996638ce5b783ccb48810">SEC_KEYBLOCK</a>)</td></tr>
<tr class="separator:abd2087cae2885c199218f5530ce7945b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68503f0e36de213094c8546b4f74eef1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>)</td></tr>
<tr class="separator:a68503f0e36de213094c8546b4f74eef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac25eb5415ebf34da68c39a3d4e3bc9ad"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>)</td></tr>
<tr class="separator:ac25eb5415ebf34da68c39a3d4e3bc9ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67114d960e61fc36c467f4bf08d37335"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>)</td></tr>
<tr class="separator:a67114d960e61fc36c467f4bf08d37335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e7bff0627202fd91790855e1300ec99"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a3e7bff0627202fd91790855e1300ec99">SMIME_GOODSIGN</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>)</td></tr>
<tr class="separator:a3e7bff0627202fd91790855e1300ec99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79c49cef9301420920c8c673f06a1be1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a79c49cef9301420920c8c673f06a1be1">SMIME_BADSIGN</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">SEC_BADSIGN</a>)</td></tr>
<tr class="separator:a79c49cef9301420920c8c673f06a1be1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c811504abf735623a6dd3ac20287f30"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#a6522a5e7af7f8624b8a3bbc94d8efb1e">SEC_SIGNOPAQUE</a>)</td></tr>
<tr class="separator:a9c811504abf735623a6dd3ac20287f30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad980bff69bb614893ad8e7e1c28a5023"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</td></tr>
<tr class="separator:ad980bff69bb614893ad8e7e1c28a5023"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a827146354c736ec416508944692e52b2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a827146354c736ec416508944692e52b2">KEYFLAG_NO_FLAGS</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:a827146354c736ec416508944692e52b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">No flags are set.  <br /></td></tr>
<tr class="separator:a827146354c736ec416508944692e52b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee8e2da44282ca27f6a786cef781334f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f">KEYFLAG_CANSIGN</a>&#160;&#160;&#160;(1 &lt;&lt; 0)</td></tr>
<tr class="memdesc:aee8e2da44282ca27f6a786cef781334f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is suitable for signing.  <br /></td></tr>
<tr class="separator:aee8e2da44282ca27f6a786cef781334f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7254adf21a76d4ceea08bd931df4310f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a7254adf21a76d4ceea08bd931df4310f">KEYFLAG_CANENCRYPT</a>&#160;&#160;&#160;(1 &lt;&lt; 1)</td></tr>
<tr class="memdesc:a7254adf21a76d4ceea08bd931df4310f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is suitable for encryption.  <br /></td></tr>
<tr class="separator:a7254adf21a76d4ceea08bd931df4310f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52372a26134009ebc0f946abc8a6075c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a52372a26134009ebc0f946abc8a6075c">KEYFLAG_ISX509</a>&#160;&#160;&#160;(1 &lt;&lt; 2)</td></tr>
<tr class="memdesc:a52372a26134009ebc0f946abc8a6075c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is an X.509 key.  <br /></td></tr>
<tr class="separator:a52372a26134009ebc0f946abc8a6075c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc955f91dd3fdc8b82246c140f023fa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aacc955f91dd3fdc8b82246c140f023fa">KEYFLAG_SECRET</a>&#160;&#160;&#160;(1 &lt;&lt; 7)</td></tr>
<tr class="memdesc:aacc955f91dd3fdc8b82246c140f023fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is a secret key.  <br /></td></tr>
<tr class="separator:aacc955f91dd3fdc8b82246c140f023fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20472f13517d60d40aa75287afc81c5d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a20472f13517d60d40aa75287afc81c5d">KEYFLAG_EXPIRED</a>&#160;&#160;&#160;(1 &lt;&lt; 8)</td></tr>
<tr class="memdesc:a20472f13517d60d40aa75287afc81c5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is expired.  <br /></td></tr>
<tr class="separator:a20472f13517d60d40aa75287afc81c5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb95b48318487d9eb8f9709e933d749e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">KEYFLAG_REVOKED</a>&#160;&#160;&#160;(1 &lt;&lt; 9)</td></tr>
<tr class="memdesc:acb95b48318487d9eb8f9709e933d749e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is revoked.  <br /></td></tr>
<tr class="separator:acb95b48318487d9eb8f9709e933d749e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a989f3449b764c6a8f5f5e0481569884a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a989f3449b764c6a8f5f5e0481569884a">KEYFLAG_DISABLED</a>&#160;&#160;&#160;(1 &lt;&lt; 10)</td></tr>
<tr class="memdesc:a989f3449b764c6a8f5f5e0481569884a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is marked disabled.  <br /></td></tr>
<tr class="separator:a989f3449b764c6a8f5f5e0481569884a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a1ead56127b7fac407296e153c0967"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a73a1ead56127b7fac407296e153c0967">KEYFLAG_SUBKEY</a>&#160;&#160;&#160;(1 &lt;&lt; 11)</td></tr>
<tr class="memdesc:a73a1ead56127b7fac407296e153c0967"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is a subkey.  <br /></td></tr>
<tr class="separator:a73a1ead56127b7fac407296e153c0967"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ffaa1a95f918db325d8d770f76a7f79"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a8ffaa1a95f918db325d8d770f76a7f79">KEYFLAG_CRITICAL</a>&#160;&#160;&#160;(1 &lt;&lt; 12)</td></tr>
<tr class="memdesc:a8ffaa1a95f918db325d8d770f76a7f79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key is marked critical.  <br /></td></tr>
<tr class="separator:a8ffaa1a95f918db325d8d770f76a7f79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4067c9bae1c276c505b42265b70529e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ae4067c9bae1c276c505b42265b70529e">KEYFLAG_PREFER_ENCRYPTION</a>&#160;&#160;&#160;(1 &lt;&lt; 13)</td></tr>
<tr class="memdesc:ae4067c9bae1c276c505b42265b70529e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key's owner prefers encryption.  <br /></td></tr>
<tr class="separator:ae4067c9bae1c276c505b42265b70529e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88a54f7be16fc36441fafe14ee14ac0b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a88a54f7be16fc36441fafe14ee14ac0b">KEYFLAG_PREFER_SIGNING</a>&#160;&#160;&#160;(1 &lt;&lt; 14)</td></tr>
<tr class="memdesc:a88a54f7be16fc36441fafe14ee14ac0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Key's owner prefers signing.  <br /></td></tr>
<tr class="separator:a88a54f7be16fc36441fafe14ee14ac0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74b325469393092ed6d402f1ba78d7ba"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a74b325469393092ed6d402f1ba78d7ba">KEYFLAG_CANTUSE</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a989f3449b764c6a8f5f5e0481569884a">KEYFLAG_DISABLED</a> | <a class="el" href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">KEYFLAG_REVOKED</a> | <a class="el" href="ncrypt_2lib_8h.html#a20472f13517d60d40aa75287afc81c5d">KEYFLAG_EXPIRED</a>)</td></tr>
<tr class="separator:a74b325469393092ed6d402f1ba78d7ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b5753c8babedca24c31e8d2dbad8130"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a5b5753c8babedca24c31e8d2dbad8130">KEYFLAG_RESTRICTIONS</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a74b325469393092ed6d402f1ba78d7ba">KEYFLAG_CANTUSE</a> | <a class="el" href="ncrypt_2lib_8h.html#a8ffaa1a95f918db325d8d770f76a7f79">KEYFLAG_CRITICAL</a>)</td></tr>
<tr class="separator:a5b5753c8babedca24c31e8d2dbad8130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71ddb5e69f239d16bdf6a6cc266072e4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a71ddb5e69f239d16bdf6a6cc266072e4">KEYFLAG_ABILITIES</a>&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f">KEYFLAG_CANSIGN</a> | <a class="el" href="ncrypt_2lib_8h.html#a7254adf21a76d4ceea08bd931df4310f">KEYFLAG_CANENCRYPT</a> | <a class="el" href="ncrypt_2lib_8h.html#ae4067c9bae1c276c505b42265b70529e">KEYFLAG_PREFER_ENCRYPTION</a> | <a class="el" href="ncrypt_2lib_8h.html#a88a54f7be16fc36441fafe14ee14ac0b">KEYFLAG_PREFER_SIGNING</a>)</td></tr>
<tr class="separator:a71ddb5e69f239d16bdf6a6cc266072e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a2073a168ca3a64c3c30d13fa4917a05d"><td class="memItemLeft" align="right" valign="top">typedef uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></td></tr>
<tr class="memdesc:a2073a168ca3a64c3c30d13fa4917a05d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags, e.g. <a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a" title="Email is encrypted.">SEC_ENCRYPT</a>.  <br /></td></tr>
<tr class="separator:a2073a168ca3a64c3c30d13fa4917a05d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530487c28aacc2c2d50f12eefb8c5506"><td class="memItemLeft" align="right" valign="top">typedef uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a530487c28aacc2c2d50f12eefb8c5506">KeyFlags</a></td></tr>
<tr class="memdesc:a530487c28aacc2c2d50f12eefb8c5506"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags describing PGP/SMIME keys, e.g. <a class="el" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f" title="Key is suitable for signing.">KEYFLAG_CANSIGN</a>.  <br /></td></tr>
<tr class="separator:a530487c28aacc2c2d50f12eefb8c5506"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a776fef61b47569d4c698411d5e733a0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a776fef61b47569d4c698411d5e733a0f">crypt_extract_keys_from_messages</a> (struct <a class="el" href="structMailbox.html">Mailbox</a> *m, struct EmailArray *ea)</td></tr>
<tr class="memdesc:a776fef61b47569d4c698411d5e733a0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract keys from a message.  <br /></td></tr>
<tr class="separator:a776fef61b47569d4c698411d5e733a0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a09719065d14c27701c998b48883ac4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a8a09719065d14c27701c998b48883ac4">crypt_forget_passphrase</a> (void)</td></tr>
<tr class="memdesc:a8a09719065d14c27701c998b48883ac4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forget a passphrase and display a message.  <br /></td></tr>
<tr class="separator:a8a09719065d14c27701c998b48883ac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb04ccb83d144391034d86704c52b987"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#abb04ccb83d144391034d86704c52b987">crypt_get_keys</a> (struct <a class="el" href="structEmail.html">Email</a> *e, char **keylist, bool oppenc_mode)</td></tr>
<tr class="memdesc:abb04ccb83d144391034d86704c52b987"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check we have all the keys we need.  <br /></td></tr>
<tr class="separator:abb04ccb83d144391034d86704c52b987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2afe38b474061773d69624018621ff1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a2afe38b474061773d69624018621ff1e">crypt_opportunistic_encrypt</a> (struct <a class="el" href="structEmail.html">Email</a> *e)</td></tr>
<tr class="memdesc:a2afe38b474061773d69624018621ff1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Can all recipients be determined.  <br /></td></tr>
<tr class="separator:a2afe38b474061773d69624018621ff1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4ab2e337a2477fba687b1f710aa7a61"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#af4ab2e337a2477fba687b1f710aa7a61">crypt_query</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:af4ab2e337a2477fba687b1f710aa7a61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check out the type of encryption used.  <br /></td></tr>
<tr class="separator:af4ab2e337a2477fba687b1f710aa7a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ee7f1419a7e39b0e9f1f9d550f4de43"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a> (<a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> flags)</td></tr>
<tr class="memdesc:a4ee7f1419a7e39b0e9f1f9d550f4de43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check that we have a usable passphrase, ask if not.  <br /></td></tr>
<tr class="separator:a4ee7f1419a7e39b0e9f1f9d550f4de43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5ae8b8d4fea0b6aa61dc38312e99d15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#ad5ae8b8d4fea0b6aa61dc38312e99d15">mutt_is_application_pgp</a> (const struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:ad5ae8b8d4fea0b6aa61dc38312e99d15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the message use PGP?  <br /></td></tr>
<tr class="separator:ad5ae8b8d4fea0b6aa61dc38312e99d15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4073ce5b5fcec6e245dbfa9369016b8e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a4073ce5b5fcec6e245dbfa9369016b8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the message use S/MIME?  <br /></td></tr>
<tr class="separator:a4073ce5b5fcec6e245dbfa9369016b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9edb0262eaed7c522977a75b76c15770"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a9edb0262eaed7c522977a75b76c15770">mutt_is_malformed_multipart_pgp_encrypted</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a9edb0262eaed7c522977a75b76c15770"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for malformed layout.  <br /></td></tr>
<tr class="separator:a9edb0262eaed7c522977a75b76c15770"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a832e4b9f5a0e463876a3d8cfe852f12d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a832e4b9f5a0e463876a3d8cfe852f12d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does the message have encrypted parts?  <br /></td></tr>
<tr class="separator:a832e4b9f5a0e463876a3d8cfe852f12d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a345fb1ff241b3fc778632947c2b08d37"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a345fb1ff241b3fc778632947c2b08d37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is a message signed?  <br /></td></tr>
<tr class="separator:a345fb1ff241b3fc778632947c2b08d37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51806f872069460bb7f4fa16d1d92710"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a51806f872069460bb7f4fa16d1d92710">mutt_is_valid_multipart_pgp_encrypted</a> (struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a51806f872069460bb7f4fa16d1d92710"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is this a valid multi-part encrypted message?  <br /></td></tr>
<tr class="separator:a51806f872069460bb7f4fa16d1d92710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7ccf06ce10b9aed658fcc6c7a40c64b8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__handler__api.html#ga7ccf06ce10b9aed658fcc6c7a40c64b8">mutt_protected_headers_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga7ccf06ce10b9aed658fcc6c7a40c64b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for protected headers - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga7ccf06ce10b9aed658fcc6c7a40c64b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a896502d4448fefadaf8786a4f2d5556e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a896502d4448fefadaf8786a4f2d5556e">mutt_protect</a> (struct <a class="el" href="structEmail.html">Email</a> *e, char *keylist, bool postpone)</td></tr>
<tr class="memdesc:a896502d4448fefadaf8786a4f2d5556e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt and/or sign a message.  <br /></td></tr>
<tr class="separator:a896502d4448fefadaf8786a4f2d5556e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52c65477f5b80ad3dc8028663653771d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a52c65477f5b80ad3dc8028663653771d">mutt_should_hide_protected_subject</a> (struct <a class="el" href="structEmail.html">Email</a> *e)</td></tr>
<tr class="memdesc:a52c65477f5b80ad3dc8028663653771d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Should <a class="el" href="structNeoMutt.html" title="Container for Accounts, Notifications.">NeoMutt</a> hide the protected subject?  <br /></td></tr>
<tr class="separator:a52c65477f5b80ad3dc8028663653771d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad8f7563b8c9aba96de145d0e17e58437"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__handler__api.html#gad8f7563b8c9aba96de145d0e17e58437">mutt_signed_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:gad8f7563b8c9aba96de145d0e17e58437"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler for "multipart/signed" - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:gad8f7563b8c9aba96de145d0e17e58437"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a397940a79b0c75800fed7d264f7fd6b4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a397940a79b0c75800fed7d264f7fd6b4">crypt_cleanup</a> (void)</td></tr>
<tr class="memdesc:a397940a79b0c75800fed7d264f7fd6b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up backend.  <br /></td></tr>
<tr class="separator:a397940a79b0c75800fed7d264f7fd6b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07a6c891658dd90ef8333a1e5bbcc285"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a07a6c891658dd90ef8333a1e5bbcc285">crypt_has_module_backend</a> (<a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> type)</td></tr>
<tr class="memdesc:a07a6c891658dd90ef8333a1e5bbcc285"><td class="mdescLeft">&#160;</td><td class="mdescRight">Is there a crypto backend for a given type?  <br /></td></tr>
<tr class="separator:a07a6c891658dd90ef8333a1e5bbcc285"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaecf706c319966f9eafd582b58ba531f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aaecf706c319966f9eafd582b58ba531f">crypt_init</a> (void)</td></tr>
<tr class="memdesc:aaecf706c319966f9eafd582b58ba531f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the crypto backends.  <br /></td></tr>
<tr class="separator:aaecf706c319966f9eafd582b58ba531f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a166ec08d102f4330fdd0cc44a32bdf96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a166ec08d102f4330fdd0cc44a32bdf96">crypt_invoke_message</a> (<a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> type)</td></tr>
<tr class="memdesc:a166ec08d102f4330fdd0cc44a32bdf96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Display an informative message.  <br /></td></tr>
<tr class="separator:a166ec08d102f4330fdd0cc44a32bdf96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2de61c155f3d4ff8b010e2e4f615ea94"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__handler__api.html#ga2de61c155f3d4ff8b010e2e4f615ea94">crypt_pgp_application_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga2de61c155f3d4ff8b010e2e4f615ea94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a9d7b47fb748a7cdb4975f2dde8179a98">CryptModuleSpecs::application_handler()</a> - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga2de61c155f3d4ff8b010e2e4f615ea94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5959b6797c94b22a7d391cbb5fd2fa33"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a5959b6797c94b22a7d391cbb5fd2fa33">crypt_pgp_check_traditional</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b, bool just_one)</td></tr>
<tr class="memdesc:a5959b6797c94b22a7d391cbb5fd2fa33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#abbb74e663273948a7e2ad35a1135e6a2">CryptModuleSpecs::pgp_check_traditional()</a>  <br /></td></tr>
<tr class="separator:a5959b6797c94b22a7d391cbb5fd2fa33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2451c9278c3e8a9f69c80384419b3822"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a2451c9278c3e8a9f69c80384419b3822">crypt_pgp_decrypt_mime</a> (FILE *fp_in, FILE **fp_out, struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structBody.html">Body</a> **b_dec)</td></tr>
<tr class="memdesc:a2451c9278c3e8a9f69c80384419b3822"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a18cf5903d388ba3cc91431e5076271ee">CryptModuleSpecs::decrypt_mime()</a>  <br /></td></tr>
<tr class="separator:a2451c9278c3e8a9f69c80384419b3822"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b445e21874bc1e1ec681a2626df13f9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__handler__api.html#ga7b445e21874bc1e1ec681a2626df13f9">crypt_pgp_encrypted_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga7b445e21874bc1e1ec681a2626df13f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a0a6f227729bf45fc362bc0896a241de2">CryptModuleSpecs::encrypted_handler()</a> - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga7b445e21874bc1e1ec681a2626df13f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a454ff57ec235e3472ef42872f00042"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a8a454ff57ec235e3472ef42872f00042">crypt_pgp_extract_key_from_attachment</a> (FILE *fp, struct <a class="el" href="structBody.html">Body</a> *b)</td></tr>
<tr class="memdesc:a8a454ff57ec235e3472ef42872f00042"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a7660e30a85a5ae60da1a384d1d351272">CryptModuleSpecs::pgp_extract_key_from_attachment()</a>  <br /></td></tr>
<tr class="separator:a8a454ff57ec235e3472ef42872f00042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d989caa27c6539e55662007a6cf2cc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a7d989caa27c6539e55662007a6cf2cc5">crypt_pgp_invoke_getkeys</a> (struct <a class="el" href="structAddress.html">Address</a> *addr)</td></tr>
<tr class="memdesc:a7d989caa27c6539e55662007a6cf2cc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#acd2b13751354a0ea6dc82ee6bbdf3724">CryptModuleSpecs::pgp_invoke_getkeys()</a>  <br /></td></tr>
<tr class="separator:a7d989caa27c6539e55662007a6cf2cc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ff317859513ab653641114e19fb8f59"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structBody.html">Body</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a6ff317859513ab653641114e19fb8f59">crypt_pgp_make_key_attachment</a> (void)</td></tr>
<tr class="memdesc:a6ff317859513ab653641114e19fb8f59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a8331dbbb3603bed062e7e80342a97b4f">CryptModuleSpecs::pgp_make_key_attachment()</a>  <br /></td></tr>
<tr class="separator:a6ff317859513ab653641114e19fb8f59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a797309f2fd7a80c9f5a3b97944e37c4b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a797309f2fd7a80c9f5a3b97944e37c4b">crypt_pgp_send_menu</a> (struct <a class="el" href="structEmail.html">Email</a> *e)</td></tr>
<tr class="memdesc:a797309f2fd7a80c9f5a3b97944e37c4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#aa5176c9adfe75f78d99e4c2bd7e6671c">CryptModuleSpecs::send_menu()</a>  <br /></td></tr>
<tr class="separator:a797309f2fd7a80c9f5a3b97944e37c4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga570796cc91abc82fbc16bcd285137688"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__handler__api.html#ga570796cc91abc82fbc16bcd285137688">crypt_smime_application_handler</a> (struct <a class="el" href="structBody.html">Body</a> *b_email, struct <a class="el" href="structState.html">State</a> *state)</td></tr>
<tr class="memdesc:ga570796cc91abc82fbc16bcd285137688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a9d7b47fb748a7cdb4975f2dde8179a98">CryptModuleSpecs::application_handler()</a> - Implements <a class="el" href="handler_8c.html#a72454e2cd50fcfe2124f5a923dcda538">handler_t</a> -.  <br /></td></tr>
<tr class="separator:ga570796cc91abc82fbc16bcd285137688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa21c1df7a3803c79c0a79426ec2f4aa2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#aa21c1df7a3803c79c0a79426ec2f4aa2">crypt_smime_decrypt_mime</a> (FILE *fp_in, FILE **fp_out, struct <a class="el" href="structBody.html">Body</a> *b, struct <a class="el" href="structBody.html">Body</a> **b_dec)</td></tr>
<tr class="memdesc:aa21c1df7a3803c79c0a79426ec2f4aa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a18cf5903d388ba3cc91431e5076271ee">CryptModuleSpecs::decrypt_mime()</a>  <br /></td></tr>
<tr class="separator:aa21c1df7a3803c79c0a79426ec2f4aa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f60f47f4d4dee7f43f502b7244af35f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a3f60f47f4d4dee7f43f502b7244af35f">crypt_smime_getkeys</a> (struct <a class="el" href="structEnvelope.html">Envelope</a> *env)</td></tr>
<tr class="memdesc:a3f60f47f4d4dee7f43f502b7244af35f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#a555d3da530f7c25207fcbae9efa8ab03">CryptModuleSpecs::smime_getkeys()</a>  <br /></td></tr>
<tr class="separator:a3f60f47f4d4dee7f43f502b7244af35f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7354df32a82355b8df8c38ea1afc06cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a7354df32a82355b8df8c38ea1afc06cc">crypt_smime_send_menu</a> (struct <a class="el" href="structEmail.html">Email</a> *e)</td></tr>
<tr class="memdesc:a7354df32a82355b8df8c38ea1afc06cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#aa5176c9adfe75f78d99e4c2bd7e6671c">CryptModuleSpecs::send_menu()</a>  <br /></td></tr>
<tr class="separator:a7354df32a82355b8df8c38ea1afc06cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c2837a7a6ddee675a5ddfd5545244c1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a9c2837a7a6ddee675a5ddfd5545244c1">crypt_smime_verify_sender</a> (struct <a class="el" href="structEmail.html">Email</a> *e, struct <a class="el" href="structMessage.html">Message</a> *msg)</td></tr>
<tr class="memdesc:a9c2837a7a6ddee675a5ddfd5545244c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper for <a class="el" href="structCryptModuleSpecs.html#ab1befdfed56bdbcdd6f42b174a66fe1a">CryptModuleSpecs::smime_verify_sender()</a>  <br /></td></tr>
<tr class="separator:a9c2837a7a6ddee675a5ddfd5545244c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a626ef0840a8870758022db54646c12ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a626ef0840a8870758022db54646c12ae">crypto_module_cleanup</a> (void)</td></tr>
<tr class="memdesc:a626ef0840a8870758022db54646c12ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up the crypto modules.  <br /></td></tr>
<tr class="separator:a626ef0840a8870758022db54646c12ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7061521ecb51237cbbc557440353af39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__crypto__init.html#ga7061521ecb51237cbbc557440353af39">pgp_gpgme_init</a> (void)</td></tr>
<tr class="memdesc:ga7061521ecb51237cbbc557440353af39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the crypto module - Implements <a class="el" href="structCryptModuleSpecs.html#a819c87369b2dc3806d846c3a7e9fb7b6">CryptModuleSpecs::init()</a> -.  <br /></td></tr>
<tr class="separator:ga7061521ecb51237cbbc557440353af39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e8df329d00791c453eb6b3f60eabfdf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a2e8df329d00791c453eb6b3f60eabfdf">mutt_gpgme_select_secret_key</a> (struct <a class="el" href="structBuffer.html">Buffer</a> *keyid)</td></tr>
<tr class="memdesc:a2e8df329d00791c453eb6b3f60eabfdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select a private Autocrypt key for a new account.  <br /></td></tr>
<tr class="separator:a2e8df329d00791c453eb6b3f60eabfdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a326949d15c60fb5c5de5361c4a88a934"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ncrypt_2lib_8h.html#a326949d15c60fb5c5de5361c4a88a934">mutt_gpgme_print_version</a> (void)</td></tr>
<tr class="memdesc:a326949d15c60fb5c5de5361c4a88a934"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get version of GPGME.  <br /></td></tr>
<tr class="separator:a326949d15c60fb5c5de5361c4a88a934"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>API for encryption/signing of emails. </p>
<dl class="section author"><dt>Authors</dt><dd><ul>
<li>Richard Russon</li>
<li>Pietro Cerutti</li>
</ul>
</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 2 of the License, or (at your option) any later version.</dd></dl>
<p>This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this program. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>

<p class="definition">Definition in file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a95845954210adfc850d5602843f858d4" name="a95845954210adfc850d5602843f858d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95845954210adfc850d5602843f858d4">&#9670;&#160;</a></span>SEC_NO_FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_NO_FLAGS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>No flags are set. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00083">83</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="aacaa4abd4c0696e260b7a0f1d466360a" name="aacaa4abd4c0696e260b7a0f1d466360a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacaa4abd4c0696e260b7a0f1d466360a">&#9670;&#160;</a></span>SEC_ENCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_ENCRYPT&#160;&#160;&#160;(1 &lt;&lt; 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> is encrypted. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00084">84</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="ae12c003463c99d28f65f1d6b8b053b2c" name="ae12c003463c99d28f65f1d6b8b053b2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae12c003463c99d28f65f1d6b8b053b2c">&#9670;&#160;</a></span>SEC_SIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_SIGN&#160;&#160;&#160;(1 &lt;&lt; 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> is signed. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00085">85</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a427cda1ba4b173fa708e124afe7b907a" name="a427cda1ba4b173fa708e124afe7b907a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a427cda1ba4b173fa708e124afe7b907a">&#9670;&#160;</a></span>SEC_GOODSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_GOODSIGN&#160;&#160;&#160;(1 &lt;&lt; 2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> has a valid signature. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00086">86</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a70ffca3c8f9bc49498e3352294c5b8fd" name="a70ffca3c8f9bc49498e3352294c5b8fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70ffca3c8f9bc49498e3352294c5b8fd">&#9670;&#160;</a></span>SEC_BADSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_BADSIGN&#160;&#160;&#160;(1 &lt;&lt; 3)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> has a bad signature. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00087">87</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a9b0f8af6da383f08d29eb97fac836e3f" name="a9b0f8af6da383f08d29eb97fac836e3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b0f8af6da383f08d29eb97fac836e3f">&#9670;&#160;</a></span>SEC_PARTSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_PARTSIGN&#160;&#160;&#160;(1 &lt;&lt; 4)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Not all parts of the email is signed. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00088">88</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a6522a5e7af7f8624b8a3bbc94d8efb1e" name="a6522a5e7af7f8624b8a3bbc94d8efb1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6522a5e7af7f8624b8a3bbc94d8efb1e">&#9670;&#160;</a></span>SEC_SIGNOPAQUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_SIGNOPAQUE&#160;&#160;&#160;(1 &lt;&lt; 5)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> has an opaque signature (encrypted) </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00089">89</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="affb64fdb57b996638ce5b783ccb48810" name="affb64fdb57b996638ce5b783ccb48810"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affb64fdb57b996638ce5b783ccb48810">&#9670;&#160;</a></span>SEC_KEYBLOCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_KEYBLOCK&#160;&#160;&#160;(1 &lt;&lt; 6)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> has a key attached. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00090">90</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a074f827472ad45f11ec1132cdfed2daf" name="a074f827472ad45f11ec1132cdfed2daf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a074f827472ad45f11ec1132cdfed2daf">&#9670;&#160;</a></span>SEC_INLINE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_INLINE&#160;&#160;&#160;(1 &lt;&lt; 7)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> has an inline signature. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00091">91</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a2fb0b0aa796d8d79a746001d09c2a2c7" name="a2fb0b0aa796d8d79a746001d09c2a2c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fb0b0aa796d8d79a746001d09c2a2c7">&#9670;&#160;</a></span>SEC_OPPENCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_OPPENCRYPT&#160;&#160;&#160;(1 &lt;&lt; 8)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opportunistic encrypt mode. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00092">92</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a0b36be5c32ca90d8f2caef9ea9d627fc" name="a0b36be5c32ca90d8f2caef9ea9d627fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b36be5c32ca90d8f2caef9ea9d627fc">&#9670;&#160;</a></span>SEC_AUTOCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_AUTOCRYPT&#160;&#160;&#160;(1 &lt;&lt; 9)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(Autocrypt) <a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> will be, or was Autocrypt encrypt+signed </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00093">93</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="ae0ce4a742538f3ee3e1bfbf143c794fb" name="ae0ce4a742538f3ee3e1bfbf143c794fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0ce4a742538f3ee3e1bfbf143c794fb">&#9670;&#160;</a></span>SEC_AUTOCRYPT_OVERRIDE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_AUTOCRYPT_OVERRIDE&#160;&#160;&#160;(1 &lt;&lt; 10)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(Autocrypt) Indicates manual set/unset of encryption </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00094">94</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a587e679a4c9cc44f11f0c467bb22b0af" name="a587e679a4c9cc44f11f0c467bb22b0af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a587e679a4c9cc44f11f0c467bb22b0af">&#9670;&#160;</a></span>APPLICATION_PGP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define APPLICATION_PGP&#160;&#160;&#160;(1 &lt;&lt; 11)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use PGP to encrypt/sign. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00096">96</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a798dfac1e8839ca89375b4ec62b3eff2" name="a798dfac1e8839ca89375b4ec62b3eff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a798dfac1e8839ca89375b4ec62b3eff2">&#9670;&#160;</a></span>APPLICATION_SMIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define APPLICATION_SMIME&#160;&#160;&#160;(1 &lt;&lt; 12)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use SMIME to encrypt/sign. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00097">97</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a3c4cec129dc84794f15f44382c25fc36" name="a3c4cec129dc84794f15f44382c25fc36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c4cec129dc84794f15f44382c25fc36">&#9670;&#160;</a></span>PGP_TRADITIONAL_CHECKED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PGP_TRADITIONAL_CHECKED&#160;&#160;&#160;(1 &lt;&lt; 13)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> has a traditional (inline) signature. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00098">98</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a3eec0b09486fe4bfe7613f808f768747" name="a3eec0b09486fe4bfe7613f808f768747"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eec0b09486fe4bfe7613f808f768747">&#9670;&#160;</a></span>SEC_ALL_FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_ALL_FLAGS&#160;&#160;&#160;((1 &lt;&lt; 14) - 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00100">100</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a6694d25dff1ee1958351160a84bb2dc0" name="a6694d25dff1ee1958351160a84bb2dc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6694d25dff1ee1958351160a84bb2dc0">&#9670;&#160;</a></span>PGP_ENCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PGP_ENCRYPT&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00102">102</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a14f75a650c49341776276f44881d54b2" name="a14f75a650c49341776276f44881d54b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f75a650c49341776276f44881d54b2">&#9670;&#160;</a></span>PGP_SIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PGP_SIGN&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00103">103</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="ae480697fdeb3d6b2c127e0ae36c52e8e" name="ae480697fdeb3d6b2c127e0ae36c52e8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae480697fdeb3d6b2c127e0ae36c52e8e">&#9670;&#160;</a></span>PGP_GOODSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PGP_GOODSIGN&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00104">104</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="abd2087cae2885c199218f5530ce7945b" name="abd2087cae2885c199218f5530ce7945b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd2087cae2885c199218f5530ce7945b">&#9670;&#160;</a></span>PGP_KEY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PGP_KEY&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#affb64fdb57b996638ce5b783ccb48810">SEC_KEYBLOCK</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00105">105</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a68503f0e36de213094c8546b4f74eef1" name="a68503f0e36de213094c8546b4f74eef1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68503f0e36de213094c8546b4f74eef1">&#9670;&#160;</a></span>PGP_INLINE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PGP_INLINE&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00106">106</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="ac25eb5415ebf34da68c39a3d4e3bc9ad" name="ac25eb5415ebf34da68c39a3d4e3bc9ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac25eb5415ebf34da68c39a3d4e3bc9ad">&#9670;&#160;</a></span>SMIME_ENCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMIME_ENCRYPT&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00108">108</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a67114d960e61fc36c467f4bf08d37335" name="a67114d960e61fc36c467f4bf08d37335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67114d960e61fc36c467f4bf08d37335">&#9670;&#160;</a></span>SMIME_SIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMIME_SIGN&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00109">109</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a3e7bff0627202fd91790855e1300ec99" name="a3e7bff0627202fd91790855e1300ec99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e7bff0627202fd91790855e1300ec99">&#9670;&#160;</a></span>SMIME_GOODSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMIME_GOODSIGN&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00110">110</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a79c49cef9301420920c8c673f06a1be1" name="a79c49cef9301420920c8c673f06a1be1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79c49cef9301420920c8c673f06a1be1">&#9670;&#160;</a></span>SMIME_BADSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMIME_BADSIGN&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">SEC_BADSIGN</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00111">111</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a9c811504abf735623a6dd3ac20287f30" name="a9c811504abf735623a6dd3ac20287f30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c811504abf735623a6dd3ac20287f30">&#9670;&#160;</a></span>SMIME_OPAQUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMIME_OPAQUE&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a> | <a class="el" href="ncrypt_2lib_8h.html#a6522a5e7af7f8624b8a3bbc94d8efb1e">SEC_SIGNOPAQUE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00112">112</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="ad980bff69bb614893ad8e7e1c28a5023" name="ad980bff69bb614893ad8e7e1c28a5023"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad980bff69bb614893ad8e7e1c28a5023">&#9670;&#160;</a></span>WithCrypto</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WithCrypto&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a> | <a class="el" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00122">122</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a827146354c736ec416508944692e52b2" name="a827146354c736ec416508944692e52b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a827146354c736ec416508944692e52b2">&#9670;&#160;</a></span>KEYFLAG_NO_FLAGS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_NO_FLAGS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>No flags are set. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00132">132</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="aee8e2da44282ca27f6a786cef781334f" name="aee8e2da44282ca27f6a786cef781334f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee8e2da44282ca27f6a786cef781334f">&#9670;&#160;</a></span>KEYFLAG_CANSIGN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_CANSIGN&#160;&#160;&#160;(1 &lt;&lt; 0)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is suitable for signing. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00133">133</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a7254adf21a76d4ceea08bd931df4310f" name="a7254adf21a76d4ceea08bd931df4310f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7254adf21a76d4ceea08bd931df4310f">&#9670;&#160;</a></span>KEYFLAG_CANENCRYPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_CANENCRYPT&#160;&#160;&#160;(1 &lt;&lt; 1)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is suitable for encryption. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00134">134</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a52372a26134009ebc0f946abc8a6075c" name="a52372a26134009ebc0f946abc8a6075c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52372a26134009ebc0f946abc8a6075c">&#9670;&#160;</a></span>KEYFLAG_ISX509</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_ISX509&#160;&#160;&#160;(1 &lt;&lt; 2)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is an X.509 key. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00135">135</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="aacc955f91dd3fdc8b82246c140f023fa" name="aacc955f91dd3fdc8b82246c140f023fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc955f91dd3fdc8b82246c140f023fa">&#9670;&#160;</a></span>KEYFLAG_SECRET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_SECRET&#160;&#160;&#160;(1 &lt;&lt; 7)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is a secret key. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00136">136</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a20472f13517d60d40aa75287afc81c5d" name="a20472f13517d60d40aa75287afc81c5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20472f13517d60d40aa75287afc81c5d">&#9670;&#160;</a></span>KEYFLAG_EXPIRED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_EXPIRED&#160;&#160;&#160;(1 &lt;&lt; 8)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is expired. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00137">137</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="acb95b48318487d9eb8f9709e933d749e" name="acb95b48318487d9eb8f9709e933d749e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb95b48318487d9eb8f9709e933d749e">&#9670;&#160;</a></span>KEYFLAG_REVOKED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_REVOKED&#160;&#160;&#160;(1 &lt;&lt; 9)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is revoked. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00138">138</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a989f3449b764c6a8f5f5e0481569884a" name="a989f3449b764c6a8f5f5e0481569884a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a989f3449b764c6a8f5f5e0481569884a">&#9670;&#160;</a></span>KEYFLAG_DISABLED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_DISABLED&#160;&#160;&#160;(1 &lt;&lt; 10)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is marked disabled. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00139">139</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a73a1ead56127b7fac407296e153c0967" name="a73a1ead56127b7fac407296e153c0967"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73a1ead56127b7fac407296e153c0967">&#9670;&#160;</a></span>KEYFLAG_SUBKEY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_SUBKEY&#160;&#160;&#160;(1 &lt;&lt; 11)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is a subkey. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00140">140</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a8ffaa1a95f918db325d8d770f76a7f79" name="a8ffaa1a95f918db325d8d770f76a7f79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ffaa1a95f918db325d8d770f76a7f79">&#9670;&#160;</a></span>KEYFLAG_CRITICAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_CRITICAL&#160;&#160;&#160;(1 &lt;&lt; 12)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key is marked critical. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00141">141</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="ae4067c9bae1c276c505b42265b70529e" name="ae4067c9bae1c276c505b42265b70529e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4067c9bae1c276c505b42265b70529e">&#9670;&#160;</a></span>KEYFLAG_PREFER_ENCRYPTION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_PREFER_ENCRYPTION&#160;&#160;&#160;(1 &lt;&lt; 13)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key's owner prefers encryption. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00142">142</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a88a54f7be16fc36441fafe14ee14ac0b" name="a88a54f7be16fc36441fafe14ee14ac0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88a54f7be16fc36441fafe14ee14ac0b">&#9670;&#160;</a></span>KEYFLAG_PREFER_SIGNING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_PREFER_SIGNING&#160;&#160;&#160;(1 &lt;&lt; 14)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Key's owner prefers signing. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00143">143</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a74b325469393092ed6d402f1ba78d7ba" name="a74b325469393092ed6d402f1ba78d7ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74b325469393092ed6d402f1ba78d7ba">&#9670;&#160;</a></span>KEYFLAG_CANTUSE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_CANTUSE&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a989f3449b764c6a8f5f5e0481569884a">KEYFLAG_DISABLED</a> | <a class="el" href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">KEYFLAG_REVOKED</a> | <a class="el" href="ncrypt_2lib_8h.html#a20472f13517d60d40aa75287afc81c5d">KEYFLAG_EXPIRED</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00145">145</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a5b5753c8babedca24c31e8d2dbad8130" name="a5b5753c8babedca24c31e8d2dbad8130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b5753c8babedca24c31e8d2dbad8130">&#9670;&#160;</a></span>KEYFLAG_RESTRICTIONS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_RESTRICTIONS&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#a74b325469393092ed6d402f1ba78d7ba">KEYFLAG_CANTUSE</a> | <a class="el" href="ncrypt_2lib_8h.html#a8ffaa1a95f918db325d8d770f76a7f79">KEYFLAG_CRITICAL</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00146">146</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a71ddb5e69f239d16bdf6a6cc266072e4" name="a71ddb5e69f239d16bdf6a6cc266072e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71ddb5e69f239d16bdf6a6cc266072e4">&#9670;&#160;</a></span>KEYFLAG_ABILITIES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KEYFLAG_ABILITIES&#160;&#160;&#160;(<a class="el" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f">KEYFLAG_CANSIGN</a> | <a class="el" href="ncrypt_2lib_8h.html#a7254adf21a76d4ceea08bd931df4310f">KEYFLAG_CANENCRYPT</a> | <a class="el" href="ncrypt_2lib_8h.html#ae4067c9bae1c276c505b42265b70529e">KEYFLAG_PREFER_ENCRYPTION</a> | <a class="el" href="ncrypt_2lib_8h.html#a88a54f7be16fc36441fafe14ee14ac0b">KEYFLAG_PREFER_SIGNING</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00148">148</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a2073a168ca3a64c3c30d13fa4917a05d" name="a2073a168ca3a64c3c30d13fa4917a05d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2073a168ca3a64c3c30d13fa4917a05d">&#9670;&#160;</a></span>SecurityFlags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint16_t <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flags, e.g. <a class="el" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a" title="Email is encrypted.">SEC_ENCRYPT</a>. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00082">82</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<a id="a530487c28aacc2c2d50f12eefb8c5506" name="a530487c28aacc2c2d50f12eefb8c5506"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a530487c28aacc2c2d50f12eefb8c5506">&#9670;&#160;</a></span>KeyFlags</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint16_t <a class="el" href="ncrypt_2lib_8h.html#a530487c28aacc2c2d50f12eefb8c5506">KeyFlags</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flags describing PGP/SMIME keys, e.g. <a class="el" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f" title="Key is suitable for signing.">KEYFLAG_CANSIGN</a>. </p>

<p class="definition">Definition at line <a class="el" href="ncrypt_2lib_8h_source.html#l00131">131</a> of file <a class="el" href="ncrypt_2lib_8h_source.html">lib.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a776fef61b47569d4c698411d5e733a0f" name="a776fef61b47569d4c698411d5e733a0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a776fef61b47569d4c698411d5e733a0f">&#9670;&#160;</a></span>crypt_extract_keys_from_messages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_extract_keys_from_messages </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structMailbox.html">Mailbox</a> *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct EmailArray *&#160;</td>
          <td class="paramname"><em>ea</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract keys from a message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td><a class="el" href="structMailbox.html" title="A mailbox.">Mailbox</a> </td></tr>
    <tr><td class="paramname">ea</td><td>Array of Emails to process</td></tr>
  </table>
  </dd>
</dl>
<p>The extracted keys will be added to the user's keyring. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00859">859</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  860</span>{</div>
<div class="line"><span class="lineno">  861</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno">  862</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBuffer.html">Buffer</a> *tempfile = <a class="code hl_function" href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a>();</div>
<div class="line"><span class="lineno">  865</span>  <a class="code hl_define" href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a>(tempfile);</div>
<div class="line"><span class="lineno">  866</span>  FILE *fp_out = <a class="code hl_define" href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">  867</span>  <span class="keywordflow">if</span> (!fp_out)</div>
<div class="line"><span class="lineno">  868</span>  {</div>
<div class="line"><span class="lineno">  869</span>    <a class="code hl_define" href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a>(<span class="stringliteral">&quot;%s&quot;</span>, <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  870</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno">  871</span>  }</div>
<div class="line"><span class="lineno">  872</span> </div>
<div class="line"><span class="lineno">  873</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div>
<div class="line"><span class="lineno">  874</span>    <a class="code hl_variable" href="globals_8c.html#a06fbffcecad5ed6656ea2948927b26b8">OptDontHandlePgpKeys</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structEmail.html">Email</a> **ep = NULL;</div>
<div class="line"><span class="lineno">  877</span>  <a class="code hl_define" href="array_8h.html#a6b8ea5fb2f366d7716f5042b347093a6">ARRAY_FOREACH</a>(ep, ea)</div>
<div class="line"><span class="lineno">  878</span>  {</div>
<div class="line"><span class="lineno">  879</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structEmail.html">Email</a> *e = *ep;</div>
<div class="line"><span class="lineno">  880</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structMessage.html">Message</a> *msg = <a class="code hl_function" href="mx_8c.html#a9b2902ecb2bebbd553a8ec733ca59886">mx_msg_open</a>(m, e);</div>
<div class="line"><span class="lineno">  881</span>    <span class="keywordflow">if</span> (!msg)</div>
<div class="line"><span class="lineno">  882</span>    {</div>
<div class="line"><span class="lineno">  883</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  884</span>    }</div>
<div class="line"><span class="lineno">  885</span>    <a class="code hl_function" href="attach_2commands_8c.html#a521686f973cf66e6c60be12cc9659ac3">mutt_parse_mime_message</a>(e, msg-&gt;<a class="code hl_variable" href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">fp</a>);</div>
<div class="line"><span class="lineno">  886</span>    <span class="keywordflow">if</span> (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> &amp;&amp; !<a class="code hl_function" href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a>(e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a>))</div>
<div class="line"><span class="lineno">  887</span>    {</div>
<div class="line"><span class="lineno">  888</span>      <a class="code hl_function" href="mx_8c.html#a2610a2afe8887bb874131a4ba092aa6a">mx_msg_close</a>(m, &amp;msg);</div>
<div class="line"><span class="lineno">  889</span>      <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_out);</div>
<div class="line"><span class="lineno">  890</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  891</span>    }</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  894</span>    {</div>
<div class="line"><span class="lineno">  895</span>      <a class="code hl_function" href="copy_8c.html#a72172841415fb14e143da3c102be0364">mutt_copy_message</a>(fp_out, e, msg, <a class="code hl_define" href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a> | <a class="code hl_define" href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a>, <a class="code hl_define" href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a>, 0);</div>
<div class="line"><span class="lineno">  896</span>      fflush(fp_out);</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>      <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  899</span>      puts(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Trying to extract PGP keys...\n&quot;</span>));</div>
<div class="line"><span class="lineno">  900</span>      <a class="code hl_function" href="cryptglue_8c.html#a842ab48184b60e3b7b206536b7b78a61">crypt_pgp_invoke_import</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  901</span>    }</div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno">  904</span>    {</div>
<div class="line"><span class="lineno">  905</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> encrypt = e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  906</span>      <a class="code hl_function" href="copy_8c.html#a72172841415fb14e143da3c102be0364">mutt_copy_message</a>(fp_out, e, msg,</div>
<div class="line"><span class="lineno">  907</span>                        encrypt ? <a class="code hl_define" href="copy_8h.html#ad0d836342af33c74966ba719fd33c475">MUTT_CM_NOHEADER</a> | <a class="code hl_define" href="copy_8h.html#acb95a965dc299a0cd0b13bf4ade6fb26">MUTT_CM_DECODE_CRYPT</a> | <a class="code hl_define" href="copy_8h.html#a68c59ce93ab61f8d664fc94e60f61f3c">MUTT_CM_DECODE_SMIME</a> :</div>
<div class="line"><span class="lineno">  908</span>                                  <a class="code hl_define" href="copy_8h.html#ac778c083de78e4fb27889f345f242d13">MUTT_CM_NO_FLAGS</a>,</div>
<div class="line"><span class="lineno">  909</span>                        <a class="code hl_define" href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a>, 0);</div>
<div class="line"><span class="lineno">  910</span>      fflush(fp_out);</div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *mbox = NULL;</div>
<div class="line"><span class="lineno">  913</span>      <span class="keywordflow">if</span> (!<a class="code hl_define" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>))</div>
<div class="line"><span class="lineno">  914</span>      {</div>
<div class="line"><span class="lineno">  915</span>        <a class="code hl_function" href="alias_8c.html#a7c57d5376e9a1cf5e1f504a452996b86">mutt_expand_aliases</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div>
<div class="line"><span class="lineno">  916</span>        mbox = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(<a class="code hl_define" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>)-&gt;mailbox);</div>
<div class="line"><span class="lineno">  917</span>      }</div>
<div class="line"><span class="lineno">  918</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>))</div>
<div class="line"><span class="lineno">  919</span>      {</div>
<div class="line"><span class="lineno">  920</span>        <a class="code hl_function" href="alias_8c.html#a7c57d5376e9a1cf5e1f504a452996b86">mutt_expand_aliases</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>);</div>
<div class="line"><span class="lineno">  921</span>        mbox = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(<a class="code hl_define" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>)-&gt;mailbox);</div>
<div class="line"><span class="lineno">  922</span>      }</div>
<div class="line"><span class="lineno">  923</span>      <span class="keywordflow">if</span> (mbox)</div>
<div class="line"><span class="lineno">  924</span>      {</div>
<div class="line"><span class="lineno">  925</span>        <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  926</span>        puts(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Trying to extract S/MIME certificates...&quot;</span>));</div>
<div class="line"><span class="lineno">  927</span>        <a class="code hl_function" href="cryptglue_8c.html#a9a62b3e7470b9f9e899a63ebae53b4da">crypt_smime_invoke_import</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile), mbox);</div>
<div class="line"><span class="lineno">  928</span>      }</div>
<div class="line"><span class="lineno">  929</span>    }</div>
<div class="line"><span class="lineno">  930</span>    <a class="code hl_function" href="mx_8c.html#a2610a2afe8887bb874131a4ba092aa6a">mx_msg_close</a>(m, &amp;msg);</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>    rewind(fp_out);</div>
<div class="line"><span class="lineno">  933</span>  }</div>
<div class="line"><span class="lineno">  934</span> </div>
<div class="line"><span class="lineno">  935</span>  <a class="code hl_define" href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a>(&amp;fp_out);</div>
<div class="line"><span class="lineno">  936</span>  <span class="keywordflow">if</span> (isendwin())</div>
<div class="line"><span class="lineno">  937</span>    <a class="code hl_function" href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a>(NULL);</div>
<div class="line"><span class="lineno">  938</span> </div>
<div class="line"><span class="lineno">  939</span>  <a class="code hl_function" href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a>(<a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(tempfile));</div>
<div class="line"><span class="lineno">  940</span> </div>
<div class="line"><span class="lineno">  941</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div>
<div class="line"><span class="lineno">  942</span>    <a class="code hl_variable" href="globals_8c.html#a06fbffcecad5ed6656ea2948927b26b8">OptDontHandlePgpKeys</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>cleanup:</div>
<div class="line"><span class="lineno">  945</span>  <a class="code hl_function" href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a>(&amp;tempfile);</div>
<div class="line"><span class="lineno">  946</span>}</div>
<div class="ttc" id="aalias_8c_html_a7c57d5376e9a1cf5e1f504a452996b86"><div class="ttname"><a href="alias_8c.html#a7c57d5376e9a1cf5e1f504a452996b86">mutt_expand_aliases</a></div><div class="ttdeci">void mutt_expand_aliases(struct AddressList *al)</div><div class="ttdoc">Expand aliases in a List of Addresses.</div><div class="ttdef"><b>Definition:</b> <a href="alias_8c_source.html#l00295">alias.c:295</a></div></div>
<div class="ttc" id="aarray_8h_html_a6b8ea5fb2f366d7716f5042b347093a6"><div class="ttname"><a href="array_8h.html#a6b8ea5fb2f366d7716f5042b347093a6">ARRAY_FOREACH</a></div><div class="ttdeci">#define ARRAY_FOREACH(elem, head)</div><div class="ttdoc">Iterate over all elements of the array.</div><div class="ttdef"><b>Definition:</b> <a href="array_8h_source.html#l00214">array.h:214</a></div></div>
<div class="ttc" id="aattach_2commands_8c_html_a521686f973cf66e6c60be12cc9659ac3"><div class="ttname"><a href="attach_2commands_8c.html#a521686f973cf66e6c60be12cc9659ac3">mutt_parse_mime_message</a></div><div class="ttdeci">void mutt_parse_mime_message(struct Email *e, FILE *fp)</div><div class="ttdoc">Parse a MIME email.</div><div class="ttdef"><b>Definition:</b> <a href="attach_2commands_8c_source.html#l00596">commands.c:596</a></div></div>
<div class="ttc" id="abuffer_8h_html_a728ebc5a947b77c8d56db44ce553a7ab"><div class="ttname"><a href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a></div><div class="ttdeci">static const char * buf_string(const struct Buffer *buf)</div><div class="ttdoc">Convert a buffer to a const char * &quot;string&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00096">buffer.h:96</a></div></div>
<div class="ttc" id="acopy_8c_html_a72172841415fb14e143da3c102be0364"><div class="ttname"><a href="copy_8c.html#a72172841415fb14e143da3c102be0364">mutt_copy_message</a></div><div class="ttdeci">int mutt_copy_message(FILE *fp_out, struct Email *e, struct Message *msg, CopyMessageFlags cmflags, CopyHeaderFlags chflags, int wraplen)</div><div class="ttdoc">Copy a message from a Mailbox.</div><div class="ttdef"><b>Definition:</b> <a href="copy_8c_source.html#l00908">copy.c:908</a></div></div>
<div class="ttc" id="acopy_8h_html_a4898a6c2c88fdba8ce7decdb6c125a96"><div class="ttname"><a href="copy_8h.html#a4898a6c2c88fdba8ce7decdb6c125a96">MUTT_CM_DECODE</a></div><div class="ttdeci">#define MUTT_CM_DECODE</div><div class="ttdoc">Decode the message body into text/plain.</div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00040">copy.h:40</a></div></div>
<div class="ttc" id="acopy_8h_html_a648ee091378fa6c0f6f129f64fc7f22b"><div class="ttname"><a href="copy_8h.html#a648ee091378fa6c0f6f129f64fc7f22b">MUTT_CM_CHARCONV</a></div><div class="ttdeci">#define MUTT_CM_CHARCONV</div><div class="ttdoc">Perform character set conversions.</div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00044">copy.h:44</a></div></div>
<div class="ttc" id="acopy_8h_html_a68c59ce93ab61f8d664fc94e60f61f3c"><div class="ttname"><a href="copy_8h.html#a68c59ce93ab61f8d664fc94e60f61f3c">MUTT_CM_DECODE_SMIME</a></div><div class="ttdeci">#define MUTT_CM_DECODE_SMIME</div><div class="ttdoc">Used for decoding S/MIME messages.</div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00048">copy.h:48</a></div></div>
<div class="ttc" id="acopy_8h_html_ac778c083de78e4fb27889f345f242d13"><div class="ttname"><a href="copy_8h.html#ac778c083de78e4fb27889f345f242d13">MUTT_CM_NO_FLAGS</a></div><div class="ttdeci">#define MUTT_CM_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00037">copy.h:37</a></div></div>
<div class="ttc" id="acopy_8h_html_acb95a965dc299a0cd0b13bf4ade6fb26"><div class="ttname"><a href="copy_8h.html#acb95a965dc299a0cd0b13bf4ade6fb26">MUTT_CM_DECODE_CRYPT</a></div><div class="ttdeci">#define MUTT_CM_DECODE_CRYPT</div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00050">copy.h:50</a></div></div>
<div class="ttc" id="acopy_8h_html_ad0d836342af33c74966ba719fd33c475"><div class="ttname"><a href="copy_8h.html#ad0d836342af33c74966ba719fd33c475">MUTT_CM_NOHEADER</a></div><div class="ttdeci">#define MUTT_CM_NOHEADER</div><div class="ttdoc">Don't copy the message header.</div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00038">copy.h:38</a></div></div>
<div class="ttc" id="acopy_8h_html_af310a44d7c96b22de90934cb18634b58"><div class="ttname"><a href="copy_8h.html#af310a44d7c96b22de90934cb18634b58">CH_NO_FLAGS</a></div><div class="ttdeci">#define CH_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition:</b> <a href="copy_8h_source.html#l00053">copy.h:53</a></div></div>
<div class="ttc" id="acrypt_8c_html_a4ee7f1419a7e39b0e9f1f9d550f4de43"><div class="ttname"><a href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a></div><div class="ttdeci">bool crypt_valid_passphrase(SecurityFlags flags)</div><div class="ttdoc">Check that we have a usable passphrase, ask if not.</div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00132">crypt.c:132</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a842ab48184b60e3b7b206536b7b78a61"><div class="ttname"><a href="cryptglue_8c.html#a842ab48184b60e3b7b206536b7b78a61">crypt_pgp_invoke_import</a></div><div class="ttdeci">void crypt_pgp_invoke_import(const char *fname)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_invoke_import()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00363">cryptglue.c:363</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a9a62b3e7470b9f9e899a63ebae53b4da"><div class="ttname"><a href="cryptglue_8c.html#a9a62b3e7470b9f9e899a63ebae53b4da">crypt_smime_invoke_import</a></div><div class="ttdeci">void crypt_smime_invoke_import(const char *infile, const char *mailbox)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::smime_invoke_import()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00507">cryptglue.c:507</a></div></div>
<div class="ttc" id="acurs__lib_8c_html_ab6a61cdfcf8c2c73ee59381c79c79774"><div class="ttname"><a href="curs__lib_8c.html#ab6a61cdfcf8c2c73ee59381c79c79774">mutt_any_key_to_continue</a></div><div class="ttdeci">int mutt_any_key_to_continue(const char *s)</div><div class="ttdoc">Prompt the user to 'press any key' and wait.</div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00174">curs_lib.c:174</a></div></div>
<div class="ttc" id="acurs__lib_8c_html_acd14d074d8b9e6cb21e851dd573cdec2"><div class="ttname"><a href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a></div><div class="ttdeci">void mutt_endwin(void)</div><div class="ttdoc">Shutdown curses.</div><div class="ttdef"><b>Definition:</b> <a href="curs__lib_8c_source.html#l00152">curs_lib.c:152</a></div></div>
<div class="ttc" id="afile_8c_html_ae57463c2854c006a3c67b78736e9056e"><div class="ttname"><a href="file_8c.html#ae57463c2854c006a3c67b78736e9056e">mutt_file_unlink</a></div><div class="ttdeci">void mutt_file_unlink(const char *s)</div><div class="ttdoc">Delete a file, carefully.</div><div class="ttdef"><b>Definition:</b> <a href="file_8c_source.html#l00159">file.c:159</a></div></div>
<div class="ttc" id="afile_8h_html_a9b519e795f098be88b93cd72c49a35ec"><div class="ttname"><a href="file_8h.html#a9b519e795f098be88b93cd72c49a35ec">mutt_file_fclose</a></div><div class="ttdeci">#define mutt_file_fclose(FP)</div><div class="ttdef"><b>Definition:</b> <a href="file_8h_source.html#l00139">file.h:139</a></div></div>
<div class="ttc" id="afile_8h_html_a9fa358d76519cb6bc8ffca5850976d46"><div class="ttname"><a href="file_8h.html#a9fa358d76519cb6bc8ffca5850976d46">mutt_file_fopen</a></div><div class="ttdeci">#define mutt_file_fopen(PATH, MODE)</div><div class="ttdef"><b>Definition:</b> <a href="file_8h_source.html#l00138">file.h:138</a></div></div>
<div class="ttc" id="aglobals_8c_html_a06fbffcecad5ed6656ea2948927b26b8"><div class="ttname"><a href="globals_8c.html#a06fbffcecad5ed6656ea2948927b26b8">OptDontHandlePgpKeys</a></div><div class="ttdeci">bool OptDontHandlePgpKeys</div><div class="ttdoc">(pseudo) used to extract PGP keys</div><div class="ttdef"><b>Definition:</b> <a href="globals_8c_source.html#l00057">globals.c:57</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gafaa521ab22db877ccf1b87e679e1b43e"><div class="ttname"><a href="group__logging__api.html#gafaa521ab22db877ccf1b87e679e1b43e">mutt_perror</a></div><div class="ttdeci">#define mutt_perror(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging2_8h_source.html#l00094">logging2.h:94</a></div></div>
<div class="ttc" id="amutt_2message_8h_html_a479d658dfd60fe8d9709ec67a58b34ca"><div class="ttname"><a href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a></div><div class="ttdeci">#define _(a)</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2message_8h_source.html#l00028">message.h:28</a></div></div>
<div class="ttc" id="amx_8c_html_a2610a2afe8887bb874131a4ba092aa6a"><div class="ttname"><a href="mx_8c.html#a2610a2afe8887bb874131a4ba092aa6a">mx_msg_close</a></div><div class="ttdeci">int mx_msg_close(struct Mailbox *m, struct Message **ptr)</div><div class="ttdoc">Close a message.</div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l01185">mx.c:1185</a></div></div>
<div class="ttc" id="amx_8c_html_a9b2902ecb2bebbd553a8ec733ca59886"><div class="ttname"><a href="mx_8c.html#a9b2902ecb2bebbd553a8ec733ca59886">mx_msg_open</a></div><div class="ttdeci">struct Message * mx_msg_open(struct Mailbox *m, struct Email *e)</div><div class="ttdoc">Return a stream pointer for a message.</div><div class="ttdef"><b>Definition:</b> <a href="mx_8c_source.html#l01139">mx.c:1139</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a587e679a4c9cc44f11f0c467bb22b0af"><div class="ttname"><a href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a></div><div class="ttdeci">#define APPLICATION_PGP</div><div class="ttdoc">Use PGP to encrypt/sign.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00096">lib.h:96</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a798dfac1e8839ca89375b4ec62b3eff2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a></div><div class="ttdeci">#define APPLICATION_SMIME</div><div class="ttdoc">Use SMIME to encrypt/sign.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00097">lib.h:97</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_aacaa4abd4c0696e260b7a0f1d466360a"><div class="ttname"><a href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a></div><div class="ttdeci">#define SEC_ENCRYPT</div><div class="ttdoc">Email is encrypted.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00084">lib.h:84</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_ad980bff69bb614893ad8e7e1c28a5023"><div class="ttname"><a href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a></div><div class="ttdeci">#define WithCrypto</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00122">lib.h:122</a></div></div>
<div class="ttc" id="apool_8c_html_a41cba27c25d33cb6822789a2856093f2"><div class="ttname"><a href="pool_8c.html#a41cba27c25d33cb6822789a2856093f2">buf_pool_get</a></div><div class="ttdeci">struct Buffer * buf_pool_get(void)</div><div class="ttdoc">Get a Buffer from the pool.</div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00082">pool.c:82</a></div></div>
<div class="ttc" id="apool_8c_html_a4cc6068279461cb8628219586dfa35a1"><div class="ttname"><a href="pool_8c.html#a4cc6068279461cb8628219586dfa35a1">buf_pool_release</a></div><div class="ttdeci">void buf_pool_release(struct Buffer **ptr)</div><div class="ttdoc">Return a Buffer to the pool.</div><div class="ttdef"><b>Definition:</b> <a href="pool_8c_source.html#l00096">pool.c:96</a></div></div>
<div class="ttc" id="aqueue_8h_html_a7d6894360bd1c41e0e6f6d84998c1362"><div class="ttname"><a href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a></div><div class="ttdeci">#define TAILQ_FIRST(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00780">queue.h:780</a></div></div>
<div class="ttc" id="aqueue_8h_html_ac3c9da7ac712eacbbad5cc54d7a3477e"><div class="ttname"><a href="queue_8h.html#ac3c9da7ac712eacbbad5cc54d7a3477e">TAILQ_EMPTY</a></div><div class="ttdeci">#define TAILQ_EMPTY(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00778">queue.h:778</a></div></div>
<div class="ttc" id="astructBuffer_html"><div class="ttname"><a href="structBuffer.html">Buffer</a></div><div class="ttdoc">String manipulation buffer.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8h_source.html#l00035">buffer.h:36</a></div></div>
<div class="ttc" id="astructEmail_html"><div class="ttname"><a href="structEmail.html">Email</a></div><div class="ttdoc">The envelope/body of an email.</div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00038">email.h:39</a></div></div>
<div class="ttc" id="astructEmail_html_a34cc4493729d7a3b1f4ed783e739a9ec"><div class="ttname"><a href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">Email::env</a></div><div class="ttdeci">struct Envelope * env</div><div class="ttdoc">Envelope information.</div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00068">email.h:68</a></div></div>
<div class="ttc" id="astructEmail_html_a570a81cd747437c9ea4357947731ae10"><div class="ttname"><a href="structEmail.html#a570a81cd747437c9ea4357947731ae10">Email::security</a></div><div class="ttdeci">SecurityFlags security</div><div class="ttdoc">bit 0-10: flags, bit 11,12: application, bit 13: traditional pgp See: ncrypt/lib.h pgplib....</div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00043">email.h:43</a></div></div>
<div class="ttc" id="astructEnvelope_html_a72ee5c0af4f94f83aeb8d31183261611"><div class="ttname"><a href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">Envelope::sender</a></div><div class="ttdeci">struct AddressList sender</div><div class="ttdoc">Email's sender.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00063">envelope.h:63</a></div></div>
<div class="ttc" id="astructEnvelope_html_af1aa00aed4b8767cf98f08e45a432ad8"><div class="ttname"><a href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">Envelope::from</a></div><div class="ttdeci">struct AddressList from</div><div class="ttdoc">Email's 'From' list.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00059">envelope.h:59</a></div></div>
<div class="ttc" id="astructMessage_html"><div class="ttname"><a href="structMessage.html">Message</a></div><div class="ttdoc">A local copy of an email.</div><div class="ttdef"><b>Definition:</b> <a href="core_2message_8h_source.html#l00033">message.h:34</a></div></div>
<div class="ttc" id="astructMessage_html_a11d53ee4319e8735c1677d8780a7b517"><div class="ttname"><a href="structMessage.html#a11d53ee4319e8735c1677d8780a7b517">Message::fp</a></div><div class="ttdeci">FILE * fp</div><div class="ttdoc">pointer to the message data</div><div class="ttdef"><b>Definition:</b> <a href="core_2message_8h_source.html#l00035">message.h:35</a></div></div>
<div class="ttc" id="atmp_8h_html_a271a7828888985955df49205d7846a45"><div class="ttname"><a href="tmp_8h.html#a271a7828888985955df49205d7846a45">buf_mktemp</a></div><div class="ttdeci">#define buf_mktemp(buf)</div><div class="ttdef"><b>Definition:</b> <a href="tmp_8h_source.html#l00033">tmp.h:33</a></div></div>
</div><!-- fragment --><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a776fef61b47569d4c698411d5e733a0f_cgraph.svg" width="388" height="694"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a776fef61b47569d4c698411d5e733a0f_icgraph.svg" width="312" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8a09719065d14c27701c998b48883ac4" name="a8a09719065d14c27701c998b48883ac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a09719065d14c27701c998b48883ac4">&#9670;&#160;</a></span>crypt_forget_passphrase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_forget_passphrase </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forget a passphrase and display a message. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00090">90</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   91</span>{</div>
<div class="line"><span class="lineno">   92</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div>
<div class="line"><span class="lineno">   93</span>    <a class="code hl_function" href="cryptglue_8c.html#ab11bb907cc90bcd3aadecfd0000b5350">crypt_pgp_void_passphrase</a>();</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</div>
<div class="line"><span class="lineno">   96</span>    <a class="code hl_function" href="cryptglue_8c.html#a84e2b083debe6ba85cf3deca3e0fe99a">crypt_smime_void_passphrase</a>();</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno">   99</span>  {</div>
<div class="line"><span class="lineno">  100</span>    <span class="comment">/* L10N: Due to the implementation details (e.g. some passwords are managed</span></div>
<div class="line"><span class="lineno">  101</span><span class="comment">       by gpg-agent) we can&#39;t know whether we forgot zero, 1, 12, ...</span></div>
<div class="line"><span class="lineno">  102</span><span class="comment">       passwords. So in English we use &quot;Passphrases&quot;. Your language might</span></div>
<div class="line"><span class="lineno">  103</span><span class="comment">       have other means to express this. */</span></div>
<div class="line"><span class="lineno">  104</span>    <a class="code hl_define" href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Passphrases forgotten&quot;</span>));</div>
<div class="line"><span class="lineno">  105</span>  }</div>
<div class="line"><span class="lineno">  106</span>}</div>
<div class="ttc" id="acryptglue_8c_html_a84e2b083debe6ba85cf3deca3e0fe99a"><div class="ttname"><a href="cryptglue_8c.html#a84e2b083debe6ba85cf3deca3e0fe99a">crypt_smime_void_passphrase</a></div><div class="ttdeci">void crypt_smime_void_passphrase(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::void_passphrase()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00412">cryptglue.c:412</a></div></div>
<div class="ttc" id="acryptglue_8c_html_ab11bb907cc90bcd3aadecfd0000b5350"><div class="ttname"><a href="cryptglue_8c.html#ab11bb907cc90bcd3aadecfd0000b5350">crypt_pgp_void_passphrase</a></div><div class="ttdeci">void crypt_pgp_void_passphrase(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::void_passphrase()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00190">cryptglue.c:190</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gae108f891125caafa9250cf0959c40c04"><div class="ttname"><a href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a></div><div class="ttdeci">#define mutt_message(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging2_8h_source.html#l00092">logging2.h:92</a></div></div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a8a09719065d14c27701c998b48883ac4_cgraph.svg" width="442" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a8a09719065d14c27701c998b48883ac4_icgraph.svg" width="392" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="abb04ccb83d144391034d86704c52b987" name="abb04ccb83d144391034d86704c52b987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb04ccb83d144391034d86704c52b987">&#9670;&#160;</a></span>crypt_get_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_get_keys </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>keylist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>oppenc_mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check we have all the keys we need. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> with addresses to match </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">keylist</td><td>Keys needed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">oppenc_mode</td><td>If true, use opportunistic encryption </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error</td></tr>
  </table>
  </dd>
</dl>
<p>Do a quick check to make sure that we can find all of the encryption keys if the user has requested this service. Return the list of keys in KEYLIST. If oppenc_mode is true, only keys that can be determined without prompting will be used. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00962">962</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  963</span>{</div>
<div class="line"><span class="lineno">  964</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno">  965</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>  <span class="keyword">struct </span>AddressList addrlist = <a class="code hl_define" href="queue_8h.html#ac269df7d4126ed9885156cbad2cbf8af">TAILQ_HEAD_INITIALIZER</a>(addrlist);</div>
<div class="line"><span class="lineno">  968</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *fqdn = <a class="code hl_function" href="sendlib_8c.html#a448ec1abcfc24a2a3d61197ef604877d">mutt_fqdn</a>(<span class="keyword">true</span>, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno">  969</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *self_encrypt = NULL;</div>
<div class="line"><span class="lineno">  970</span> </div>
<div class="line"><span class="lineno">  971</span>  <span class="comment">/* Do a quick check to make sure that we can find all of the encryption</span></div>
<div class="line"><span class="lineno">  972</span><span class="comment">   * keys if the user has requested this service.  */</span></div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>  *keylist = NULL;</div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span><span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div>
<div class="line"><span class="lineno">  977</span>  <span class="keywordflow">if</span> (!oppenc_mode &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>))</div>
<div class="line"><span class="lineno">  978</span>  {</div>
<div class="line"><span class="lineno">  979</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="autocrypt_8c.html#a90f0aa8320453b9acc5cf33bd28fe8d0">mutt_autocrypt_ui_recommendation</a>(e, keylist) &lt;= <a class="code hl_enumvalue" href="autocrypt_2lib_8h.html#aed237ffa27e23d83cb0acc07586ffbdaa5243c176ca12aa8812707f39781ebec3">AUTOCRYPT_REC_NO</a>)</div>
<div class="line"><span class="lineno">  980</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  981</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  982</span>  }</div>
<div class="line"><span class="lineno">  983</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div>
<div class="line"><span class="lineno">  986</span>    <a class="code hl_variable" href="globals_8c.html#a3cf441307286abc7db5e6b8213cfad98">OptPgpCheckTrust</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span>  <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;addrlist, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  989</span>  <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;addrlist, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  990</span>  <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;addrlist, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">bcc</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  991</span>  <a class="code hl_function" href="address_2address_8c.html#a1de5e467c74e205ff465fd601c275b88">mutt_addrlist_qualify</a>(&amp;addrlist, fqdn);</div>
<div class="line"><span class="lineno">  992</span>  <a class="code hl_function" href="address_2address_8c.html#aee5d40d84136d3a7adba727e2908ad66">mutt_addrlist_dedupe</a>(&amp;addrlist);</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>  <span class="keywordflow">if</span> (oppenc_mode || (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>))</div>
<div class="line"><span class="lineno">  995</span>  {</div>
<div class="line"><span class="lineno">  996</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  997</span>    {</div>
<div class="line"><span class="lineno">  998</span>      *keylist = <a class="code hl_function" href="cryptglue_8c.html#a34d285974b12e7f0eae09d7d17e1a13b">crypt_pgp_find_keys</a>(&amp;addrlist, oppenc_mode);</div>
<div class="line"><span class="lineno">  999</span>      <span class="keywordflow">if</span> (!*keylist)</div>
<div class="line"><span class="lineno"> 1000</span>      {</div>
<div class="line"><span class="lineno"> 1001</span>        <a class="code hl_function" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;addrlist);</div>
<div class="line"><span class="lineno"> 1002</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1003</span>      }</div>
<div class="line"><span class="lineno"> 1004</span>      <a class="code hl_variable" href="globals_8c.html#a3cf441307286abc7db5e6b8213cfad98">OptPgpCheckTrust</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1005</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_self_encrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_self_encrypt&quot;</span>);</div>
<div class="line"><span class="lineno"> 1006</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_pgp_default_key = <a class="code hl_function" href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_default_key&quot;</span>);</div>
<div class="line"><span class="lineno"> 1007</span>      <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code hl_enumeration" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_pgp_encrypt_self = <a class="code hl_function" href="config_2helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_encrypt_self&quot;</span>);</div>
<div class="line"><span class="lineno"> 1008</span>      <span class="keywordflow">if</span> (c_pgp_self_encrypt || (c_pgp_encrypt_self == <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>))</div>
<div class="line"><span class="lineno"> 1009</span>        self_encrypt = c_pgp_default_key;</div>
<div class="line"><span class="lineno"> 1010</span>    }</div>
<div class="line"><span class="lineno"> 1011</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno"> 1012</span>    {</div>
<div class="line"><span class="lineno"> 1013</span>      *keylist = <a class="code hl_function" href="cryptglue_8c.html#a143eed9672ff73b918294d07abfb8563">crypt_smime_find_keys</a>(&amp;addrlist, oppenc_mode);</div>
<div class="line"><span class="lineno"> 1014</span>      <span class="keywordflow">if</span> (!*keylist)</div>
<div class="line"><span class="lineno"> 1015</span>      {</div>
<div class="line"><span class="lineno"> 1016</span>        <a class="code hl_function" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;addrlist);</div>
<div class="line"><span class="lineno"> 1017</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno"> 1018</span>      }</div>
<div class="line"><span class="lineno"> 1019</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> c_smime_self_encrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;smime_self_encrypt&quot;</span>);</div>
<div class="line"><span class="lineno"> 1020</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_smime_default_key = <a class="code hl_function" href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;smime_default_key&quot;</span>);</div>
<div class="line"><span class="lineno"> 1021</span>      <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code hl_enumeration" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a> c_smime_encrypt_self = <a class="code hl_function" href="config_2helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;smime_encrypt_self&quot;</span>);</div>
<div class="line"><span class="lineno"> 1022</span>      <span class="keywordflow">if</span> (c_smime_self_encrypt || (c_smime_encrypt_self == <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>))</div>
<div class="line"><span class="lineno"> 1023</span>        self_encrypt = c_smime_default_key;</div>
<div class="line"><span class="lineno"> 1024</span>    }</div>
<div class="line"><span class="lineno"> 1025</span>  }</div>
<div class="line"><span class="lineno"> 1026</span> </div>
<div class="line"><span class="lineno"> 1027</span>  <span class="keywordflow">if</span> (!oppenc_mode &amp;&amp; self_encrypt)</div>
<div class="line"><span class="lineno"> 1028</span>  {</div>
<div class="line"><span class="lineno"> 1029</span>    <span class="keyword">const</span> <span class="keywordtype">size_t</span> keylist_size = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(*keylist);</div>
<div class="line"><span class="lineno"> 1030</span>    <a class="code hl_define" href="memory_8h.html#abd7aad5fe8f11bcd476c64b4243081ba">MUTT_MEM_REALLOC</a>(keylist, keylist_size + <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(self_encrypt) + 2, <span class="keywordtype">char</span>);</div>
<div class="line"><span class="lineno"> 1031</span>    sprintf(*keylist + keylist_size, <span class="stringliteral">&quot; %s&quot;</span>, self_encrypt);</div>
<div class="line"><span class="lineno"> 1032</span>  }</div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span>  <a class="code hl_function" href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a>(&amp;addrlist);</div>
<div class="line"><span class="lineno"> 1035</span> </div>
<div class="line"><span class="lineno"> 1036</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1037</span>}</div>
<div class="ttc" id="aaddress_2address_8c_html_a16764dc80c9b3f6ad2897c8b7e59bd10"><div class="ttname"><a href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a></div><div class="ttdeci">void mutt_addrlist_copy(struct AddressList *dst, const struct AddressList *src, bool prune)</div><div class="ttdoc">Copy a list of addresses into another list.</div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00765">address.c:765</a></div></div>
<div class="ttc" id="aaddress_2address_8c_html_a1de5e467c74e205ff465fd601c275b88"><div class="ttname"><a href="address_2address_8c.html#a1de5e467c74e205ff465fd601c275b88">mutt_addrlist_qualify</a></div><div class="ttdeci">void mutt_addrlist_qualify(struct AddressList *al, const char *host)</div><div class="ttdoc">Expand local names in an Address list using a hostname.</div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00680">address.c:680</a></div></div>
<div class="ttc" id="aaddress_2address_8c_html_a396bcf6adfff6663096fa6ae99c31c9a"><div class="ttname"><a href="address_2address_8c.html#a396bcf6adfff6663096fa6ae99c31c9a">mutt_addrlist_clear</a></div><div class="ttdeci">void mutt_addrlist_clear(struct AddressList *al)</div><div class="ttdoc">Unlink and free all Address in an AddressList.</div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01460">address.c:1460</a></div></div>
<div class="ttc" id="aaddress_2address_8c_html_aee5d40d84136d3a7adba727e2908ad66"><div class="ttname"><a href="address_2address_8c.html#aee5d40d84136d3a7adba727e2908ad66">mutt_addrlist_dedupe</a></div><div class="ttdeci">void mutt_addrlist_dedupe(struct AddressList *al)</div><div class="ttdoc">Remove duplicate addresses.</div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l01397">address.c:1397</a></div></div>
<div class="ttc" id="aautocrypt_2lib_8h_html_aed237ffa27e23d83cb0acc07586ffbdaa5243c176ca12aa8812707f39781ebec3"><div class="ttname"><a href="autocrypt_2lib_8h.html#aed237ffa27e23d83cb0acc07586ffbdaa5243c176ca12aa8812707f39781ebec3">AUTOCRYPT_REC_NO</a></div><div class="ttdeci">@ AUTOCRYPT_REC_NO</div><div class="ttdoc">Do no use Autocrypt.</div><div class="ttdef"><b>Definition:</b> <a href="autocrypt_2lib_8h_source.html#l00164">lib.h:164</a></div></div>
<div class="ttc" id="aautocrypt_8c_html_a90f0aa8320453b9acc5cf33bd28fe8d0"><div class="ttname"><a href="autocrypt_8c.html#a90f0aa8320453b9acc5cf33bd28fe8d0">mutt_autocrypt_ui_recommendation</a></div><div class="ttdeci">enum AutocryptRec mutt_autocrypt_ui_recommendation(const struct Email *e, char **keylist)</div><div class="ttdoc">Get the recommended action for an Email.</div><div class="ttdef"><b>Definition:</b> <a href="autocrypt_8c_source.html#l00558">autocrypt.c:558</a></div></div>
<div class="ttc" id="aconfig_2helpers_8c_html_a6b1589ee93ff51ef31f1d9324e138078"><div class="ttname"><a href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a></div><div class="ttdeci">const char * cs_subset_string(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a string config item by name.</div><div class="ttdef"><b>Definition:</b> <a href="config_2helpers_8c_source.html#l00291">helpers.c:291</a></div></div>
<div class="ttc" id="aconfig_2helpers_8c_html_a9154ba713ce99b0937f475eec7c61af9"><div class="ttname"><a href="config_2helpers_8c.html#a9154ba713ce99b0937f475eec7c61af9">cs_subset_quad</a></div><div class="ttdeci">enum QuadOption cs_subset_quad(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a quad-value config item by name.</div><div class="ttdef"><b>Definition:</b> <a href="config_2helpers_8c_source.html#l00192">helpers.c:192</a></div></div>
<div class="ttc" id="aconfig_2helpers_8c_html_ae50f679dd6c5bd1ba820884c8602f038"><div class="ttname"><a href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a></div><div class="ttdeci">bool cs_subset_bool(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get a boolean config item by name.</div><div class="ttdef"><b>Definition:</b> <a href="config_2helpers_8c_source.html#l00047">helpers.c:47</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a143eed9672ff73b918294d07abfb8563"><div class="ttname"><a href="cryptglue_8c.html#a143eed9672ff73b918294d07abfb8563">crypt_smime_find_keys</a></div><div class="ttdeci">char * crypt_smime_find_keys(struct AddressList *addrlist, bool oppenc_mode)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::find_keys()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00474">cryptglue.c:474</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a34d285974b12e7f0eae09d7d17e1a13b"><div class="ttname"><a href="cryptglue_8c.html#a34d285974b12e7f0eae09d7d17e1a13b">crypt_pgp_find_keys</a></div><div class="ttdeci">char * crypt_pgp_find_keys(struct AddressList *addrlist, bool oppenc_mode)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::find_keys()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00315">cryptglue.c:315</a></div></div>
<div class="ttc" id="aglobals_8c_html_a3cf441307286abc7db5e6b8213cfad98"><div class="ttname"><a href="globals_8c.html#a3cf441307286abc7db5e6b8213cfad98">OptPgpCheckTrust</a></div><div class="ttdeci">bool OptPgpCheckTrust</div><div class="ttdoc">(pseudo) used by dlg_pgp()</div><div class="ttdef"><b>Definition:</b> <a href="globals_8c_source.html#l00066">globals.c:66</a></div></div>
<div class="ttc" id="amemory_8h_html_abd7aad5fe8f11bcd476c64b4243081ba"><div class="ttname"><a href="memory_8h.html#abd7aad5fe8f11bcd476c64b4243081ba">MUTT_MEM_REALLOC</a></div><div class="ttdeci">#define MUTT_MEM_REALLOC(pptr, n, type)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00050">memory.h:50</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_acca6786b903b22a5924219f9db96e10d"><div class="ttname"><a href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a></div><div class="ttdeci">size_t mutt_str_len(const char *a)</div><div class="ttdoc">Calculate the length of a string, safely.</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00498">string.c:498</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a0b36be5c32ca90d8f2caef9ea9d627fc"><div class="ttname"><a href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a></div><div class="ttdeci">#define SEC_AUTOCRYPT</div><div class="ttdoc">(Autocrypt) Message will be, or was Autocrypt encrypt+signed</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00093">lib.h:93</a></div></div>
<div class="ttc" id="aquad_8h_html_a738f558a271fe5035e0ee3b700ee35db"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35db">QuadOption</a></div><div class="ttdeci">QuadOption</div><div class="ttdoc">Possible values for a quad-option.</div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00035">quad.h:36</a></div></div>
<div class="ttc" id="aquad_8h_html_a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7"><div class="ttname"><a href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a></div><div class="ttdeci">@ MUTT_YES</div><div class="ttdoc">User answered 'Yes', or assume 'Yes'.</div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00039">quad.h:39</a></div></div>
<div class="ttc" id="aqueue_8h_html_ac269df7d4126ed9885156cbad2cbf8af"><div class="ttname"><a href="queue_8h.html#ac269df7d4126ed9885156cbad2cbf8af">TAILQ_HEAD_INITIALIZER</a></div><div class="ttdeci">#define TAILQ_HEAD_INITIALIZER(head)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00694">queue.h:694</a></div></div>
<div class="ttc" id="asendlib_8c_html_a448ec1abcfc24a2a3d61197ef604877d"><div class="ttname"><a href="sendlib_8c.html#a448ec1abcfc24a2a3d61197ef604877d">mutt_fqdn</a></div><div class="ttdeci">const char * mutt_fqdn(bool may_hide_host, const struct ConfigSubset *sub)</div><div class="ttdoc">Get the Fully-Qualified Domain Name.</div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00706">sendlib.c:706</a></div></div>
<div class="ttc" id="astructEnvelope_html_a2d927371b3b80e025d6f7522b7361fe7"><div class="ttname"><a href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">Envelope::to</a></div><div class="ttdeci">struct AddressList to</div><div class="ttdoc">Email's 'To' list.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00060">envelope.h:60</a></div></div>
<div class="ttc" id="astructEnvelope_html_a6b00837b3cb4b41898b42307135be8b6"><div class="ttname"><a href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">Envelope::cc</a></div><div class="ttdeci">struct AddressList cc</div><div class="ttdoc">Email's 'Cc' list.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00061">envelope.h:61</a></div></div>
<div class="ttc" id="astructEnvelope_html_aad427832f4ae422f1b16d0896c1d3af6"><div class="ttname"><a href="structEnvelope.html#aad427832f4ae422f1b16d0896c1d3af6">Envelope::bcc</a></div><div class="ttdeci">struct AddressList bcc</div><div class="ttdoc">Email's 'Bcc' list.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00062">envelope.h:62</a></div></div>
<div class="ttc" id="astructNeoMutt_html"><div class="ttname"><a href="structNeoMutt.html">NeoMutt</a></div><div class="ttdoc">Container for Accounts, Notifications.</div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00042">neomutt.h:43</a></div></div>
<div class="ttc" id="astructNeoMutt_html_af98065e32243ce9331f93b7f30247d47"><div class="ttname"><a href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">NeoMutt::sub</a></div><div class="ttdeci">struct ConfigSubset * sub</div><div class="ttdoc">Inherited config items.</div><div class="ttdef"><b>Definition:</b> <a href="neomutt_8h_source.html#l00047">neomutt.h:47</a></div></div>
</div><!-- fragment --><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_abb04ccb83d144391034d86704c52b987_cgraph.svg" width="608" height="588"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_abb04ccb83d144391034d86704c52b987_icgraph.svg" width="514" height="74"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2afe38b474061773d69624018621ff1e" name="a2afe38b474061773d69624018621ff1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2afe38b474061773d69624018621ff1e">&#9670;&#160;</a></span>crypt_opportunistic_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_opportunistic_encrypt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Can all recipients be determined. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a></td></tr>
  </table>
  </dd>
</dl>
<p>Check if all recipients keys can be automatically determined. Enable encryption if they can, otherwise disable encryption. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01046">1046</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1047</span>{</div>
<div class="line"><span class="lineno"> 1048</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno"> 1049</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1050</span> </div>
<div class="line"><span class="lineno"> 1051</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_opportunistic_encrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_opportunistic_encrypt&quot;</span>);</div>
<div class="line"><span class="lineno"> 1052</span>  <span class="keywordflow">if</span> (!(c_crypt_opportunistic_encrypt &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a>)))</div>
<div class="line"><span class="lineno"> 1053</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>  <span class="keywordtype">char</span> *pgpkeylist = NULL;</div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>  <a class="code hl_function" href="crypt_8c.html#abb04ccb83d144391034d86704c52b987">crypt_get_keys</a>(e, &amp;pgpkeylist, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1058</span>  <span class="keywordflow">if</span> (pgpkeylist)</div>
<div class="line"><span class="lineno"> 1059</span>  {</div>
<div class="line"><span class="lineno"> 1060</span>    e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> |= <a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a>;</div>
<div class="line"><span class="lineno"> 1061</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;pgpkeylist);</div>
<div class="line"><span class="lineno"> 1062</span>  }</div>
<div class="line"><span class="lineno"> 1063</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1064</span>  {</div>
<div class="line"><span class="lineno"> 1065</span>    e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp;= ~SEC_ENCRYPT;</div>
<div class="line"><span class="lineno"> 1066</span>  }</div>
<div class="line"><span class="lineno"> 1067</span>}</div>
<div class="ttc" id="acrypt_8c_html_abb04ccb83d144391034d86704c52b987"><div class="ttname"><a href="crypt_8c.html#abb04ccb83d144391034d86704c52b987">crypt_get_keys</a></div><div class="ttdeci">int crypt_get_keys(struct Email *e, char **keylist, bool oppenc_mode)</div><div class="ttdoc">Check we have all the keys we need.</div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00962">crypt.c:962</a></div></div>
<div class="ttc" id="amemory_8h_html_a25875003b43b81a4302256caa4a13599"><div class="ttname"><a href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a></div><div class="ttdeci">#define FREE(x)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00062">memory.h:62</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a2fb0b0aa796d8d79a746001d09c2a2c7"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2fb0b0aa796d8d79a746001d09c2a2c7">SEC_OPPENCRYPT</a></div><div class="ttdeci">#define SEC_OPPENCRYPT</div><div class="ttdoc">Opportunistic encrypt mode.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00092">lib.h:92</a></div></div>
</div><!-- fragment --><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a2afe38b474061773d69624018621ff1e_cgraph.svg" width="479" height="70"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a2afe38b474061773d69624018621ff1e_icgraph.svg" width="784" height="336"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="af4ab2e337a2477fba687b1f710aa7a61" name="af4ab2e337a2477fba687b1f710aa7a61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4ab2e337a2477fba687b1f710aa7a61">&#9670;&#160;</a></span>crypt_query()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> crypt_query </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check out the type of encryption used. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>Flags, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT.">SecurityFlags</a> </td></tr>
    <tr><td class="paramname">0</td><td>Error (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set.">SEC_NO_FLAGS</a>)</td></tr>
  </table>
  </dd>
</dl>
<p>Set the cached status values if there are any. </p>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00688">688</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  689</span>{</div>
<div class="line"><span class="lineno">  690</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> || !b)</div>
<div class="line"><span class="lineno">  691</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>  <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> rc = <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>  <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>)</div>
<div class="line"><span class="lineno">  696</span>  {</div>
<div class="line"><span class="lineno">  697</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div>
<div class="line"><span class="lineno">  698</span>      rc |= <a class="code hl_function" href="crypt_8c.html#ad5ae8b8d4fea0b6aa61dc38312e99d15">mutt_is_application_pgp</a>(b);</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</div>
<div class="line"><span class="lineno">  701</span>    {</div>
<div class="line"><span class="lineno">  702</span>      rc |= <a class="code hl_function" href="crypt_8c.html#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a>(b);</div>
<div class="line"><span class="lineno">  703</span>      <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a>)</div>
<div class="line"><span class="lineno">  704</span>        rc |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>;</div>
<div class="line"><span class="lineno">  705</span>      <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#a4de063a5f09cb7376f9fde6bb0fe48bc">badsig</a>)</div>
<div class="line"><span class="lineno">  706</span>        rc |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">SEC_BADSIGN</a>;</div>
<div class="line"><span class="lineno">  707</span>    }</div>
<div class="line"><span class="lineno">  708</span>  }</div>
<div class="line"><span class="lineno">  709</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>))</div>
<div class="line"><span class="lineno">  710</span>  {</div>
<div class="line"><span class="lineno">  711</span>    rc |= <a class="code hl_function" href="crypt_8c.html#ad5ae8b8d4fea0b6aa61dc38312e99d15">mutt_is_application_pgp</a>(b);</div>
<div class="line"><span class="lineno">  712</span>    <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a>)</div>
<div class="line"><span class="lineno">  713</span>      rc |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>;</div>
<div class="line"><span class="lineno">  714</span>  }</div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>  <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>)</div>
<div class="line"><span class="lineno">  717</span>  {</div>
<div class="line"><span class="lineno">  718</span>    rc |= <a class="code hl_function" href="crypt_8c.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a>(b);</div>
<div class="line"><span class="lineno">  719</span>    rc |= <a class="code hl_function" href="crypt_8c.html#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a>(b);</div>
<div class="line"><span class="lineno">  720</span>    rc |= <a class="code hl_function" href="crypt_8c.html#a9edb0262eaed7c522977a75b76c15770">mutt_is_malformed_multipart_pgp_encrypted</a>(b);</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>    <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">goodsig</a>)</div>
<div class="line"><span class="lineno">  723</span>      rc |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>;</div>
<div class="line"><span class="lineno">  724</span><span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div>
<div class="line"><span class="lineno">  725</span>    <span class="keywordflow">if</span> (rc &amp;&amp; b-&gt;<a class="code hl_variable" href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">is_autocrypt</a>)</div>
<div class="line"><span class="lineno">  726</span>      rc |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>;</div>
<div class="line"><span class="lineno">  727</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  728</span>  }</div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span>  <span class="keywordflow">if</span> ((b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a>))</div>
<div class="line"><span class="lineno">  731</span>  {</div>
<div class="line"><span class="lineno">  732</span>    <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> u = b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> ? <a class="code hl_define" href="ncrypt_2lib_8h.html#a3eec0b09486fe4bfe7613f808f768747">SEC_ALL_FLAGS</a> : <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>; <span class="comment">/* Bits set in all parts */</span></div>
<div class="line"><span class="lineno">  733</span>    <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> w = <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>; <span class="comment">/* Bits set in any part  */</span></div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>    <span class="keywordflow">for</span> (b = b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>; b; b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>)</div>
<div class="line"><span class="lineno">  736</span>    {</div>
<div class="line"><span class="lineno">  737</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> v = <a class="code hl_function" href="crypt_8c.html#af4ab2e337a2477fba687b1f710aa7a61">crypt_query</a>(b);</div>
<div class="line"><span class="lineno">  738</span>      u &amp;= v;</div>
<div class="line"><span class="lineno">  739</span>      w |= v;</div>
<div class="line"><span class="lineno">  740</span>    }</div>
<div class="line"><span class="lineno">  741</span>    rc |= u | (w &amp; ~SEC_GOODSIGN);</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>    <span class="keywordflow">if</span> ((w &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>) &amp;&amp; !(u &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a>))</div>
<div class="line"><span class="lineno">  744</span>      rc |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a9b0f8af6da383f08d29eb97fac836e3f">SEC_PARTSIGN</a>;</div>
<div class="line"><span class="lineno">  745</span>  }</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  748</span>}</div>
<div class="ttc" id="acrypt_8c_html_a345fb1ff241b3fc778632947c2b08d37"><div class="ttname"><a href="crypt_8c.html#a345fb1ff241b3fc778632947c2b08d37">mutt_is_multipart_signed</a></div><div class="ttdeci">SecurityFlags mutt_is_multipart_signed(struct Body *b)</div><div class="ttdoc">Is a message signed?</div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00409">crypt.c:409</a></div></div>
<div class="ttc" id="acrypt_8c_html_a4073ce5b5fcec6e245dbfa9369016b8e"><div class="ttname"><a href="crypt_8c.html#a4073ce5b5fcec6e245dbfa9369016b8e">mutt_is_application_smime</a></div><div class="ttdeci">SecurityFlags mutt_is_application_smime(struct Body *b)</div><div class="ttdoc">Does the message use S/MIME?</div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00610">crypt.c:610</a></div></div>
<div class="ttc" id="acrypt_8c_html_a832e4b9f5a0e463876a3d8cfe852f12d"><div class="ttname"><a href="crypt_8c.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a></div><div class="ttdeci">SecurityFlags mutt_is_multipart_encrypted(struct Body *b)</div><div class="ttdoc">Does the message have encrypted parts?</div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00444">crypt.c:444</a></div></div>
<div class="ttc" id="acrypt_8c_html_a9edb0262eaed7c522977a75b76c15770"><div class="ttname"><a href="crypt_8c.html#a9edb0262eaed7c522977a75b76c15770">mutt_is_malformed_multipart_pgp_encrypted</a></div><div class="ttdeci">SecurityFlags mutt_is_malformed_multipart_pgp_encrypted(struct Body *b)</div><div class="ttdoc">Check for malformed layout.</div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00505">crypt.c:505</a></div></div>
<div class="ttc" id="acrypt_8c_html_ad5ae8b8d4fea0b6aa61dc38312e99d15"><div class="ttname"><a href="crypt_8c.html#ad5ae8b8d4fea0b6aa61dc38312e99d15">mutt_is_application_pgp</a></div><div class="ttdeci">SecurityFlags mutt_is_application_pgp(const struct Body *b)</div><div class="ttdoc">Does the message use PGP?</div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00549">crypt.c:549</a></div></div>
<div class="ttc" id="acrypt_8c_html_af4ab2e337a2477fba687b1f710aa7a61"><div class="ttname"><a href="crypt_8c.html#af4ab2e337a2477fba687b1f710aa7a61">crypt_query</a></div><div class="ttdeci">SecurityFlags crypt_query(struct Body *b)</div><div class="ttdoc">Check out the type of encryption used.</div><div class="ttdef"><b>Definition:</b> <a href="crypt_8c_source.html#l00688">crypt.c:688</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a2cbb8dddd761b8bfba754d933a979c1b">TYPE_MESSAGE</a></div><div class="ttdeci">@ TYPE_MESSAGE</div><div class="ttdoc">Type: 'message/*'.</div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00035">mime.h:35</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a></div><div class="ttdeci">@ TYPE_MULTIPART</div><div class="ttdoc">Type: 'multipart/*'.</div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00037">mime.h:37</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a></div><div class="ttdeci">@ TYPE_APPLICATION</div><div class="ttdoc">Type: 'application/*'.</div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00033">mime.h:33</a></div></div>
<div class="ttc" id="amime_8h_html_a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167"><div class="ttname"><a href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a></div><div class="ttdeci">@ TYPE_TEXT</div><div class="ttdoc">Type: 'text/*'.</div><div class="ttdef"><b>Definition:</b> <a href="mime_8h_source.html#l00038">mime.h:38</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a2073a168ca3a64c3c30d13fa4917a05d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a></div><div class="ttdeci">uint16_t SecurityFlags</div><div class="ttdoc">Flags, e.g. SEC_ENCRYPT.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00082">lib.h:82</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a3eec0b09486fe4bfe7613f808f768747"><div class="ttname"><a href="ncrypt_2lib_8h.html#a3eec0b09486fe4bfe7613f808f768747">SEC_ALL_FLAGS</a></div><div class="ttdeci">#define SEC_ALL_FLAGS</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00100">lib.h:100</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a427cda1ba4b173fa708e124afe7b907a"><div class="ttname"><a href="ncrypt_2lib_8h.html#a427cda1ba4b173fa708e124afe7b907a">SEC_GOODSIGN</a></div><div class="ttdeci">#define SEC_GOODSIGN</div><div class="ttdoc">Email has a valid signature.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00086">lib.h:86</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a70ffca3c8f9bc49498e3352294c5b8fd"><div class="ttname"><a href="ncrypt_2lib_8h.html#a70ffca3c8f9bc49498e3352294c5b8fd">SEC_BADSIGN</a></div><div class="ttdeci">#define SEC_BADSIGN</div><div class="ttdoc">Email has a bad signature.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00087">lib.h:87</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a95845954210adfc850d5602843f858d4"><div class="ttname"><a href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a></div><div class="ttdeci">#define SEC_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00083">lib.h:83</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a9b0f8af6da383f08d29eb97fac836e3f"><div class="ttname"><a href="ncrypt_2lib_8h.html#a9b0f8af6da383f08d29eb97fac836e3f">SEC_PARTSIGN</a></div><div class="ttdeci">#define SEC_PARTSIGN</div><div class="ttdoc">Not all parts of the email is signed.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00088">lib.h:88</a></div></div>
<div class="ttc" id="astructBody_html_a0b87b7bdb6faef44d9aac4854975f805"><div class="ttname"><a href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">Body::parts</a></div><div class="ttdeci">struct Body * parts</div><div class="ttdoc">parts of a multipart or message/rfc822</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00073">body.h:73</a></div></div>
<div class="ttc" id="astructBody_html_a4de063a5f09cb7376f9fde6bb0fe48bc"><div class="ttname"><a href="structBody.html#a4de063a5f09cb7376f9fde6bb0fe48bc">Body::badsig</a></div><div class="ttdeci">bool badsig</div><div class="ttdoc">Bad cryptographic signature (needed to check encrypted s/mime-signatures)</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00043">body.h:43</a></div></div>
<div class="ttc" id="astructBody_html_a63e1a4c2a0bacf3d1d5869edfebed0dd"><div class="ttname"><a href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">Body::is_autocrypt</a></div><div class="ttdeci">bool is_autocrypt</div><div class="ttdoc">Flag autocrypt-decrypted messages for replying.</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00050">body.h:50</a></div></div>
<div class="ttc" id="astructBody_html_ac55cdfce46eed13151dcfe9b329d254c"><div class="ttname"><a href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">Body::next</a></div><div class="ttdeci">struct Body * next</div><div class="ttdoc">next attachment in the list</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00072">body.h:72</a></div></div>
<div class="ttc" id="astructBody_html_ae4b2706a5c4601ae1497a96e047d8f5e"><div class="ttname"><a href="structBody.html#ae4b2706a5c4601ae1497a96e047d8f5e">Body::goodsig</a></div><div class="ttdeci">bool goodsig</div><div class="ttdoc">Good cryptographic signature.</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00045">body.h:45</a></div></div>
<div class="ttc" id="astructBody_html_af77d79aadb278bef8f2829c268f2486f"><div class="ttname"><a href="structBody.html#af77d79aadb278bef8f2829c268f2486f">Body::type</a></div><div class="ttdeci">unsigned int type</div><div class="ttdoc">content-type primary type, ContentType</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00040">body.h:40</a></div></div>
</div><!-- fragment --><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_af4ab2e337a2477fba687b1f710aa7a61_cgraph.svg" width="362" height="264"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_af4ab2e337a2477fba687b1f710aa7a61_icgraph.svg" width="554" height="379"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4ee7f1419a7e39b0e9f1f9d550f4de43" name="a4ee7f1419a7e39b0e9f1f9d550f4de43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ee7f1419a7e39b0e9f1f9d550f4de43">&#9670;&#160;</a></span>crypt_valid_passphrase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool crypt_valid_passphrase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td>
          <td class="paramname"><em>flags</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check that we have a usable passphrase, ask if not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">flags</td><td>Flags, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT.">SecurityFlags</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Success </td></tr>
    <tr><td class="paramname">false</td><td>Failed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00132">132</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  133</span>{</div>
<div class="line"><span class="lineno">  134</span>  <span class="keywordtype">bool</span> rc = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span><span class="preprocessor">#ifndef DEBUG</span></div>
<div class="line"><span class="lineno">  137</span>  disable_coredumps();</div>
<div class="line"><span class="lineno">  138</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (flags &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  141</span>    rc = <a class="code hl_function" href="cryptglue_8c.html#ad29ef155ee6ccc83b50614068bb5b597">crypt_pgp_valid_passphrase</a>();</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (flags &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno">  144</span>    rc = <a class="code hl_function" href="cryptglue_8c.html#a82c5ed5b55a8c04d810494995152f10d">crypt_smime_valid_passphrase</a>();</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno">  147</span>}</div>
<div class="ttc" id="acryptglue_8c_html_a82c5ed5b55a8c04d810494995152f10d"><div class="ttname"><a href="cryptglue_8c.html#a82c5ed5b55a8c04d810494995152f10d">crypt_smime_valid_passphrase</a></div><div class="ttdeci">bool crypt_smime_valid_passphrase(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::valid_passphrase()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00421">cryptglue.c:421</a></div></div>
<div class="ttc" id="acryptglue_8c_html_ad29ef155ee6ccc83b50614068bb5b597"><div class="ttname"><a href="cryptglue_8c.html#ad29ef155ee6ccc83b50614068bb5b597">crypt_pgp_valid_passphrase</a></div><div class="ttdeci">bool crypt_pgp_valid_passphrase(void)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::valid_passphrase()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00199">cryptglue.c:199</a></div></div>
</div><!-- fragment --><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a4ee7f1419a7e39b0e9f1f9d550f4de43_cgraph.svg" width="432" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a4ee7f1419a7e39b0e9f1f9d550f4de43_icgraph.svg" width="647" height="760"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad5ae8b8d4fea0b6aa61dc38312e99d15" name="ad5ae8b8d4fea0b6aa61dc38312e99d15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5ae8b8d4fea0b6aa61dc38312e99d15">&#9670;&#160;</a></span>mutt_is_application_pgp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_application_pgp </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the message use PGP? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> uses PGP, e.g. <a class="el" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> doesn't use PGP, (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set.">SEC_NO_FLAGS</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00549">549</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  550</span>{</div>
<div class="line"><span class="lineno">  551</span>  <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> t = <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  552</span>  <span class="keywordtype">char</span> *p = NULL;</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>  <span class="keywordflow">if</span> (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>)</div>
<div class="line"><span class="lineno">  555</span>  {</div>
<div class="line"><span class="lineno">  556</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp&quot;</span>) || <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;x-pgp-message&quot;</span>))</div>
<div class="line"><span class="lineno">  557</span>    {</div>
<div class="line"><span class="lineno">  558</span>      p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;x-action&quot;</span>);</div>
<div class="line"><span class="lineno">  559</span>      <span class="keywordflow">if</span> (p &amp;&amp; (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;sign&quot;</span>) || <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;signclear&quot;</span>)))</div>
<div class="line"><span class="lineno">  560</span>      {</div>
<div class="line"><span class="lineno">  561</span>        t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>;</div>
<div class="line"><span class="lineno">  562</span>      }</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>      p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;format&quot;</span>);</div>
<div class="line"><span class="lineno">  565</span>      <span class="keywordflow">if</span> (p &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;keys-only&quot;</span>))</div>
<div class="line"><span class="lineno">  566</span>      {</div>
<div class="line"><span class="lineno">  567</span>        t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a>;</div>
<div class="line"><span class="lineno">  568</span>      }</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>      <span class="keywordflow">if</span> (t == <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>)</div>
<div class="line"><span class="lineno">  571</span>        t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>; <span class="comment">/* not necessarily correct, but... */</span></div>
<div class="line"><span class="lineno">  572</span>    }</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-signed&quot;</span>))</div>
<div class="line"><span class="lineno">  575</span>      t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>;</div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-keys&quot;</span>))</div>
<div class="line"><span class="lineno">  578</span>      t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a>;</div>
<div class="line"><span class="lineno">  579</span>  }</div>
<div class="line"><span class="lineno">  580</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> == <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;plain&quot;</span>, b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>))</div>
<div class="line"><span class="lineno">  581</span>  {</div>
<div class="line"><span class="lineno">  582</span>    <span class="keywordflow">if</span> (((p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;x-mutt-action&quot;</span>)) ||</div>
<div class="line"><span class="lineno">  583</span>         (p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;x-action&quot;</span>)) ||</div>
<div class="line"><span class="lineno">  584</span>         (p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;action&quot;</span>))) &amp;&amp;</div>
<div class="line"><span class="lineno">  585</span>        <a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(p, <span class="stringliteral">&quot;pgp-sign&quot;</span>))</div>
<div class="line"><span class="lineno">  586</span>    {</div>
<div class="line"><span class="lineno">  587</span>      t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>;</div>
<div class="line"><span class="lineno">  588</span>    }</div>
<div class="line"><span class="lineno">  589</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(p, <span class="stringliteral">&quot;pgp-encrypt&quot;</span>))</div>
<div class="line"><span class="lineno">  590</span>    {</div>
<div class="line"><span class="lineno">  591</span>      t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  592</span>    }</div>
<div class="line"><span class="lineno">  593</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a>(p, <span class="stringliteral">&quot;pgp-keys&quot;</span>))</div>
<div class="line"><span class="lineno">  594</span>    {</div>
<div class="line"><span class="lineno">  595</span>      t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a>;</div>
<div class="line"><span class="lineno">  596</span>    }</div>
<div class="line"><span class="lineno">  597</span>  }</div>
<div class="line"><span class="lineno">  598</span>  <span class="keywordflow">if</span> (t)</div>
<div class="line"><span class="lineno">  599</span>    t |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a>;</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>  <span class="keywordflow">return</span> t;</div>
<div class="line"><span class="lineno">  602</span>}</div>
<div class="ttc" id="amutt_2string_8c_html_a29db81d6f5a7dd216cbea75ecf8a5885"><div class="ttname"><a href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a></div><div class="ttdeci">bool mutt_istr_equal(const char *a, const char *b)</div><div class="ttdoc">Compare two strings, ignoring case.</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00672">string.c:672</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_aebd2a8a3f8a30062c31fa1474d87cc41"><div class="ttname"><a href="mutt_2string_8c.html#aebd2a8a3f8a30062c31fa1474d87cc41">mutt_istr_startswith</a></div><div class="ttdeci">size_t mutt_istr_startswith(const char *str, const char *prefix)</div><div class="ttdoc">Check whether a string starts with a prefix, ignoring case.</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00244">string.c:244</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a14f75a650c49341776276f44881d54b2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a></div><div class="ttdeci">#define PGP_SIGN</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00103">lib.h:103</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a6694d25dff1ee1958351160a84bb2dc0"><div class="ttname"><a href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a></div><div class="ttdeci">#define PGP_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00102">lib.h:102</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a68503f0e36de213094c8546b4f74eef1"><div class="ttname"><a href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a></div><div class="ttdeci">#define PGP_INLINE</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00106">lib.h:106</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_abd2087cae2885c199218f5530ce7945b"><div class="ttname"><a href="ncrypt_2lib_8h.html#abd2087cae2885c199218f5530ce7945b">PGP_KEY</a></div><div class="ttdeci">#define PGP_KEY</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00105">lib.h:105</a></div></div>
<div class="ttc" id="aparameter_8c_html_a31d10561ad6b3637e7591569b903aa33"><div class="ttname"><a href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a></div><div class="ttdeci">char * mutt_param_get(const struct ParameterList *pl, const char *s)</div><div class="ttdoc">Find a matching Parameter.</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00085">parameter.c:85</a></div></div>
<div class="ttc" id="astructBody_html_a782cee95e0064e3895b88248bdfc781a"><div class="ttname"><a href="structBody.html#a782cee95e0064e3895b88248bdfc781a">Body::parameter</a></div><div class="ttdeci">struct ParameterList parameter</div><div class="ttdoc">Parameters of the content-type.</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00063">body.h:63</a></div></div>
<div class="ttc" id="astructBody_html_ace00f9cba9b46a2d434764335d2fa43a"><div class="ttname"><a href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">Body::subtype</a></div><div class="ttdeci">char * subtype</div><div class="ttdoc">content-type subtype</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00061">body.h:61</a></div></div>
</div><!-- fragment --><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_ad5ae8b8d4fea0b6aa61dc38312e99d15_cgraph.svg" width="540" height="103"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_ad5ae8b8d4fea0b6aa61dc38312e99d15_icgraph.svg" width="859" height="690"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4073ce5b5fcec6e245dbfa9369016b8e" name="a4073ce5b5fcec6e245dbfa9369016b8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4073ce5b5fcec6e245dbfa9369016b8e">&#9670;&#160;</a></span>mutt_is_application_smime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_application_smime </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the message use S/MIME? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> uses S/MIME, e.g. <a class="el" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> doesn't use S/MIME, (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set.">SEC_NO_FLAGS</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00610">610</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  611</span>{</div>
<div class="line"><span class="lineno">  612</span>  <span class="keywordflow">if</span> (!b)</div>
<div class="line"><span class="lineno">  613</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>  <span class="keywordflow">if</span> (((b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> &amp; <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) == 0) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>)</div>
<div class="line"><span class="lineno">  616</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>  <span class="keywordtype">char</span> *t = NULL;</div>
<div class="line"><span class="lineno">  619</span>  <span class="keywordtype">bool</span> complain = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  620</span>  <span class="comment">/* S/MIME MIME types don&#39;t need x- anymore, see RFC2311 */</span></div>
<div class="line"><span class="lineno">  621</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;x-pkcs7-mime&quot;</span>) || <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pkcs7-mime&quot;</span>))</div>
<div class="line"><span class="lineno">  622</span>  {</div>
<div class="line"><span class="lineno">  623</span>    t = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;smime-type&quot;</span>);</div>
<div class="line"><span class="lineno">  624</span>    <span class="keywordflow">if</span> (t)</div>
<div class="line"><span class="lineno">  625</span>    {</div>
<div class="line"><span class="lineno">  626</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(t, <span class="stringliteral">&quot;enveloped-data&quot;</span>))</div>
<div class="line"><span class="lineno">  627</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  628</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(t, <span class="stringliteral">&quot;signed-data&quot;</span>))</div>
<div class="line"><span class="lineno">  629</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a>;</div>
<div class="line"><span class="lineno">  630</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  631</span>    }</div>
<div class="line"><span class="lineno">  632</span>    <span class="comment">/* Netscape 4.7 uses</span></div>
<div class="line"><span class="lineno">  633</span><span class="comment">     * Content-Description: S/MIME Encrypted Message</span></div>
<div class="line"><span class="lineno">  634</span><span class="comment">     * instead of Content-Type parameter */</span></div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#a90db5151872e23e56a8f31d68925c121">description</a>, <span class="stringliteral">&quot;S/MIME Encrypted Message&quot;</span>))</div>
<div class="line"><span class="lineno">  636</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  637</span>    complain = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  638</span>  }</div>
<div class="line"><span class="lineno">  639</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;octet-stream&quot;</span>))</div>
<div class="line"><span class="lineno">  640</span>  {</div>
<div class="line"><span class="lineno">  641</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  642</span>  }</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>  t = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;name&quot;</span>);</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>  <span class="keywordflow">if</span> (!t)</div>
<div class="line"><span class="lineno">  647</span>    t = b-&gt;<a class="code hl_variable" href="structBody.html#a0a77f105609a64f37c359b9c81d1f263">d_filename</a>;</div>
<div class="line"><span class="lineno">  648</span>  <span class="keywordflow">if</span> (!t)</div>
<div class="line"><span class="lineno">  649</span>    t = b-&gt;<a class="code hl_variable" href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">filename</a>;</div>
<div class="line"><span class="lineno">  650</span>  <span class="keywordflow">if</span> (!t)</div>
<div class="line"><span class="lineno">  651</span>  {</div>
<div class="line"><span class="lineno">  652</span>    <span class="keywordflow">if</span> (complain)</div>
<div class="line"><span class="lineno">  653</span>    {</div>
<div class="line"><span class="lineno">  654</span>      <a class="code hl_define" href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;S/MIME messages with no hints on content are unsupported&quot;</span>));</div>
<div class="line"><span class="lineno">  655</span>    }</div>
<div class="line"><span class="lineno">  656</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  657</span>  }</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>  <span class="comment">/* no .p7c, .p10 support yet. */</span></div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>  <span class="keywordtype">int</span> len = <a class="code hl_function" href="mutt_2string_8c.html#acca6786b903b22a5924219f9db96e10d">mutt_str_len</a>(t) - 4;</div>
<div class="line"><span class="lineno">  662</span>  <span class="keywordflow">if</span> ((len &gt; 0) &amp;&amp; (*(t + len) == <span class="charliteral">&#39;.&#39;</span>))</div>
<div class="line"><span class="lineno">  663</span>  {</div>
<div class="line"><span class="lineno">  664</span>    len++;</div>
<div class="line"><span class="lineno">  665</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>((t + len), <span class="stringliteral">&quot;p7m&quot;</span>))</div>
<div class="line"><span class="lineno">  666</span>    {</div>
<div class="line"><span class="lineno">  667</span>      <span class="comment">/* Not sure if this is the correct thing to do, but</span></div>
<div class="line"><span class="lineno">  668</span><span class="comment">       * it&#39;s required for compatibility with Outlook */</span></div>
<div class="line"><span class="lineno">  669</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a>;</div>
<div class="line"><span class="lineno">  670</span>    }</div>
<div class="line"><span class="lineno">  671</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>((t + len), <span class="stringliteral">&quot;p7s&quot;</span>))</div>
<div class="line"><span class="lineno">  672</span>    {</div>
<div class="line"><span class="lineno">  673</span>      <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a>;</div>
<div class="line"><span class="lineno">  674</span>    }</div>
<div class="line"><span class="lineno">  675</span>  }</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  678</span>}</div>
<div class="ttc" id="ancrypt_2lib_8h_html_a67114d960e61fc36c467f4bf08d37335"><div class="ttname"><a href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a></div><div class="ttdeci">#define SMIME_SIGN</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00109">lib.h:109</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a9c811504abf735623a6dd3ac20287f30"><div class="ttname"><a href="ncrypt_2lib_8h.html#a9c811504abf735623a6dd3ac20287f30">SMIME_OPAQUE</a></div><div class="ttdeci">#define SMIME_OPAQUE</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00112">lib.h:112</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_ac25eb5415ebf34da68c39a3d4e3bc9ad"><div class="ttname"><a href="ncrypt_2lib_8h.html#ac25eb5415ebf34da68c39a3d4e3bc9ad">SMIME_ENCRYPT</a></div><div class="ttdeci">#define SMIME_ENCRYPT</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00108">lib.h:108</a></div></div>
<div class="ttc" id="astructBody_html_a0a77f105609a64f37c359b9c81d1f263"><div class="ttname"><a href="structBody.html#a0a77f105609a64f37c359b9c81d1f263">Body::d_filename</a></div><div class="ttdeci">char * d_filename</div><div class="ttdoc">filename to be used for the content-disposition header If NULL, filename is used instead.</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00056">body.h:56</a></div></div>
<div class="ttc" id="astructBody_html_a90db5151872e23e56a8f31d68925c121"><div class="ttname"><a href="structBody.html#a90db5151872e23e56a8f31d68925c121">Body::description</a></div><div class="ttdeci">char * description</div><div class="ttdoc">content-description</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00055">body.h:55</a></div></div>
<div class="ttc" id="astructBody_html_afe3cd2c4b1070e3d0edbf1fed939ac5a"><div class="ttname"><a href="structBody.html#afe3cd2c4b1070e3d0edbf1fed939ac5a">Body::filename</a></div><div class="ttdeci">char * filename</div><div class="ttdoc">When sending a message, this is the file to which this structure refers.</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00059">body.h:59</a></div></div>
</div><!-- fragment --><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a4073ce5b5fcec6e245dbfa9369016b8e_cgraph.svg" width="488" height="111"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a4073ce5b5fcec6e245dbfa9369016b8e_icgraph.svg" width="847" height="719"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a9edb0262eaed7c522977a75b76c15770" name="a9edb0262eaed7c522977a75b76c15770"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9edb0262eaed7c522977a75b76c15770">&#9670;&#160;</a></span>mutt_is_malformed_multipart_pgp_encrypted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_malformed_multipart_pgp_encrypted </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for malformed layout. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td>Success, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT.">SecurityFlags</a> </td></tr>
    <tr><td class="paramname">0</td><td>Error, (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set.">SEC_NO_FLAGS</a>)</td></tr>
  </table>
  </dd>
</dl>
<p>This checks for the malformed layout caused by MS Exchange in some cases: </p><div class="fragment"><div class="line">&lt;multipart/mixed&gt;</div>
<div class="line">   &lt;text/plain&gt;</div>
<div class="line">   &lt;application/pgp-encrypted&gt; [BASE64-encoded]</div>
<div class="line">   &lt;application/octet-stream&gt; [BASE64-encoded]</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00505">505</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  506</span>{</div>
<div class="line"><span class="lineno">  507</span>  <span class="keywordflow">if</span> (!(<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  508</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> || !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;mixed&quot;</span>))</div>
<div class="line"><span class="lineno">  511</span>  {</div>
<div class="line"><span class="lineno">  512</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  513</span>  }</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>  b = b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno">  516</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div>
<div class="line"><span class="lineno">  517</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;plain&quot;</span>) || (b-&gt;<a class="code hl_variable" href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">length</a> != 0))</div>
<div class="line"><span class="lineno">  518</span>  {</div>
<div class="line"><span class="lineno">  519</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  520</span>  }</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>  b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno">  523</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div>
<div class="line"><span class="lineno">  524</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-encrypted&quot;</span>))</div>
<div class="line"><span class="lineno">  525</span>  {</div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  527</span>  }</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>  b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno">  530</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div>
<div class="line"><span class="lineno">  531</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;octet-stream&quot;</span>))</div>
<div class="line"><span class="lineno">  532</span>  {</div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  534</span>  }</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>  b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno">  537</span>  <span class="keywordflow">if</span> (b)</div>
<div class="line"><span class="lineno">  538</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  541</span>}</div>
<div class="ttc" id="astructBody_html_a6f92d7ec8568ca04ae07931c56dd0790"><div class="ttname"><a href="structBody.html#a6f92d7ec8568ca04ae07931c56dd0790">Body::length</a></div><div class="ttdeci">LOFF_T length</div><div class="ttdoc">length (in bytes) of attachment</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00053">body.h:53</a></div></div>
</div><!-- fragment --><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a9edb0262eaed7c522977a75b76c15770_cgraph.svg" width="383" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a9edb0262eaed7c522977a75b76c15770_icgraph.svg" width="472" height="331"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a832e4b9f5a0e463876a3d8cfe852f12d" name="a832e4b9f5a0e463876a3d8cfe852f12d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a832e4b9f5a0e463876a3d8cfe852f12d">&#9670;&#160;</a></span>mutt_is_multipart_encrypted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_multipart_encrypted </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does the message have encrypted parts? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> has got encrypted parts, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT.">SecurityFlags</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> hasn't got encrypted parts (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set.">SEC_NO_FLAGS</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00444">444</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  445</span>{</div>
<div class="line"><span class="lineno">  446</span>  <span class="keywordflow">if</span> ((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) == 0)</div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>  <span class="keywordtype">char</span> *p = NULL;</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div>
<div class="line"><span class="lineno">  452</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;encrypted&quot;</span>) ||</div>
<div class="line"><span class="lineno">  453</span>      !(p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protocol&quot;</span>)) ||</div>
<div class="line"><span class="lineno">  454</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;application/pgp-encrypted&quot;</span>))</div>
<div class="line"><span class="lineno">  455</span>  {</div>
<div class="line"><span class="lineno">  456</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  457</span>  }</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  460</span>}</div>
</div><!-- fragment --><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a832e4b9f5a0e463876a3d8cfe852f12d_cgraph.svg" width="550" height="62"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a832e4b9f5a0e463876a3d8cfe852f12d_icgraph.svg" width="467" height="420"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a345fb1ff241b3fc778632947c2b08d37" name="a345fb1ff241b3fc778632947c2b08d37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a345fb1ff241b3fc778632947c2b08d37">&#9670;&#160;</a></span>mutt_is_multipart_signed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> mutt_is_multipart_signed </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is a message signed? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">num</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> is signed, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT.">SecurityFlags</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> is not signed (<a class="el" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4" title="No flags are set.">SEC_NO_FLAGS</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00409">409</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  410</span>{</div>
<div class="line"><span class="lineno">  411</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79a877e24e62c85f20ff0e0f09ab983031e">TYPE_MULTIPART</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> || !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;signed&quot;</span>))</div>
<div class="line"><span class="lineno">  412</span>  {</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  414</span>  }</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>  <span class="keywordtype">char</span> *p = <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;b-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protocol&quot;</span>);</div>
<div class="line"><span class="lineno">  417</span>  <span class="keywordflow">if</span> (!p)</div>
<div class="line"><span class="lineno">  418</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;multipart/mixed&quot;</span>))</div>
<div class="line"><span class="lineno">  421</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>;</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;application/pgp-signature&quot;</span>))</div>
<div class="line"><span class="lineno">  424</span>  {</div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a14f75a650c49341776276f44881d54b2">PGP_SIGN</a>;</div>
<div class="line"><span class="lineno">  426</span>  }</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp;</div>
<div class="line"><span class="lineno">  429</span>      (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;application/x-pkcs7-signature&quot;</span>) ||</div>
<div class="line"><span class="lineno">  430</span>       <a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(p, <span class="stringliteral">&quot;application/pkcs7-signature&quot;</span>)))</div>
<div class="line"><span class="lineno">  431</span>  {</div>
<div class="line"><span class="lineno">  432</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a67114d960e61fc36c467f4bf08d37335">SMIME_SIGN</a>;</div>
<div class="line"><span class="lineno">  433</span>  }</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  436</span>}</div>
<div class="ttc" id="ancrypt_2lib_8h_html_ae12c003463c99d28f65f1d6b8b053b2c"><div class="ttname"><a href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a></div><div class="ttdeci">#define SEC_SIGN</div><div class="ttdoc">Email is signed.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00085">lib.h:85</a></div></div>
</div><!-- fragment --><div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a345fb1ff241b3fc778632947c2b08d37_cgraph.svg" width="527" height="62"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a345fb1ff241b3fc778632947c2b08d37_icgraph.svg" width="430" height="452"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a51806f872069460bb7f4fa16d1d92710" name="a51806f872069460bb7f4fa16d1d92710"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51806f872069460bb7f4fa16d1d92710">&#9670;&#160;</a></span>mutt_is_valid_multipart_pgp_encrypted()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_is_valid_multipart_pgp_encrypted </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is this a valid multi-part encrypted message? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td><a class="el" href="structBody.html" title="The body of an email.">Body</a> of email </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">&gt;0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> is valid, with encrypted parts, e.g. <a class="el" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a> </td></tr>
    <tr><td class="paramname">0</td><td><a class="el" href="structMessage.html" title="A local copy of an email.">Message</a> hasn't got encrypted parts </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00468">468</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  469</span>{</div>
<div class="line"><span class="lineno">  470</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="crypt_8c.html#a832e4b9f5a0e463876a3d8cfe852f12d">mutt_is_multipart_encrypted</a>(b) == <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>)</div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>  b = b-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>;</div>
<div class="line"><span class="lineno">  474</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div>
<div class="line"><span class="lineno">  475</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;pgp-encrypted&quot;</span>))</div>
<div class="line"><span class="lineno">  476</span>  {</div>
<div class="line"><span class="lineno">  477</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  478</span>  }</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>  b = b-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno">  481</span>  <span class="keywordflow">if</span> (!b || (b-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ac5074066199e3f540550ca0b1a38978e">TYPE_APPLICATION</a>) || !b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a> ||</div>
<div class="line"><span class="lineno">  482</span>      !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(b-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;octet-stream&quot;</span>))</div>
<div class="line"><span class="lineno">  483</span>  {</div>
<div class="line"><span class="lineno">  484</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  485</span>  }</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>  <span class="keywordflow">return</span> <a class="code hl_define" href="ncrypt_2lib_8h.html#a6694d25dff1ee1958351160a84bb2dc0">PGP_ENCRYPT</a>;</div>
<div class="line"><span class="lineno">  488</span>}</div>
</div><!-- fragment --><div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a51806f872069460bb7f4fa16d1d92710_cgraph.svg" width="590" height="70"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-24" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a51806f872069460bb7f4fa16d1d92710_icgraph.svg" width="416" height="184"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a896502d4448fefadaf8786a4f2d5556e" name="a896502d4448fefadaf8786a4f2d5556e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a896502d4448fefadaf8786a4f2d5556e">&#9670;&#160;</a></span>mutt_protect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_protect </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>keylist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>postpone</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt and/or sign a message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> </td></tr>
    <tr><td class="paramname">keylist</td><td>List of keys to encrypt to (space-separated) </td></tr>
    <tr><td class="paramname">postpone</td><td>When true, signing is automatically disabled </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l00157">157</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  158</span>{</div>
<div class="line"><span class="lineno">  159</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *pbody = NULL, *tmp_pbody = NULL;</div>
<div class="line"><span class="lineno">  160</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *tmp_smime_pbody = NULL;</div>
<div class="line"><span class="lineno">  161</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structBody.html">Body</a> *tmp_pgp_pbody = NULL;</div>
<div class="line"><span class="lineno">  162</span>  <span class="keywordtype">bool</span> has_retainable_sig = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a>)</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>  <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> security = e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a>;</div>
<div class="line"><span class="lineno">  168</span>  <span class="keywordtype">int</span> sign = security &amp; (<a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#ae12c003463c99d28f65f1d6b8b053b2c">SEC_SIGN</a>);</div>
<div class="line"><span class="lineno">  169</span>  <span class="keywordflow">if</span> (postpone)</div>
<div class="line"><span class="lineno">  170</span>  {</div>
<div class="line"><span class="lineno">  171</span>    sign = <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  172</span>    security &amp;= ~SEC_SIGN;</div>
<div class="line"><span class="lineno">  173</span>  }</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>  <span class="keywordflow">if</span> (!(security &amp; (<a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)) &amp;&amp; !sign)</div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>  <span class="keywordflow">if</span> (sign &amp;&amp; !(security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>) &amp;&amp; !<a class="code hl_function" href="crypt_8c.html#a4ee7f1419a7e39b0e9f1f9d550f4de43">crypt_valid_passphrase</a>(security))</div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; !(security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  182</span>      ((security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a>) == <a class="code hl_define" href="ncrypt_2lib_8h.html#a68503f0e36de213094c8546b4f74eef1">PGP_INLINE</a>))</div>
<div class="line"><span class="lineno">  183</span>  {</div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">if</span> ((e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#af77d79aadb278bef8f2829c268f2486f">type</a> != <a class="code hl_enumvalue" href="mime_8h.html#a3ccd048df649c335df5a7f82673bbc79ad88e88afaec507209421bba20aeeb167">TYPE_TEXT</a>) || !<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#ace00f9cba9b46a2d434764335d2fa43a">subtype</a>, <span class="stringliteral">&quot;plain&quot;</span>))</div>
<div class="line"><span class="lineno">  185</span>    {</div>
<div class="line"><span class="lineno">  186</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="question_2lib_8h.html#a8ba883bf53e8ab425a03d17368de84b4">query_quadoption</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Inline PGP can&#39;t be used with attachments.  Revert to PGP/MIME?&quot;</span>),</div>
<div class="line"><span class="lineno">  187</span>                           <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_mime_auto&quot;</span>) != <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div>
<div class="line"><span class="lineno">  188</span>      {</div>
<div class="line"><span class="lineno">  189</span>        <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mail not sent: inline PGP can&#39;t be used with attachments&quot;</span>));</div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  191</span>      }</div>
<div class="line"><span class="lineno">  192</span>    }</div>
<div class="line"><span class="lineno">  193</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="mutt_2string_8c.html#a29db81d6f5a7dd216cbea75ecf8a5885">mutt_istr_equal</a>(<span class="stringliteral">&quot;flowed&quot;</span>, <a class="code hl_function" href="parameter_8c.html#a31d10561ad6b3637e7591569b903aa33">mutt_param_get</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;format&quot;</span>)))</div>
<div class="line"><span class="lineno">  194</span>    {</div>
<div class="line"><span class="lineno">  195</span>      <span class="keywordflow">if</span> ((<a class="code hl_function" href="question_2lib_8h.html#a8ba883bf53e8ab425a03d17368de84b4">query_quadoption</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Inline PGP can&#39;t be used with format=flowed.  Revert to PGP/MIME?&quot;</span>),</div>
<div class="line"><span class="lineno">  196</span>                            <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_mime_auto&quot;</span>)) != <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div>
<div class="line"><span class="lineno">  197</span>      {</div>
<div class="line"><span class="lineno">  198</span>        <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mail not sent: inline PGP can&#39;t be used with format=flowed&quot;</span>));</div>
<div class="line"><span class="lineno">  199</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  200</span>      }</div>
<div class="line"><span class="lineno">  201</span>    }</div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  203</span>    {</div>
<div class="line"><span class="lineno">  204</span>      <span class="comment">/* they really want to send it inline... go for it */</span></div>
<div class="line"><span class="lineno">  205</span>      <span class="keywordflow">if</span> (!isendwin())</div>
<div class="line"><span class="lineno">  206</span>      {</div>
<div class="line"><span class="lineno">  207</span>        <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  208</span>        puts(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Invoking PGP...&quot;</span>));</div>
<div class="line"><span class="lineno">  209</span>      }</div>
<div class="line"><span class="lineno">  210</span>      pbody = <a class="code hl_function" href="cryptglue_8c.html#a3458a0bbc46b247f9dd5ea63d1e9231f">crypt_pgp_traditional_encryptsign</a>(e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, security, keylist);</div>
<div class="line"><span class="lineno">  211</span>      <span class="keywordflow">if</span> (pbody)</div>
<div class="line"><span class="lineno">  212</span>      {</div>
<div class="line"><span class="lineno">  213</span>        e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = pbody;</div>
<div class="line"><span class="lineno">  214</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  215</span>      }</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>      <span class="comment">/* otherwise inline won&#39;t work...ask for revert */</span></div>
<div class="line"><span class="lineno">  218</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="question_2lib_8h.html#a8ba883bf53e8ab425a03d17368de84b4">query_quadoption</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Message can&#39;t be sent inline.  Revert to using PGP/MIME?&quot;</span>),</div>
<div class="line"><span class="lineno">  219</span>                           <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_mime_auto&quot;</span>) != <a class="code hl_enumvalue" href="quad_8h.html#a738f558a271fe5035e0ee3b700ee35dbafee7088606c4724651c799a6a0b182b7">MUTT_YES</a>)</div>
<div class="line"><span class="lineno">  220</span>      {</div>
<div class="line"><span class="lineno">  221</span>        <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Mail not sent&quot;</span>));</div>
<div class="line"><span class="lineno">  222</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  223</span>      }</div>
<div class="line"><span class="lineno">  224</span>    }</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <span class="comment">/* go ahead with PGP/MIME */</span></div>
<div class="line"><span class="lineno">  227</span>  }</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>  <span class="keywordflow">if</span> (!isendwin())</div>
<div class="line"><span class="lineno">  230</span>    <a class="code hl_function" href="curs__lib_8c.html#acd14d074d8b9e6cb21e851dd573cdec2">mutt_endwin</a>();</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>)</div>
<div class="line"><span class="lineno">  233</span>    tmp_smime_pbody = e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div>
<div class="line"><span class="lineno">  234</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>)</div>
<div class="line"><span class="lineno">  235</span>    tmp_pgp_pbody = e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>;</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span><span class="preprocessor">#ifdef CRYPT_BACKEND_GPGME</span></div>
<div class="line"><span class="lineno">  238</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_use_pka = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_use_pka&quot;</span>);</div>
<div class="line"><span class="lineno">  239</span>  <span class="keywordflow">if</span> (sign &amp;&amp; c_crypt_use_pka)</div>
<div class="line"><span class="lineno">  240</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  241</span>  <span class="keywordflow">if</span> (sign)</div>
<div class="line"><span class="lineno">  242</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  243</span>  {</div>
<div class="line"><span class="lineno">  244</span>    <span class="comment">/* Set sender (necessary for e.g. PKA).  */</span></div>
<div class="line"><span class="lineno">  245</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *mailbox = NULL;</div>
<div class="line"><span class="lineno">  246</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structAddress.html">Address</a> *from = <a class="code hl_define" href="queue_8h.html#a7d6894360bd1c41e0e6f6d84998c1362">TAILQ_FIRST</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div>
<div class="line"><span class="lineno">  247</span>    <span class="keywordtype">bool</span> free_from = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>    <span class="keywordflow">if</span> (!from)</div>
<div class="line"><span class="lineno">  250</span>    {</div>
<div class="line"><span class="lineno">  251</span>      free_from = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  252</span>      from = <a class="code hl_function" href="send_8c.html#a90907de4e46f3a56b2889b79a48c9011">mutt_default_from</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno">  253</span>    }</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>    <a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a> = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(from-&gt;<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>);</div>
<div class="line"><span class="lineno">  256</span>    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structAddress.html">Address</a> *c_envelope_from_address = <a class="code hl_function" href="address_2config__type_8c.html#ae303ac83498043a651ec046b572bc707">cs_subset_address</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;envelope_from_address&quot;</span>);</div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a> &amp;&amp; c_envelope_from_address)</div>
<div class="line"><span class="lineno">  258</span>      <a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a> = <a class="code hl_function" href="buffer_8h.html#a728ebc5a947b77c8d56db44ce553a7ab">buf_string</a>(c_envelope_from_address-&gt;<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>);</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno">  261</span>      <a class="code hl_function" href="cryptglue_8c.html#a9f57744c7bcac595aa1a8838f83dc369">crypt_smime_set_sender</a>(<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>);</div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  263</span>      <a class="code hl_function" href="cryptglue_8c.html#a9f42f50373941a87a03df3424ce1b7c4">crypt_pgp_set_sender</a>(<a class="code hl_variable" href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">mailbox</a>);</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">if</span> (free_from)</div>
<div class="line"><span class="lineno">  266</span>      <a class="code hl_function" href="address_2address_8c.html#a40eda06e6e64ff9d9f1e7d3b69e7c846">mutt_addr_free</a>(&amp;from);</div>
<div class="line"><span class="lineno">  267</span>  }</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_protected_headers_write = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_protected_headers_write&quot;</span>);</div>
<div class="line"><span class="lineno">  270</span>  <span class="keywordflow">if</span> (c_crypt_protected_headers_write)</div>
<div class="line"><span class="lineno">  271</span>  {</div>
<div class="line"><span class="lineno">  272</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_devel_security = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;devel_security&quot;</span>);</div>
<div class="line"><span class="lineno">  273</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structEnvelope.html">Envelope</a> *protected_headers = <a class="code hl_function" href="envelope_8c.html#a406e6f76001e7604ce65ffe972fc19c1">mutt_env_new</a>();</div>
<div class="line"><span class="lineno">  274</span>    <a class="code hl_function" href="envelope_8c.html#a91c00f700ee3ca43aa33487591b0d317">mutt_env_set_subject</a>(protected_headers, e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">subject</a>);</div>
<div class="line"><span class="lineno">  275</span>    <span class="keywordflow">if</span> (c_devel_security)</div>
<div class="line"><span class="lineno">  276</span>    {</div>
<div class="line"><span class="lineno">  277</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a1c204b091d782098fc1efa0c2f3b1e20">return_path</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a1c204b091d782098fc1efa0c2f3b1e20">return_path</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  278</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  279</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a2d927371b3b80e025d6f7522b7361fe7">to</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  280</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a6b00837b3cb4b41898b42307135be8b6">cc</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  281</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a72ee5c0af4f94f83aeb8d31183261611">sender</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  282</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">reply_to</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  283</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>,</div>
<div class="line"><span class="lineno">  284</span>                         &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">mail_followup_to</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  285</span>      <a class="code hl_function" href="address_2address_8c.html#a16764dc80c9b3f6ad2897c8b7e59bd10">mutt_addrlist_copy</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">x_original_to</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">x_original_to</a>, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  286</span>      <a class="code hl_function" href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a>, e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">message_id</a>);</div>
<div class="line"><span class="lineno">  287</span>      <a class="code hl_function" href="list_8c.html#a3df8a4dc742babace631d82e71321678">mutt_list_copy_tail</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">references</a>);</div>
<div class="line"><span class="lineno">  288</span>      <a class="code hl_function" href="list_8c.html#a3df8a4dc742babace631d82e71321678">mutt_list_copy_tail</a>(&amp;protected_headers-&gt;<a class="code hl_variable" href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">in_reply_to</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">in_reply_to</a>);</div>
<div class="line"><span class="lineno">  289</span>      <a class="code hl_function" href="envelope_8c.html#a0108f989ca58622df272cf31b610395e">mutt_env_to_intl</a>(protected_headers, NULL, NULL);</div>
<div class="line"><span class="lineno">  290</span>    }</div>
<div class="line"><span class="lineno">  291</span>    <a class="code hl_function" href="sendlib_8c.html#ac35da3d19eb0d95d4f6260adab57b4c9">mutt_prepare_envelope</a>(protected_headers, 0, <a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>);</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    <a class="code hl_function" href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>);</div>
<div class="line"><span class="lineno">  294</span>    e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a> = protected_headers;</div>
<div class="line"><span class="lineno">  295</span>    <a class="code hl_function" href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protected-headers&quot;</span>, <span class="stringliteral">&quot;v1&quot;</span>);</div>
<div class="line"><span class="lineno">  296</span>  }</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span><span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div>
<div class="line"><span class="lineno">  299</span>  <span class="comment">/* A note about e-&gt;body-&gt;mime_headers.  If postpone or send</span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">   * fails, the mime_headers is cleared out before returning to the</span></div>
<div class="line"><span class="lineno">  301</span><span class="comment">   * compose menu.  So despite the &quot;robustness&quot; code above and in the</span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">   * gen_gossip_list function below, mime_headers will not be set when</span></div>
<div class="line"><span class="lineno">  303</span><span class="comment">   * entering mutt_protect().</span></div>
<div class="line"><span class="lineno">  304</span><span class="comment">   *</span></div>
<div class="line"><span class="lineno">  305</span><span class="comment">   * This is important to note because the user could toggle</span></div>
<div class="line"><span class="lineno">  306</span><span class="comment">   * $crypt_protected_headers_write or $autocrypt off back in the</span></div>
<div class="line"><span class="lineno">  307</span><span class="comment">   * compose menu.  We don&#39;t want mutt_rfc822_write_header() to write</span></div>
<div class="line"><span class="lineno">  308</span><span class="comment">   * stale data from one option if the other is set.</span></div>
<div class="line"><span class="lineno">  309</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  310</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_autocrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;autocrypt&quot;</span>);</div>
<div class="line"><span class="lineno">  311</span>  <span class="keywordflow">if</span> (c_autocrypt &amp;&amp; !postpone &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>))</div>
<div class="line"><span class="lineno">  312</span>  {</div>
<div class="line"><span class="lineno">  313</span>    <a class="code hl_function" href="autocrypt_8c.html#a30461121efab5b3f112767d63191c507">mutt_autocrypt_generate_gossip_list</a>(e);</div>
<div class="line"><span class="lineno">  314</span>  }</div>
<div class="line"><span class="lineno">  315</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>  <span class="keywordflow">if</span> (sign)</div>
<div class="line"><span class="lineno">  318</span>  {</div>
<div class="line"><span class="lineno">  319</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno">  320</span>    {</div>
<div class="line"><span class="lineno">  321</span>      tmp_pbody = <a class="code hl_function" href="cryptglue_8c.html#a1f1953623a760a5e61931e08dec39b96">crypt_smime_sign_message</a>(e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div>
<div class="line"><span class="lineno">  322</span>      <span class="keywordflow">if</span> (!tmp_pbody)</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  324</span>      pbody = tmp_pbody;</div>
<div class="line"><span class="lineno">  325</span>      tmp_smime_pbody = tmp_pbody;</div>
<div class="line"><span class="lineno">  326</span>    }</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> c_pgp_retainable_sigs = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;pgp_retainable_sigs&quot;</span>);</div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  330</span>        (!(security &amp; (<a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)) || c_pgp_retainable_sigs))</div>
<div class="line"><span class="lineno">  331</span>    {</div>
<div class="line"><span class="lineno">  332</span>      tmp_pbody = <a class="code hl_function" href="cryptglue_8c.html#a4e9129743f94b5324f1e4d3ed46db412">crypt_pgp_sign_message</a>(e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div>
<div class="line"><span class="lineno">  333</span>      <span class="keywordflow">if</span> (!tmp_pbody)</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>      has_retainable_sig = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  337</span>      sign = <a class="code hl_define" href="ncrypt_2lib_8h.html#a95845954210adfc850d5602843f858d4">SEC_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno">  338</span>      pbody = tmp_pbody;</div>
<div class="line"><span class="lineno">  339</span>      tmp_pgp_pbody = tmp_pbody;</div>
<div class="line"><span class="lineno">  340</span>    }</div>
<div class="line"><span class="lineno">  341</span>  }</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>  <span class="keywordflow">if</span> (security &amp; (<a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>))</div>
<div class="line"><span class="lineno">  344</span>  {</div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno">  346</span>    {</div>
<div class="line"><span class="lineno">  347</span>      tmp_pbody = <a class="code hl_function" href="cryptglue_8c.html#a1cc54e2b04340367de82a07781ab68a2">crypt_smime_build_smime_entity</a>(tmp_smime_pbody, keylist);</div>
<div class="line"><span class="lineno">  348</span>      <span class="keywordflow">if</span> (!tmp_pbody)</div>
<div class="line"><span class="lineno">  349</span>      {</div>
<div class="line"><span class="lineno">  350</span>        <span class="comment">/* signed ? free it! */</span></div>
<div class="line"><span class="lineno">  351</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  352</span>      }</div>
<div class="line"><span class="lineno">  353</span>      <span class="comment">/* free tmp_body if messages was signed AND encrypted ... */</span></div>
<div class="line"><span class="lineno">  354</span>      <span class="keywordflow">if</span> ((tmp_smime_pbody != e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>) &amp;&amp; (tmp_smime_pbody != tmp_pbody))</div>
<div class="line"><span class="lineno">  355</span>      {</div>
<div class="line"><span class="lineno">  356</span>        <span class="comment">/* detach and don&#39;t delete e-&gt;body,</span></div>
<div class="line"><span class="lineno">  357</span><span class="comment">         * which tmp_smime_pbody-&gt;parts after signing. */</span></div>
<div class="line"><span class="lineno">  358</span>        tmp_smime_pbody-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a> = tmp_smime_pbody-&gt;<a class="code hl_variable" href="structBody.html#a0b87b7bdb6faef44d9aac4854975f805">parts</a>-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>;</div>
<div class="line"><span class="lineno">  359</span>        e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a> = NULL;</div>
<div class="line"><span class="lineno">  360</span>        <a class="code hl_function" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;tmp_smime_pbody);</div>
<div class="line"><span class="lineno">  361</span>      }</div>
<div class="line"><span class="lineno">  362</span>      pbody = tmp_pbody;</div>
<div class="line"><span class="lineno">  363</span>    }</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>    <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (security &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  366</span>    {</div>
<div class="line"><span class="lineno">  367</span>      pbody = <a class="code hl_function" href="cryptglue_8c.html#ae2ebaf8e03c2029af925d234447a74d9">crypt_pgp_encrypt_message</a>(e, tmp_pgp_pbody, keylist, sign, &amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a34cc4493729d7a3b1f4ed783e739a9ec">env</a>-&gt;<a class="code hl_variable" href="structEnvelope.html#af1aa00aed4b8767cf98f08e45a432ad8">from</a>);</div>
<div class="line"><span class="lineno">  368</span>      <span class="keywordflow">if</span> (!pbody)</div>
<div class="line"><span class="lineno">  369</span>      {</div>
<div class="line"><span class="lineno">  370</span>        <span class="comment">/* did we perform a retainable signature? */</span></div>
<div class="line"><span class="lineno">  371</span>        <span class="keywordflow">if</span> (has_retainable_sig)</div>
<div class="line"><span class="lineno">  372</span>        {</div>
<div class="line"><span class="lineno">  373</span>          <span class="comment">/* remove the outer multipart layer */</span></div>
<div class="line"><span class="lineno">  374</span>          tmp_pgp_pbody = <a class="code hl_function" href="multipart_8c.html#a294249634f22cab1bce592ca8602c5ec">mutt_remove_multipart</a>(tmp_pgp_pbody);</div>
<div class="line"><span class="lineno">  375</span>          <span class="comment">/* get rid of the signature */</span></div>
<div class="line"><span class="lineno">  376</span>          <a class="code hl_function" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;tmp_pgp_pbody-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>);</div>
<div class="line"><span class="lineno">  377</span>        }</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>        <span class="keywordflow">goto</span> bail;</div>
<div class="line"><span class="lineno">  380</span>      }</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>      <span class="comment">// destroy temporary signature envelope when doing retainable signatures.</span></div>
<div class="line"><span class="lineno">  383</span>      <span class="keywordflow">if</span> (has_retainable_sig)</div>
<div class="line"><span class="lineno">  384</span>      {</div>
<div class="line"><span class="lineno">  385</span>        tmp_pgp_pbody = <a class="code hl_function" href="multipart_8c.html#a294249634f22cab1bce592ca8602c5ec">mutt_remove_multipart</a>(tmp_pgp_pbody);</div>
<div class="line"><span class="lineno">  386</span>        <a class="code hl_function" href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a>(&amp;tmp_pgp_pbody-&gt;<a class="code hl_variable" href="structBody.html#ac55cdfce46eed13151dcfe9b329d254c">next</a>);</div>
<div class="line"><span class="lineno">  387</span>      }</div>
<div class="line"><span class="lineno">  388</span>    }</div>
<div class="line"><span class="lineno">  389</span>  }</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>  <span class="keywordflow">if</span> (pbody)</div>
<div class="line"><span class="lineno">  392</span>  {</div>
<div class="line"><span class="lineno">  393</span>    e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a> = pbody;</div>
<div class="line"><span class="lineno">  394</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  395</span>  }</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>bail:</div>
<div class="line"><span class="lineno">  398</span>  <a class="code hl_function" href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">mime_headers</a>);</div>
<div class="line"><span class="lineno">  399</span>  <a class="code hl_function" href="parameter_8c.html#a34454ee6af9d43eeabf80898dc7270b8">mutt_param_delete</a>(&amp;e-&gt;<a class="code hl_variable" href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">body</a>-&gt;<a class="code hl_variable" href="structBody.html#a782cee95e0064e3895b88248bdfc781a">parameter</a>, <span class="stringliteral">&quot;protected-headers&quot;</span>);</div>
<div class="line"><span class="lineno">  400</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  401</span>}</div>
<div class="ttc" id="aaddress_2address_8c_html_a40eda06e6e64ff9d9f1e7d3b69e7c846"><div class="ttname"><a href="address_2address_8c.html#a40eda06e6e64ff9d9f1e7d3b69e7c846">mutt_addr_free</a></div><div class="ttdeci">void mutt_addr_free(struct Address **ptr)</div><div class="ttdoc">Free a single Address.</div><div class="ttdef"><b>Definition:</b> <a href="address_2address_8c_source.html#l00462">address.c:462</a></div></div>
<div class="ttc" id="aaddress_2config__type_8c_html_ae303ac83498043a651ec046b572bc707"><div class="ttname"><a href="address_2config__type_8c.html#ae303ac83498043a651ec046b572bc707">cs_subset_address</a></div><div class="ttdeci">const struct Address * cs_subset_address(const struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Get an Address config item by name.</div><div class="ttdef"><b>Definition:</b> <a href="address_2config__type_8c_source.html#l00286">config_type.c:286</a></div></div>
<div class="ttc" id="aautocrypt_8c_html_a30461121efab5b3f112767d63191c507"><div class="ttname"><a href="autocrypt_8c.html#a30461121efab5b3f112767d63191c507">mutt_autocrypt_generate_gossip_list</a></div><div class="ttdeci">int mutt_autocrypt_generate_gossip_list(struct Email *e)</div><div class="ttdoc">Create the gossip list headers.</div><div class="ttdef"><b>Definition:</b> <a href="autocrypt_8c_source.html#l00823">autocrypt.c:823</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a1cc54e2b04340367de82a07781ab68a2"><div class="ttname"><a href="cryptglue_8c.html#a1cc54e2b04340367de82a07781ab68a2">crypt_smime_build_smime_entity</a></div><div class="ttdeci">struct Body * crypt_smime_build_smime_entity(struct Body *b, char *certlist)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::smime_build_smime_entity()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00496">cryptglue.c:496</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a1f1953623a760a5e61931e08dec39b96"><div class="ttname"><a href="cryptglue_8c.html#a1f1953623a760a5e61931e08dec39b96">crypt_smime_sign_message</a></div><div class="ttdeci">struct Body * crypt_smime_sign_message(struct Body *b, const struct AddressList *from)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::sign_message()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00485">cryptglue.c:485</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a3458a0bbc46b247f9dd5ea63d1e9231f"><div class="ttname"><a href="cryptglue_8c.html#a3458a0bbc46b247f9dd5ea63d1e9231f">crypt_pgp_traditional_encryptsign</a></div><div class="ttdeci">struct Body * crypt_pgp_traditional_encryptsign(struct Body *b, SecurityFlags flags, char *keylist)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_traditional_encryptsign()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00293">cryptglue.c:293</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a4e9129743f94b5324f1e4d3ed46db412"><div class="ttname"><a href="cryptglue_8c.html#a4e9129743f94b5324f1e4d3ed46db412">crypt_pgp_sign_message</a></div><div class="ttdeci">struct Body * crypt_pgp_sign_message(struct Body *b, const struct AddressList *from)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::sign_message()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00326">cryptglue.c:326</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a9f42f50373941a87a03df3424ce1b7c4"><div class="ttname"><a href="cryptglue_8c.html#a9f42f50373941a87a03df3424ce1b7c4">crypt_pgp_set_sender</a></div><div class="ttdeci">void crypt_pgp_set_sender(const char *sender)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::set_sender()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00403">cryptglue.c:403</a></div></div>
<div class="ttc" id="acryptglue_8c_html_a9f57744c7bcac595aa1a8838f83dc369"><div class="ttname"><a href="cryptglue_8c.html#a9f57744c7bcac595aa1a8838f83dc369">crypt_smime_set_sender</a></div><div class="ttdeci">void crypt_smime_set_sender(const char *sender)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::set_sender()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00538">cryptglue.c:538</a></div></div>
<div class="ttc" id="acryptglue_8c_html_ae2ebaf8e03c2029af925d234447a74d9"><div class="ttname"><a href="cryptglue_8c.html#ae2ebaf8e03c2029af925d234447a74d9">crypt_pgp_encrypt_message</a></div><div class="ttdeci">struct Body * crypt_pgp_encrypt_message(struct Email *e, struct Body *b, char *keylist, int sign, const struct AddressList *from)</div><div class="ttdoc">Wrapper for CryptModuleSpecs::pgp_encrypt_message()</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00337">cryptglue.c:337</a></div></div>
<div class="ttc" id="aemail_2body_8c_html_a129af1c316fcbc26b55fb48957bab2cb"><div class="ttname"><a href="email_2body_8c.html#a129af1c316fcbc26b55fb48957bab2cb">mutt_body_free</a></div><div class="ttdeci">void mutt_body_free(struct Body **ptr)</div><div class="ttdoc">Free a Body.</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8c_source.html#l00058">body.c:58</a></div></div>
<div class="ttc" id="aenvelope_8c_html_a0108f989ca58622df272cf31b610395e"><div class="ttname"><a href="envelope_8c.html#a0108f989ca58622df272cf31b610395e">mutt_env_to_intl</a></div><div class="ttdeci">int mutt_env_to_intl(struct Envelope *env, const char **tag, char **err)</div><div class="ttdoc">Convert an Envelope's Address fields to Punycode format.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8c_source.html#l00355">envelope.c:355</a></div></div>
<div class="ttc" id="aenvelope_8c_html_a244dacf9b1001c9ce1dbd473e001381f"><div class="ttname"><a href="envelope_8c.html#a244dacf9b1001c9ce1dbd473e001381f">mutt_env_free</a></div><div class="ttdeci">void mutt_env_free(struct Envelope **ptr)</div><div class="ttdoc">Free an Envelope.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8c_source.html#l00126">envelope.c:126</a></div></div>
<div class="ttc" id="aenvelope_8c_html_a406e6f76001e7604ce65ffe972fc19c1"><div class="ttname"><a href="envelope_8c.html#a406e6f76001e7604ce65ffe972fc19c1">mutt_env_new</a></div><div class="ttdeci">struct Envelope * mutt_env_new(void)</div><div class="ttdoc">Create a new Envelope.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8c_source.html#l00046">envelope.c:46</a></div></div>
<div class="ttc" id="aenvelope_8c_html_a91c00f700ee3ca43aa33487591b0d317"><div class="ttname"><a href="envelope_8c.html#a91c00f700ee3ca43aa33487591b0d317">mutt_env_set_subject</a></div><div class="ttdeci">void mutt_env_set_subject(struct Envelope *env, const char *subj)</div><div class="ttdoc">Set both subject and real_subj to subj.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8c_source.html#l00069">envelope.c:69</a></div></div>
<div class="ttc" id="agroup__logging__api_html_gacc1fd6d7ab1603e80e11e84e90d061e4"><div class="ttname"><a href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a></div><div class="ttdeci">#define mutt_error(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging2_8h_source.html#l00093">logging2.h:93</a></div></div>
<div class="ttc" id="alist_8c_html_a3df8a4dc742babace631d82e71321678"><div class="ttname"><a href="list_8c.html#a3df8a4dc742babace631d82e71321678">mutt_list_copy_tail</a></div><div class="ttdeci">void mutt_list_copy_tail(struct ListHead *dst, const struct ListHead *src)</div><div class="ttdoc">Copy a list into another list.</div><div class="ttdef"><b>Definition:</b> <a href="list_8c_source.html#l00275">list.c:275</a></div></div>
<div class="ttc" id="amultipart_8c_html_a294249634f22cab1bce592ca8602c5ec"><div class="ttname"><a href="multipart_8c.html#a294249634f22cab1bce592ca8602c5ec">mutt_remove_multipart</a></div><div class="ttdeci">struct Body * mutt_remove_multipart(struct Body *b)</div><div class="ttdoc">Extract the multipart body if it exists.</div><div class="ttdef"><b>Definition:</b> <a href="multipart_8c_source.html#l00126">multipart.c:126</a></div></div>
<div class="ttc" id="amutt_2string_8c_html_af8c32ffc64dd55e92001a974a4be6bbf"><div class="ttname"><a href="mutt_2string_8c.html#af8c32ffc64dd55e92001a974a4be6bbf">mutt_str_replace</a></div><div class="ttdeci">char * mutt_str_replace(char **p, const char *s)</div><div class="ttdoc">Replace one string with another.</div><div class="ttdef"><b>Definition:</b> <a href="mutt_2string_8c_source.html#l00282">string.c:282</a></div></div>
<div class="ttc" id="aparameter_8c_html_a34454ee6af9d43eeabf80898dc7270b8"><div class="ttname"><a href="parameter_8c.html#a34454ee6af9d43eeabf80898dc7270b8">mutt_param_delete</a></div><div class="ttdeci">void mutt_param_delete(struct ParameterList *pl, const char *attribute)</div><div class="ttdoc">Delete a matching Parameter.</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00143">parameter.c:143</a></div></div>
<div class="ttc" id="aparameter_8c_html_a42249fc15b1e52df046a0a10de29da44"><div class="ttname"><a href="parameter_8c.html#a42249fc15b1e52df046a0a10de29da44">mutt_param_set</a></div><div class="ttdeci">void mutt_param_set(struct ParameterList *pl, const char *attribute, const char *value)</div><div class="ttdoc">Set a Parameter.</div><div class="ttdef"><b>Definition:</b> <a href="parameter_8c_source.html#l00111">parameter.c:111</a></div></div>
<div class="ttc" id="aquestion_2lib_8h_html_a8ba883bf53e8ab425a03d17368de84b4"><div class="ttname"><a href="question_2lib_8h.html#a8ba883bf53e8ab425a03d17368de84b4">query_quadoption</a></div><div class="ttdeci">enum QuadOption query_quadoption(const char *prompt, struct ConfigSubset *sub, const char *name)</div><div class="ttdoc">Ask the user a quad-question.</div><div class="ttdef"><b>Definition:</b> <a href="question_8c_source.html#l00378">question.c:378</a></div></div>
<div class="ttc" id="asend_8c_html_a90907de4e46f3a56b2889b79a48c9011"><div class="ttname"><a href="send_8c.html#a90907de4e46f3a56b2889b79a48c9011">mutt_default_from</a></div><div class="ttdeci">struct Address * mutt_default_from(struct ConfigSubset *sub)</div><div class="ttdoc">Get a default 'from' Address.</div><div class="ttdef"><b>Definition:</b> <a href="send_8c_source.html#l01393">send.c:1393</a></div></div>
<div class="ttc" id="asendlib_8c_html_ac35da3d19eb0d95d4f6260adab57b4c9"><div class="ttname"><a href="sendlib_8c.html#ac35da3d19eb0d95d4f6260adab57b4c9">mutt_prepare_envelope</a></div><div class="ttdeci">void mutt_prepare_envelope(struct Envelope *env, bool final, struct ConfigSubset *sub)</div><div class="ttdoc">Prepare an email header.</div><div class="ttdef"><b>Definition:</b> <a href="sendlib_8c_source.html#l00779">sendlib.c:779</a></div></div>
<div class="ttc" id="astructAddress_html"><div class="ttname"><a href="structAddress.html">Address</a></div><div class="ttdoc">An email address.</div><div class="ttdef"><b>Definition:</b> <a href="address_8h_source.html#l00035">address.h:36</a></div></div>
<div class="ttc" id="astructAddress_html_a45cd47ee76ef04b63f55a0345c691fe8"><div class="ttname"><a href="structAddress.html#a45cd47ee76ef04b63f55a0345c691fe8">Address::mailbox</a></div><div class="ttdeci">struct Buffer * mailbox</div><div class="ttdoc">Mailbox and host address.</div><div class="ttdef"><b>Definition:</b> <a href="address_8h_source.html#l00038">address.h:38</a></div></div>
<div class="ttc" id="astructBody_html"><div class="ttname"><a href="structBody.html">Body</a></div><div class="ttdoc">The body of an email.</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00035">body.h:36</a></div></div>
<div class="ttc" id="astructBody_html_a62f6c9b4245ed3b6b9296adb45aa4010"><div class="ttname"><a href="structBody.html#a62f6c9b4245ed3b6b9296adb45aa4010">Body::mime_headers</a></div><div class="ttdeci">struct Envelope * mime_headers</div><div class="ttdoc">Memory hole protected headers.</div><div class="ttdef"><b>Definition:</b> <a href="email_2body_8h_source.html#l00076">body.h:76</a></div></div>
<div class="ttc" id="astructEmail_html_a57ad6ac618c0f685804f6f5bb390b3a6"><div class="ttname"><a href="structEmail.html#a57ad6ac618c0f685804f6f5bb390b3a6">Email::body</a></div><div class="ttdeci">struct Body * body</div><div class="ttdoc">List of MIME parts.</div><div class="ttdef"><b>Definition:</b> <a href="email_8h_source.html#l00069">email.h:69</a></div></div>
<div class="ttc" id="astructEnvelope_html"><div class="ttname"><a href="structEnvelope.html">Envelope</a></div><div class="ttdoc">The header of an Email.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00056">envelope.h:57</a></div></div>
<div class="ttc" id="astructEnvelope_html_a1c204b091d782098fc1efa0c2f3b1e20"><div class="ttname"><a href="structEnvelope.html#a1c204b091d782098fc1efa0c2f3b1e20">Envelope::return_path</a></div><div class="ttdeci">struct AddressList return_path</div><div class="ttdoc">Return path for the Email.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00058">envelope.h:58</a></div></div>
<div class="ttc" id="astructEnvelope_html_a20d5ccf675db375e011a7791151fa09d"><div class="ttname"><a href="structEnvelope.html#a20d5ccf675db375e011a7791151fa09d">Envelope::subject</a></div><div class="ttdeci">char *const subject</div><div class="ttdoc">Email's subject.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00070">envelope.h:70</a></div></div>
<div class="ttc" id="astructEnvelope_html_a4b75ab1853f95878dec079371bb0d799"><div class="ttname"><a href="structEnvelope.html#a4b75ab1853f95878dec079371bb0d799">Envelope::reply_to</a></div><div class="ttdeci">struct AddressList reply_to</div><div class="ttdoc">Email's 'reply-to'.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00064">envelope.h:64</a></div></div>
<div class="ttc" id="astructEnvelope_html_a50418c13a849bf27b22922bd5867e5e1"><div class="ttname"><a href="structEnvelope.html#a50418c13a849bf27b22922bd5867e5e1">Envelope::message_id</a></div><div class="ttdeci">char * message_id</div><div class="ttdoc">Message ID.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00073">envelope.h:73</a></div></div>
<div class="ttc" id="astructEnvelope_html_a525bd5213606067d5c2be2e17fbe956b"><div class="ttname"><a href="structEnvelope.html#a525bd5213606067d5c2be2e17fbe956b">Envelope::x_original_to</a></div><div class="ttdeci">struct AddressList x_original_to</div><div class="ttdoc">Email's 'X-Original-to'.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00066">envelope.h:66</a></div></div>
<div class="ttc" id="astructEnvelope_html_a6044b60220b8029a6a505e5b61f1cadc"><div class="ttname"><a href="structEnvelope.html#a6044b60220b8029a6a505e5b61f1cadc">Envelope::mail_followup_to</a></div><div class="ttdeci">struct AddressList mail_followup_to</div><div class="ttdoc">Email's 'mail-followup-to'.</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00065">envelope.h:65</a></div></div>
<div class="ttc" id="astructEnvelope_html_a832eec73356a806761e26f0bc40d9083"><div class="ttname"><a href="structEnvelope.html#a832eec73356a806761e26f0bc40d9083">Envelope::references</a></div><div class="ttdeci">struct ListHead references</div><div class="ttdoc">message references (in reverse order)</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00083">envelope.h:83</a></div></div>
<div class="ttc" id="astructEnvelope_html_a9ae6d450b2f012c37d3350f4305fbb90"><div class="ttname"><a href="structEnvelope.html#a9ae6d450b2f012c37d3350f4305fbb90">Envelope::in_reply_to</a></div><div class="ttdeci">struct ListHead in_reply_to</div><div class="ttdoc">in-reply-to header content</div><div class="ttdef"><b>Definition:</b> <a href="envelope_8h_source.html#l00084">envelope.h:84</a></div></div>
</div><!-- fragment --><div id="dynsection-25" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a896502d4448fefadaf8786a4f2d5556e_cgraph.svg" width="718" height="1532"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-26" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a896502d4448fefadaf8786a4f2d5556e_icgraph.svg" width="502" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a52c65477f5b80ad3dc8028663653771d" name="a52c65477f5b80ad3dc8028663653771d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52c65477f5b80ad3dc8028663653771d">&#9670;&#160;</a></span>mutt_should_hide_protected_subject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mutt_should_hide_protected_subject </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Should <a class="el" href="structNeoMutt.html" title="Container for Accounts, Notifications.">NeoMutt</a> hide the protected subject? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td><a class="el" href="structEmail.html" title="The envelope/body of an email.">Email</a> to test </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>The subject should be protected </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt_8c_source.html#l01101">1101</a> of file <a class="el" href="crypt_8c_source.html">crypt.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1102</span>{</div>
<div class="line"><span class="lineno"> 1103</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_protected_headers_write = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_protected_headers_write&quot;</span>);</div>
<div class="line"><span class="lineno"> 1104</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> c_crypt_protected_headers_subject =</div>
<div class="line"><span class="lineno"> 1105</span>      <a class="code hl_function" href="config_2helpers_8c.html#a6b1589ee93ff51ef31f1d9324e138078">cs_subset_string</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_protected_headers_subject&quot;</span>);</div>
<div class="line"><span class="lineno"> 1106</span>  <span class="keywordflow">if</span> (c_crypt_protected_headers_write &amp;&amp; (e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; (<a class="code hl_define" href="ncrypt_2lib_8h.html#aacaa4abd4c0696e260b7a0f1d466360a">SEC_ENCRYPT</a> | <a class="code hl_define" href="ncrypt_2lib_8h.html#a0b36be5c32ca90d8f2caef9ea9d627fc">SEC_AUTOCRYPT</a>)) &amp;&amp;</div>
<div class="line"><span class="lineno"> 1107</span>      !(e-&gt;<a class="code hl_variable" href="structEmail.html#a570a81cd747437c9ea4357947731ae10">security</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a>) &amp;&amp; c_crypt_protected_headers_subject)</div>
<div class="line"><span class="lineno"> 1108</span>  {</div>
<div class="line"><span class="lineno"> 1109</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1110</span>  }</div>
<div class="line"><span class="lineno"> 1111</span> </div>
<div class="line"><span class="lineno"> 1112</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1113</span>}</div>
<div class="ttc" id="ancrypt_2lib_8h_html_a074f827472ad45f11ec1132cdfed2daf"><div class="ttname"><a href="ncrypt_2lib_8h.html#a074f827472ad45f11ec1132cdfed2daf">SEC_INLINE</a></div><div class="ttdeci">#define SEC_INLINE</div><div class="ttdoc">Email has an inline signature.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00091">lib.h:91</a></div></div>
</div><!-- fragment --><div id="dynsection-27" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a52c65477f5b80ad3dc8028663653771d_cgraph.svg" width="380" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-28" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a52c65477f5b80ad3dc8028663653771d_icgraph.svg" width="371" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a397940a79b0c75800fed7d264f7fd6b4" name="a397940a79b0c75800fed7d264f7fd6b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a397940a79b0c75800fed7d264f7fd6b4">&#9670;&#160;</a></span>crypt_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_cleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean up backend. </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00141">141</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  142</span>{</div>
<div class="line"><span class="lineno">  143</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, cleanup))</div>
<div class="line"><span class="lineno">  144</span>    (<a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, cleanup))();</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, cleanup))</div>
<div class="line"><span class="lineno">  147</span>    (<a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, cleanup))();</div>
<div class="line"><span class="lineno">  148</span>}</div>
<div class="ttc" id="acryptglue_8c_html_a69a7f3b98b67a0831a8a5e3fc47d5c93"><div class="ttname"><a href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a></div><div class="ttdeci">#define CRYPT_MOD_CALL_CHECK(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00079">cryptglue.c:79</a></div></div>
<div class="ttc" id="acryptglue_8c_html_acaf721ab817757c241a5abd18fc8618b"><div class="ttname"><a href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a></div><div class="ttdeci">#define CRYPT_MOD_CALL(identifier, func)</div><div class="ttdef"><b>Definition:</b> <a href="cryptglue_8c_source.html#l00085">cryptglue.c:85</a></div></div>
</div><!-- fragment --><div id="dynsection-29" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a397940a79b0c75800fed7d264f7fd6b4_icgraph.svg" width="219" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a07a6c891658dd90ef8333a1e5bbcc285" name="a07a6c891658dd90ef8333a1e5bbcc285"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07a6c891658dd90ef8333a1e5bbcc285">&#9670;&#160;</a></span>crypt_has_module_backend()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool crypt_has_module_backend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Is there a crypto backend for a given type? </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Crypto type, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT.">SecurityFlags</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>Backend is present </td></tr>
    <tr><td class="paramname">false</td><td>Backend is not present </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00170">170</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  171</span>{</div>
<div class="line"><span class="lineno">  172</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (type &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  173</span>      <a class="code hl_function" href="crypt__mod_8c.html#a1f102fb7d3fd9928a89b854ed0c0a44a">crypto_module_lookup</a>(<a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  174</span>  {</div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  176</span>  }</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (type &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) &amp;&amp;</div>
<div class="line"><span class="lineno">  179</span>      <a class="code hl_function" href="crypt__mod_8c.html#a1f102fb7d3fd9928a89b854ed0c0a44a">crypto_module_lookup</a>(<a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno">  180</span>  {</div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  182</span>  }</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  185</span>}</div>
<div class="ttc" id="acrypt__mod_8c_html_a1f102fb7d3fd9928a89b854ed0c0a44a"><div class="ttname"><a href="crypt__mod_8c.html#a1f102fb7d3fd9928a89b854ed0c0a44a">crypto_module_lookup</a></div><div class="ttdeci">const struct CryptModuleSpecs * crypto_module_lookup(int identifier)</div><div class="ttdoc">Lookup a crypto module by name.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod_8c_source.html#l00068">crypt_mod.c:68</a></div></div>
</div><!-- fragment --><div id="dynsection-30" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-30-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-30-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-30-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a07a6c891658dd90ef8333a1e5bbcc285_cgraph.svg" width="414" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-31" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-31-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-31-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-31-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a07a6c891658dd90ef8333a1e5bbcc285_icgraph.svg" width="440" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aaecf706c319966f9eafd582b58ba531f" name="aaecf706c319966f9eafd582b58ba531f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaecf706c319966f9eafd582b58ba531f">&#9670;&#160;</a></span>crypt_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the crypto backends. </p>
<p>This calls <a class="el" href="structCryptModuleSpecs.html#a819c87369b2dc3806d846c3a7e9fb7b6">CryptModuleSpecs::init()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00093">93</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>{</div>
<div class="line"><span class="lineno">   95</span><span class="preprocessor">#ifdef CRYPT_BACKEND_GPGME</span></div>
<div class="line"><span class="lineno">   96</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_crypt_use_gpgme = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;crypt_use_gpgme&quot;</span>);</div>
<div class="line"><span class="lineno">   97</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   98</span><span class="preprocessor">#ifdef CRYPT_BACKEND_CLASSIC_PGP</span></div>
<div class="line"><span class="lineno">   99</span>  <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno">  100</span>#ifdef CRYPT_BACKEND_GPGME</div>
<div class="line"><span class="lineno">  101</span>      (!c_crypt_use_gpgme)</div>
<div class="line"><span class="lineno">  102</span>#<span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  103</span>      1</div>
<div class="line"><span class="lineno">  104</span>#endif</div>
<div class="line"><span class="lineno">  105</span>  )</div>
<div class="line"><span class="lineno">  106</span>    <a class="code hl_function" href="crypt__mod_8c.html#a513ba46e8a0671d5d5c80f8379f99bcf">crypto_module_register</a>(&amp;<a class="code hl_variable" href="group__crypto__api.html#ga9938cbc74b33ff75be208a4d2d26121a">CryptModPgpClassic</a>);</div>
<div class="line"><span class="lineno">  107</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span><span class="preprocessor">#ifdef CRYPT_BACKEND_CLASSIC_SMIME</span></div>
<div class="line"><span class="lineno">  110</span>  <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno">  111</span>#ifdef CRYPT_BACKEND_GPGME</div>
<div class="line"><span class="lineno">  112</span>      (!c_crypt_use_gpgme)</div>
<div class="line"><span class="lineno">  113</span>#<span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  114</span>      1</div>
<div class="line"><span class="lineno">  115</span>#endif</div>
<div class="line"><span class="lineno">  116</span>  )</div>
<div class="line"><span class="lineno">  117</span>    <a class="code hl_function" href="crypt__mod_8c.html#a513ba46e8a0671d5d5c80f8379f99bcf">crypto_module_register</a>(&amp;<a class="code hl_variable" href="group__crypto__api.html#ga499a72d2fd05f50e46774c5969964835">CryptModSmimeClassic</a>);</div>
<div class="line"><span class="lineno">  118</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span><span class="preprocessor">#ifdef CRYPT_BACKEND_GPGME</span></div>
<div class="line"><span class="lineno">  121</span>  <span class="keywordflow">if</span> (c_crypt_use_gpgme)</div>
<div class="line"><span class="lineno">  122</span>  {</div>
<div class="line"><span class="lineno">  123</span>    <a class="code hl_function" href="crypt__mod_8c.html#a513ba46e8a0671d5d5c80f8379f99bcf">crypto_module_register</a>(&amp;<a class="code hl_variable" href="group__crypto__api.html#ga808d0d336f52e42a5b9da3762aff4f0c">CryptModPgpGpgme</a>);</div>
<div class="line"><span class="lineno">  124</span>    <a class="code hl_function" href="crypt__mod_8c.html#a513ba46e8a0671d5d5c80f8379f99bcf">crypto_module_register</a>(&amp;<a class="code hl_variable" href="group__crypto__api.html#ga25940e46039d9c3c99c4c95f064ef06c">CryptModSmimeGpgme</a>);</div>
<div class="line"><span class="lineno">  125</span>  }</div>
<div class="line"><span class="lineno">  126</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span><span class="preprocessor">#if defined(CRYPT_BACKEND_CLASSIC_PGP) ||                                      \</span></div>
<div class="line"><span class="lineno">  129</span><span class="preprocessor">    defined(CRYPT_BACKEND_CLASSIC_SMIME) || defined(CRYPT_BACKEND_GPGME)</span></div>
<div class="line"><span class="lineno">  130</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, init))</div>
<div class="line"><span class="lineno">  131</span>    <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, init)();</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, init))</div>
<div class="line"><span class="lineno">  134</span>    <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, init)();</div>
<div class="line"><span class="lineno">  135</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  136</span>}</div>
<div class="ttc" id="acrypt__mod_8c_html_a513ba46e8a0671d5d5c80f8379f99bcf"><div class="ttname"><a href="crypt__mod_8c.html#a513ba46e8a0671d5d5c80f8379f99bcf">crypto_module_register</a></div><div class="ttdeci">void crypto_module_register(const struct CryptModuleSpecs *specs)</div><div class="ttdoc">Register a new crypto module.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod_8c_source.html#l00054">crypt_mod.c:54</a></div></div>
<div class="ttc" id="agroup__crypto__api_html_ga25940e46039d9c3c99c4c95f064ef06c"><div class="ttname"><a href="group__crypto__api.html#ga25940e46039d9c3c99c4c95f064ef06c">CryptModSmimeGpgme</a></div><div class="ttdeci">const struct CryptModuleSpecs CryptModSmimeGpgme</div><div class="ttdoc">GPGME SMIME - Implements CryptModuleSpecs -.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod__smime__gpgme_8c_source.html#l00058">crypt_mod_smime_gpgme.c:58</a></div></div>
<div class="ttc" id="agroup__crypto__api_html_ga499a72d2fd05f50e46774c5969964835"><div class="ttname"><a href="group__crypto__api.html#ga499a72d2fd05f50e46774c5969964835">CryptModSmimeClassic</a></div><div class="ttdeci">const struct CryptModuleSpecs CryptModSmimeClassic</div><div class="ttdoc">CLI SMIME - Implements CryptModuleSpecs -.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod__smime__classic_8c_source.html#l00056">crypt_mod_smime_classic.c:56</a></div></div>
<div class="ttc" id="agroup__crypto__api_html_ga808d0d336f52e42a5b9da3762aff4f0c"><div class="ttname"><a href="group__crypto__api.html#ga808d0d336f52e42a5b9da3762aff4f0c">CryptModPgpGpgme</a></div><div class="ttdeci">const struct CryptModuleSpecs CryptModPgpGpgme</div><div class="ttdoc">GPGME PGP - Implements CryptModuleSpecs -.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod__pgp__gpgme_8c_source.html#l00058">crypt_mod_pgp_gpgme.c:58</a></div></div>
<div class="ttc" id="agroup__crypto__api_html_ga9938cbc74b33ff75be208a4d2d26121a"><div class="ttname"><a href="group__crypto__api.html#ga9938cbc74b33ff75be208a4d2d26121a">CryptModPgpClassic</a></div><div class="ttdeci">const struct CryptModuleSpecs CryptModPgpClassic</div><div class="ttdoc">CLI PGP - Implements CryptModuleSpecs -.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod__pgp__classic_8c_source.html#l00042">crypt_mod_pgp_classic.c:42</a></div></div>
</div><!-- fragment --><div id="dynsection-32" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-32-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-32-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-32-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_aaecf706c319966f9eafd582b58ba531f_cgraph.svg" width="308" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-33" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-33-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-33-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-33-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_aaecf706c319966f9eafd582b58ba531f_icgraph.svg" width="190" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a166ec08d102f4330fdd0cc44a32bdf96" name="a166ec08d102f4330fdd0cc44a32bdf96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a166ec08d102f4330fdd0cc44a32bdf96">&#9670;&#160;</a></span>crypt_invoke_message()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_invoke_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Display an informative message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Crypto type, see <a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d" title="Flags, e.g. SEC_ENCRYPT.">SecurityFlags</a></td></tr>
  </table>
  </dd>
</dl>
<p>Show a message that a backend will be invoked. </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00156">156</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  157</span>{</div>
<div class="line"><span class="lineno">  158</span>  <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>) != 0) &amp;&amp; (type &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>))</div>
<div class="line"><span class="lineno">  159</span>    <a class="code hl_define" href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Invoking PGP...&quot;</span>));</div>
<div class="line"><span class="lineno">  160</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((<a class="code hl_define" href="ncrypt_2lib_8h.html#ad980bff69bb614893ad8e7e1c28a5023">WithCrypto</a> &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>) != 0) &amp;&amp; (type &amp; <a class="code hl_define" href="ncrypt_2lib_8h.html#a798dfac1e8839ca89375b4ec62b3eff2">APPLICATION_SMIME</a>))</div>
<div class="line"><span class="lineno">  161</span>    <a class="code hl_define" href="group__logging__api.html#gae108f891125caafa9250cf0959c40c04">mutt_message</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;Invoking S/MIME...&quot;</span>));</div>
<div class="line"><span class="lineno">  162</span>}</div>
</div><!-- fragment --><div id="dynsection-34" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-34-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-34-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-34-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a166ec08d102f4330fdd0cc44a32bdf96_icgraph.svg" width="320" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a5959b6797c94b22a7d391cbb5fd2fa33" name="a5959b6797c94b22a7d391cbb5fd2fa33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5959b6797c94b22a7d391cbb5fd2fa33">&#9670;&#160;</a></span>crypt_pgp_check_traditional()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool crypt_pgp_check_traditional </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>just_one</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#abbb74e663273948a7e2ad35a1135e6a2">CryptModuleSpecs::pgp_check_traditional()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00282">282</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  283</span>{</div>
<div class="line"><span class="lineno">  284</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, pgp_check_traditional))</div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, pgp_check_traditional)(fp, b, just_one);</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  288</span>}</div>
</div><!-- fragment --><div id="dynsection-35" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-35-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-35-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-35-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a5959b6797c94b22a7d391cbb5fd2fa33_icgraph.svg" width="410" height="102"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2451c9278c3e8a9f69c80384419b3822" name="a2451c9278c3e8a9f69c80384419b3822"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2451c9278c3e8a9f69c80384419b3822">&#9670;&#160;</a></span>crypt_pgp_decrypt_mime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_pgp_decrypt_mime </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE **&#160;</td>
          <td class="paramname"><em>fp_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> **&#160;</td>
          <td class="paramname"><em>b_dec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a18cf5903d388ba3cc91431e5076271ee">CryptModuleSpecs::decrypt_mime()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00210">210</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  211</span>{</div>
<div class="line"><span class="lineno">  212</span><span class="preprocessor">#ifdef USE_AUTOCRYPT</span></div>
<div class="line"><span class="lineno">  213</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> c_autocrypt = <a class="code hl_function" href="config_2helpers_8c.html#ae50f679dd6c5bd1ba820884c8602f038">cs_subset_bool</a>(<a class="code hl_struct" href="structNeoMutt.html">NeoMutt</a>-&gt;<a class="code hl_variable" href="structNeoMutt.html#af98065e32243ce9331f93b7f30247d47">sub</a>, <span class="stringliteral">&quot;autocrypt&quot;</span>);</div>
<div class="line"><span class="lineno">  214</span>  <span class="keywordflow">if</span> (c_autocrypt)</div>
<div class="line"><span class="lineno">  215</span>  {</div>
<div class="line"><span class="lineno">  216</span>    <a class="code hl_variable" href="globals_8c.html#a1137c8074e2a6ff941529fc8e64fbca5">OptAutocryptGpgme</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  217</span>    <span class="keywordtype">int</span> result = <a class="code hl_function" href="group__crypto__decrypt__mime.html#ga5d822f6985e4a58d377b8d37367ccc84">pgp_gpgme_decrypt_mime</a>(fp_in, fp_out, b, b_dec);</div>
<div class="line"><span class="lineno">  218</span>    <a class="code hl_variable" href="globals_8c.html#a1137c8074e2a6ff941529fc8e64fbca5">OptAutocryptGpgme</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">if</span> (result == 0)</div>
<div class="line"><span class="lineno">  220</span>    {</div>
<div class="line"><span class="lineno">  221</span>      b-&gt;<a class="code hl_variable" href="structBody.html#a63e1a4c2a0bacf3d1d5869edfebed0dd">is_autocrypt</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  222</span>      <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  223</span>    }</div>
<div class="line"><span class="lineno">  224</span>  }</div>
<div class="line"><span class="lineno">  225</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, decrypt_mime))</div>
<div class="line"><span class="lineno">  228</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, decrypt_mime)(fp_in, fp_out, b, b_dec);</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  231</span>}</div>
<div class="ttc" id="aglobals_8c_html_a1137c8074e2a6ff941529fc8e64fbca5"><div class="ttname"><a href="globals_8c.html#a1137c8074e2a6ff941529fc8e64fbca5">OptAutocryptGpgme</a></div><div class="ttdeci">bool OptAutocryptGpgme</div><div class="ttdoc">(pseudo) use Autocrypt context inside ncrypt/crypt_gpgme.c</div><div class="ttdef"><b>Definition:</b> <a href="globals_8c_source.html#l00055">globals.c:55</a></div></div>
<div class="ttc" id="agroup__crypto__decrypt__mime_html_ga5d822f6985e4a58d377b8d37367ccc84"><div class="ttname"><a href="group__crypto__decrypt__mime.html#ga5d822f6985e4a58d377b8d37367ccc84">pgp_gpgme_decrypt_mime</a></div><div class="ttdeci">int pgp_gpgme_decrypt_mime(FILE *fp_in, FILE **fp_out, struct Body *b, struct Body **b_dec)</div><div class="ttdoc">Decrypt an encrypted MIME part - Implements CryptModuleSpecs::decrypt_mime() -.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l01894">crypt_gpgme.c:1894</a></div></div>
</div><!-- fragment --><div id="dynsection-36" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-36-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-36-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-36-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a2451c9278c3e8a9f69c80384419b3822_cgraph.svg" width="428" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-37" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-37-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-37-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-37-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a2451c9278c3e8a9f69c80384419b3822_icgraph.svg" width="446" height="159"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8a454ff57ec235e3472ef42872f00042" name="a8a454ff57ec235e3472ef42872f00042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a454ff57ec235e3472ef42872f00042">&#9670;&#160;</a></span>crypt_pgp_extract_key_from_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_pgp_extract_key_from_attachment </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a7660e30a85a5ae60da1a384d1d351272">CryptModuleSpecs::pgp_extract_key_from_attachment()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00394">394</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  395</span>{</div>
<div class="line"><span class="lineno">  396</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, pgp_extract_key_from_attachment))</div>
<div class="line"><span class="lineno">  397</span>    <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, pgp_extract_key_from_attachment)(fp, b);</div>
<div class="line"><span class="lineno">  398</span>}</div>
</div><!-- fragment --><div id="dynsection-38" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-38-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-38-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-38-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a8a454ff57ec235e3472ef42872f00042_icgraph.svg" width="352" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a7d989caa27c6539e55662007a6cf2cc5" name="a7d989caa27c6539e55662007a6cf2cc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d989caa27c6539e55662007a6cf2cc5">&#9670;&#160;</a></span>crypt_pgp_invoke_getkeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_pgp_invoke_getkeys </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structAddress.html">Address</a> *&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#acd2b13751354a0ea6dc82ee6bbdf3724">CryptModuleSpecs::pgp_invoke_getkeys()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00273">273</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  274</span>{</div>
<div class="line"><span class="lineno">  275</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, pgp_invoke_getkeys))</div>
<div class="line"><span class="lineno">  276</span>    <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, pgp_invoke_getkeys)(addr);</div>
<div class="line"><span class="lineno">  277</span>}</div>
</div><!-- fragment --><div id="dynsection-39" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-39-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-39-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-39-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a7d989caa27c6539e55662007a6cf2cc5_icgraph.svg" width="343" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a6ff317859513ab653641114e19fb8f59" name="a6ff317859513ab653641114e19fb8f59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ff317859513ab653641114e19fb8f59">&#9670;&#160;</a></span>crypt_pgp_make_key_attachment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structBody.html">Body</a> * crypt_pgp_make_key_attachment </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a8331dbbb3603bed062e7e80342a97b4f">CryptModuleSpecs::pgp_make_key_attachment()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00304">304</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  305</span>{</div>
<div class="line"><span class="lineno">  306</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, pgp_make_key_attachment))</div>
<div class="line"><span class="lineno">  307</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, pgp_make_key_attachment)();</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  310</span>}</div>
</div><!-- fragment --><div id="dynsection-40" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-40-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-40-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-40-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a6ff317859513ab653641114e19fb8f59_icgraph.svg" width="396" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a797309f2fd7a80c9f5a3b97944e37c4b" name="a797309f2fd7a80c9f5a3b97944e37c4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a797309f2fd7a80c9f5a3b97944e37c4b">&#9670;&#160;</a></span>crypt_pgp_send_menu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> crypt_pgp_send_menu </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#aa5176c9adfe75f78d99e4c2bd7e6671c">CryptModuleSpecs::send_menu()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00383">383</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  384</span>{</div>
<div class="line"><span class="lineno">  385</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(PGP, send_menu))</div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(PGP, send_menu)(e);</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  389</span>}</div>
</div><!-- fragment --><div id="dynsection-41" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-41-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-41-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-41-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a797309f2fd7a80c9f5a3b97944e37c4b_icgraph.svg" width="394" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aa21c1df7a3803c79c0a79426ec2f4aa2" name="aa21c1df7a3803c79c0a79426ec2f4aa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa21c1df7a3803c79c0a79426ec2f4aa2">&#9670;&#160;</a></span>crypt_smime_decrypt_mime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_smime_decrypt_mime </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE **&#160;</td>
          <td class="paramname"><em>fp_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structBody.html">Body</a> **&#160;</td>
          <td class="paramname"><em>b_dec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a18cf5903d388ba3cc91431e5076271ee">CryptModuleSpecs::decrypt_mime()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00432">432</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  433</span>{</div>
<div class="line"><span class="lineno">  434</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, decrypt_mime))</div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, decrypt_mime)(fp_in, fp_out, b, b_dec);</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>  <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  438</span>}</div>
</div><!-- fragment --><div id="dynsection-42" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-42-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-42-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-42-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_aa21c1df7a3803c79c0a79426ec2f4aa2_icgraph.svg" width="463" height="159"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a3f60f47f4d4dee7f43f502b7244af35f" name="a3f60f47f4d4dee7f43f502b7244af35f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f60f47f4d4dee7f43f502b7244af35f">&#9670;&#160;</a></span>crypt_smime_getkeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypt_smime_getkeys </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEnvelope.html">Envelope</a> *&#160;</td>
          <td class="paramname"><em>env</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#a555d3da530f7c25207fcbae9efa8ab03">CryptModuleSpecs::smime_getkeys()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00454">454</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  455</span>{</div>
<div class="line"><span class="lineno">  456</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, smime_getkeys))</div>
<div class="line"><span class="lineno">  457</span>    <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, smime_getkeys)(env);</div>
<div class="line"><span class="lineno">  458</span>}</div>
</div><!-- fragment --><div id="dynsection-43" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-43-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-43-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-43-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a3f60f47f4d4dee7f43f502b7244af35f_icgraph.svg" width="422" height="199"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a7354df32a82355b8df8c38ea1afc06cc" name="a7354df32a82355b8df8c38ea1afc06cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7354df32a82355b8df8c38ea1afc06cc">&#9670;&#160;</a></span>crypt_smime_send_menu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="ncrypt_2lib_8h.html#a2073a168ca3a64c3c30d13fa4917a05d">SecurityFlags</a> crypt_smime_send_menu </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#aa5176c9adfe75f78d99e4c2bd7e6671c">CryptModuleSpecs::send_menu()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00527">527</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  528</span>{</div>
<div class="line"><span class="lineno">  529</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, send_menu))</div>
<div class="line"><span class="lineno">  530</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, send_menu)(e);</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  533</span>}</div>
</div><!-- fragment --><div id="dynsection-44" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-44-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-44-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-44-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a7354df32a82355b8df8c38ea1afc06cc_icgraph.svg" width="427" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a9c2837a7a6ddee675a5ddfd5545244c1" name="a9c2837a7a6ddee675a5ddfd5545244c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c2837a7a6ddee675a5ddfd5545244c1">&#9670;&#160;</a></span>crypt_smime_verify_sender()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crypt_smime_verify_sender </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structEmail.html">Email</a> *&#160;</td>
          <td class="paramname"><em>e</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structMessage.html">Message</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper for <a class="el" href="structCryptModuleSpecs.html#ab1befdfed56bdbcdd6f42b174a66fe1a">CryptModuleSpecs::smime_verify_sender()</a> </p>

<p class="definition">Definition at line <a class="el" href="cryptglue_8c_source.html#l00463">463</a> of file <a class="el" href="cryptglue_8c_source.html">cryptglue.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  464</span>{</div>
<div class="line"><span class="lineno">  465</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="cryptglue_8c.html#a69a7f3b98b67a0831a8a5e3fc47d5c93">CRYPT_MOD_CALL_CHECK</a>(SMIME, smime_verify_sender))</div>
<div class="line"><span class="lineno">  466</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="cryptglue_8c.html#acaf721ab817757c241a5abd18fc8618b">CRYPT_MOD_CALL</a>(SMIME, smime_verify_sender)(e, msg);</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>  <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  469</span>}</div>
</div><!-- fragment --><div id="dynsection-45" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-45-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-45-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-45-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a9c2837a7a6ddee675a5ddfd5545244c1_icgraph.svg" width="306" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a626ef0840a8870758022db54646c12ae" name="a626ef0840a8870758022db54646c12ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a626ef0840a8870758022db54646c12ae">&#9670;&#160;</a></span>crypto_module_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_module_cleanup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean up the crypto modules. </p>

<p class="definition">Definition at line <a class="el" href="crypt__mod_8c_source.html#l00084">84</a> of file <a class="el" href="crypt__mod_8c_source.html">crypt_mod.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   85</span>{</div>
<div class="line"><span class="lineno">   86</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structCryptModule.html">CryptModule</a> *np = NULL, *tmp = NULL;</div>
<div class="line"><span class="lineno">   87</span>  <a class="code hl_define" href="queue_8h.html#ac3203dcce73148c142df4586eb55ce55">STAILQ_FOREACH_SAFE</a>(np, &amp;<a class="code hl_variable" href="crypt__mod_8c.html#af02141bb2d6f54361dee65146fc22c82">CryptModules</a>, entries, tmp)</div>
<div class="line"><span class="lineno">   88</span>  {</div>
<div class="line"><span class="lineno">   89</span>    <a class="code hl_define" href="queue_8h.html#a2a0d6665f277f80bf301a16e6ab2403c">STAILQ_REMOVE</a>(&amp;<a class="code hl_variable" href="crypt__mod_8c.html#af02141bb2d6f54361dee65146fc22c82">CryptModules</a>, np, <a class="code hl_struct" href="structCryptModule.html">CryptModule</a>, entries);</div>
<div class="line"><span class="lineno">   90</span>    <a class="code hl_define" href="memory_8h.html#a25875003b43b81a4302256caa4a13599">FREE</a>(&amp;np);</div>
<div class="line"><span class="lineno">   91</span>  }</div>
<div class="line"><span class="lineno">   92</span>}</div>
<div class="ttc" id="acrypt__mod_8c_html_af02141bb2d6f54361dee65146fc22c82"><div class="ttname"><a href="crypt__mod_8c.html#af02141bb2d6f54361dee65146fc22c82">CryptModules</a></div><div class="ttdeci">static struct CryptModuleList CryptModules</div><div class="ttdoc">Linked list of crypto modules, e.g. CryptModSmimeClassic, CryptModPgpGpgme.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod_8c_source.html#l00048">crypt_mod.c:48</a></div></div>
<div class="ttc" id="aqueue_8h_html_a2a0d6665f277f80bf301a16e6ab2403c"><div class="ttname"><a href="queue_8h.html#a2a0d6665f277f80bf301a16e6ab2403c">STAILQ_REMOVE</a></div><div class="ttdeci">#define STAILQ_REMOVE(head, elm, type, field)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00441">queue.h:441</a></div></div>
<div class="ttc" id="aqueue_8h_html_ac3203dcce73148c142df4586eb55ce55"><div class="ttname"><a href="queue_8h.html#ac3203dcce73148c142df4586eb55ce55">STAILQ_FOREACH_SAFE</a></div><div class="ttdeci">#define STAILQ_FOREACH_SAFE(var, head, field, tvar)</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00400">queue.h:400</a></div></div>
<div class="ttc" id="astructCryptModule_html"><div class="ttname"><a href="structCryptModule.html">CryptModule</a></div><div class="ttdoc">A crypto plugin module.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__mod_8c_source.html#l00040">crypt_mod.c:41</a></div></div>
</div><!-- fragment --><div id="dynsection-46" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-46-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-46-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-46-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a626ef0840a8870758022db54646c12ae_icgraph.svg" width="280" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2e8df329d00791c453eb6b3f60eabfdf" name="a2e8df329d00791c453eb6b3f60eabfdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e8df329d00791c453eb6b3f60eabfdf">&#9670;&#160;</a></span>mutt_gpgme_select_secret_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mutt_gpgme_select_secret_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structBuffer.html">Buffer</a> *&#160;</td>
          <td class="paramname"><em>keyid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select a private Autocrypt key for a new account. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">keyid</td><td>Autocrypt Key id </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success </td></tr>
    <tr><td class="paramname">-1</td><td>Error</td></tr>
  </table>
  </dd>
</dl>
<p>Unfortunately, the internal <a class="el" href="crypt__gpgme_8c.html" title="Wrapper for PGP/SMIME calls to GPGME.">ncrypt/crypt_gpgme.c</a> functions use <a class="el" href="structCryptKeyInfo.html" title="A stored PGP key.">CryptKeyInfo</a>, and so aren't exportable.</p>
<p>This function queries all private keys, provides the crypt_select_keys() menu, and returns the selected key fingerprint in keyid. </p>

<p class="definition">Definition at line <a class="el" href="crypt__gpgme_8c_source.html#l03683">3683</a> of file <a class="el" href="crypt__gpgme_8c_source.html">crypt_gpgme.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3684</span>{</div>
<div class="line"><span class="lineno"> 3685</span>  <span class="keywordtype">int</span> rc = -1;</div>
<div class="line"><span class="lineno"> 3686</span>  gpgme_error_t err = GPG_ERR_NO_ERROR;</div>
<div class="line"><span class="lineno"> 3687</span>  gpgme_key_t key = NULL;</div>
<div class="line"><span class="lineno"> 3688</span>  gpgme_user_id_t uid = NULL;</div>
<div class="line"><span class="lineno"> 3689</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structCryptKeyInfo.html">CryptKeyInfo</a> *results = NULL, *k = NULL;</div>
<div class="line"><span class="lineno"> 3690</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structCryptKeyInfo.html">CryptKeyInfo</a> **kend = NULL;</div>
<div class="line"><span class="lineno"> 3691</span>  <span class="keyword">struct </span><a class="code hl_struct" href="structCryptKeyInfo.html">CryptKeyInfo</a> *choice = NULL;</div>
<div class="line"><span class="lineno"> 3692</span> </div>
<div class="line"><span class="lineno"> 3693</span>  gpgme_ctx_t ctx = <a class="code hl_function" href="crypt__gpgme_8c.html#a54ca8638b13c6da904a48009a8bba358">create_gpgme_context</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3694</span> </div>
<div class="line"><span class="lineno"> 3695</span>  <span class="comment">/* list all secret keys */</span></div>
<div class="line"><span class="lineno"> 3696</span>  <span class="keywordflow">if</span> (gpgme_op_keylist_start(ctx, NULL, 1))</div>
<div class="line"><span class="lineno"> 3697</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno"> 3698</span> </div>
<div class="line"><span class="lineno"> 3699</span>  kend = &amp;results;</div>
<div class="line"><span class="lineno"> 3700</span> </div>
<div class="line"><span class="lineno"> 3701</span>  <span class="keywordflow">while</span> ((err = gpgme_op_keylist_next(ctx, &amp;key)) == GPG_ERR_NO_ERROR)</div>
<div class="line"><span class="lineno"> 3702</span>  {</div>
<div class="line"><span class="lineno"> 3703</span>    <a class="code hl_typedef" href="ncrypt_2lib_8h.html#a530487c28aacc2c2d50f12eefb8c5506">KeyFlags</a> <a class="code hl_variable" href="structCryptKeyInfo.html#a2894df08ee0680de1cb45856e8169bda">flags</a> = <a class="code hl_define" href="ncrypt_2lib_8h.html#a827146354c736ec416508944692e52b2">KEYFLAG_NO_FLAGS</a>;</div>
<div class="line"><span class="lineno"> 3704</span> </div>
<div class="line"><span class="lineno"> 3705</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="crypt__gpgme_8c.html#abb291e3ef82be0b81dd87945790b1ab8">key_check_cap</a>(key, <a class="code hl_enumvalue" href="crypt__gpgme_8h.html#aedb110bc0a5b06622df514a7b1f9bca7a75ebf9fda903040f7f471570de3b8007">KEY_CAP_CAN_ENCRYPT</a>))</div>
<div class="line"><span class="lineno"> 3706</span>      <a class="code hl_variable" href="structCryptKeyInfo.html#a2894df08ee0680de1cb45856e8169bda">flags</a> |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a7254adf21a76d4ceea08bd931df4310f">KEYFLAG_CANENCRYPT</a>;</div>
<div class="line"><span class="lineno"> 3707</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="crypt__gpgme_8c.html#abb291e3ef82be0b81dd87945790b1ab8">key_check_cap</a>(key, <a class="code hl_enumvalue" href="crypt__gpgme_8h.html#aedb110bc0a5b06622df514a7b1f9bca7ae432daf7afa64983a95cfd196db416d4">KEY_CAP_CAN_SIGN</a>))</div>
<div class="line"><span class="lineno"> 3708</span>      <a class="code hl_variable" href="structCryptKeyInfo.html#a2894df08ee0680de1cb45856e8169bda">flags</a> |= <a class="code hl_define" href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f">KEYFLAG_CANSIGN</a>;</div>
<div class="line"><span class="lineno"> 3709</span> </div>
<div class="line"><span class="lineno"> 3710</span>    <span class="keywordflow">if</span> (key-&gt;revoked)</div>
<div class="line"><span class="lineno"> 3711</span>      <a class="code hl_variable" href="structCryptKeyInfo.html#a2894df08ee0680de1cb45856e8169bda">flags</a> |= <a class="code hl_define" href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">KEYFLAG_REVOKED</a>;</div>
<div class="line"><span class="lineno"> 3712</span>    <span class="keywordflow">if</span> (key-&gt;expired)</div>
<div class="line"><span class="lineno"> 3713</span>      <a class="code hl_variable" href="structCryptKeyInfo.html#a2894df08ee0680de1cb45856e8169bda">flags</a> |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a20472f13517d60d40aa75287afc81c5d">KEYFLAG_EXPIRED</a>;</div>
<div class="line"><span class="lineno"> 3714</span>    <span class="keywordflow">if</span> (key-&gt;disabled)</div>
<div class="line"><span class="lineno"> 3715</span>      <a class="code hl_variable" href="structCryptKeyInfo.html#a2894df08ee0680de1cb45856e8169bda">flags</a> |= <a class="code hl_define" href="ncrypt_2lib_8h.html#a989f3449b764c6a8f5f5e0481569884a">KEYFLAG_DISABLED</a>;</div>
<div class="line"><span class="lineno"> 3716</span> </div>
<div class="line"><span class="lineno"> 3717</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="structCryptKeyInfo.html#a50a205646d0bad20dac5dd051dcd1b20">idx</a>;</div>
<div class="line"><span class="lineno"> 3718</span>    <span class="keywordflow">for</span> (<a class="code hl_variable" href="structCryptKeyInfo.html#a50a205646d0bad20dac5dd051dcd1b20">idx</a> = 0, <a class="code hl_variable" href="structCryptKeyInfo.html#ad919b2d8bdd41f9d972b1325c88934d8">uid</a> = key-&gt;uids; <a class="code hl_variable" href="structCryptKeyInfo.html#ad919b2d8bdd41f9d972b1325c88934d8">uid</a>; <a class="code hl_variable" href="structCryptKeyInfo.html#a50a205646d0bad20dac5dd051dcd1b20">idx</a>++, <a class="code hl_variable" href="structCryptKeyInfo.html#ad919b2d8bdd41f9d972b1325c88934d8">uid</a> = <a class="code hl_variable" href="structCryptKeyInfo.html#ad919b2d8bdd41f9d972b1325c88934d8">uid</a>-&gt;next)</div>
<div class="line"><span class="lineno"> 3719</span>    {</div>
<div class="line"><span class="lineno"> 3720</span>      k = <a class="code hl_define" href="memory_8h.html#a9aaf8f21a29735767a069ff1aee9d7d9">MUTT_MEM_CALLOC</a>(1, <span class="keyword">struct</span> <a class="code hl_struct" href="structCryptKeyInfo.html">CryptKeyInfo</a>);</div>
<div class="line"><span class="lineno"> 3721</span>      k-&gt;kobj = key;</div>
<div class="line"><span class="lineno"> 3722</span>      gpgme_key_ref(k-&gt;kobj);</div>
<div class="line"><span class="lineno"> 3723</span>      k-&gt;idx = <a class="code hl_variable" href="structCryptKeyInfo.html#a50a205646d0bad20dac5dd051dcd1b20">idx</a>;</div>
<div class="line"><span class="lineno"> 3724</span>      k-&gt;uid = <a class="code hl_variable" href="structCryptKeyInfo.html#ad919b2d8bdd41f9d972b1325c88934d8">uid</a>-&gt;uid;</div>
<div class="line"><span class="lineno"> 3725</span>      k-&gt;flags = <a class="code hl_variable" href="structCryptKeyInfo.html#a2894df08ee0680de1cb45856e8169bda">flags</a>;</div>
<div class="line"><span class="lineno"> 3726</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="structCryptKeyInfo.html#ad919b2d8bdd41f9d972b1325c88934d8">uid</a>-&gt;revoked)</div>
<div class="line"><span class="lineno"> 3727</span>        k-&gt;flags |= <a class="code hl_define" href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">KEYFLAG_REVOKED</a>;</div>
<div class="line"><span class="lineno"> 3728</span>      k-&gt;validity = <a class="code hl_variable" href="structCryptKeyInfo.html#ad919b2d8bdd41f9d972b1325c88934d8">uid</a>-&gt;validity;</div>
<div class="line"><span class="lineno"> 3729</span>      *kend = k;</div>
<div class="line"><span class="lineno"> 3730</span>      kend = &amp;k-&gt;<a class="code hl_variable" href="structCryptKeyInfo.html#a6ff63ed6d46d28597f6e51b7720fb006">next</a>;</div>
<div class="line"><span class="lineno"> 3731</span>    }</div>
<div class="line"><span class="lineno"> 3732</span>    gpgme_key_unref(key);</div>
<div class="line"><span class="lineno"> 3733</span>  }</div>
<div class="line"><span class="lineno"> 3734</span>  <span class="keywordflow">if</span> (gpg_err_code(err) != GPG_ERR_EOF)</div>
<div class="line"><span class="lineno"> 3735</span>    <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;gpgme_op_keylist_next failed: %s&quot;</span>), gpgme_strerror(err));</div>
<div class="line"><span class="lineno"> 3736</span>  gpgme_op_keylist_end(ctx);</div>
<div class="line"><span class="lineno"> 3737</span> </div>
<div class="line"><span class="lineno"> 3738</span>  <span class="keywordflow">if</span> (!results)</div>
<div class="line"><span class="lineno"> 3739</span>  {</div>
<div class="line"><span class="lineno"> 3740</span>    <span class="comment">/* L10N: mutt_gpgme_select_secret_key() tries to list all secret keys to choose</span></div>
<div class="line"><span class="lineno"> 3741</span><span class="comment">       from.  This error is displayed if no results were found.  */</span></div>
<div class="line"><span class="lineno"> 3742</span>    <a class="code hl_define" href="group__logging__api.html#gacc1fd6d7ab1603e80e11e84e90d061e4">mutt_error</a>(<a class="code hl_define" href="mutt_2message_8h.html#a479d658dfd60fe8d9709ec67a58b34ca">_</a>(<span class="stringliteral">&quot;No secret keys found&quot;</span>));</div>
<div class="line"><span class="lineno"> 3743</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno"> 3744</span>  }</div>
<div class="line"><span class="lineno"> 3745</span> </div>
<div class="line"><span class="lineno"> 3746</span>  choice = <a class="code hl_function" href="group__gui__dlg.html#ga067e027820ea20630ff23e4774c206ea">dlg_gpgme</a>(results, NULL, <span class="stringliteral">&quot;*&quot;</span>, <a class="code hl_define" href="ncrypt_2lib_8h.html#a587e679a4c9cc44f11f0c467bb22b0af">APPLICATION_PGP</a>, NULL);</div>
<div class="line"><span class="lineno"> 3747</span>  <span class="keywordflow">if</span> (!(choice &amp;&amp; choice-&gt;<a class="code hl_variable" href="structCryptKeyInfo.html#ae1f570089508f19aa36f6c1cdb31eca0">kobj</a> &amp;&amp; choice-&gt;<a class="code hl_variable" href="structCryptKeyInfo.html#ae1f570089508f19aa36f6c1cdb31eca0">kobj</a>-&gt;subkeys &amp;&amp; choice-&gt;<a class="code hl_variable" href="structCryptKeyInfo.html#ae1f570089508f19aa36f6c1cdb31eca0">kobj</a>-&gt;subkeys-&gt;fpr))</div>
<div class="line"><span class="lineno"> 3748</span>    <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="lineno"> 3749</span>  <a class="code hl_function" href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a>(keyid, choice-&gt;<a class="code hl_variable" href="structCryptKeyInfo.html#ae1f570089508f19aa36f6c1cdb31eca0">kobj</a>-&gt;subkeys-&gt;fpr);</div>
<div class="line"><span class="lineno"> 3750</span> </div>
<div class="line"><span class="lineno"> 3751</span>  rc = 0;</div>
<div class="line"><span class="lineno"> 3752</span> </div>
<div class="line"><span class="lineno"> 3753</span>cleanup:</div>
<div class="line"><span class="lineno"> 3754</span>  <a class="code hl_function" href="crypt__gpgme_8c.html#ae007f214cde6d7245c8a5ca70da0e4de">crypt_key_free</a>(&amp;choice);</div>
<div class="line"><span class="lineno"> 3755</span>  <a class="code hl_function" href="crypt__gpgme_8c.html#ae007f214cde6d7245c8a5ca70da0e4de">crypt_key_free</a>(&amp;results);</div>
<div class="line"><span class="lineno"> 3756</span>  gpgme_release(ctx);</div>
<div class="line"><span class="lineno"> 3757</span>  <span class="keywordflow">return</span> rc;</div>
<div class="line"><span class="lineno"> 3758</span>}</div>
<div class="ttc" id="abuffer_8c_html_ac958acbd189e463a2c3bbc2f23aaeb1e"><div class="ttname"><a href="buffer_8c.html#ac958acbd189e463a2c3bbc2f23aaeb1e">buf_strcpy</a></div><div class="ttdeci">size_t buf_strcpy(struct Buffer *buf, const char *s)</div><div class="ttdoc">Copy a string into a Buffer.</div><div class="ttdef"><b>Definition:</b> <a href="buffer_8c_source.html#l00395">buffer.c:395</a></div></div>
<div class="ttc" id="acrypt__gpgme_8c_html_a54ca8638b13c6da904a48009a8bba358"><div class="ttname"><a href="crypt__gpgme_8c.html#a54ca8638b13c6da904a48009a8bba358">create_gpgme_context</a></div><div class="ttdeci">gpgme_ctx_t create_gpgme_context(bool for_smime)</div><div class="ttdoc">Create a new GPGME context.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l00361">crypt_gpgme.c:361</a></div></div>
<div class="ttc" id="acrypt__gpgme_8c_html_abb291e3ef82be0b81dd87945790b1ab8"><div class="ttname"><a href="crypt__gpgme_8c.html#abb291e3ef82be0b81dd87945790b1ab8">key_check_cap</a></div><div class="ttdeci">unsigned int key_check_cap(gpgme_key_t key, enum KeyCap cap)</div><div class="ttdoc">Check the capabilities of a key.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l02946">crypt_gpgme.c:2946</a></div></div>
<div class="ttc" id="acrypt__gpgme_8c_html_ae007f214cde6d7245c8a5ca70da0e4de"><div class="ttname"><a href="crypt__gpgme_8c.html#ae007f214cde6d7245c8a5ca70da0e4de">crypt_key_free</a></div><div class="ttdeci">static void crypt_key_free(struct CryptKeyInfo **keylist)</div><div class="ttdoc">Release all the keys in a list.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8c_source.html#l00253">crypt_gpgme.c:253</a></div></div>
<div class="ttc" id="acrypt__gpgme_8h_html_aedb110bc0a5b06622df514a7b1f9bca7a75ebf9fda903040f7f471570de3b8007"><div class="ttname"><a href="crypt__gpgme_8h.html#aedb110bc0a5b06622df514a7b1f9bca7a75ebf9fda903040f7f471570de3b8007">KEY_CAP_CAN_ENCRYPT</a></div><div class="ttdeci">@ KEY_CAP_CAN_ENCRYPT</div><div class="ttdoc">Key can be used for encryption.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00077">crypt_gpgme.h:77</a></div></div>
<div class="ttc" id="acrypt__gpgme_8h_html_aedb110bc0a5b06622df514a7b1f9bca7ae432daf7afa64983a95cfd196db416d4"><div class="ttname"><a href="crypt__gpgme_8h.html#aedb110bc0a5b06622df514a7b1f9bca7ae432daf7afa64983a95cfd196db416d4">KEY_CAP_CAN_SIGN</a></div><div class="ttdeci">@ KEY_CAP_CAN_SIGN</div><div class="ttdoc">Key can be used for signing.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00078">crypt_gpgme.h:78</a></div></div>
<div class="ttc" id="agroup__gui__dlg_html_ga067e027820ea20630ff23e4774c206ea"><div class="ttname"><a href="group__gui__dlg.html#ga067e027820ea20630ff23e4774c206ea">dlg_gpgme</a></div><div class="ttdeci">struct CryptKeyInfo * dlg_gpgme(struct CryptKeyInfo *keys, struct Address *p, const char *s, unsigned int app, bool *forced_valid)</div><div class="ttdoc">Get the user to select a key -.</div><div class="ttdef"><b>Definition:</b> <a href="dlg__gpgme_8c_source.html#l00195">dlg_gpgme.c:195</a></div></div>
<div class="ttc" id="amemory_8h_html_a9aaf8f21a29735767a069ff1aee9d7d9"><div class="ttname"><a href="memory_8h.html#a9aaf8f21a29735767a069ff1aee9d7d9">MUTT_MEM_CALLOC</a></div><div class="ttdeci">#define MUTT_MEM_CALLOC(n, type)</div><div class="ttdef"><b>Definition:</b> <a href="memory_8h_source.html#l00047">memory.h:47</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a20472f13517d60d40aa75287afc81c5d"><div class="ttname"><a href="ncrypt_2lib_8h.html#a20472f13517d60d40aa75287afc81c5d">KEYFLAG_EXPIRED</a></div><div class="ttdeci">#define KEYFLAG_EXPIRED</div><div class="ttdoc">Key is expired.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00137">lib.h:137</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a530487c28aacc2c2d50f12eefb8c5506"><div class="ttname"><a href="ncrypt_2lib_8h.html#a530487c28aacc2c2d50f12eefb8c5506">KeyFlags</a></div><div class="ttdeci">uint16_t KeyFlags</div><div class="ttdoc">Flags describing PGP/SMIME keys, e.g. KEYFLAG_CANSIGN.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00131">lib.h:131</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a7254adf21a76d4ceea08bd931df4310f"><div class="ttname"><a href="ncrypt_2lib_8h.html#a7254adf21a76d4ceea08bd931df4310f">KEYFLAG_CANENCRYPT</a></div><div class="ttdeci">#define KEYFLAG_CANENCRYPT</div><div class="ttdoc">Key is suitable for encryption.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00134">lib.h:134</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a827146354c736ec416508944692e52b2"><div class="ttname"><a href="ncrypt_2lib_8h.html#a827146354c736ec416508944692e52b2">KEYFLAG_NO_FLAGS</a></div><div class="ttdeci">#define KEYFLAG_NO_FLAGS</div><div class="ttdoc">No flags are set.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00132">lib.h:132</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_a989f3449b764c6a8f5f5e0481569884a"><div class="ttname"><a href="ncrypt_2lib_8h.html#a989f3449b764c6a8f5f5e0481569884a">KEYFLAG_DISABLED</a></div><div class="ttdeci">#define KEYFLAG_DISABLED</div><div class="ttdoc">Key is marked disabled.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00139">lib.h:139</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_acb95b48318487d9eb8f9709e933d749e"><div class="ttname"><a href="ncrypt_2lib_8h.html#acb95b48318487d9eb8f9709e933d749e">KEYFLAG_REVOKED</a></div><div class="ttdeci">#define KEYFLAG_REVOKED</div><div class="ttdoc">Key is revoked.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00138">lib.h:138</a></div></div>
<div class="ttc" id="ancrypt_2lib_8h_html_aee8e2da44282ca27f6a786cef781334f"><div class="ttname"><a href="ncrypt_2lib_8h.html#aee8e2da44282ca27f6a786cef781334f">KEYFLAG_CANSIGN</a></div><div class="ttdeci">#define KEYFLAG_CANSIGN</div><div class="ttdoc">Key is suitable for signing.</div><div class="ttdef"><b>Definition:</b> <a href="ncrypt_2lib_8h_source.html#l00133">lib.h:133</a></div></div>
<div class="ttc" id="astructCryptKeyInfo_html"><div class="ttname"><a href="structCryptKeyInfo.html">CryptKeyInfo</a></div><div class="ttdoc">A stored PGP key.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00043">crypt_gpgme.h:44</a></div></div>
<div class="ttc" id="astructCryptKeyInfo_html_a2894df08ee0680de1cb45856e8169bda"><div class="ttname"><a href="structCryptKeyInfo.html#a2894df08ee0680de1cb45856e8169bda">CryptKeyInfo::flags</a></div><div class="ttdeci">KeyFlags flags</div><div class="ttdoc">global and per uid flags (for convenience)</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00049">crypt_gpgme.h:49</a></div></div>
<div class="ttc" id="astructCryptKeyInfo_html_a50a205646d0bad20dac5dd051dcd1b20"><div class="ttname"><a href="structCryptKeyInfo.html#a50a205646d0bad20dac5dd051dcd1b20">CryptKeyInfo::idx</a></div><div class="ttdeci">int idx</div><div class="ttdoc">and the user ID at this index</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00047">crypt_gpgme.h:47</a></div></div>
<div class="ttc" id="astructCryptKeyInfo_html_a6ff63ed6d46d28597f6e51b7720fb006"><div class="ttname"><a href="structCryptKeyInfo.html#a6ff63ed6d46d28597f6e51b7720fb006">CryptKeyInfo::next</a></div><div class="ttdeci">struct CryptKeyInfo * next</div><div class="ttdoc">Linked list.</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00045">crypt_gpgme.h:45</a></div></div>
<div class="ttc" id="astructCryptKeyInfo_html_ad919b2d8bdd41f9d972b1325c88934d8"><div class="ttname"><a href="structCryptKeyInfo.html#ad919b2d8bdd41f9d972b1325c88934d8">CryptKeyInfo::uid</a></div><div class="ttdeci">const char * uid</div><div class="ttdoc">and for convenience point to this user ID</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00048">crypt_gpgme.h:48</a></div></div>
<div class="ttc" id="astructCryptKeyInfo_html_ae1f570089508f19aa36f6c1cdb31eca0"><div class="ttname"><a href="structCryptKeyInfo.html#ae1f570089508f19aa36f6c1cdb31eca0">CryptKeyInfo::kobj</a></div><div class="ttdeci">gpgme_key_t kobj</div><div class="ttdef"><b>Definition:</b> <a href="crypt__gpgme_8h_source.html#l00046">crypt_gpgme.h:46</a></div></div>
</div><!-- fragment --><div id="dynsection-47" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-47-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-47-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-47-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a2e8df329d00791c453eb6b3f60eabfdf_cgraph.svg" width="436" height="234"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div id="dynsection-48" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-48-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-48-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-48-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a2e8df329d00791c453eb6b3f60eabfdf_icgraph.svg" width="442" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a326949d15c60fb5c5de5361c4a88a934" name="a326949d15c60fb5c5de5361c4a88a934"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a326949d15c60fb5c5de5361c4a88a934">&#9670;&#160;</a></span>mutt_gpgme_print_version()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * mutt_gpgme_print_version </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get version of GPGME. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">ptr</td><td>GPGME version string </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypt__gpgme_8c_source.html#l04161">4161</a> of file <a class="el" href="crypt__gpgme_8c_source.html">crypt_gpgme.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4162</span>{</div>
<div class="line"><span class="lineno"> 4163</span>  <span class="keywordflow">return</span> GPGME_VERSION;</div>
<div class="line"><span class="lineno"> 4164</span>}</div>
</div><!-- fragment --><div id="dynsection-49" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-49-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-49-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-49-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="ncrypt_2lib_8h_a326949d15c60fb5c5de5361c4a88a934_icgraph.svg" width="343" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
</body>
</html>
